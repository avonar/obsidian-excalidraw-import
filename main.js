"use strict";var yT=Object.create;var no=Object.defineProperty;var _T=Object.getOwnPropertyDescriptor;var vT=Object.getOwnPropertyNames;var bT=Object.getPrototypeOf,ST=Object.prototype.hasOwnProperty;var R=(n,e)=>()=>(e||n((e={exports:{}}).exports,e),e.exports),ET=(n,e)=>{for(var t in e)no(n,t,{get:e[t],enumerable:!0})},Pg=(n,e,t,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of vT(e))!ST.call(n,i)&&i!==t&&no(n,i,{get:()=>e[i],enumerable:!(r=_T(e,i))||r.enumerable});return n};var iu=(n,e,t)=>(t=n!=null?yT(bT(n)):{},Pg(e||!n||!n.__esModule?no(t,"default",{value:n,enumerable:!0}):t,n)),wT=n=>Pg(no({},"__esModule",{value:!0}),n);var le=R(bt=>{"use strict";Object.defineProperty(bt,"__esModule",{value:!0});bt.DEFAULT_MAX_RECEIVE_MESSAGE_LENGTH=bt.DEFAULT_MAX_SEND_MESSAGE_LENGTH=bt.Propagate=bt.LogVerbosity=bt.Status=void 0;var L_;(function(n){n[n.OK=0]="OK",n[n.CANCELLED=1]="CANCELLED",n[n.UNKNOWN=2]="UNKNOWN",n[n.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",n[n.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",n[n.NOT_FOUND=5]="NOT_FOUND",n[n.ALREADY_EXISTS=6]="ALREADY_EXISTS",n[n.PERMISSION_DENIED=7]="PERMISSION_DENIED",n[n.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",n[n.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",n[n.ABORTED=10]="ABORTED",n[n.OUT_OF_RANGE=11]="OUT_OF_RANGE",n[n.UNIMPLEMENTED=12]="UNIMPLEMENTED",n[n.INTERNAL=13]="INTERNAL",n[n.UNAVAILABLE=14]="UNAVAILABLE",n[n.DATA_LOSS=15]="DATA_LOSS",n[n.UNAUTHENTICATED=16]="UNAUTHENTICATED"})(L_||(bt.Status=L_={}));var F_;(function(n){n[n.DEBUG=0]="DEBUG",n[n.INFO=1]="INFO",n[n.ERROR=2]="ERROR",n[n.NONE=3]="NONE"})(F_||(bt.LogVerbosity=F_={}));var B_;(function(n){n[n.DEADLINE=1]="DEADLINE",n[n.CENSUS_STATS_CONTEXT=2]="CENSUS_STATS_CONTEXT",n[n.CENSUS_TRACING_CONTEXT=4]="CENSUS_TRACING_CONTEXT",n[n.CANCELLATION=8]="CANCELLATION",n[n.DEFAULTS=65535]="DEFAULTS"})(B_||(bt.Propagate=B_={}));bt.DEFAULT_MAX_SEND_MESSAGE_LENGTH=-1;bt.DEFAULT_MAX_RECEIVE_MESSAGE_LENGTH=4*1024*1024});var nd=R((P4,bA)=>{bA.exports={name:"@grpc/grpc-js",version:"1.9.15",description:"gRPC Library for Node - pure JS implementation",homepage:"https://grpc.io/",repository:"https://github.com/grpc/grpc-node/tree/master/packages/grpc-js",main:"build/src/index.js",engines:{node:"^8.13.0 || >=10.10.0"},keywords:[],author:{name:"Google Inc."},types:"build/src/index.d.ts",license:"Apache-2.0",devDependencies:{"@types/gulp":"^4.0.6","@types/gulp-mocha":"0.0.32","@types/lodash":"^4.14.186","@types/mocha":"^5.2.6","@types/ncp":"^2.0.1","@types/pify":"^3.0.2","@types/semver":"^7.3.9","@typescript-eslint/eslint-plugin":"^5.59.11","@typescript-eslint/parser":"^5.59.11","@typescript-eslint/typescript-estree":"^5.59.11","clang-format":"^1.0.55",eslint:"^8.42.0","eslint-config-prettier":"^8.8.0","eslint-plugin-node":"^11.1.0","eslint-plugin-prettier":"^4.2.1",execa:"^2.0.3",gulp:"^4.0.2","gulp-mocha":"^6.0.0",lodash:"^4.17.4",madge:"^5.0.1","mocha-jenkins-reporter":"^0.4.1",ncp:"^2.0.0",pify:"^4.0.1",prettier:"^2.8.8",rimraf:"^3.0.2",semver:"^7.3.5","ts-node":"^10.9.1",typescript:"^5.1.3"},contributors:[{name:"Google Inc."}],scripts:{build:"npm run compile",clean:"rimraf ./build",compile:"tsc -p .",format:'clang-format -i -style="{Language: JavaScript, BasedOnStyle: Google, ColumnLimit: 80}" src/*.ts test/*.ts',lint:"eslint src/*.ts test/*.ts",prepare:"npm run generate-types && npm run compile",test:"gulp test",check:"npm run lint",fix:"eslint --fix src/*.ts test/*.ts",pretest:"npm run generate-types && npm run generate-test-types && npm run compile",posttest:"npm run check && madge -c ./build/src","generate-types":"proto-loader-gen-types --keepCase --longs String --enums String --defaults --oneofs --includeComments --includeDirs proto/ --include-dirs test/fixtures/ -O src/generated/ --grpcLib ../index channelz.proto","generate-test-types":"proto-loader-gen-types --keepCase --longs String --enums String --defaults --oneofs --includeComments --include-dirs test/fixtures/ -O test/generated/ --grpcLib ../../src/index test_service.proto"},dependencies:{"@grpc/proto-loader":"^0.7.8","@types/node":">=12.12.47"},files:["src/**/*.ts","build/src/**/*.{js,d.ts,js.map}","proto/*.proto","LICENSE","deps/envoy-api/envoy/api/v2/**/*.proto","deps/envoy-api/envoy/config/**/*.proto","deps/envoy-api/envoy/service/**/*.proto","deps/envoy-api/envoy/type/**/*.proto","deps/udpa/udpa/**/*.proto","deps/googleapis/google/api/*.proto","deps/googleapis/google/rpc/*.proto","deps/protoc-gen-validate/validate/**/*.proto"]}});var be=R(nt=>{"use strict";var rd,id,sd,ad;Object.defineProperty(nt,"__esModule",{value:!0});nt.isTracerEnabled=nt.trace=nt.log=nt.setLoggerVerbosity=nt.setLogger=nt.getLogger=void 0;var Gn=le(),SA=require("process"),EA=nd().version,wA={error:(n,...e)=>{console.error("E "+n,...e)},info:(n,...e)=>{console.error("I "+n,...e)},debug:(n,...e)=>{console.error("D "+n,...e)}},Nr=wA,ci=Gn.LogVerbosity.ERROR,TA=(id=(rd=process.env.GRPC_NODE_VERBOSITY)!==null&&rd!==void 0?rd:process.env.GRPC_VERBOSITY)!==null&&id!==void 0?id:"";switch(TA.toUpperCase()){case"DEBUG":ci=Gn.LogVerbosity.DEBUG;break;case"INFO":ci=Gn.LogVerbosity.INFO;break;case"ERROR":ci=Gn.LogVerbosity.ERROR;break;case"NONE":ci=Gn.LogVerbosity.NONE;break;default:}var CA=()=>Nr;nt.getLogger=CA;var IA=n=>{Nr=n};nt.setLogger=IA;var AA=n=>{ci=n};nt.setLoggerVerbosity=AA;var RA=(n,...e)=>{let t;if(n>=ci){switch(n){case Gn.LogVerbosity.DEBUG:t=Nr.debug;break;case Gn.LogVerbosity.INFO:t=Nr.info;break;case Gn.LogVerbosity.ERROR:t=Nr.error;break}t||(t=Nr.error),t&&t.bind(Nr)(...e)}};nt.log=RA;var DA=(ad=(sd=process.env.GRPC_NODE_TRACE)!==null&&sd!==void 0?sd:process.env.GRPC_TRACE)!==null&&ad!==void 0?ad:"",od=new Set,U_=new Set;for(let n of DA.split(","))n.startsWith("-")?U_.add(n.substring(1)):od.add(n);var xA=od.has("all");function NA(n,e,t){q_(e)&&(0,nt.log)(n,new Date().toISOString()+" | v"+EA+" "+SA.pid+" | "+e+" | "+t)}nt.trace=NA;function q_(n){return!U_.has(n)&&(xA||od.has(n))}nt.isTracerEnabled=q_});var So=R(ui=>{"use strict";Object.defineProperty(ui,"__esModule",{value:!0});ui.getErrorCode=ui.getErrorMessage=void 0;function OA(n){return n instanceof Error?n.message:String(n)}ui.getErrorMessage=OA;function kA(n){return typeof n=="object"&&n!==null&&"code"in n&&typeof n.code=="number"?n.code:null}ui.getErrorCode=kA});var st=R(wo=>{"use strict";Object.defineProperty(wo,"__esModule",{value:!0});wo.Metadata=void 0;var MA=be(),PA=le(),LA=So(),FA=/^[0-9a-z_.-]+$/,BA=/^[ -~]*$/;function UA(n){return FA.test(n)}function qA(n){return BA.test(n)}function z_(n){return n.endsWith("-bin")}function VA(n){return!n.startsWith("grpc-")}function Eo(n){return n.toLowerCase()}function V_(n,e){if(!UA(n))throw new Error('Metadata key "'+n+'" contains illegal characters');if(e!=null)if(z_(n)){if(!Buffer.isBuffer(e))throw new Error("keys that end with '-bin' must have Buffer values")}else{if(Buffer.isBuffer(e))throw new Error("keys that don't end with '-bin' must have String values");if(!qA(e))throw new Error('Metadata string value "'+e+'" contains illegal characters')}}var ld=class n{constructor(e={}){this.internalRepr=new Map,this.options=e}set(e,t){e=Eo(e),V_(e,t),this.internalRepr.set(e,[t])}add(e,t){e=Eo(e),V_(e,t);let r=this.internalRepr.get(e);r===void 0?this.internalRepr.set(e,[t]):r.push(t)}remove(e){e=Eo(e),this.internalRepr.delete(e)}get(e){return e=Eo(e),this.internalRepr.get(e)||[]}getMap(){let e={};for(let[t,r]of this.internalRepr)if(r.length>0){let i=r[0];e[t]=Buffer.isBuffer(i)?Buffer.from(i):i}return e}clone(){let e=new n(this.options),t=e.internalRepr;for(let[r,i]of this.internalRepr){let s=i.map(a=>Buffer.isBuffer(a)?Buffer.from(a):a);t.set(r,s)}return e}merge(e){for(let[t,r]of e.internalRepr){let i=(this.internalRepr.get(t)||[]).concat(r);this.internalRepr.set(t,i)}}setOptions(e){this.options=e}getOptions(){return this.options}toHttp2Headers(){let e={};for(let[t,r]of this.internalRepr)e[t]=r.map(zA);return e}toJSON(){let e={};for(let[t,r]of this.internalRepr)e[t]=r;return e}static fromHttp2Headers(e){let t=new n;for(let r of Object.keys(e)){if(r.charAt(0)===":")continue;let i=e[r];try{z_(r)?Array.isArray(i)?i.forEach(s=>{t.add(r,Buffer.from(s,"base64"))}):i!==void 0&&(VA(r)?i.split(",").forEach(s=>{t.add(r,Buffer.from(s.trim(),"base64"))}):t.add(r,Buffer.from(i,"base64"))):Array.isArray(i)?i.forEach(s=>{t.add(r,s)}):i!==void 0&&t.add(r,i)}catch(s){let a=`Failed to add metadata entry ${r}: ${i}. ${(0,LA.getErrorMessage)(s)}. For more information see https://github.com/grpc/grpc-node/issues/1173`;(0,MA.log)(PA.LogVerbosity.ERROR,a)}}return t}};wo.Metadata=ld;var zA=n=>Buffer.isBuffer(n)?n.toString("base64"):n});var fd=R(To=>{"use strict";Object.defineProperty(To,"__esModule",{value:!0});To.CallCredentials=void 0;var hd=st();function GA(n){return"getRequestHeaders"in n&&typeof n.getRequestHeaders=="function"}var di=class n{static createFromMetadataGenerator(e){return new ud(e)}static createFromGoogleCredential(e){return n.createFromMetadataGenerator((t,r)=>{let i;GA(e)?i=e.getRequestHeaders(t.service_url):i=new Promise((s,a)=>{e.getRequestMetadata(t.service_url,(o,l)=>{if(o){a(o);return}if(!l){a(new Error("Headers not set by metadata plugin"));return}s(l)})}),i.then(s=>{let a=new hd.Metadata;for(let o of Object.keys(s))a.add(o,s[o]);r(null,a)},s=>{r(s)})})}static createEmpty(){return new dd}};To.CallCredentials=di;var cd=class n extends di{constructor(e){super(),this.creds=e}async generateMetadata(e){let t=new hd.Metadata,r=await Promise.all(this.creds.map(i=>i.generateMetadata(e)));for(let i of r)t.merge(i);return t}compose(e){return new n(this.creds.concat([e]))}_equals(e){return this===e?!0:e instanceof n?this.creds.every((t,r)=>t._equals(e.creds[r])):!1}},ud=class n extends di{constructor(e){super(),this.metadataGenerator=e}generateMetadata(e){return new Promise((t,r)=>{this.metadataGenerator(e,(i,s)=>{s!==void 0?t(s):r(i)})})}compose(e){return new cd([this,e])}_equals(e){return this===e?!0:e instanceof n?this.metadataGenerator===e.metadataGenerator:!1}},dd=class n extends di{generateMetadata(e){return Promise.resolve(new hd.Metadata)}compose(e){return e}_equals(e){return e instanceof n}}});var md=R(hi=>{"use strict";Object.defineProperty(hi,"__esModule",{value:!0});hi.getDefaultRootsData=hi.CIPHER_SUITES=void 0;var $A=require("fs");hi.CIPHER_SUITES=process.env.GRPC_SSL_CIPHER_SUITES;var G_=process.env.GRPC_DEFAULT_SSL_ROOTS_FILE_PATH,pd=null;function jA(){return G_?(pd===null&&(pd=$A.readFileSync(G_)),pd):null}hi.getDefaultRootsData=jA});var Ao=R(Io=>{"use strict";Object.defineProperty(Io,"__esModule",{value:!0});Io.ChannelCredentials=void 0;var KA=require("tls"),HA=fd(),$_=md();function gd(n,e){if(n&&!(n instanceof Buffer))throw new TypeError(`${e}, if provided, must be a Buffer.`)}var fi=class{constructor(e){this.callCredentials=e||HA.CallCredentials.createEmpty()}_getCallCredentials(){return this.callCredentials}static createSsl(e,t,r,i){var s;if(gd(e,"Root certificate"),gd(t,"Private key"),gd(r,"Certificate chain"),t&&!r)throw new Error("Private key must be given with accompanying certificate chain");if(!t&&r)throw new Error("Certificate chain must be given with accompanying private key");let a=(0,KA.createSecureContext)({ca:(s=e??(0,$_.getDefaultRootsData)())!==null&&s!==void 0?s:void 0,key:t??void 0,cert:r??void 0,ciphers:$_.CIPHER_SUITES});return new Co(a,i??{})}static createFromSecureContext(e,t){return new Co(e,t??{})}static createInsecure(){return new yd}};Io.ChannelCredentials=fi;var yd=class n extends fi{constructor(e){super(e)}compose(e){throw new Error("Cannot compose insecure credentials")}_getConnectionOptions(){return null}_isSecure(){return!1}_equals(e){return e instanceof n}},Co=class n extends fi{constructor(e,t){super(),this.secureContext=e,this.verifyOptions=t,this.connectionOptions={secureContext:e},t?.checkServerIdentity&&(this.connectionOptions.checkServerIdentity=t.checkServerIdentity)}compose(e){let t=this.callCredentials.compose(e);return new _d(this,t)}_getConnectionOptions(){return Object.assign({},this.connectionOptions)}_isSecure(){return!0}_equals(e){return this===e?!0:e instanceof n?this.secureContext===e.secureContext&&this.verifyOptions.checkServerIdentity===e.verifyOptions.checkServerIdentity:!1}},_d=class n extends fi{constructor(e,t){super(t),this.channelCredentials=e}compose(e){let t=this.callCredentials.compose(e);return new n(this.channelCredentials,t)}_getConnectionOptions(){return this.channelCredentials._getConnectionOptions()}_isSecure(){return!0}_equals(e){return this===e?!0:e instanceof n?this.channelCredentials._equals(e.channelCredentials)&&this.callCredentials._equals(e.callCredentials):!1}}});var jn=R(Ke=>{"use strict";Object.defineProperty(Ke,"__esModule",{value:!0});Ke.validateLoadBalancingConfig=Ke.getFirstUsableConfig=Ke.isLoadBalancerNameRegistered=Ke.createLoadBalancer=Ke.registerDefaultLoadBalancerType=Ke.registerLoadBalancerType=Ke.createChildChannelControlHelper=void 0;function WA(n,e){var t,r,i,s,a,o,l,c,u,m;return{createSubchannel:(r=(t=e.createSubchannel)===null||t===void 0?void 0:t.bind(e))!==null&&r!==void 0?r:n.createSubchannel.bind(n),updateState:(s=(i=e.updateState)===null||i===void 0?void 0:i.bind(e))!==null&&s!==void 0?s:n.updateState.bind(n),requestReresolution:(o=(a=e.requestReresolution)===null||a===void 0?void 0:a.bind(e))!==null&&o!==void 0?o:n.requestReresolution.bind(n),addChannelzChild:(c=(l=e.addChannelzChild)===null||l===void 0?void 0:l.bind(e))!==null&&c!==void 0?c:n.addChannelzChild.bind(n),removeChannelzChild:(m=(u=e.removeChannelzChild)===null||u===void 0?void 0:u.bind(e))!==null&&m!==void 0?m:n.removeChannelzChild.bind(n)}}Ke.createChildChannelControlHelper=WA;var $n={},vd=null;function QA(n,e,t){$n[n]={LoadBalancer:e,LoadBalancingConfig:t}}Ke.registerLoadBalancerType=QA;function YA(n){vd=n}Ke.registerDefaultLoadBalancerType=YA;function JA(n,e){let t=n.getLoadBalancerName();return t in $n?new $n[t].LoadBalancer(e):null}Ke.createLoadBalancer=JA;function ZA(n){return n in $n}Ke.isLoadBalancerNameRegistered=ZA;function XA(n,e=!1){for(let t of n)if(t.getLoadBalancerName()in $n)return t;return e&&vd?new $n[vd].LoadBalancingConfig:null}Ke.getFirstUsableConfig=XA;function eR(n){if(!(n!==null&&typeof n=="object"))throw new Error("Load balancing config must be an object");let e=Object.keys(n);if(e.length!==1)throw new Error("Provided load balancing config has multiple conflicting entries");let t=e[0];if(t in $n)return $n[t].LoadBalancingConfig.createFromJson(n[t]);throw new Error(`Unrecognized load balancing config name ${t}`)}Ke.validateLoadBalancingConfig=eR});var bd=R(Kn=>{"use strict";Object.defineProperty(Kn,"__esModule",{value:!0});Kn.extractAndSelectServiceConfig=Kn.validateServiceConfig=Kn.validateRetryThrottling=void 0;var tR=require("os"),Ro=le(),nR=jn(),Do=/^\d+(\.\d{1,9})?s$/,rR="node";function iR(n){if("service"in n&&n.service!==""){if(typeof n.service!="string")throw new Error(`Invalid method config name: invalid service: expected type string, got ${typeof n.service}`);if("method"in n&&n.method!==""){if(typeof n.method!="string")throw new Error(`Invalid method config name: invalid method: expected type string, got ${typeof n.service}`);return{service:n.service,method:n.method}}else return{service:n.service}}else{if("method"in n&&n.method!==void 0)throw new Error("Invalid method config name: method set with empty or unset service");return{}}}function sR(n){if(!("maxAttempts"in n)||!Number.isInteger(n.maxAttempts)||n.maxAttempts<2)throw new Error("Invalid method config retry policy: maxAttempts must be an integer at least 2");if(!("initialBackoff"in n)||typeof n.initialBackoff!="string"||!Do.test(n.initialBackoff))throw new Error("Invalid method config retry policy: initialBackoff must be a string consisting of a positive integer followed by s");if(!("maxBackoff"in n)||typeof n.maxBackoff!="string"||!Do.test(n.maxBackoff))throw new Error("Invalid method config retry policy: maxBackoff must be a string consisting of a positive integer followed by s");if(!("backoffMultiplier"in n)||typeof n.backoffMultiplier!="number"||n.backoffMultiplier<=0)throw new Error("Invalid method config retry policy: backoffMultiplier must be a number greater than 0");if(!("retryableStatusCodes"in n&&Array.isArray(n.retryableStatusCodes)))throw new Error("Invalid method config retry policy: retryableStatusCodes is required");if(n.retryableStatusCodes.length===0)throw new Error("Invalid method config retry policy: retryableStatusCodes must be non-empty");for(let e of n.retryableStatusCodes)if(typeof e=="number"){if(!Object.values(Ro.Status).includes(e))throw new Error("Invalid method config retry policy: retryableStatusCodes value not in status code range")}else if(typeof e=="string"){if(!Object.values(Ro.Status).includes(e.toUpperCase()))throw new Error("Invalid method config retry policy: retryableStatusCodes value not a status code name")}else throw new Error("Invalid method config retry policy: retryableStatusCodes value must be a string or number");return{maxAttempts:n.maxAttempts,initialBackoff:n.initialBackoff,maxBackoff:n.maxBackoff,backoffMultiplier:n.backoffMultiplier,retryableStatusCodes:n.retryableStatusCodes}}function aR(n){if(!("maxAttempts"in n)||!Number.isInteger(n.maxAttempts)||n.maxAttempts<2)throw new Error("Invalid method config hedging policy: maxAttempts must be an integer at least 2");if("hedgingDelay"in n&&(typeof n.hedgingDelay!="string"||!Do.test(n.hedgingDelay)))throw new Error("Invalid method config hedging policy: hedgingDelay must be a string consisting of a positive integer followed by s");if("nonFatalStatusCodes"in n&&Array.isArray(n.nonFatalStatusCodes))for(let t of n.nonFatalStatusCodes)if(typeof t=="number"){if(!Object.values(Ro.Status).includes(t))throw new Error("Invlid method config hedging policy: nonFatalStatusCodes value not in status code range")}else if(typeof t=="string"){if(!Object.values(Ro.Status).includes(t.toUpperCase()))throw new Error("Invlid method config hedging policy: nonFatalStatusCodes value not a status code name")}else throw new Error("Invlid method config hedging policy: nonFatalStatusCodes value must be a string or number");let e={maxAttempts:n.maxAttempts};return n.hedgingDelay&&(e.hedgingDelay=n.hedgingDelay),n.nonFatalStatusCodes&&(e.nonFatalStatusCodes=n.nonFatalStatusCodes),e}function oR(n){var e;let t={name:[]};if(!("name"in n)||!Array.isArray(n.name))throw new Error("Invalid method config: invalid name array");for(let r of n.name)t.name.push(iR(r));if("waitForReady"in n){if(typeof n.waitForReady!="boolean")throw new Error("Invalid method config: invalid waitForReady");t.waitForReady=n.waitForReady}if("timeout"in n)if(typeof n.timeout=="object"){if(!("seconds"in n.timeout)||typeof n.timeout.seconds!="number")throw new Error("Invalid method config: invalid timeout.seconds");if(!("nanos"in n.timeout)||typeof n.timeout.nanos!="number")throw new Error("Invalid method config: invalid timeout.nanos");t.timeout=n.timeout}else if(typeof n.timeout=="string"&&Do.test(n.timeout)){let r=n.timeout.substring(0,n.timeout.length-1).split(".");t.timeout={seconds:r[0]|0,nanos:((e=r[1])!==null&&e!==void 0?e:0)|0}}else throw new Error("Invalid method config: invalid timeout");if("maxRequestBytes"in n){if(typeof n.maxRequestBytes!="number")throw new Error("Invalid method config: invalid maxRequestBytes");t.maxRequestBytes=n.maxRequestBytes}if("maxResponseBytes"in n){if(typeof n.maxResponseBytes!="number")throw new Error("Invalid method config: invalid maxRequestBytes");t.maxResponseBytes=n.maxResponseBytes}if("retryPolicy"in n){if("hedgingPolicy"in n)throw new Error("Invalid method config: retryPolicy and hedgingPolicy cannot both be specified");t.retryPolicy=sR(n.retryPolicy)}else"hedgingPolicy"in n&&(t.hedgingPolicy=aR(n.hedgingPolicy));return t}function j_(n){if(!("maxTokens"in n)||typeof n.maxTokens!="number"||n.maxTokens<=0||n.maxTokens>1e3)throw new Error("Invalid retryThrottling: maxTokens must be a number in (0, 1000]");if(!("tokenRatio"in n)||typeof n.tokenRatio!="number"||n.tokenRatio<=0)throw new Error("Invalid retryThrottling: tokenRatio must be a number greater than 0");return{maxTokens:+n.maxTokens.toFixed(3),tokenRatio:+n.tokenRatio.toFixed(3)}}Kn.validateRetryThrottling=j_;function K_(n){let e={loadBalancingConfig:[],methodConfig:[]};if("loadBalancingPolicy"in n)if(typeof n.loadBalancingPolicy=="string")e.loadBalancingPolicy=n.loadBalancingPolicy;else throw new Error("Invalid service config: invalid loadBalancingPolicy");if("loadBalancingConfig"in n)if(Array.isArray(n.loadBalancingConfig))for(let r of n.loadBalancingConfig)e.loadBalancingConfig.push((0,nR.validateLoadBalancingConfig)(r));else throw new Error("Invalid service config: invalid loadBalancingConfig");if("methodConfig"in n&&Array.isArray(n.methodConfig))for(let r of n.methodConfig)e.methodConfig.push(oR(r));"retryThrottling"in n&&(e.retryThrottling=j_(n.retryThrottling));let t=[];for(let r of e.methodConfig)for(let i of r.name){for(let s of t)if(i.service===s.service&&i.method===s.method)throw new Error(`Invalid service config: duplicate name ${i.service}/${i.method}`);t.push(i)}return e}Kn.validateServiceConfig=K_;function lR(n){if(!("serviceConfig"in n))throw new Error("Invalid service config choice: missing service config");let e={serviceConfig:K_(n.serviceConfig)};if("clientLanguage"in n)if(Array.isArray(n.clientLanguage)){e.clientLanguage=[];for(let r of n.clientLanguage)if(typeof r=="string")e.clientLanguage.push(r);else throw new Error("Invalid service config choice: invalid clientLanguage")}else throw new Error("Invalid service config choice: invalid clientLanguage");if("clientHostname"in n)if(Array.isArray(n.clientHostname)){e.clientHostname=[];for(let r of n.clientHostname)if(typeof r=="string")e.clientHostname.push(r);else throw new Error("Invalid service config choice: invalid clientHostname")}else throw new Error("Invalid service config choice: invalid clientHostname");if("percentage"in n)if(typeof n.percentage=="number"&&0<=n.percentage&&n.percentage<=100)e.percentage=n.percentage;else throw new Error("Invalid service config choice: invalid percentage");let t=["clientLanguage","percentage","clientHostname","serviceConfig"];for(let r in n)if(!t.includes(r))throw new Error(`Invalid service config choice: unexpected field ${r}`);return e}function cR(n,e){if(!Array.isArray(n))throw new Error("Invalid service config list");for(let t of n){let r=lR(t);if(!(typeof r.percentage=="number"&&e>r.percentage)){if(Array.isArray(r.clientHostname)){let i=!1;for(let s of r.clientHostname)s===tR.hostname()&&(i=!0);if(!i)continue}if(Array.isArray(r.clientLanguage)){let i=!1;for(let s of r.clientLanguage)s===rR&&(i=!0);if(!i)continue}return r.serviceConfig}}throw new Error("No matching service config found")}function uR(n,e){for(let t of n)if(t.length>0&&t[0].startsWith("grpc_config=")){let r=t.join("").substring(12),i=JSON.parse(r);return cR(i,e)}return null}Kn.extractAndSelectServiceConfig=uR});var St=R(xo=>{"use strict";Object.defineProperty(xo,"__esModule",{value:!0});xo.ConnectivityState=void 0;var H_;(function(n){n[n.IDLE=0]="IDLE",n[n.CONNECTING=1]="CONNECTING",n[n.READY=2]="READY",n[n.TRANSIENT_FAILURE=3]="TRANSIENT_FAILURE",n[n.SHUTDOWN=4]="SHUTDOWN"})(H_||(xo.ConnectivityState=H_={}))});var ht=R(Hn=>{"use strict";Object.defineProperty(Hn,"__esModule",{value:!0});Hn.uriToString=Hn.splitHostPort=Hn.parseUri=void 0;var dR=/^(?:([A-Za-z0-9+.-]+):)?(?:\/\/([^/]*)\/)?(.+)$/;function hR(n){let e=dR.exec(n);return e===null?null:{scheme:e[1],authority:e[2],path:e[3]}}Hn.parseUri=hR;var W_=/^\d+$/;function fR(n){if(n.startsWith("[")){let e=n.indexOf("]");if(e===-1)return null;let t=n.substring(1,e);if(t.indexOf(":")===-1)return null;if(n.length>e+1)if(n[e+1]===":"){let r=n.substring(e+2);return W_.test(r)?{host:t,port:+r}:null}else return null;else return{host:t}}else{let e=n.split(":");return e.length===2?W_.test(e[1])?{host:e[0],port:+e[1]}:null:{host:n}}}Hn.splitHostPort=fR;function pR(n){let e="";return n.scheme!==void 0&&(e+=n.scheme+":"),n.authority!==void 0&&(e+="//"+n.authority+"/"),e+=n.path,e}Hn.uriToString=pR});var Wt=R(Et=>{"use strict";Object.defineProperty(Et,"__esModule",{value:!0});Et.mapUriDefaultScheme=Et.getDefaultAuthority=Et.createResolver=Et.registerDefaultScheme=Et.registerResolver=void 0;var Ed=ht(),pi={},Sd=null;function mR(n,e){pi[n]=e}Et.registerResolver=mR;function gR(n){Sd=n}Et.registerDefaultScheme=gR;function yR(n,e,t){if(n.scheme!==void 0&&n.scheme in pi)return new pi[n.scheme](n,e,t);throw new Error(`No resolver could be created for target ${(0,Ed.uriToString)(n)}`)}Et.createResolver=yR;function _R(n){if(n.scheme!==void 0&&n.scheme in pi)return pi[n.scheme].getDefaultAuthority(n);throw new Error(`Invalid target ${(0,Ed.uriToString)(n)}`)}Et.getDefaultAuthority=_R;function vR(n){return n.scheme===void 0||!(n.scheme in pi)?Sd!==null?{scheme:Sd,authority:void 0,path:(0,Ed.uriToString)(n)}:null:n}Et.mapUriDefaultScheme=vR});var Qn=R(Wn=>{"use strict";Object.defineProperty(Wn,"__esModule",{value:!0});Wn.QueuePicker=Wn.UnavailablePicker=Wn.PickResultType=void 0;var bR=st(),SR=le(),No;(function(n){n[n.COMPLETE=0]="COMPLETE",n[n.QUEUE=1]="QUEUE",n[n.TRANSIENT_FAILURE=2]="TRANSIENT_FAILURE",n[n.DROP=3]="DROP"})(No||(Wn.PickResultType=No={}));var wd=class{constructor(e){this.status=Object.assign({code:SR.Status.UNAVAILABLE,details:"No connection established",metadata:new bR.Metadata},e)}pick(e){return{pickResultType:No.TRANSIENT_FAILURE,subchannel:null,status:this.status,onCallStarted:null,onCallEnded:null}}};Wn.UnavailablePicker=wd;var Td=class{constructor(e){this.loadBalancer=e,this.calledExitIdle=!1}pick(e){return this.calledExitIdle||(process.nextTick(()=>{this.loadBalancer.exitIdle()}),this.calledExitIdle=!0),{pickResultType:No.QUEUE,subchannel:null,status:null,onCallStarted:null,onCallEnded:null}}};Wn.QueuePicker=Td});var $s=R(Oo=>{"use strict";Object.defineProperty(Oo,"__esModule",{value:!0});Oo.BackoffTimeout=void 0;var ER=1e3,wR=1.6,TR=12e4,CR=.2;function IR(n,e){return Math.random()*(e-n)+n}var Cd=class{constructor(e,t){this.callback=e,this.initialDelay=ER,this.multiplier=wR,this.maxDelay=TR,this.jitter=CR,this.running=!1,this.hasRef=!0,this.startTime=new Date,this.endTime=new Date,t&&(t.initialDelay&&(this.initialDelay=t.initialDelay),t.multiplier&&(this.multiplier=t.multiplier),t.jitter&&(this.jitter=t.jitter),t.maxDelay&&(this.maxDelay=t.maxDelay)),this.nextDelay=this.initialDelay,this.timerId=setTimeout(()=>{},0),clearTimeout(this.timerId)}runTimer(e){var t,r;this.endTime=this.startTime,this.endTime.setMilliseconds(this.endTime.getMilliseconds()+this.nextDelay),clearTimeout(this.timerId),this.timerId=setTimeout(()=>{this.callback(),this.running=!1},e),this.hasRef||(r=(t=this.timerId).unref)===null||r===void 0||r.call(t)}runOnce(){this.running=!0,this.startTime=new Date,this.runTimer(this.nextDelay);let e=Math.min(this.nextDelay*this.multiplier,this.maxDelay),t=e*this.jitter;this.nextDelay=e+IR(-t,t)}stop(){clearTimeout(this.timerId),this.running=!1}reset(){if(this.nextDelay=this.initialDelay,this.running){let e=new Date,t=this.startTime;t.setMilliseconds(t.getMilliseconds()+this.nextDelay),clearTimeout(this.timerId),e<t?this.runTimer(t.getTime()-e.getTime()):this.running=!1}}isRunning(){return this.running}ref(){var e,t;this.hasRef=!0,(t=(e=this.timerId).ref)===null||t===void 0||t.call(e)}unref(){var e,t;this.hasRef=!1,(t=(e=this.timerId).unref)===null||t===void 0||t.call(e)}getEndTime(){return this.endTime}};Oo.BackoffTimeout=Cd});var Mo=R(ko=>{"use strict";Object.defineProperty(ko,"__esModule",{value:!0});ko.ChildLoadBalancerHandler=void 0;var AR=jn(),RR=St(),DR="child_load_balancer_helper",Id=class{constructor(e){this.channelControlHelper=e,this.currentChild=null,this.pendingChild=null,this.latestConfig=null,this.ChildPolicyHelper=class{constructor(t){this.parent=t,this.child=null}createSubchannel(t,r){return this.parent.channelControlHelper.createSubchannel(t,r)}updateState(t,r){var i;if(this.calledByPendingChild()){if(t===RR.ConnectivityState.CONNECTING)return;(i=this.parent.currentChild)===null||i===void 0||i.destroy(),this.parent.currentChild=this.parent.pendingChild,this.parent.pendingChild=null}else if(!this.calledByCurrentChild())return;this.parent.channelControlHelper.updateState(t,r)}requestReresolution(){var t;let r=(t=this.parent.pendingChild)!==null&&t!==void 0?t:this.parent.currentChild;this.child===r&&this.parent.channelControlHelper.requestReresolution()}setChild(t){this.child=t}addChannelzChild(t){this.parent.channelControlHelper.addChannelzChild(t)}removeChannelzChild(t){this.parent.channelControlHelper.removeChannelzChild(t)}calledByPendingChild(){return this.child===this.parent.pendingChild}calledByCurrentChild(){return this.child===this.parent.currentChild}}}configUpdateRequiresNewPolicyInstance(e,t){return e.getLoadBalancerName()!==t.getLoadBalancerName()}updateAddressList(e,t,r){let i;if(this.currentChild===null||this.latestConfig===null||this.configUpdateRequiresNewPolicyInstance(this.latestConfig,t)){let s=new this.ChildPolicyHelper(this),a=(0,AR.createLoadBalancer)(t,s);s.setChild(a),this.currentChild===null?(this.currentChild=a,i=this.currentChild):(this.pendingChild&&this.pendingChild.destroy(),this.pendingChild=a,i=this.pendingChild)}else this.pendingChild===null?i=this.currentChild:i=this.pendingChild;this.latestConfig=t,i.updateAddressList(e,t,r)}exitIdle(){this.currentChild&&(this.currentChild.exitIdle(),this.pendingChild&&this.pendingChild.exitIdle())}resetBackoff(){this.currentChild&&(this.currentChild.resetBackoff(),this.pendingChild&&this.pendingChild.resetBackoff())}destroy(){this.currentChild&&(this.currentChild.destroy(),this.currentChild=null),this.pendingChild&&(this.pendingChild.destroy(),this.pendingChild=null)}getTypeName(){return DR}};ko.ChildLoadBalancerHandler=Id});var Y_=R(Po=>{"use strict";Object.defineProperty(Po,"__esModule",{value:!0});Po.ResolvingLoadBalancer=void 0;var xR=jn(),NR=bd(),at=St(),OR=Wt(),mi=Qn(),kR=$s(),Ad=le(),MR=st(),PR=be(),LR=le(),FR=ht(),BR=Mo(),UR="resolving_load_balancer";function Q_(n){PR.trace(LR.LogVerbosity.DEBUG,UR,n)}var qR=["SERVICE_AND_METHOD","SERVICE","EMPTY"];function VR(n,e,t,r){for(let i of t.name)switch(r){case"EMPTY":if(!i.service&&!i.method)return!0;break;case"SERVICE":if(i.service===n&&!i.method)return!0;break;case"SERVICE_AND_METHOD":if(i.service===n&&i.method===e)return!0}return!1}function zR(n,e,t,r){for(let i of t)if(VR(n,e,i,r))return i;return null}function GR(n){return function(t,r){var i,s;let a=t.split("/").filter(c=>c.length>0),o=(i=a[0])!==null&&i!==void 0?i:"",l=(s=a[1])!==null&&s!==void 0?s:"";if(n&&n.methodConfig)for(let c of qR){let u=zR(o,l,n.methodConfig,c);if(u)return{methodConfig:u,pickInformation:{},status:Ad.Status.OK,dynamicFilterFactories:[]}}return{methodConfig:{name:[]},pickInformation:{},status:Ad.Status.OK,dynamicFilterFactories:[]}}}var Rd=class{constructor(e,t,r,i,s){this.target=e,this.channelControlHelper=t,this.onSuccessfulResolution=i,this.onFailedResolution=s,this.latestChildState=at.ConnectivityState.IDLE,this.latestChildPicker=new mi.QueuePicker(this),this.currentState=at.ConnectivityState.IDLE,this.previousServiceConfig=null,this.continueResolving=!1,r["grpc.service_config"]?this.defaultServiceConfig=(0,NR.validateServiceConfig)(JSON.parse(r["grpc.service_config"])):this.defaultServiceConfig={loadBalancingConfig:[],methodConfig:[]},this.updateState(at.ConnectivityState.IDLE,new mi.QueuePicker(this)),this.childLoadBalancer=new BR.ChildLoadBalancerHandler({createSubchannel:t.createSubchannel.bind(t),requestReresolution:()=>{this.backoffTimeout.isRunning()?(Q_("requestReresolution delayed by backoff timer until "+this.backoffTimeout.getEndTime().toISOString()),this.continueResolving=!0):this.updateResolution()},updateState:(o,l)=>{this.latestChildState=o,this.latestChildPicker=l,this.updateState(o,l)},addChannelzChild:t.addChannelzChild.bind(t),removeChannelzChild:t.removeChannelzChild.bind(t)}),this.innerResolver=(0,OR.createResolver)(e,{onSuccessfulResolution:(o,l,c,u,m)=>{var d;this.backoffTimeout.stop(),this.backoffTimeout.reset();let p=null;l===null?c===null?(this.previousServiceConfig=null,p=this.defaultServiceConfig):this.previousServiceConfig===null?this.handleResolutionFailure(c):p=this.previousServiceConfig:(p=l,this.previousServiceConfig=l);let E=(d=p?.loadBalancingConfig)!==null&&d!==void 0?d:[],C=(0,xR.getFirstUsableConfig)(E,!0);if(C===null){this.handleResolutionFailure({code:Ad.Status.UNAVAILABLE,details:"All load balancer options in service config are not compatible",metadata:new MR.Metadata});return}this.childLoadBalancer.updateAddressList(o,C,m);let T=p??this.defaultServiceConfig;this.onSuccessfulResolution(T,u??GR(T))},onError:o=>{this.handleResolutionFailure(o)}},r);let a={initialDelay:r["grpc.initial_reconnect_backoff_ms"],maxDelay:r["grpc.max_reconnect_backoff_ms"]};this.backoffTimeout=new kR.BackoffTimeout(()=>{this.continueResolving?(this.updateResolution(),this.continueResolving=!1):this.updateState(this.latestChildState,this.latestChildPicker)},a),this.backoffTimeout.unref()}updateResolution(){this.innerResolver.updateResolution(),this.currentState===at.ConnectivityState.IDLE&&this.updateState(at.ConnectivityState.CONNECTING,new mi.QueuePicker(this)),this.backoffTimeout.runOnce()}updateState(e,t){Q_((0,FR.uriToString)(this.target)+" "+at.ConnectivityState[this.currentState]+" -> "+at.ConnectivityState[e]),e===at.ConnectivityState.IDLE&&(t=new mi.QueuePicker(this)),this.currentState=e,this.channelControlHelper.updateState(e,t)}handleResolutionFailure(e){this.latestChildState===at.ConnectivityState.IDLE&&(this.updateState(at.ConnectivityState.TRANSIENT_FAILURE,new mi.UnavailablePicker(e)),this.onFailedResolution(e))}exitIdle(){(this.currentState===at.ConnectivityState.IDLE||this.currentState===at.ConnectivityState.TRANSIENT_FAILURE)&&(this.backoffTimeout.isRunning()?this.continueResolving=!0:this.updateResolution()),this.childLoadBalancer.exitIdle()}updateAddressList(e,t){throw new Error("updateAddressList not supported on ResolvingLoadBalancer")}resetBackoff(){this.backoffTimeout.reset(),this.childLoadBalancer.resetBackoff()}destroy(){this.childLoadBalancer.destroy(),this.innerResolver.destroy(),this.backoffTimeout.reset(),this.backoffTimeout.stop(),this.latestChildState=at.ConnectivityState.IDLE,this.latestChildPicker=new mi.QueuePicker(this),this.currentState=at.ConnectivityState.IDLE,this.previousServiceConfig=null,this.continueResolving=!1}getTypeName(){return"resolving_load_balancer"}};Po.ResolvingLoadBalancer=Rd});var J_=R(gi=>{"use strict";Object.defineProperty(gi,"__esModule",{value:!0});gi.channelOptionsEqual=gi.recognizedOptions=void 0;gi.recognizedOptions={"grpc.ssl_target_name_override":!0,"grpc.primary_user_agent":!0,"grpc.secondary_user_agent":!0,"grpc.default_authority":!0,"grpc.keepalive_time_ms":!0,"grpc.keepalive_timeout_ms":!0,"grpc.keepalive_permit_without_calls":!0,"grpc.service_config":!0,"grpc.max_concurrent_streams":!0,"grpc.initial_reconnect_backoff_ms":!0,"grpc.max_reconnect_backoff_ms":!0,"grpc.use_local_subchannel_pool":!0,"grpc.max_send_message_length":!0,"grpc.max_receive_message_length":!0,"grpc.enable_http_proxy":!0,"grpc.enable_channelz":!0,"grpc.dns_min_time_between_resolutions_ms":!0,"grpc.enable_retries":!0,"grpc.per_rpc_retry_buffer_size":!0,"grpc.retry_buffer_size":!0,"grpc.max_connection_age_ms":!0,"grpc.max_connection_age_grace_ms":!0,"grpc-node.max_session_memory":!0,"grpc.service_config_disable_resolution":!0,"grpc.client_idle_timeout_ms":!0,"grpc-node.tls_enable_trace":!0};function $R(n,e){let t=Object.keys(n).sort(),r=Object.keys(e).sort();if(t.length!==r.length)return!1;for(let i=0;i<t.length;i+=1)if(t[i]!==r[i]||n[t[i]]!==e[r[i]])return!1;return!0}gi.channelOptionsEqual=$R});var Yt=R(Qt=>{"use strict";Object.defineProperty(Qt,"__esModule",{value:!0});Qt.stringToSubchannelAddress=Qt.subchannelAddressToString=Qt.subchannelAddressEqual=Qt.isTcpSubchannelAddress=void 0;var jR=require("net");function js(n){return"port"in n}Qt.isTcpSubchannelAddress=js;function KR(n,e){return!n&&!e?!0:!n||!e?!1:js(n)?js(e)&&n.host===e.host&&n.port===e.port:!js(e)&&n.path===e.path}Qt.subchannelAddressEqual=KR;function HR(n){return js(n)?n.host+":"+n.port:n.path}Qt.subchannelAddressToString=HR;var WR=443;function QR(n,e){return(0,jR.isIP)(n)?{host:n,port:e??WR}:{path:n}}Qt.stringToSubchannelAddress=QR});var Lo=R(yi=>{"use strict";Object.defineProperty(yi,"__esModule",{value:!0});yi.addAdminServicesToServer=yi.registerAdminService=void 0;var Z_=[];function YR(n,e){Z_.push({getServiceDefinition:n,getHandlers:e})}yi.registerAdminService=YR;function JR(n){for(let{getServiceDefinition:e,getHandlers:t}of Z_)n.addService(e(),t())}yi.addAdminServicesToServer=JR});var X_=R(wt=>{"use strict";Object.defineProperty(wt,"__esModule",{value:!0});wt.ClientDuplexStreamImpl=wt.ClientWritableStreamImpl=wt.ClientReadableStreamImpl=wt.ClientUnaryCallImpl=wt.callErrorFromStatus=void 0;var ZR=require("events"),kd=require("stream"),Ks=le();function XR(n,e){let t=`${n.code} ${Ks.Status[n.code]}: ${n.details}`,i=`${new Error(t).stack}
for call at
${e}`;return Object.assign(new Error(t),n,{stack:i})}wt.callErrorFromStatus=XR;var Dd=class extends ZR.EventEmitter{constructor(){super()}cancel(){var e;(e=this.call)===null||e===void 0||e.cancelWithStatus(Ks.Status.CANCELLED,"Cancelled on client")}getPeer(){var e,t;return(t=(e=this.call)===null||e===void 0?void 0:e.getPeer())!==null&&t!==void 0?t:"unknown"}};wt.ClientUnaryCallImpl=Dd;var xd=class extends kd.Readable{constructor(e){super({objectMode:!0}),this.deserialize=e}cancel(){var e;(e=this.call)===null||e===void 0||e.cancelWithStatus(Ks.Status.CANCELLED,"Cancelled on client")}getPeer(){var e,t;return(t=(e=this.call)===null||e===void 0?void 0:e.getPeer())!==null&&t!==void 0?t:"unknown"}_read(e){var t;(t=this.call)===null||t===void 0||t.startRead()}};wt.ClientReadableStreamImpl=xd;var Nd=class extends kd.Writable{constructor(e){super({objectMode:!0}),this.serialize=e}cancel(){var e;(e=this.call)===null||e===void 0||e.cancelWithStatus(Ks.Status.CANCELLED,"Cancelled on client")}getPeer(){var e,t;return(t=(e=this.call)===null||e===void 0?void 0:e.getPeer())!==null&&t!==void 0?t:"unknown"}_write(e,t,r){var i;let s={callback:r},a=Number(t);Number.isNaN(a)||(s.flags=a),(i=this.call)===null||i===void 0||i.sendMessageWithContext(s,e)}_final(e){var t;(t=this.call)===null||t===void 0||t.halfClose(),e()}};wt.ClientWritableStreamImpl=Nd;var Od=class extends kd.Duplex{constructor(e,t){super({objectMode:!0}),this.serialize=e,this.deserialize=t}cancel(){var e;(e=this.call)===null||e===void 0||e.cancelWithStatus(Ks.Status.CANCELLED,"Cancelled on client")}getPeer(){var e,t;return(t=(e=this.call)===null||e===void 0?void 0:e.getPeer())!==null&&t!==void 0?t:"unknown"}_read(e){var t;(t=this.call)===null||t===void 0||t.startRead()}_write(e,t,r){var i;let s={callback:r},a=Number(t);Number.isNaN(a)||(s.flags=a),(i=this.call)===null||i===void 0||i.sendMessageWithContext(s,e)}_final(e){var t;(t=this.call)===null||t===void 0||t.halfClose(),e()}};wt.ClientDuplexStreamImpl=Od});var ev=R(_i=>{"use strict";Object.defineProperty(_i,"__esModule",{value:!0});_i.InterceptingListenerImpl=_i.isInterceptingListener=void 0;function eD(n){return n.onReceiveMetadata!==void 0&&n.onReceiveMetadata.length===1}_i.isInterceptingListener=eD;var Md=class{constructor(e,t){this.listener=e,this.nextListener=t,this.processingMetadata=!1,this.hasPendingMessage=!1,this.processingMessage=!1,this.pendingStatus=null}processPendingMessage(){this.hasPendingMessage&&(this.nextListener.onReceiveMessage(this.pendingMessage),this.pendingMessage=null,this.hasPendingMessage=!1)}processPendingStatus(){this.pendingStatus&&this.nextListener.onReceiveStatus(this.pendingStatus)}onReceiveMetadata(e){this.processingMetadata=!0,this.listener.onReceiveMetadata(e,t=>{this.processingMetadata=!1,this.nextListener.onReceiveMetadata(t),this.processPendingMessage(),this.processPendingStatus()})}onReceiveMessage(e){this.processingMessage=!0,this.listener.onReceiveMessage(e,t=>{this.processingMessage=!1,this.processingMetadata?(this.pendingMessage=t,this.hasPendingMessage=!0):(this.nextListener.onReceiveMessage(t),this.processPendingStatus())})}onReceiveStatus(e){this.listener.onReceiveStatus(e,t=>{this.processingMetadata||this.processingMessage?this.pendingStatus=t:this.nextListener.onReceiveStatus(t)})}};_i.InterceptingListenerImpl=Md});var Vd=R(Tt=>{"use strict";Object.defineProperty(Tt,"__esModule",{value:!0});Tt.getInterceptingCall=Tt.InterceptingCall=Tt.RequesterBuilder=Tt.ListenerBuilder=Tt.InterceptorConfigurationError=void 0;var tD=st(),tv=ev(),nv=le(),rv=So(),Ws=class n extends Error{constructor(e){super(e),this.name="InterceptorConfigurationError",Error.captureStackTrace(this,n)}};Tt.InterceptorConfigurationError=Ws;var Ld=class{constructor(){this.metadata=void 0,this.message=void 0,this.status=void 0}withOnReceiveMetadata(e){return this.metadata=e,this}withOnReceiveMessage(e){return this.message=e,this}withOnReceiveStatus(e){return this.status=e,this}build(){return{onReceiveMetadata:this.metadata,onReceiveMessage:this.message,onReceiveStatus:this.status}}};Tt.ListenerBuilder=Ld;var Fd=class{constructor(){this.start=void 0,this.message=void 0,this.halfClose=void 0,this.cancel=void 0}withStart(e){return this.start=e,this}withSendMessage(e){return this.message=e,this}withHalfClose(e){return this.halfClose=e,this}withCancel(e){return this.cancel=e,this}build(){return{start:this.start,sendMessage:this.message,halfClose:this.halfClose,cancel:this.cancel}}};Tt.RequesterBuilder=Fd;var Pd={onReceiveMetadata:(n,e)=>{e(n)},onReceiveMessage:(n,e)=>{e(n)},onReceiveStatus:(n,e)=>{e(n)}},Hs={start:(n,e,t)=>{t(n,e)},sendMessage:(n,e)=>{e(n)},halfClose:n=>{n()},cancel:n=>{n()}},Bd=class{constructor(e,t){var r,i,s,a;this.nextCall=e,this.processingMetadata=!1,this.pendingMessageContext=null,this.processingMessage=!1,this.pendingHalfClose=!1,t?this.requester={start:(r=t.start)!==null&&r!==void 0?r:Hs.start,sendMessage:(i=t.sendMessage)!==null&&i!==void 0?i:Hs.sendMessage,halfClose:(s=t.halfClose)!==null&&s!==void 0?s:Hs.halfClose,cancel:(a=t.cancel)!==null&&a!==void 0?a:Hs.cancel}:this.requester=Hs}cancelWithStatus(e,t){this.requester.cancel(()=>{this.nextCall.cancelWithStatus(e,t)})}getPeer(){return this.nextCall.getPeer()}processPendingMessage(){this.pendingMessageContext&&(this.nextCall.sendMessageWithContext(this.pendingMessageContext,this.pendingMessage),this.pendingMessageContext=null,this.pendingMessage=null)}processPendingHalfClose(){this.pendingHalfClose&&this.nextCall.halfClose()}start(e,t){var r,i,s,a,o,l;let c={onReceiveMetadata:(i=(r=t?.onReceiveMetadata)===null||r===void 0?void 0:r.bind(t))!==null&&i!==void 0?i:(u=>{}),onReceiveMessage:(a=(s=t?.onReceiveMessage)===null||s===void 0?void 0:s.bind(t))!==null&&a!==void 0?a:(u=>{}),onReceiveStatus:(l=(o=t?.onReceiveStatus)===null||o===void 0?void 0:o.bind(t))!==null&&l!==void 0?l:(u=>{})};this.processingMetadata=!0,this.requester.start(e,c,(u,m)=>{var d,p,E;this.processingMetadata=!1;let C;if((0,tv.isInterceptingListener)(m))C=m;else{let T={onReceiveMetadata:(d=m.onReceiveMetadata)!==null&&d!==void 0?d:Pd.onReceiveMetadata,onReceiveMessage:(p=m.onReceiveMessage)!==null&&p!==void 0?p:Pd.onReceiveMessage,onReceiveStatus:(E=m.onReceiveStatus)!==null&&E!==void 0?E:Pd.onReceiveStatus};C=new tv.InterceptingListenerImpl(T,c)}this.nextCall.start(u,C),this.processPendingMessage(),this.processPendingHalfClose()})}sendMessageWithContext(e,t){this.processingMessage=!0,this.requester.sendMessage(t,r=>{this.processingMessage=!1,this.processingMetadata?(this.pendingMessageContext=e,this.pendingMessage=t):(this.nextCall.sendMessageWithContext(e,r),this.processPendingHalfClose())})}sendMessage(e){this.sendMessageWithContext({},e)}startRead(){this.nextCall.startRead()}halfClose(){this.requester.halfClose(()=>{this.processingMetadata||this.processingMessage?this.pendingHalfClose=!0:this.nextCall.halfClose()})}};Tt.InterceptingCall=Bd;function nD(n,e,t){var r,i;let s=(r=t.deadline)!==null&&r!==void 0?r:1/0,a=t.host,o=(i=t.parent)!==null&&i!==void 0?i:null,l=t.propagate_flags,c=t.credentials,u=n.createCall(e,s,a,o,l);return c&&u.setCredentials(c),u}var Fo=class{constructor(e,t){this.call=e,this.methodDefinition=t}cancelWithStatus(e,t){this.call.cancelWithStatus(e,t)}getPeer(){return this.call.getPeer()}sendMessageWithContext(e,t){let r;try{r=this.methodDefinition.requestSerialize(t)}catch(i){this.call.cancelWithStatus(nv.Status.INTERNAL,`Request message serialization failure: ${(0,rv.getErrorMessage)(i)}`);return}this.call.sendMessageWithContext(e,r)}sendMessage(e){this.sendMessageWithContext({},e)}start(e,t){let r=null;this.call.start(e,{onReceiveMetadata:i=>{var s;(s=t?.onReceiveMetadata)===null||s===void 0||s.call(t,i)},onReceiveMessage:i=>{var s;let a;try{a=this.methodDefinition.responseDeserialize(i)}catch(o){r={code:nv.Status.INTERNAL,details:`Response message parsing error: ${(0,rv.getErrorMessage)(o)}`,metadata:new tD.Metadata},this.call.cancelWithStatus(r.code,r.details);return}(s=t?.onReceiveMessage)===null||s===void 0||s.call(t,a)},onReceiveStatus:i=>{var s,a;r?(s=t?.onReceiveStatus)===null||s===void 0||s.call(t,r):(a=t?.onReceiveStatus)===null||a===void 0||a.call(t,i)}})}startRead(){this.call.startRead()}halfClose(){this.call.halfClose()}},Ud=class extends Fo{constructor(e,t){super(e,t)}start(e,t){var r,i;let s=!1,a={onReceiveMetadata:(i=(r=t?.onReceiveMetadata)===null||r===void 0?void 0:r.bind(t))!==null&&i!==void 0?i:(o=>{}),onReceiveMessage:o=>{var l;s=!0,(l=t?.onReceiveMessage)===null||l===void 0||l.call(t,o)},onReceiveStatus:o=>{var l,c;s||(l=t?.onReceiveMessage)===null||l===void 0||l.call(t,null),(c=t?.onReceiveStatus)===null||c===void 0||c.call(t,o)}};super.start(e,a),this.call.startRead()}},qd=class extends Fo{};function rD(n,e,t){let r=nD(n,t.path,e);return t.responseStream?new qd(r,t):new Ud(r,t)}function iD(n,e,t,r){if(n.clientInterceptors.length>0&&n.clientInterceptorProviders.length>0)throw new Ws("Both interceptors and interceptor_providers were passed as options to the client constructor. Only one of these is allowed.");if(n.callInterceptors.length>0&&n.callInterceptorProviders.length>0)throw new Ws("Both interceptors and interceptor_providers were passed as call options. Only one of these is allowed.");let i=[];n.callInterceptors.length>0||n.callInterceptorProviders.length>0?i=[].concat(n.callInterceptors,n.callInterceptorProviders.map(o=>o(e))).filter(o=>o):i=[].concat(n.clientInterceptors,n.clientInterceptorProviders.map(o=>o(e))).filter(o=>o);let s=Object.assign({},t,{method_definition:e});return i.reduceRight((o,l)=>c=>l(c,o),o=>rD(r,o,e))(s)}Tt.getInterceptingCall=iD});var $d=R(Uo=>{"use strict";Object.defineProperty(Uo,"__esModule",{value:!0});Uo.Client=void 0;var Jt=X_(),sD=jd(),aD=St(),Yn=le(),vi=st(),Bo=Vd(),Nt=Symbol(),bi=Symbol(),Si=Symbol(),wn=Symbol();function zd(n){return typeof n=="function"}function Ei(n){return n.stack.split(`
`).slice(1).join(`
`)}var Gd=class{constructor(e,t,r={}){var i,s;if(r=Object.assign({},r),this[bi]=(i=r.interceptors)!==null&&i!==void 0?i:[],delete r.interceptors,this[Si]=(s=r.interceptor_providers)!==null&&s!==void 0?s:[],delete r.interceptor_providers,this[bi].length>0&&this[Si].length>0)throw new Error("Both interceptors and interceptor_providers were passed as options to the client constructor. Only one of these is allowed.");if(this[wn]=r.callInvocationTransformer,delete r.callInvocationTransformer,r.channelOverride)this[Nt]=r.channelOverride;else if(r.channelFactoryOverride){let a=r.channelFactoryOverride;delete r.channelFactoryOverride,this[Nt]=a(e,t,r)}else this[Nt]=new sD.ChannelImplementation(e,t,r)}close(){this[Nt].close()}getChannel(){return this[Nt]}waitForReady(e,t){let r=i=>{if(i){t(new Error("Failed to connect before the deadline"));return}let s;try{s=this[Nt].getConnectivityState(!0)}catch{t(new Error("The channel has been closed"));return}if(s===aD.ConnectivityState.READY)t();else try{this[Nt].watchConnectivityState(s,e,r)}catch{t(new Error("The channel has been closed"))}};setImmediate(r)}checkOptionalUnaryResponseArguments(e,t,r){if(zd(e))return{metadata:new vi.Metadata,options:{},callback:e};if(zd(t))return e instanceof vi.Metadata?{metadata:e,options:{},callback:t}:{metadata:new vi.Metadata,options:e,callback:t};if(!(e instanceof vi.Metadata&&t instanceof Object&&zd(r)))throw new Error("Incorrect arguments passed");return{metadata:e,options:t,callback:r}}makeUnaryRequest(e,t,r,i,s,a,o){var l,c;let u=this.checkOptionalUnaryResponseArguments(s,a,o),m={path:e,requestStream:!1,responseStream:!1,requestSerialize:t,responseDeserialize:r},d={argument:i,metadata:u.metadata,call:new Jt.ClientUnaryCallImpl,channel:this[Nt],methodDefinition:m,callOptions:u.options,callback:u.callback};this[wn]&&(d=this[wn](d));let p=d.call,E={clientInterceptors:this[bi],clientInterceptorProviders:this[Si],callInterceptors:(l=d.callOptions.interceptors)!==null&&l!==void 0?l:[],callInterceptorProviders:(c=d.callOptions.interceptor_providers)!==null&&c!==void 0?c:[]},C=(0,Bo.getInterceptingCall)(E,d.methodDefinition,d.callOptions,d.channel);p.call=C;let T=null,I=!1,N=new Error;return C.start(d.metadata,{onReceiveMetadata:A=>{p.emit("metadata",A)},onReceiveMessage(A){T!==null&&C.cancelWithStatus(Yn.Status.INTERNAL,"Too many responses received"),T=A},onReceiveStatus(A){if(!I){if(I=!0,A.code===Yn.Status.OK)if(T===null){let S=Ei(N);d.callback((0,Jt.callErrorFromStatus)({code:Yn.Status.INTERNAL,details:"No message received",metadata:A.metadata},S))}else d.callback(null,T);else{let S=Ei(N);d.callback((0,Jt.callErrorFromStatus)(A,S))}N=null,p.emit("status",A)}}}),C.sendMessage(i),C.halfClose(),p}makeClientStreamRequest(e,t,r,i,s,a){var o,l;let c=this.checkOptionalUnaryResponseArguments(i,s,a),u={path:e,requestStream:!0,responseStream:!1,requestSerialize:t,responseDeserialize:r},m={metadata:c.metadata,call:new Jt.ClientWritableStreamImpl(t),channel:this[Nt],methodDefinition:u,callOptions:c.options,callback:c.callback};this[wn]&&(m=this[wn](m));let d=m.call,p={clientInterceptors:this[bi],clientInterceptorProviders:this[Si],callInterceptors:(o=m.callOptions.interceptors)!==null&&o!==void 0?o:[],callInterceptorProviders:(l=m.callOptions.interceptor_providers)!==null&&l!==void 0?l:[]},E=(0,Bo.getInterceptingCall)(p,m.methodDefinition,m.callOptions,m.channel);d.call=E;let C=null,T=!1,I=new Error;return E.start(m.metadata,{onReceiveMetadata:N=>{d.emit("metadata",N)},onReceiveMessage(N){C!==null&&E.cancelWithStatus(Yn.Status.INTERNAL,"Too many responses received"),C=N},onReceiveStatus(N){if(!T){if(T=!0,N.code===Yn.Status.OK)if(C===null){let A=Ei(I);m.callback((0,Jt.callErrorFromStatus)({code:Yn.Status.INTERNAL,details:"No message received",metadata:N.metadata},A))}else m.callback(null,C);else{let A=Ei(I);m.callback((0,Jt.callErrorFromStatus)(N,A))}I=null,d.emit("status",N)}}}),d}checkMetadataAndOptions(e,t){let r,i;return e instanceof vi.Metadata?(r=e,t?i=t:i={}):(e?i=e:i={},r=new vi.Metadata),{metadata:r,options:i}}makeServerStreamRequest(e,t,r,i,s,a){var o,l;let c=this.checkMetadataAndOptions(s,a),u={path:e,requestStream:!1,responseStream:!0,requestSerialize:t,responseDeserialize:r},m={argument:i,metadata:c.metadata,call:new Jt.ClientReadableStreamImpl(r),channel:this[Nt],methodDefinition:u,callOptions:c.options};this[wn]&&(m=this[wn](m));let d=m.call,p={clientInterceptors:this[bi],clientInterceptorProviders:this[Si],callInterceptors:(o=m.callOptions.interceptors)!==null&&o!==void 0?o:[],callInterceptorProviders:(l=m.callOptions.interceptor_providers)!==null&&l!==void 0?l:[]},E=(0,Bo.getInterceptingCall)(p,m.methodDefinition,m.callOptions,m.channel);d.call=E;let C=!1,T=new Error;return E.start(m.metadata,{onReceiveMetadata(I){d.emit("metadata",I)},onReceiveMessage(I){d.push(I)},onReceiveStatus(I){if(!C){if(C=!0,d.push(null),I.code!==Yn.Status.OK){let N=Ei(T);d.emit("error",(0,Jt.callErrorFromStatus)(I,N))}T=null,d.emit("status",I)}}}),E.sendMessage(i),E.halfClose(),d}makeBidiStreamRequest(e,t,r,i,s){var a,o;let l=this.checkMetadataAndOptions(i,s),c={path:e,requestStream:!0,responseStream:!0,requestSerialize:t,responseDeserialize:r},u={metadata:l.metadata,call:new Jt.ClientDuplexStreamImpl(t,r),channel:this[Nt],methodDefinition:c,callOptions:l.options};this[wn]&&(u=this[wn](u));let m=u.call,d={clientInterceptors:this[bi],clientInterceptorProviders:this[Si],callInterceptors:(a=u.callOptions.interceptors)!==null&&a!==void 0?a:[],callInterceptorProviders:(o=u.callOptions.interceptor_providers)!==null&&o!==void 0?o:[]},p=(0,Bo.getInterceptingCall)(d,u.methodDefinition,u.callOptions,u.channel);m.call=p;let E=!1,C=new Error;return p.start(u.metadata,{onReceiveMetadata(T){m.emit("metadata",T)},onReceiveMessage(T){m.push(T)},onReceiveStatus(T){if(!E){if(E=!0,m.push(null),T.code!==Yn.Status.OK){let I=Ei(C);m.emit("error",(0,Jt.callErrorFromStatus)(T,I))}C=null,m.emit("status",T)}}}),m}};Uo.Client=Gd});var Hd=R(wi=>{"use strict";Object.defineProperty(wi,"__esModule",{value:!0});wi.loadPackageDefinition=wi.makeClientConstructor=void 0;var Qs=$d(),oD={unary:Qs.Client.prototype.makeUnaryRequest,server_stream:Qs.Client.prototype.makeServerStreamRequest,client_stream:Qs.Client.prototype.makeClientStreamRequest,bidi:Qs.Client.prototype.makeBidiStreamRequest};function Kd(n){return["__proto__","prototype","constructor"].includes(n)}function iv(n,e,t){t||(t={});class r extends Qs.Client{}return Object.keys(n).forEach(i=>{if(Kd(i))return;let s=n[i],a;if(typeof i=="string"&&i.charAt(0)==="$")throw new Error("Method names cannot start with $");s.requestStream?s.responseStream?a="bidi":a="client_stream":s.responseStream?a="server_stream":a="unary";let o=s.requestSerialize,l=s.responseDeserialize,c=lD(oD[a],s.path,o,l);r.prototype[i]=c,Object.assign(r.prototype[i],s),s.originalName&&!Kd(s.originalName)&&(r.prototype[s.originalName]=r.prototype[i])}),r.service=n,r.serviceName=e,r}wi.makeClientConstructor=iv;function lD(n,e,t,r){return function(...i){return n.call(this,e,t,r,...i)}}function cD(n){return"format"in n}function uD(n){let e={};for(let t in n)if(Object.prototype.hasOwnProperty.call(n,t)){let r=n[t],i=t.split(".");if(i.some(o=>Kd(o)))continue;let s=i[i.length-1],a=e;for(let o of i.slice(0,-1))a[o]||(a[o]={}),a=a[o];cD(r)?a[s]=r:a[s]=iv(r,s,{})}return e}wi.loadPackageDefinition=uD});var Dv=R((a6,Rv)=>{var dD=1/0,hD="[object Symbol]",fD=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,pD=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Vo="\\ud800-\\udfff",hv="\\u0300-\\u036f\\ufe20-\\ufe23",fv="\\u20d0-\\u20f0",pv="\\u2700-\\u27bf",mv="a-z\\xdf-\\xf6\\xf8-\\xff",mD="\\xac\\xb1\\xd7\\xf7",gD="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",yD="\\u2000-\\u206f",_D=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",gv="A-Z\\xc0-\\xd6\\xd8-\\xde",yv="\\ufe0e\\ufe0f",_v=mD+gD+yD+_D,Qd="['\u2019]",vD="["+Vo+"]",sv="["+_v+"]",qo="["+hv+fv+"]",vv="\\d+",bD="["+pv+"]",bv="["+mv+"]",Sv="[^"+Vo+_v+vv+pv+mv+gv+"]",Wd="\\ud83c[\\udffb-\\udfff]",SD="(?:"+qo+"|"+Wd+")",Ev="[^"+Vo+"]",Yd="(?:\\ud83c[\\udde6-\\uddff]){2}",Jd="[\\ud800-\\udbff][\\udc00-\\udfff]",Ti="["+gv+"]",wv="\\u200d",av="(?:"+bv+"|"+Sv+")",ED="(?:"+Ti+"|"+Sv+")",ov="(?:"+Qd+"(?:d|ll|m|re|s|t|ve))?",lv="(?:"+Qd+"(?:D|LL|M|RE|S|T|VE))?",Tv=SD+"?",Cv="["+yv+"]?",wD="(?:"+wv+"(?:"+[Ev,Yd,Jd].join("|")+")"+Cv+Tv+")*",Iv=Cv+Tv+wD,TD="(?:"+[bD,Yd,Jd].join("|")+")"+Iv,CD="(?:"+[Ev+qo+"?",qo,Yd,Jd,vD].join("|")+")",ID=RegExp(Qd,"g"),AD=RegExp(qo,"g"),RD=RegExp(Wd+"(?="+Wd+")|"+CD+Iv,"g"),DD=RegExp([Ti+"?"+bv+"+"+ov+"(?="+[sv,Ti,"$"].join("|")+")",ED+"+"+lv+"(?="+[sv,Ti+av,"$"].join("|")+")",Ti+"?"+av+"+"+ov,Ti+"+"+lv,vv,TD].join("|"),"g"),xD=RegExp("["+wv+Vo+hv+fv+yv+"]"),ND=/[a-z][A-Z]|[A-Z]{2,}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,OD={\u00C0:"A",\u00C1:"A",\u00C2:"A",\u00C3:"A",\u00C4:"A",\u00C5:"A",\u00E0:"a",\u00E1:"a",\u00E2:"a",\u00E3:"a",\u00E4:"a",\u00E5:"a",\u00C7:"C",\u00E7:"c",\u00D0:"D",\u00F0:"d",\u00C8:"E",\u00C9:"E",\u00CA:"E",\u00CB:"E",\u00E8:"e",\u00E9:"e",\u00EA:"e",\u00EB:"e",\u00CC:"I",\u00CD:"I",\u00CE:"I",\u00CF:"I",\u00EC:"i",\u00ED:"i",\u00EE:"i",\u00EF:"i",\u00D1:"N",\u00F1:"n",\u00D2:"O",\u00D3:"O",\u00D4:"O",\u00D5:"O",\u00D6:"O",\u00D8:"O",\u00F2:"o",\u00F3:"o",\u00F4:"o",\u00F5:"o",\u00F6:"o",\u00F8:"o",\u00D9:"U",\u00DA:"U",\u00DB:"U",\u00DC:"U",\u00F9:"u",\u00FA:"u",\u00FB:"u",\u00FC:"u",\u00DD:"Y",\u00FD:"y",\u00FF:"y",\u00C6:"Ae",\u00E6:"ae",\u00DE:"Th",\u00FE:"th",\u00DF:"ss",\u0100:"A",\u0102:"A",\u0104:"A",\u0101:"a",\u0103:"a",\u0105:"a",\u0106:"C",\u0108:"C",\u010A:"C",\u010C:"C",\u0107:"c",\u0109:"c",\u010B:"c",\u010D:"c",\u010E:"D",\u0110:"D",\u010F:"d",\u0111:"d",\u0112:"E",\u0114:"E",\u0116:"E",\u0118:"E",\u011A:"E",\u0113:"e",\u0115:"e",\u0117:"e",\u0119:"e",\u011B:"e",\u011C:"G",\u011E:"G",\u0120:"G",\u0122:"G",\u011D:"g",\u011F:"g",\u0121:"g",\u0123:"g",\u0124:"H",\u0126:"H",\u0125:"h",\u0127:"h",\u0128:"I",\u012A:"I",\u012C:"I",\u012E:"I",\u0130:"I",\u0129:"i",\u012B:"i",\u012D:"i",\u012F:"i",\u0131:"i",\u0134:"J",\u0135:"j",\u0136:"K",\u0137:"k",\u0138:"k",\u0139:"L",\u013B:"L",\u013D:"L",\u013F:"L",\u0141:"L",\u013A:"l",\u013C:"l",\u013E:"l",\u0140:"l",\u0142:"l",\u0143:"N",\u0145:"N",\u0147:"N",\u014A:"N",\u0144:"n",\u0146:"n",\u0148:"n",\u014B:"n",\u014C:"O",\u014E:"O",\u0150:"O",\u014D:"o",\u014F:"o",\u0151:"o",\u0154:"R",\u0156:"R",\u0158:"R",\u0155:"r",\u0157:"r",\u0159:"r",\u015A:"S",\u015C:"S",\u015E:"S",\u0160:"S",\u015B:"s",\u015D:"s",\u015F:"s",\u0161:"s",\u0162:"T",\u0164:"T",\u0166:"T",\u0163:"t",\u0165:"t",\u0167:"t",\u0168:"U",\u016A:"U",\u016C:"U",\u016E:"U",\u0170:"U",\u0172:"U",\u0169:"u",\u016B:"u",\u016D:"u",\u016F:"u",\u0171:"u",\u0173:"u",\u0174:"W",\u0175:"w",\u0176:"Y",\u0177:"y",\u0178:"Y",\u0179:"Z",\u017B:"Z",\u017D:"Z",\u017A:"z",\u017C:"z",\u017E:"z",\u0132:"IJ",\u0133:"ij",\u0152:"Oe",\u0153:"oe",\u0149:"'n",\u017F:"ss"},kD=typeof global=="object"&&global&&global.Object===Object&&global,MD=typeof self=="object"&&self&&self.Object===Object&&self,PD=kD||MD||Function("return this")();function LD(n,e,t,r){var i=-1,s=n?n.length:0;for(r&&s&&(t=n[++i]);++i<s;)t=e(t,n[i],i,n);return t}function FD(n){return n.split("")}function BD(n){return n.match(fD)||[]}function UD(n){return function(e){return n?.[e]}}var qD=UD(OD);function Av(n){return xD.test(n)}function VD(n){return ND.test(n)}function zD(n){return Av(n)?GD(n):FD(n)}function GD(n){return n.match(RD)||[]}function $D(n){return n.match(DD)||[]}var jD=Object.prototype,KD=jD.toString,cv=PD.Symbol,uv=cv?cv.prototype:void 0,dv=uv?uv.toString:void 0;function HD(n,e,t){var r=-1,i=n.length;e<0&&(e=-e>i?0:i+e),t=t>i?i:t,t<0&&(t+=i),i=e>t?0:t-e>>>0,e>>>=0;for(var s=Array(i);++r<i;)s[r]=n[r+e];return s}function WD(n){if(typeof n=="string")return n;if(XD(n))return dv?dv.call(n):"";var e=n+"";return e=="0"&&1/n==-dD?"-0":e}function QD(n,e,t){var r=n.length;return t=t===void 0?r:t,!e&&t>=r?n:HD(n,e,t)}function YD(n){return function(e){e=zo(e);var t=Av(e)?zD(e):void 0,r=t?t[0]:e.charAt(0),i=t?QD(t,1).join(""):e.slice(1);return r[n]()+i}}function JD(n){return function(e){return LD(ix(nx(e).replace(ID,"")),n,"")}}function ZD(n){return!!n&&typeof n=="object"}function XD(n){return typeof n=="symbol"||ZD(n)&&KD.call(n)==hD}function zo(n){return n==null?"":WD(n)}var ex=JD(function(n,e,t){return e=e.toLowerCase(),n+(t?tx(e):e)});function tx(n){return rx(zo(n).toLowerCase())}function nx(n){return n=zo(n),n&&n.replace(pD,qD).replace(AD,"")}var rx=YD("toUpperCase");function ix(n,e,t){return n=zo(n),e=t?void 0:e,e===void 0?VD(n)?$D(n):BD(n):n.match(e)||[]}Rv.exports=ex});var Zd=R((o6,xv)=>{"use strict";xv.exports=sx;function sx(n,e){for(var t=new Array(arguments.length-1),r=0,i=2,s=!0;i<arguments.length;)t[r++]=arguments[i++];return new Promise(function(o,l){t[r]=function(u){if(s)if(s=!1,u)l(u);else{for(var m=new Array(arguments.length-1),d=0;d<m.length;)m[d++]=arguments[d];o.apply(null,m)}};try{n.apply(e||null,t)}catch(c){s&&(s=!1,l(c))}})}});var Mv=R(kv=>{"use strict";var Go=kv;Go.length=function(e){var t=e.length;if(!t)return 0;for(var r=0;--t%4>1&&e.charAt(t)==="=";)++r;return Math.ceil(e.length*3)/4-r};var Ci=new Array(64),Ov=new Array(123);for(Ot=0;Ot<64;)Ov[Ci[Ot]=Ot<26?Ot+65:Ot<52?Ot+71:Ot<62?Ot-4:Ot-59|43]=Ot++;var Ot;Go.encode=function(e,t,r){for(var i=null,s=[],a=0,o=0,l;t<r;){var c=e[t++];switch(o){case 0:s[a++]=Ci[c>>2],l=(c&3)<<4,o=1;break;case 1:s[a++]=Ci[l|c>>4],l=(c&15)<<2,o=2;break;case 2:s[a++]=Ci[l|c>>6],s[a++]=Ci[c&63],o=0;break}a>8191&&((i||(i=[])).push(String.fromCharCode.apply(String,s)),a=0)}return o&&(s[a++]=Ci[l],s[a++]=61,o===1&&(s[a++]=61)),i?(a&&i.push(String.fromCharCode.apply(String,s.slice(0,a))),i.join("")):String.fromCharCode.apply(String,s.slice(0,a))};var Nv="invalid encoding";Go.decode=function(e,t,r){for(var i=r,s=0,a,o=0;o<e.length;){var l=e.charCodeAt(o++);if(l===61&&s>1)break;if((l=Ov[l])===void 0)throw Error(Nv);switch(s){case 0:a=l,s=1;break;case 1:t[r++]=a<<2|(l&48)>>4,a=l,s=2;break;case 2:t[r++]=(a&15)<<4|(l&60)>>2,a=l,s=3;break;case 3:t[r++]=(a&3)<<6|l,s=0;break}}if(s===1)throw Error(Nv);return r-i};Go.test=function(e){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(e)}});var Lv=R((c6,Pv)=>{"use strict";Pv.exports=$o;function $o(){this._listeners={}}$o.prototype.on=function(e,t,r){return(this._listeners[e]||(this._listeners[e]=[])).push({fn:t,ctx:r||this}),this};$o.prototype.off=function(e,t){if(e===void 0)this._listeners={};else if(t===void 0)this._listeners[e]=[];else for(var r=this._listeners[e],i=0;i<r.length;)r[i].fn===t?r.splice(i,1):++i;return this};$o.prototype.emit=function(e){var t=this._listeners[e];if(t){for(var r=[],i=1;i<arguments.length;)r.push(arguments[i++]);for(i=0;i<t.length;)t[i].fn.apply(t[i++].ctx,r)}return this}});var Gv=R((u6,zv)=>{"use strict";zv.exports=Fv(Fv);function Fv(n){return typeof Float32Array<"u"?(function(){var e=new Float32Array([-0]),t=new Uint8Array(e.buffer),r=t[3]===128;function i(l,c,u){e[0]=l,c[u]=t[0],c[u+1]=t[1],c[u+2]=t[2],c[u+3]=t[3]}function s(l,c,u){e[0]=l,c[u]=t[3],c[u+1]=t[2],c[u+2]=t[1],c[u+3]=t[0]}n.writeFloatLE=r?i:s,n.writeFloatBE=r?s:i;function a(l,c){return t[0]=l[c],t[1]=l[c+1],t[2]=l[c+2],t[3]=l[c+3],e[0]}function o(l,c){return t[3]=l[c],t[2]=l[c+1],t[1]=l[c+2],t[0]=l[c+3],e[0]}n.readFloatLE=r?a:o,n.readFloatBE=r?o:a})():(function(){function e(r,i,s,a){var o=i<0?1:0;if(o&&(i=-i),i===0)r(1/i>0?0:2147483648,s,a);else if(isNaN(i))r(2143289344,s,a);else if(i>34028234663852886e22)r((o<<31|2139095040)>>>0,s,a);else if(i<11754943508222875e-54)r((o<<31|Math.round(i/1401298464324817e-60))>>>0,s,a);else{var l=Math.floor(Math.log(i)/Math.LN2),c=Math.round(i*Math.pow(2,-l)*8388608)&8388607;r((o<<31|l+127<<23|c)>>>0,s,a)}}n.writeFloatLE=e.bind(null,Bv),n.writeFloatBE=e.bind(null,Uv);function t(r,i,s){var a=r(i,s),o=(a>>31)*2+1,l=a>>>23&255,c=a&8388607;return l===255?c?NaN:o*(1/0):l===0?o*1401298464324817e-60*c:o*Math.pow(2,l-150)*(c+8388608)}n.readFloatLE=t.bind(null,qv),n.readFloatBE=t.bind(null,Vv)})(),typeof Float64Array<"u"?(function(){var e=new Float64Array([-0]),t=new Uint8Array(e.buffer),r=t[7]===128;function i(l,c,u){e[0]=l,c[u]=t[0],c[u+1]=t[1],c[u+2]=t[2],c[u+3]=t[3],c[u+4]=t[4],c[u+5]=t[5],c[u+6]=t[6],c[u+7]=t[7]}function s(l,c,u){e[0]=l,c[u]=t[7],c[u+1]=t[6],c[u+2]=t[5],c[u+3]=t[4],c[u+4]=t[3],c[u+5]=t[2],c[u+6]=t[1],c[u+7]=t[0]}n.writeDoubleLE=r?i:s,n.writeDoubleBE=r?s:i;function a(l,c){return t[0]=l[c],t[1]=l[c+1],t[2]=l[c+2],t[3]=l[c+3],t[4]=l[c+4],t[5]=l[c+5],t[6]=l[c+6],t[7]=l[c+7],e[0]}function o(l,c){return t[7]=l[c],t[6]=l[c+1],t[5]=l[c+2],t[4]=l[c+3],t[3]=l[c+4],t[2]=l[c+5],t[1]=l[c+6],t[0]=l[c+7],e[0]}n.readDoubleLE=r?a:o,n.readDoubleBE=r?o:a})():(function(){function e(r,i,s,a,o,l){var c=a<0?1:0;if(c&&(a=-a),a===0)r(0,o,l+i),r(1/a>0?0:2147483648,o,l+s);else if(isNaN(a))r(0,o,l+i),r(2146959360,o,l+s);else if(a>17976931348623157e292)r(0,o,l+i),r((c<<31|2146435072)>>>0,o,l+s);else{var u;if(a<22250738585072014e-324)u=a/5e-324,r(u>>>0,o,l+i),r((c<<31|u/4294967296)>>>0,o,l+s);else{var m=Math.floor(Math.log(a)/Math.LN2);m===1024&&(m=1023),u=a*Math.pow(2,-m),r(u*4503599627370496>>>0,o,l+i),r((c<<31|m+1023<<20|u*1048576&1048575)>>>0,o,l+s)}}}n.writeDoubleLE=e.bind(null,Bv,0,4),n.writeDoubleBE=e.bind(null,Uv,4,0);function t(r,i,s,a,o){var l=r(a,o+i),c=r(a,o+s),u=(c>>31)*2+1,m=c>>>20&2047,d=4294967296*(c&1048575)+l;return m===2047?d?NaN:u*(1/0):m===0?u*5e-324*d:u*Math.pow(2,m-1075)*(d+4503599627370496)}n.readDoubleLE=t.bind(null,qv,0,4),n.readDoubleBE=t.bind(null,Vv,4,0)})(),n}function Bv(n,e,t){e[t]=n&255,e[t+1]=n>>>8&255,e[t+2]=n>>>16&255,e[t+3]=n>>>24}function Uv(n,e,t){e[t]=n>>>24,e[t+1]=n>>>16&255,e[t+2]=n>>>8&255,e[t+3]=n&255}function qv(n,e){return(n[e]|n[e+1]<<8|n[e+2]<<16|n[e+3]<<24)>>>0}function Vv(n,e){return(n[e]<<24|n[e+1]<<16|n[e+2]<<8|n[e+3])>>>0}});var Xd=R((exports,module)=>{"use strict";module.exports=inquire;function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(n){}return null}});var jv=R($v=>{"use strict";var eh=$v;eh.length=function(e){for(var t=0,r=0,i=0;i<e.length;++i)r=e.charCodeAt(i),r<128?t+=1:r<2048?t+=2:(r&64512)===55296&&(e.charCodeAt(i+1)&64512)===56320?(++i,t+=4):t+=3;return t};eh.read=function(e,t,r){var i=r-t;if(i<1)return"";for(var s=null,a=[],o=0,l;t<r;)l=e[t++],l<128?a[o++]=l:l>191&&l<224?a[o++]=(l&31)<<6|e[t++]&63:l>239&&l<365?(l=((l&7)<<18|(e[t++]&63)<<12|(e[t++]&63)<<6|e[t++]&63)-65536,a[o++]=55296+(l>>10),a[o++]=56320+(l&1023)):a[o++]=(l&15)<<12|(e[t++]&63)<<6|e[t++]&63,o>8191&&((s||(s=[])).push(String.fromCharCode.apply(String,a)),o=0);return s?(o&&s.push(String.fromCharCode.apply(String,a.slice(0,o))),s.join("")):String.fromCharCode.apply(String,a.slice(0,o))};eh.write=function(e,t,r){for(var i=r,s,a,o=0;o<e.length;++o)s=e.charCodeAt(o),s<128?t[r++]=s:s<2048?(t[r++]=s>>6|192,t[r++]=s&63|128):(s&64512)===55296&&((a=e.charCodeAt(o+1))&64512)===56320?(s=65536+((s&1023)<<10)+(a&1023),++o,t[r++]=s>>18|240,t[r++]=s>>12&63|128,t[r++]=s>>6&63|128,t[r++]=s&63|128):(t[r++]=s>>12|224,t[r++]=s>>6&63|128,t[r++]=s&63|128);return r-i}});var Hv=R((h6,Kv)=>{"use strict";Kv.exports=ax;function ax(n,e,t){var r=t||8192,i=r>>>1,s=null,a=r;return function(l){if(l<1||l>i)return n(l);a+l>r&&(s=n(r),a=0);var c=e.call(s,a,a+=l);return a&7&&(a=(a|7)+1),c}}});var Qv=R((f6,Wv)=>{"use strict";Wv.exports=Pe;var Ys=Zt();function Pe(n,e){this.lo=n>>>0,this.hi=e>>>0}var Or=Pe.zero=new Pe(0,0);Or.toNumber=function(){return 0};Or.zzEncode=Or.zzDecode=function(){return this};Or.length=function(){return 1};var ox=Pe.zeroHash="\0\0\0\0\0\0\0\0";Pe.fromNumber=function(e){if(e===0)return Or;var t=e<0;t&&(e=-e);var r=e>>>0,i=(e-r)/4294967296>>>0;return t&&(i=~i>>>0,r=~r>>>0,++r>4294967295&&(r=0,++i>4294967295&&(i=0))),new Pe(r,i)};Pe.from=function(e){if(typeof e=="number")return Pe.fromNumber(e);if(Ys.isString(e))if(Ys.Long)e=Ys.Long.fromString(e);else return Pe.fromNumber(parseInt(e,10));return e.low||e.high?new Pe(e.low>>>0,e.high>>>0):Or};Pe.prototype.toNumber=function(e){if(!e&&this.hi>>>31){var t=~this.lo+1>>>0,r=~this.hi>>>0;return t||(r=r+1>>>0),-(t+r*4294967296)}return this.lo+this.hi*4294967296};Pe.prototype.toLong=function(e){return Ys.Long?new Ys.Long(this.lo|0,this.hi|0,!!e):{low:this.lo|0,high:this.hi|0,unsigned:!!e}};var Jn=String.prototype.charCodeAt;Pe.fromHash=function(e){return e===ox?Or:new Pe((Jn.call(e,0)|Jn.call(e,1)<<8|Jn.call(e,2)<<16|Jn.call(e,3)<<24)>>>0,(Jn.call(e,4)|Jn.call(e,5)<<8|Jn.call(e,6)<<16|Jn.call(e,7)<<24)>>>0)};Pe.prototype.toHash=function(){return String.fromCharCode(this.lo&255,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,this.hi&255,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)};Pe.prototype.zzEncode=function(){var e=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^e)>>>0,this.lo=(this.lo<<1^e)>>>0,this};Pe.prototype.zzDecode=function(){var e=-(this.lo&1);return this.lo=((this.lo>>>1|this.hi<<31)^e)>>>0,this.hi=(this.hi>>>1^e)>>>0,this};Pe.prototype.length=function(){var e=this.lo,t=(this.lo>>>28|this.hi<<4)>>>0,r=this.hi>>>24;return r===0?t===0?e<16384?e<128?1:2:e<2097152?3:4:t<16384?t<128?5:6:t<2097152?7:8:r<128?9:10}});var Zt=R(th=>{"use strict";var z=th;z.asPromise=Zd();z.base64=Mv();z.EventEmitter=Lv();z.float=Gv();z.inquire=Xd();z.utf8=jv();z.pool=Hv();z.LongBits=Qv();z.isNode=!!(typeof global<"u"&&global&&global.process&&global.process.versions&&global.process.versions.node);z.global=z.isNode&&global||typeof window<"u"&&window||typeof self<"u"&&self||th;z.emptyArray=Object.freeze?Object.freeze([]):[];z.emptyObject=Object.freeze?Object.freeze({}):{};z.isInteger=Number.isInteger||function(e){return typeof e=="number"&&isFinite(e)&&Math.floor(e)===e};z.isString=function(e){return typeof e=="string"||e instanceof String};z.isObject=function(e){return e&&typeof e=="object"};z.isset=z.isSet=function(e,t){var r=e[t];return r!=null&&e.hasOwnProperty(t)?typeof r!="object"||(Array.isArray(r)?r.length:Object.keys(r).length)>0:!1};z.Buffer=(function(){try{var n=z.inquire("buffer").Buffer;return n.prototype.utf8Write?n:null}catch{return null}})();z._Buffer_from=null;z._Buffer_allocUnsafe=null;z.newBuffer=function(e){return typeof e=="number"?z.Buffer?z._Buffer_allocUnsafe(e):new z.Array(e):z.Buffer?z._Buffer_from(e):typeof Uint8Array>"u"?e:new Uint8Array(e)};z.Array=typeof Uint8Array<"u"?Uint8Array:Array;z.Long=z.global.dcodeIO&&z.global.dcodeIO.Long||z.global.Long||z.inquire("long");z.key2Re=/^true|false|0|1$/;z.key32Re=/^-?(?:0|[1-9][0-9]*)$/;z.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/;z.longToHash=function(e){return e?z.LongBits.from(e).toHash():z.LongBits.zeroHash};z.longFromHash=function(e,t){var r=z.LongBits.fromHash(e);return z.Long?z.Long.fromBits(r.lo,r.hi,t):r.toNumber(!!t)};function Yv(n,e,t){for(var r=Object.keys(e),i=0;i<r.length;++i)(n[r[i]]===void 0||!t)&&(n[r[i]]=e[r[i]]);return n}z.merge=Yv;z.lcFirst=function(e){return e.charAt(0).toLowerCase()+e.substring(1)};function Jv(n){function e(t,r){if(!(this instanceof e))return new e(t,r);Object.defineProperty(this,"message",{get:function(){return t}}),Error.captureStackTrace?Error.captureStackTrace(this,e):Object.defineProperty(this,"stack",{value:new Error().stack||""}),r&&Yv(this,r)}return e.prototype=Object.create(Error.prototype,{constructor:{value:e,writable:!0,enumerable:!1,configurable:!0},name:{get:function(){return n},set:void 0,enumerable:!1,configurable:!0},toString:{value:function(){return this.name+": "+this.message},writable:!0,enumerable:!1,configurable:!0}}),e}z.newError=Jv;z.ProtocolError=Jv("ProtocolError");z.oneOfGetter=function(e){for(var t={},r=0;r<e.length;++r)t[e[r]]=1;return function(){for(var i=Object.keys(this),s=i.length-1;s>-1;--s)if(t[i[s]]===1&&this[i[s]]!==void 0&&this[i[s]]!==null)return i[s]}};z.oneOfSetter=function(e){return function(t){for(var r=0;r<e.length;++r)e[r]!==t&&delete this[e[r]]}};z.toJSONOptions={longs:String,enums:String,bytes:String,json:!0};z._configure=function(){var n=z.Buffer;if(!n){z._Buffer_from=z._Buffer_allocUnsafe=null;return}z._Buffer_from=n.from!==Uint8Array.from&&n.from||function(t,r){return new n(t,r)},z._Buffer_allocUnsafe=n.allocUnsafe||function(t){return new n(t)}}});var Ko=R((m6,t0)=>{"use strict";t0.exports=ie;var Ct=Zt(),nh,jo=Ct.LongBits,Zv=Ct.base64,Xv=Ct.utf8;function Js(n,e,t){this.fn=n,this.len=e,this.next=void 0,this.val=t}function ih(){}function lx(n){this.head=n.head,this.tail=n.tail,this.len=n.len,this.next=n.states}function ie(){this.len=0,this.head=new Js(ih,0,0),this.tail=this.head,this.states=null}var e0=function(){return Ct.Buffer?function(){return(ie.create=function(){return new nh})()}:function(){return new ie}};ie.create=e0();ie.alloc=function(e){return new Ct.Array(e)};Ct.Array!==Array&&(ie.alloc=Ct.pool(ie.alloc,Ct.Array.prototype.subarray));ie.prototype._push=function(e,t,r){return this.tail=this.tail.next=new Js(e,t,r),this.len+=t,this};function sh(n,e,t){e[t]=n&255}function cx(n,e,t){for(;n>127;)e[t++]=n&127|128,n>>>=7;e[t]=n}function ah(n,e){this.len=n,this.next=void 0,this.val=e}ah.prototype=Object.create(Js.prototype);ah.prototype.fn=cx;ie.prototype.uint32=function(e){return this.len+=(this.tail=this.tail.next=new ah((e=e>>>0)<128?1:e<16384?2:e<2097152?3:e<268435456?4:5,e)).len,this};ie.prototype.int32=function(e){return e<0?this._push(oh,10,jo.fromNumber(e)):this.uint32(e)};ie.prototype.sint32=function(e){return this.uint32((e<<1^e>>31)>>>0)};function oh(n,e,t){for(;n.hi;)e[t++]=n.lo&127|128,n.lo=(n.lo>>>7|n.hi<<25)>>>0,n.hi>>>=7;for(;n.lo>127;)e[t++]=n.lo&127|128,n.lo=n.lo>>>7;e[t++]=n.lo}ie.prototype.uint64=function(e){var t=jo.from(e);return this._push(oh,t.length(),t)};ie.prototype.int64=ie.prototype.uint64;ie.prototype.sint64=function(e){var t=jo.from(e).zzEncode();return this._push(oh,t.length(),t)};ie.prototype.bool=function(e){return this._push(sh,1,e?1:0)};function rh(n,e,t){e[t]=n&255,e[t+1]=n>>>8&255,e[t+2]=n>>>16&255,e[t+3]=n>>>24}ie.prototype.fixed32=function(e){return this._push(rh,4,e>>>0)};ie.prototype.sfixed32=ie.prototype.fixed32;ie.prototype.fixed64=function(e){var t=jo.from(e);return this._push(rh,4,t.lo)._push(rh,4,t.hi)};ie.prototype.sfixed64=ie.prototype.fixed64;ie.prototype.float=function(e){return this._push(Ct.float.writeFloatLE,4,e)};ie.prototype.double=function(e){return this._push(Ct.float.writeDoubleLE,8,e)};var ux=Ct.Array.prototype.set?function(e,t,r){t.set(e,r)}:function(e,t,r){for(var i=0;i<e.length;++i)t[r+i]=e[i]};ie.prototype.bytes=function(e){var t=e.length>>>0;if(!t)return this._push(sh,1,0);if(Ct.isString(e)){var r=ie.alloc(t=Zv.length(e));Zv.decode(e,r,0),e=r}return this.uint32(t)._push(ux,t,e)};ie.prototype.string=function(e){var t=Xv.length(e);return t?this.uint32(t)._push(Xv.write,t,e):this._push(sh,1,0)};ie.prototype.fork=function(){return this.states=new lx(this),this.head=this.tail=new Js(ih,0,0),this.len=0,this};ie.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new Js(ih,0,0),this.len=0),this};ie.prototype.ldelim=function(){var e=this.head,t=this.tail,r=this.len;return this.reset().uint32(r),r&&(this.tail.next=e.next,this.tail=t,this.len+=r),this};ie.prototype.finish=function(){for(var e=this.head.next,t=this.constructor.alloc(this.len),r=0;e;)e.fn(e.val,t,r),r+=e.len,e=e.next;return t};ie._configure=function(n){nh=n,ie.create=e0(),nh._configure()}});var i0=R((g6,r0)=>{"use strict";r0.exports=Xt;var n0=Ko();(Xt.prototype=Object.create(n0.prototype)).constructor=Xt;var Zn=Zt();function Xt(){n0.call(this)}Xt._configure=function(){Xt.alloc=Zn._Buffer_allocUnsafe,Xt.writeBytesBuffer=Zn.Buffer&&Zn.Buffer.prototype instanceof Uint8Array&&Zn.Buffer.prototype.set.name==="set"?function(e,t,r){t.set(e,r)}:function(e,t,r){if(e.copy)e.copy(t,r,0,e.length);else for(var i=0;i<e.length;)t[r++]=e[i++]}};Xt.prototype.bytes=function(e){Zn.isString(e)&&(e=Zn._Buffer_from(e,"base64"));var t=e.length>>>0;return this.uint32(t),t&&this._push(Xt.writeBytesBuffer,t,e),this};function dx(n,e,t){n.length<40?Zn.utf8.write(n,e,t):e.utf8Write?e.utf8Write(n,t):e.write(n,t)}Xt.prototype.string=function(e){var t=Zn.Buffer.byteLength(e);return this.uint32(t),t&&this._push(dx,t,e),this};Xt._configure()});var Wo=R((y6,c0)=>{"use strict";c0.exports=Ee;var kt=Zt(),ch,o0=kt.LongBits,hx=kt.utf8;function Mt(n,e){return RangeError("index out of range: "+n.pos+" + "+(e||1)+" > "+n.len)}function Ee(n){this.buf=n,this.pos=0,this.len=n.length}var s0=typeof Uint8Array<"u"?function(e){if(e instanceof Uint8Array||Array.isArray(e))return new Ee(e);throw Error("illegal buffer")}:function(e){if(Array.isArray(e))return new Ee(e);throw Error("illegal buffer")},l0=function(){return kt.Buffer?function(t){return(Ee.create=function(i){return kt.Buffer.isBuffer(i)?new ch(i):s0(i)})(t)}:s0};Ee.create=l0();Ee.prototype._slice=kt.Array.prototype.subarray||kt.Array.prototype.slice;Ee.prototype.uint32=(function(){var e=4294967295;return function(){if(e=(this.buf[this.pos]&127)>>>0,this.buf[this.pos++]<128||(e=(e|(this.buf[this.pos]&127)<<7)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&127)<<14)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&127)<<21)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&15)<<28)>>>0,this.buf[this.pos++]<128))return e;if((this.pos+=5)>this.len)throw this.pos=this.len,Mt(this,10);return e}})();Ee.prototype.int32=function(){return this.uint32()|0};Ee.prototype.sint32=function(){var e=this.uint32();return e>>>1^-(e&1)|0};function lh(){var n=new o0(0,0),e=0;if(this.len-this.pos>4){for(;e<4;++e)if(n.lo=(n.lo|(this.buf[this.pos]&127)<<e*7)>>>0,this.buf[this.pos++]<128)return n;if(n.lo=(n.lo|(this.buf[this.pos]&127)<<28)>>>0,n.hi=(n.hi|(this.buf[this.pos]&127)>>4)>>>0,this.buf[this.pos++]<128)return n;e=0}else{for(;e<3;++e){if(this.pos>=this.len)throw Mt(this);if(n.lo=(n.lo|(this.buf[this.pos]&127)<<e*7)>>>0,this.buf[this.pos++]<128)return n}return n.lo=(n.lo|(this.buf[this.pos++]&127)<<e*7)>>>0,n}if(this.len-this.pos>4){for(;e<5;++e)if(n.hi=(n.hi|(this.buf[this.pos]&127)<<e*7+3)>>>0,this.buf[this.pos++]<128)return n}else for(;e<5;++e){if(this.pos>=this.len)throw Mt(this);if(n.hi=(n.hi|(this.buf[this.pos]&127)<<e*7+3)>>>0,this.buf[this.pos++]<128)return n}throw Error("invalid varint encoding")}Ee.prototype.bool=function(){return this.uint32()!==0};function Ho(n,e){return(n[e-4]|n[e-3]<<8|n[e-2]<<16|n[e-1]<<24)>>>0}Ee.prototype.fixed32=function(){if(this.pos+4>this.len)throw Mt(this,4);return Ho(this.buf,this.pos+=4)};Ee.prototype.sfixed32=function(){if(this.pos+4>this.len)throw Mt(this,4);return Ho(this.buf,this.pos+=4)|0};function a0(){if(this.pos+8>this.len)throw Mt(this,8);return new o0(Ho(this.buf,this.pos+=4),Ho(this.buf,this.pos+=4))}Ee.prototype.float=function(){if(this.pos+4>this.len)throw Mt(this,4);var e=kt.float.readFloatLE(this.buf,this.pos);return this.pos+=4,e};Ee.prototype.double=function(){if(this.pos+8>this.len)throw Mt(this,4);var e=kt.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,e};Ee.prototype.bytes=function(){var e=this.uint32(),t=this.pos,r=this.pos+e;if(r>this.len)throw Mt(this,e);if(this.pos+=e,Array.isArray(this.buf))return this.buf.slice(t,r);if(t===r){var i=kt.Buffer;return i?i.alloc(0):new this.buf.constructor(0)}return this._slice.call(this.buf,t,r)};Ee.prototype.string=function(){var e=this.bytes();return hx.read(e,0,e.length)};Ee.prototype.skip=function(e){if(typeof e=="number"){if(this.pos+e>this.len)throw Mt(this,e);this.pos+=e}else do if(this.pos>=this.len)throw Mt(this);while(this.buf[this.pos++]&128);return this};Ee.prototype.skipType=function(n){switch(n){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;(n=this.uint32()&7)!==4;)this.skipType(n);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+n+" at offset "+this.pos)}return this};Ee._configure=function(n){ch=n,Ee.create=l0(),ch._configure();var e=kt.Long?"toLong":"toNumber";kt.merge(Ee.prototype,{int64:function(){return lh.call(this)[e](!1)},uint64:function(){return lh.call(this)[e](!0)},sint64:function(){return lh.call(this).zzDecode()[e](!1)},fixed64:function(){return a0.call(this)[e](!0)},sfixed64:function(){return a0.call(this)[e](!1)}})}});var f0=R((_6,h0)=>{"use strict";h0.exports=kr;var d0=Wo();(kr.prototype=Object.create(d0.prototype)).constructor=kr;var u0=Zt();function kr(n){d0.call(this,n)}kr._configure=function(){u0.Buffer&&(kr.prototype._slice=u0.Buffer.prototype.slice)};kr.prototype.string=function(){var e=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+e,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+e,this.len))};kr._configure()});var m0=R((v6,p0)=>{"use strict";p0.exports=Zs;var uh=Zt();(Zs.prototype=Object.create(uh.EventEmitter.prototype)).constructor=Zs;function Zs(n,e,t){if(typeof n!="function")throw TypeError("rpcImpl must be a function");uh.EventEmitter.call(this),this.rpcImpl=n,this.requestDelimited=!!e,this.responseDelimited=!!t}Zs.prototype.rpcCall=function n(e,t,r,i,s){if(!i)throw TypeError("request must be specified");var a=this;if(!s)return uh.asPromise(n,a,e,t,r,i);if(!a.rpcImpl){setTimeout(function(){s(Error("already ended"))},0);return}try{return a.rpcImpl(e,t[a.requestDelimited?"encodeDelimited":"encode"](i).finish(),function(l,c){if(l)return a.emit("error",l,e),s(l);if(c===null){a.end(!0);return}if(!(c instanceof r))try{c=r[a.responseDelimited?"decodeDelimited":"decode"](c)}catch(u){return a.emit("error",u,e),s(u)}return a.emit("data",c,e),s(null,c)})}catch(o){a.emit("error",o,e),setTimeout(function(){s(o)},0);return}};Zs.prototype.end=function(e){return this.rpcImpl&&(e||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this}});var dh=R(g0=>{"use strict";var fx=g0;fx.Service=m0()});var hh=R((S6,y0)=>{"use strict";y0.exports={}});var b0=R(v0=>{"use strict";var ot=v0;ot.build="minimal";ot.Writer=Ko();ot.BufferWriter=i0();ot.Reader=Wo();ot.BufferReader=f0();ot.util=Zt();ot.rpc=dh();ot.roots=hh();ot.configure=_0;function _0(){ot.util._configure(),ot.Writer._configure(ot.BufferWriter),ot.Reader._configure(ot.BufferReader)}_0()});var E0=R((w6,S0)=>{"use strict";S0.exports=fh;function fh(n,e){typeof n=="string"&&(e=n,n=void 0);var t=[];function r(s){if(typeof s!="string"){var a=i();if(fh.verbose&&console.log("codegen: "+a),a="return "+a,s){for(var o=Object.keys(s),l=new Array(o.length+1),c=new Array(o.length),u=0;u<o.length;)l[u]=o[u],c[u]=s[o[u++]];return l[u]=a,Function.apply(null,l).apply(null,c)}return Function(a)()}for(var m=new Array(arguments.length-1),d=0;d<m.length;)m[d]=arguments[++d];if(d=0,s=s.replace(/%([%dfijs])/g,function(E,C){var T=m[d++];switch(C){case"d":case"f":return String(Number(T));case"i":return String(Math.floor(T));case"j":return JSON.stringify(T);case"s":return String(T)}return"%"}),d!==m.length)throw Error("parameter count mismatch");return t.push(s),r}function i(s){return"function "+(s||e||"")+"("+(n&&n.join(",")||"")+`){
  `+t.join(`
  `)+`
}`}return r.toString=i,r}fh.verbose=!1});var T0=R((T6,w0)=>{"use strict";w0.exports=Xs;var px=Zd(),mx=Xd(),ph=mx("fs");function Xs(n,e,t){return typeof e=="function"?(t=e,e={}):e||(e={}),t?!e.xhr&&ph&&ph.readFile?ph.readFile(n,function(i,s){return i&&typeof XMLHttpRequest<"u"?Xs.xhr(n,e,t):i?t(i):t(null,e.binary?s:s.toString("utf8"))}):Xs.xhr(n,e,t):px(Xs,this,n,e)}Xs.xhr=function(e,t,r){var i=new XMLHttpRequest;i.onreadystatechange=function(){if(i.readyState===4){if(i.status!==0&&i.status!==200)return r(Error("status "+i.status));if(t.binary){var a=i.response;if(!a){a=[];for(var o=0;o<i.responseText.length;++o)a.push(i.responseText.charCodeAt(o)&255)}return r(null,typeof Uint8Array<"u"?new Uint8Array(a):a)}return r(null,i.responseText)}},t.binary&&("overrideMimeType"in i&&i.overrideMimeType("text/plain; charset=x-user-defined"),i.responseType="arraybuffer"),i.open("GET",e),i.send()}});var A0=R(I0=>{"use strict";var gh=I0,C0=gh.isAbsolute=function(e){return/^(?:\/|\w+:)/.test(e)},mh=gh.normalize=function(e){e=e.replace(/\\/g,"/").replace(/\/{2,}/g,"/");var t=e.split("/"),r=C0(e),i="";r&&(i=t.shift()+"/");for(var s=0;s<t.length;)t[s]===".."?s>0&&t[s-1]!==".."?t.splice(--s,2):r?t.splice(s,1):++s:t[s]==="."?t.splice(s,1):++s;return i+t.join("/")};gh.resolve=function(e,t,r){return r||(t=mh(t)),C0(t)?t:(r||(e=mh(e)),(e=e.replace(/(?:\/|^)[^/]+$/,"")).length?mh(e+"/"+t):t)}});var Ai=R((I6,x0)=>{"use strict";x0.exports=te;var Qo=er();((te.prototype=Object.create(Qo.prototype)).constructor=te).className="Namespace";var yh=Xn(),Yo=Le(),gx=Lr(),Mr,Ii,Pr;te.fromJSON=function(e,t){return new te(e,t.options).addJSON(t.nested)};function R0(n,e){if(n&&n.length){for(var t={},r=0;r<n.length;++r)t[n[r].name]=n[r].toJSON(e);return t}}te.arrayToJSON=R0;te.isReservedId=function(e,t){if(e){for(var r=0;r<e.length;++r)if(typeof e[r]!="string"&&e[r][0]<=t&&e[r][1]>t)return!0}return!1};te.isReservedName=function(e,t){if(e){for(var r=0;r<e.length;++r)if(e[r]===t)return!0}return!1};function te(n,e){Qo.call(this,n,e),this.nested=void 0,this._nestedArray=null,this._lookupCache={},this._needsRecursiveFeatureResolution=!0,this._needsRecursiveResolve=!0}function D0(n){n._nestedArray=null,n._lookupCache={};for(var e=n;e=e.parent;)e._lookupCache={};return n}Object.defineProperty(te.prototype,"nestedArray",{get:function(){return this._nestedArray||(this._nestedArray=Yo.toArray(this.nested))}});te.prototype.toJSON=function(e){return Yo.toObject(["options",this.options,"nested",R0(this.nestedArray,e)])};te.prototype.addJSON=function(e){var t=this;if(e)for(var r=Object.keys(e),i=0,s;i<r.length;++i)s=e[r[i]],t.add((s.fields!==void 0?Mr.fromJSON:s.values!==void 0?Pr.fromJSON:s.methods!==void 0?Ii.fromJSON:s.id!==void 0?yh.fromJSON:te.fromJSON)(r[i],s));return this};te.prototype.get=function(e){return this.nested&&this.nested[e]||null};te.prototype.getEnum=function(e){if(this.nested&&this.nested[e]instanceof Pr)return this.nested[e].values;throw Error("no such enum: "+e)};te.prototype.add=function(e){if(!(e instanceof yh&&e.extend!==void 0||e instanceof Mr||e instanceof gx||e instanceof Pr||e instanceof Ii||e instanceof te))throw TypeError("object must be a valid nested object");if(!this.nested)this.nested={};else{var t=this.get(e.name);if(t)if(t instanceof te&&e instanceof te&&!(t instanceof Mr||t instanceof Ii)){for(var r=t.nestedArray,i=0;i<r.length;++i)e.add(r[i]);this.remove(t),this.nested||(this.nested={}),e.setOptions(t.options,!0)}else throw Error("duplicate name '"+e.name+"' in "+this)}this.nested[e.name]=e,this instanceof Mr||this instanceof Ii||this instanceof Pr||this instanceof yh||e._edition||(e._edition=e._defaultEdition),this._needsRecursiveFeatureResolution=!0,this._needsRecursiveResolve=!0;for(var s=this;s=s.parent;)s._needsRecursiveFeatureResolution=!0,s._needsRecursiveResolve=!0;return e.onAdd(this),D0(this)};te.prototype.remove=function(e){if(!(e instanceof Qo))throw TypeError("object must be a ReflectionObject");if(e.parent!==this)throw Error(e+" is not a member of "+this);return delete this.nested[e.name],Object.keys(this.nested).length||(this.nested=void 0),e.onRemove(this),D0(this)};te.prototype.define=function(e,t){if(Yo.isString(e))e=e.split(".");else if(!Array.isArray(e))throw TypeError("illegal path");if(e&&e.length&&e[0]==="")throw Error("path must be relative");for(var r=this;e.length>0;){var i=e.shift();if(r.nested&&r.nested[i]){if(r=r.nested[i],!(r instanceof te))throw Error("path conflicts with non-namespace objects")}else r.add(r=new te(i))}return t&&r.addJSON(t),r};te.prototype.resolveAll=function(){if(!this._needsRecursiveResolve)return this;this._resolveFeaturesRecursive(this._edition);var e=this.nestedArray,t=0;for(this.resolve();t<e.length;)e[t]instanceof te?e[t++].resolveAll():e[t++].resolve();return this._needsRecursiveResolve=!1,this};te.prototype._resolveFeaturesRecursive=function(e){return this._needsRecursiveFeatureResolution?(this._needsRecursiveFeatureResolution=!1,e=this._edition||e,Qo.prototype._resolveFeaturesRecursive.call(this,e),this.nestedArray.forEach(t=>{t._resolveFeaturesRecursive(e)}),this):this};te.prototype.lookup=function(e,t,r){if(typeof t=="boolean"?(r=t,t=void 0):t&&!Array.isArray(t)&&(t=[t]),Yo.isString(e)&&e.length){if(e===".")return this.root;e=e.split(".")}else if(!e.length)return this;var i=e.join(".");if(e[0]==="")return this.root.lookup(e.slice(1),t);var s=this.root._fullyQualifiedObjects&&this.root._fullyQualifiedObjects["."+i];if(s&&(!t||t.indexOf(s.constructor)>-1)||(s=this._lookupImpl(e,i),s&&(!t||t.indexOf(s.constructor)>-1)))return s;if(r)return null;for(var a=this;a.parent;){if(s=a.parent._lookupImpl(e,i),s&&(!t||t.indexOf(s.constructor)>-1))return s;a=a.parent}return null};te.prototype._lookupImpl=function(e,t){if(Object.prototype.hasOwnProperty.call(this._lookupCache,t))return this._lookupCache[t];var r=this.get(e[0]),i=null;if(r)e.length===1?i=r:r instanceof te&&(e=e.slice(1),i=r._lookupImpl(e,e.join(".")));else for(var s=0;s<this.nestedArray.length;++s)this._nestedArray[s]instanceof te&&(r=this._nestedArray[s]._lookupImpl(e,t))&&(i=r);return this._lookupCache[t]=i,i};te.prototype.lookupType=function(e){var t=this.lookup(e,[Mr]);if(!t)throw Error("no such type: "+e);return t};te.prototype.lookupEnum=function(e){var t=this.lookup(e,[Pr]);if(!t)throw Error("no such Enum '"+e+"' in "+this);return t};te.prototype.lookupTypeOrEnum=function(e){var t=this.lookup(e,[Mr,Pr]);if(!t)throw Error("no such Type or Enum '"+e+"' in "+this);return t};te.prototype.lookupService=function(e){var t=this.lookup(e,[Ii]);if(!t)throw Error("no such Service '"+e+"' in "+this);return t};te._configure=function(n,e,t){Mr=n,Ii=e,Pr=t}});var Jo=R((A6,N0)=>{"use strict";N0.exports=Tn;var _h=Xn();((Tn.prototype=Object.create(_h.prototype)).constructor=Tn).className="MapField";var yx=Fr(),ea=Le();function Tn(n,e,t,r,i,s){if(_h.call(this,n,e,r,void 0,void 0,i,s),!ea.isString(t))throw TypeError("keyType must be a string");this.keyType=t,this.resolvedKeyType=null,this.map=!0}Tn.fromJSON=function(e,t){return new Tn(e,t.id,t.keyType,t.type,t.options,t.comment)};Tn.prototype.toJSON=function(e){var t=e?!!e.keepComments:!1;return ea.toObject(["keyType",this.keyType,"type",this.type,"id",this.id,"extend",this.extend,"options",this.options,"comment",t?this.comment:void 0])};Tn.prototype.resolve=function(){if(this.resolved)return this;if(yx.mapKey[this.keyType]===void 0)throw Error("invalid key type: "+this.keyType);return _h.prototype.resolve.call(this)};Tn.d=function(e,t,r){return typeof r=="function"?r=ea.decorateType(r).name:r&&typeof r=="object"&&(r=ea.decorateEnum(r).name),function(s,a){ea.decorateType(s.constructor).add(new Tn(a,e,t,r))}}});var Zo=R((R6,O0)=>{"use strict";O0.exports=Br;var vh=er();((Br.prototype=Object.create(vh.prototype)).constructor=Br).className="Method";var Ri=Le();function Br(n,e,t,r,i,s,a,o,l){if(Ri.isObject(i)?(a=i,i=s=void 0):Ri.isObject(s)&&(a=s,s=void 0),!(e===void 0||Ri.isString(e)))throw TypeError("type must be a string");if(!Ri.isString(t))throw TypeError("requestType must be a string");if(!Ri.isString(r))throw TypeError("responseType must be a string");vh.call(this,n,a),this.type=e||"rpc",this.requestType=t,this.requestStream=i?!0:void 0,this.responseType=r,this.responseStream=s?!0:void 0,this.resolvedRequestType=null,this.resolvedResponseType=null,this.comment=o,this.parsedOptions=l}Br.fromJSON=function(e,t){return new Br(e,t.type,t.requestType,t.responseType,t.requestStream,t.responseStream,t.options,t.comment,t.parsedOptions)};Br.prototype.toJSON=function(e){var t=e?!!e.keepComments:!1;return Ri.toObject(["type",this.type!=="rpc"&&this.type||void 0,"requestType",this.requestType,"requestStream",this.requestStream,"responseType",this.responseType,"responseStream",this.responseStream,"options",this.options,"comment",t?this.comment:void 0,"parsedOptions",this.parsedOptions])};Br.prototype.resolve=function(){return this.resolved?this:(this.resolvedRequestType=this.parent.lookupType(this.requestType),this.resolvedResponseType=this.parent.lookupType(this.responseType),vh.prototype.resolve.call(this))}});var Xo=R((D6,M0)=>{"use strict";M0.exports=ft;var Cn=Ai();((ft.prototype=Object.create(Cn.prototype)).constructor=ft).className="Service";var bh=Zo(),ta=Le(),_x=dh();function ft(n,e){Cn.call(this,n,e),this.methods={},this._methodsArray=null}ft.fromJSON=function(e,t){var r=new ft(e,t.options);if(t.methods)for(var i=Object.keys(t.methods),s=0;s<i.length;++s)r.add(bh.fromJSON(i[s],t.methods[i[s]]));return t.nested&&r.addJSON(t.nested),t.edition&&(r._edition=t.edition),r.comment=t.comment,r._defaultEdition="proto3",r};ft.prototype.toJSON=function(e){var t=Cn.prototype.toJSON.call(this,e),r=e?!!e.keepComments:!1;return ta.toObject(["edition",this._editionToJSON(),"options",t&&t.options||void 0,"methods",Cn.arrayToJSON(this.methodsArray,e)||{},"nested",t&&t.nested||void 0,"comment",r?this.comment:void 0])};Object.defineProperty(ft.prototype,"methodsArray",{get:function(){return this._methodsArray||(this._methodsArray=ta.toArray(this.methods))}});function k0(n){return n._methodsArray=null,n}ft.prototype.get=function(e){return this.methods[e]||Cn.prototype.get.call(this,e)};ft.prototype.resolveAll=function(){if(!this._needsRecursiveResolve)return this;Cn.prototype.resolve.call(this);for(var e=this.methodsArray,t=0;t<e.length;++t)e[t].resolve();return this};ft.prototype._resolveFeaturesRecursive=function(e){return this._needsRecursiveFeatureResolution?(e=this._edition||e,Cn.prototype._resolveFeaturesRecursive.call(this,e),this.methodsArray.forEach(t=>{t._resolveFeaturesRecursive(e)}),this):this};ft.prototype.add=function(e){if(this.get(e.name))throw Error("duplicate name '"+e.name+"' in "+this);return e instanceof bh?(this.methods[e.name]=e,e.parent=this,k0(this)):Cn.prototype.add.call(this,e)};ft.prototype.remove=function(e){if(e instanceof bh){if(this.methods[e.name]!==e)throw Error(e+" is not a member of "+this);return delete this.methods[e.name],e.parent=null,k0(this)}return Cn.prototype.remove.call(this,e)};ft.prototype.create=function(e,t,r){for(var i=new _x.Service(e,t,r),s=0,a;s<this.methodsArray.length;++s){var o=ta.lcFirst((a=this._methodsArray[s]).resolve().name).replace(/[^$\w_]/g,"");i[o]=ta.codegen(["r","c"],ta.isReserved(o)?o+"_":o)("return this.rpcCall(m,q,s,r,c)")({m:a,q:a.resolvedRequestType.ctor,s:a.resolvedResponseType.ctor})}return i}});var el=R((x6,P0)=>{"use strict";P0.exports=en;var vx=Zt();function en(n){if(n)for(var e=Object.keys(n),t=0;t<e.length;++t)this[e[t]]=n[e[t]]}en.create=function(e){return this.$type.create(e)};en.encode=function(e,t){return this.$type.encode(e,t)};en.encodeDelimited=function(e,t){return this.$type.encodeDelimited(e,t)};en.decode=function(e){return this.$type.decode(e)};en.decodeDelimited=function(e){return this.$type.decodeDelimited(e)};en.verify=function(e){return this.$type.verify(e)};en.fromObject=function(e){return this.$type.fromObject(e)};en.toObject=function(e,t){return this.$type.toObject(e,t)};en.prototype.toJSON=function(){return this.$type.toObject(this,vx.toJSONOptions)}});var Sh=R((N6,F0)=>{"use strict";F0.exports=Ex;var bx=Pt(),In=Fr(),L0=Le();function Sx(n){return"missing required '"+n.name+"'"}function Ex(n){for(var e=L0.codegen(["r","l","e"],n.name+"$decode")("if(!(r instanceof Reader))")("r=Reader.create(r)")("var c=l===undefined?r.len:r.pos+l,m=new this.ctor"+(n.fieldsArray.filter(function(o){return o.map}).length?",k,value":""))("while(r.pos<c){")("var t=r.uint32()")("if(t===e)")("break")("switch(t>>>3){"),t=0;t<n.fieldsArray.length;++t){var r=n._fieldsArray[t].resolve(),i=r.resolvedType instanceof bx?"int32":r.type,s="m"+L0.safeProp(r.name);e("case %i: {",r.id),r.map?(e("if(%s===util.emptyObject)",s)("%s={}",s)("var c2 = r.uint32()+r.pos"),In.defaults[r.keyType]!==void 0?e("k=%j",In.defaults[r.keyType]):e("k=null"),In.defaults[i]!==void 0?e("value=%j",In.defaults[i]):e("value=null"),e("while(r.pos<c2){")("var tag2=r.uint32()")("switch(tag2>>>3){")("case 1: k=r.%s(); break",r.keyType)("case 2:"),In.basic[i]===void 0?e("value=types[%i].decode(r,r.uint32())",t):e("value=r.%s()",i),e("break")("default:")("r.skipType(tag2&7)")("break")("}")("}"),In.long[r.keyType]!==void 0?e('%s[typeof k==="object"?util.longToHash(k):k]=value',s):e("%s[k]=value",s)):r.repeated?(e("if(!(%s&&%s.length))",s,s)("%s=[]",s),In.packed[i]!==void 0&&e("if((t&7)===2){")("var c2=r.uint32()+r.pos")("while(r.pos<c2)")("%s.push(r.%s())",s,i)("}else"),In.basic[i]===void 0?e(r.delimited?"%s.push(types[%i].decode(r,undefined,((t&~7)|4)))":"%s.push(types[%i].decode(r,r.uint32()))",s,t):e("%s.push(r.%s())",s,i)):In.basic[i]===void 0?e(r.delimited?"%s=types[%i].decode(r,undefined,((t&~7)|4))":"%s=types[%i].decode(r,r.uint32())",s,t):e("%s=r.%s()",s,i),e("break")("}")}for(e("default:")("r.skipType(t&7)")("break")("}")("}"),t=0;t<n._fieldsArray.length;++t){var a=n._fieldsArray[t];a.required&&e("if(!m.hasOwnProperty(%j))",a.name)("throw util.ProtocolError(%j,{instance:m})",Sx(a))}return e("return m")}});var Th=R((O6,B0)=>{"use strict";B0.exports=Cx;var wx=Pt(),Eh=Le();function It(n,e){return n.name+": "+e+(n.repeated&&e!=="array"?"[]":n.map&&e!=="object"?"{k:"+n.keyType+"}":"")+" expected"}function wh(n,e,t,r){if(e.resolvedType)if(e.resolvedType instanceof wx){n("switch(%s){",r)("default:")("return%j",It(e,"enum value"));for(var i=Object.keys(e.resolvedType.values),s=0;s<i.length;++s)n("case %i:",e.resolvedType.values[i[s]]);n("break")("}")}else n("{")("var e=types[%i].verify(%s);",t,r)("if(e)")("return%j+e",e.name+".")("}");else switch(e.type){case"int32":case"uint32":case"sint32":case"fixed32":case"sfixed32":n("if(!util.isInteger(%s))",r)("return%j",It(e,"integer"));break;case"int64":case"uint64":case"sint64":case"fixed64":case"sfixed64":n("if(!util.isInteger(%s)&&!(%s&&util.isInteger(%s.low)&&util.isInteger(%s.high)))",r,r,r,r)("return%j",It(e,"integer|Long"));break;case"float":case"double":n('if(typeof %s!=="number")',r)("return%j",It(e,"number"));break;case"bool":n('if(typeof %s!=="boolean")',r)("return%j",It(e,"boolean"));break;case"string":n("if(!util.isString(%s))",r)("return%j",It(e,"string"));break;case"bytes":n('if(!(%s&&typeof %s.length==="number"||util.isString(%s)))',r,r,r)("return%j",It(e,"buffer"));break}return n}function Tx(n,e,t){switch(e.keyType){case"int32":case"uint32":case"sint32":case"fixed32":case"sfixed32":n("if(!util.key32Re.test(%s))",t)("return%j",It(e,"integer key"));break;case"int64":case"uint64":case"sint64":case"fixed64":case"sfixed64":n("if(!util.key64Re.test(%s))",t)("return%j",It(e,"integer|Long key"));break;case"bool":n("if(!util.key2Re.test(%s))",t)("return%j",It(e,"boolean key"));break}return n}function Cx(n){var e=Eh.codegen(["m"],n.name+"$verify")('if(typeof m!=="object"||m===null)')("return%j","object expected"),t=n.oneofsArray,r={};t.length&&e("var p={}");for(var i=0;i<n.fieldsArray.length;++i){var s=n._fieldsArray[i].resolve(),a="m"+Eh.safeProp(s.name);if(s.optional&&e("if(%s!=null&&m.hasOwnProperty(%j)){",a,s.name),s.map)e("if(!util.isObject(%s))",a)("return%j",It(s,"object"))("var k=Object.keys(%s)",a)("for(var i=0;i<k.length;++i){"),Tx(e,s,"k[i]"),wh(e,s,i,a+"[k[i]]")("}");else if(s.repeated)e("if(!Array.isArray(%s))",a)("return%j",It(s,"array"))("for(var i=0;i<%s.length;++i){",a),wh(e,s,i,a+"[i]")("}");else{if(s.partOf){var o=Eh.safeProp(s.partOf.name);r[s.partOf.name]===1&&e("if(p%s===1)",o)("return%j",s.partOf.name+": multiple values"),r[s.partOf.name]=1,e("p%s=1",o)}wh(e,s,i,a)}s.optional&&e("}")}return e("return null")}});var Ah=R(q0=>{"use strict";var U0=q0,na=Pt(),tn=Le();function Ch(n,e,t,r){var i=!1;if(e.resolvedType)if(e.resolvedType instanceof na){n("switch(d%s){",r);for(var s=e.resolvedType.values,a=Object.keys(s),o=0;o<a.length;++o)s[a[o]]===e.typeDefault&&!i&&(n("default:")('if(typeof(d%s)==="number"){m%s=d%s;break}',r,r,r),e.repeated||n("break"),i=!0),n("case%j:",a[o])("case %i:",s[a[o]])("m%s=%j",r,s[a[o]])("break");n("}")}else n('if(typeof d%s!=="object")',r)("throw TypeError(%j)",e.fullName+": object expected")("m%s=types[%i].fromObject(d%s)",r,t,r);else{var l=!1;switch(e.type){case"double":case"float":n("m%s=Number(d%s)",r,r);break;case"uint32":case"fixed32":n("m%s=d%s>>>0",r,r);break;case"int32":case"sint32":case"sfixed32":n("m%s=d%s|0",r,r);break;case"uint64":l=!0;case"int64":case"sint64":case"fixed64":case"sfixed64":n("if(util.Long)")("(m%s=util.Long.fromValue(d%s)).unsigned=%j",r,r,l)('else if(typeof d%s==="string")',r)("m%s=parseInt(d%s,10)",r,r)('else if(typeof d%s==="number")',r)("m%s=d%s",r,r)('else if(typeof d%s==="object")',r)("m%s=new util.LongBits(d%s.low>>>0,d%s.high>>>0).toNumber(%s)",r,r,r,l?"true":"");break;case"bytes":n('if(typeof d%s==="string")',r)("util.base64.decode(d%s,m%s=util.newBuffer(util.base64.length(d%s)),0)",r,r,r)("else if(d%s.length >= 0)",r)("m%s=d%s",r,r);break;case"string":n("m%s=String(d%s)",r,r);break;case"bool":n("m%s=Boolean(d%s)",r,r);break}}return n}U0.fromObject=function(e){var t=e.fieldsArray,r=tn.codegen(["d"],e.name+"$fromObject")("if(d instanceof this.ctor)")("return d");if(!t.length)return r("return new this.ctor");r("var m=new this.ctor");for(var i=0;i<t.length;++i){var s=t[i].resolve(),a=tn.safeProp(s.name);s.map?(r("if(d%s){",a)('if(typeof d%s!=="object")',a)("throw TypeError(%j)",s.fullName+": object expected")("m%s={}",a)("for(var ks=Object.keys(d%s),i=0;i<ks.length;++i){",a),Ch(r,s,i,a+"[ks[i]]")("}")("}")):s.repeated?(r("if(d%s){",a)("if(!Array.isArray(d%s))",a)("throw TypeError(%j)",s.fullName+": array expected")("m%s=[]",a)("for(var i=0;i<d%s.length;++i){",a),Ch(r,s,i,a+"[i]")("}")("}")):(s.resolvedType instanceof na||r("if(d%s!=null){",a),Ch(r,s,i,a),s.resolvedType instanceof na||r("}"))}return r("return m")};function Ih(n,e,t,r){if(e.resolvedType)e.resolvedType instanceof na?n("d%s=o.enums===String?(types[%i].values[m%s]===undefined?m%s:types[%i].values[m%s]):m%s",r,t,r,r,t,r,r):n("d%s=types[%i].toObject(m%s,o)",r,t,r);else{var i=!1;switch(e.type){case"double":case"float":n("d%s=o.json&&!isFinite(m%s)?String(m%s):m%s",r,r,r,r);break;case"uint64":i=!0;case"int64":case"sint64":case"fixed64":case"sfixed64":n('if(typeof m%s==="number")',r)("d%s=o.longs===String?String(m%s):m%s",r,r,r)("else")("d%s=o.longs===String?util.Long.prototype.toString.call(m%s):o.longs===Number?new util.LongBits(m%s.low>>>0,m%s.high>>>0).toNumber(%s):m%s",r,r,r,r,i?"true":"",r);break;case"bytes":n("d%s=o.bytes===String?util.base64.encode(m%s,0,m%s.length):o.bytes===Array?Array.prototype.slice.call(m%s):m%s",r,r,r,r,r);break;default:n("d%s=m%s",r,r);break}}return n}U0.toObject=function(e){var t=e.fieldsArray.slice().sort(tn.compareFieldsById);if(!t.length)return tn.codegen()("return {}");for(var r=tn.codegen(["m","o"],e.name+"$toObject")("if(!o)")("o={}")("var d={}"),i=[],s=[],a=[],o=0;o<t.length;++o)t[o].partOf||(t[o].resolve().repeated?i:t[o].map?s:a).push(t[o]);if(i.length){for(r("if(o.arrays||o.defaults){"),o=0;o<i.length;++o)r("d%s=[]",tn.safeProp(i[o].name));r("}")}if(s.length){for(r("if(o.objects||o.defaults){"),o=0;o<s.length;++o)r("d%s={}",tn.safeProp(s[o].name));r("}")}if(a.length){for(r("if(o.defaults){"),o=0;o<a.length;++o){var l=a[o],c=tn.safeProp(l.name);if(l.resolvedType instanceof na)r("d%s=o.enums===String?%j:%j",c,l.resolvedType.valuesById[l.typeDefault],l.typeDefault);else if(l.long)r("if(util.Long){")("var n=new util.Long(%i,%i,%j)",l.typeDefault.low,l.typeDefault.high,l.typeDefault.unsigned)("d%s=o.longs===String?n.toString():o.longs===Number?n.toNumber():n",c)("}else")("d%s=o.longs===String?%j:%i",c,l.typeDefault.toString(),l.typeDefault.toNumber());else if(l.bytes){var u="["+Array.prototype.slice.call(l.typeDefault).join(",")+"]";r("if(o.bytes===String)d%s=%j",c,String.fromCharCode.apply(String,l.typeDefault))("else{")("d%s=%s",c,u)("if(o.bytes!==Array)d%s=util.newBuffer(d%s)",c,c)("}")}else r("d%s=%j",c,l.typeDefault)}r("}")}var m=!1;for(o=0;o<t.length;++o){var l=t[o],d=e._fieldsArray.indexOf(l),c=tn.safeProp(l.name);l.map?(m||(m=!0,r("var ks2")),r("if(m%s&&(ks2=Object.keys(m%s)).length){",c,c)("d%s={}",c)("for(var j=0;j<ks2.length;++j){"),Ih(r,l,d,c+"[ks2[j]]")("}")):l.repeated?(r("if(m%s&&m%s.length){",c,c)("d%s=[]",c)("for(var j=0;j<m%s.length;++j){",c),Ih(r,l,d,c+"[j]")("}")):(r("if(m%s!=null&&m.hasOwnProperty(%j)){",c,l.name),Ih(r,l,d,c),l.partOf&&r("if(o.oneofs)")("d%s=%j",tn.safeProp(l.partOf.name),l.name)),r("}")}return r("return d")}});var Rh=R(V0=>{"use strict";var Ix=V0,Ax=el();Ix[".google.protobuf.Any"]={fromObject:function(n){if(n&&n["@type"]){var e=n["@type"].substring(n["@type"].lastIndexOf("/")+1),t=this.lookup(e);if(t){var r=n["@type"].charAt(0)==="."?n["@type"].slice(1):n["@type"];return r.indexOf("/")===-1&&(r="/"+r),this.create({type_url:r,value:t.encode(t.fromObject(n)).finish()})}}return this.fromObject(n)},toObject:function(n,e){var t="type.googleapis.com/",r="",i="";if(e&&e.json&&n.type_url&&n.value){i=n.type_url.substring(n.type_url.lastIndexOf("/")+1),r=n.type_url.substring(0,n.type_url.lastIndexOf("/")+1);var s=this.lookup(i);s&&(n=s.decode(n.value))}if(!(n instanceof this.ctor)&&n instanceof Ax){var a=n.$type.toObject(n,e),o=n.$type.fullName[0]==="."?n.$type.fullName.slice(1):n.$type.fullName;return r===""&&(r=t),i=r+o,a["@type"]=i,a}return this.toObject(n,e)}}});var rl=R((P6,G0)=>{"use strict";G0.exports=de;var At=Ai();((de.prototype=Object.create(At.prototype)).constructor=de).className="Type";var Rx=Pt(),Nh=Lr(),tl=Xn(),Dx=Jo(),xx=Xo(),Dh=el(),xh=Wo(),Nx=Ko(),He=Le(),Ox=Oh(),kx=Sh(),Mx=Th(),z0=Ah(),Px=Rh();function de(n,e){At.call(this,n,e),this.fields={},this.oneofs=void 0,this.extensions=void 0,this.reserved=void 0,this.group=void 0,this._fieldsById=null,this._fieldsArray=null,this._oneofsArray=null,this._ctor=null}Object.defineProperties(de.prototype,{fieldsById:{get:function(){if(this._fieldsById)return this._fieldsById;this._fieldsById={};for(var n=Object.keys(this.fields),e=0;e<n.length;++e){var t=this.fields[n[e]],r=t.id;if(this._fieldsById[r])throw Error("duplicate id "+r+" in "+this);this._fieldsById[r]=t}return this._fieldsById}},fieldsArray:{get:function(){return this._fieldsArray||(this._fieldsArray=He.toArray(this.fields))}},oneofsArray:{get:function(){return this._oneofsArray||(this._oneofsArray=He.toArray(this.oneofs))}},ctor:{get:function(){return this._ctor||(this.ctor=de.generateConstructor(this)())},set:function(n){var e=n.prototype;e instanceof Dh||((n.prototype=new Dh).constructor=n,He.merge(n.prototype,e)),n.$type=n.prototype.$type=this,He.merge(n,Dh,!0),this._ctor=n;for(var t=0;t<this.fieldsArray.length;++t)this._fieldsArray[t].resolve();var r={};for(t=0;t<this.oneofsArray.length;++t)r[this._oneofsArray[t].resolve().name]={get:He.oneOfGetter(this._oneofsArray[t].oneof),set:He.oneOfSetter(this._oneofsArray[t].oneof)};t&&Object.defineProperties(n.prototype,r)}}});de.generateConstructor=function(e){for(var t=He.codegen(["p"],e.name),r=0,i;r<e.fieldsArray.length;++r)(i=e._fieldsArray[r]).map?t("this%s={}",He.safeProp(i.name)):i.repeated&&t("this%s=[]",He.safeProp(i.name));return t("if(p)for(var ks=Object.keys(p),i=0;i<ks.length;++i)if(p[ks[i]]!=null)")("this[ks[i]]=p[ks[i]]")};function nl(n){return n._fieldsById=n._fieldsArray=n._oneofsArray=null,delete n.encode,delete n.decode,delete n.verify,n}de.fromJSON=function(e,t){var r=new de(e,t.options);r.extensions=t.extensions,r.reserved=t.reserved;for(var i=Object.keys(t.fields),s=0;s<i.length;++s)r.add((typeof t.fields[i[s]].keyType<"u"?Dx.fromJSON:tl.fromJSON)(i[s],t.fields[i[s]]));if(t.oneofs)for(i=Object.keys(t.oneofs),s=0;s<i.length;++s)r.add(Nh.fromJSON(i[s],t.oneofs[i[s]]));if(t.nested)for(i=Object.keys(t.nested),s=0;s<i.length;++s){var a=t.nested[i[s]];r.add((a.id!==void 0?tl.fromJSON:a.fields!==void 0?de.fromJSON:a.values!==void 0?Rx.fromJSON:a.methods!==void 0?xx.fromJSON:At.fromJSON)(i[s],a))}return t.extensions&&t.extensions.length&&(r.extensions=t.extensions),t.reserved&&t.reserved.length&&(r.reserved=t.reserved),t.group&&(r.group=!0),t.comment&&(r.comment=t.comment),t.edition&&(r._edition=t.edition),r._defaultEdition="proto3",r};de.prototype.toJSON=function(e){var t=At.prototype.toJSON.call(this,e),r=e?!!e.keepComments:!1;return He.toObject(["edition",this._editionToJSON(),"options",t&&t.options||void 0,"oneofs",At.arrayToJSON(this.oneofsArray,e),"fields",At.arrayToJSON(this.fieldsArray.filter(function(i){return!i.declaringField}),e)||{},"extensions",this.extensions&&this.extensions.length?this.extensions:void 0,"reserved",this.reserved&&this.reserved.length?this.reserved:void 0,"group",this.group||void 0,"nested",t&&t.nested||void 0,"comment",r?this.comment:void 0])};de.prototype.resolveAll=function(){if(!this._needsRecursiveResolve)return this;At.prototype.resolveAll.call(this);var e=this.oneofsArray;for(r=0;r<e.length;)e[r++].resolve();for(var t=this.fieldsArray,r=0;r<t.length;)t[r++].resolve();return this};de.prototype._resolveFeaturesRecursive=function(e){return this._needsRecursiveFeatureResolution?(e=this._edition||e,At.prototype._resolveFeaturesRecursive.call(this,e),this.oneofsArray.forEach(t=>{t._resolveFeatures(e)}),this.fieldsArray.forEach(t=>{t._resolveFeatures(e)}),this):this};de.prototype.get=function(e){return this.fields[e]||this.oneofs&&this.oneofs[e]||this.nested&&this.nested[e]||null};de.prototype.add=function(e){if(this.get(e.name))throw Error("duplicate name '"+e.name+"' in "+this);if(e instanceof tl&&e.extend===void 0){if(this._fieldsById?this._fieldsById[e.id]:this.fieldsById[e.id])throw Error("duplicate id "+e.id+" in "+this);if(this.isReservedId(e.id))throw Error("id "+e.id+" is reserved in "+this);if(this.isReservedName(e.name))throw Error("name '"+e.name+"' is reserved in "+this);return e.parent&&e.parent.remove(e),this.fields[e.name]=e,e.message=this,e.onAdd(this),nl(this)}return e instanceof Nh?(this.oneofs||(this.oneofs={}),this.oneofs[e.name]=e,e.onAdd(this),nl(this)):At.prototype.add.call(this,e)};de.prototype.remove=function(e){if(e instanceof tl&&e.extend===void 0){if(!this.fields||this.fields[e.name]!==e)throw Error(e+" is not a member of "+this);return delete this.fields[e.name],e.parent=null,e.onRemove(this),nl(this)}if(e instanceof Nh){if(!this.oneofs||this.oneofs[e.name]!==e)throw Error(e+" is not a member of "+this);return delete this.oneofs[e.name],e.parent=null,e.onRemove(this),nl(this)}return At.prototype.remove.call(this,e)};de.prototype.isReservedId=function(e){return At.isReservedId(this.reserved,e)};de.prototype.isReservedName=function(e){return At.isReservedName(this.reserved,e)};de.prototype.create=function(e){return new this.ctor(e)};de.prototype.setup=function(){for(var e=this.fullName,t=[],r=0;r<this.fieldsArray.length;++r)t.push(this._fieldsArray[r].resolve().resolvedType);this.encode=Ox(this)({Writer:Nx,types:t,util:He}),this.decode=kx(this)({Reader:xh,types:t,util:He}),this.verify=Mx(this)({types:t,util:He}),this.fromObject=z0.fromObject(this)({types:t,util:He}),this.toObject=z0.toObject(this)({types:t,util:He});var i=Px[e];if(i){var s=Object.create(this);s.fromObject=this.fromObject,this.fromObject=i.fromObject.bind(s),s.toObject=this.toObject,this.toObject=i.toObject.bind(s)}return this};de.prototype.encode=function(e,t){return this.setup().encode(e,t)};de.prototype.encodeDelimited=function(e,t){return this.encode(e,t&&t.len?t.fork():t).ldelim()};de.prototype.decode=function(e,t){return this.setup().decode(e,t)};de.prototype.decodeDelimited=function(e){return e instanceof xh||(e=xh.create(e)),this.decode(e,e.uint32())};de.prototype.verify=function(e){return this.setup().verify(e)};de.prototype.fromObject=function(e){return this.setup().fromObject(e)};de.prototype.toObject=function(e,t){return this.setup().toObject(e,t)};de.d=function(e){return function(r){He.decorateType(r,e)}}});var ol=R((L6,K0)=>{"use strict";K0.exports=pt;var al=Ai();((pt.prototype=Object.create(al.prototype)).constructor=pt).className="Root";var il=Xn(),kh=Pt(),Lx=Lr(),tr=Le(),Mh,Ph,ra;function pt(n){al.call(this,"",n),this.deferred=[],this.files=[],this._edition="proto2",this._fullyQualifiedObjects={}}pt.fromJSON=function(e,t){return t||(t=new pt),e.options&&t.setOptions(e.options),t.addJSON(e.nested).resolveAll()};pt.prototype.resolvePath=tr.path.resolve;pt.prototype.fetch=tr.fetch;function j0(){}pt.prototype.load=function n(e,t,r){typeof t=="function"&&(r=t,t=void 0);var i=this;if(!r)return tr.asPromise(n,i,e,t);var s=r===j0;function a(p,E){if(r){if(s)throw p;E&&E.resolveAll();var C=r;r=null,C(p,E)}}function o(p){var E=p.lastIndexOf("google/protobuf/");if(E>-1){var C=p.substring(E);if(C in ra)return C}return null}function l(p,E){try{if(tr.isString(E)&&E.charAt(0)==="{"&&(E=JSON.parse(E)),!tr.isString(E))i.setOptions(E.options).addJSON(E.nested);else{Ph.filename=p;var C=Ph(E,i,t),T,I=0;if(C.imports)for(;I<C.imports.length;++I)(T=o(C.imports[I])||i.resolvePath(p,C.imports[I]))&&c(T);if(C.weakImports)for(I=0;I<C.weakImports.length;++I)(T=o(C.weakImports[I])||i.resolvePath(p,C.weakImports[I]))&&c(T,!0)}}catch(N){a(N)}!s&&!u&&a(null,i)}function c(p,E){if(p=o(p)||p,!(i.files.indexOf(p)>-1)){if(i.files.push(p),p in ra){s?l(p,ra[p]):(++u,setTimeout(function(){--u,l(p,ra[p])}));return}if(s){var C;try{C=tr.fs.readFileSync(p).toString("utf8")}catch(T){E||a(T);return}l(p,C)}else++u,i.fetch(p,function(T,I){if(--u,!!r){if(T){E?u||a(null,i):a(T);return}l(p,I)}})}}var u=0;tr.isString(e)&&(e=[e]);for(var m=0,d;m<e.length;++m)(d=i.resolvePath("",e[m]))&&c(d);return s?(i.resolveAll(),i):(u||a(null,i),i)};pt.prototype.loadSync=function(e,t){if(!tr.isNode)throw Error("not supported");return this.load(e,t,j0)};pt.prototype.resolveAll=function(){if(!this._needsRecursiveResolve)return this;if(this.deferred.length)throw Error("unresolvable extensions: "+this.deferred.map(function(e){return"'extend "+e.extend+"' in "+e.parent.fullName}).join(", "));return al.prototype.resolveAll.call(this)};var sl=/^[A-Z]/;function $0(n,e){var t=e.parent.lookup(e.extend);if(t){var r=new il(e.fullName,e.id,e.type,e.rule,void 0,e.options);return t.get(r.name)||(r.declaringField=e,e.extensionField=r,t.add(r)),!0}return!1}pt.prototype._handleAdd=function(e){if(e instanceof il)e.extend!==void 0&&!e.extensionField&&($0(this,e)||this.deferred.push(e));else if(e instanceof kh)sl.test(e.name)&&(e.parent[e.name]=e.values);else if(!(e instanceof Lx)){if(e instanceof Mh)for(var t=0;t<this.deferred.length;)$0(this,this.deferred[t])?this.deferred.splice(t,1):++t;for(var r=0;r<e.nestedArray.length;++r)this._handleAdd(e._nestedArray[r]);sl.test(e.name)&&(e.parent[e.name]=e)}(e instanceof Mh||e instanceof kh||e instanceof il)&&(this._fullyQualifiedObjects[e.fullName]=e)};pt.prototype._handleRemove=function(e){if(e instanceof il){if(e.extend!==void 0)if(e.extensionField)e.extensionField.parent.remove(e.extensionField),e.extensionField=null;else{var t=this.deferred.indexOf(e);t>-1&&this.deferred.splice(t,1)}}else if(e instanceof kh)sl.test(e.name)&&delete e.parent[e.name];else if(e instanceof al){for(var r=0;r<e.nestedArray.length;++r)this._handleRemove(e._nestedArray[r]);sl.test(e.name)&&delete e.parent[e.name]}delete this._fullyQualifiedObjects[e.fullName]};pt._configure=function(n,e,t){Mh=n,Ph=e,ra=t}});var Le=R((F6,W0)=>{"use strict";var we=W0.exports=Zt(),H0=hh(),Lh,Fh;we.codegen=E0();we.fetch=T0();we.path=A0();we.fs=we.inquire("fs");we.toArray=function(e){if(e){for(var t=Object.keys(e),r=new Array(t.length),i=0;i<t.length;)r[i]=e[t[i++]];return r}return[]};we.toObject=function(e){for(var t={},r=0;r<e.length;){var i=e[r++],s=e[r++];s!==void 0&&(t[i]=s)}return t};var Fx=/\\/g,Bx=/"/g;we.isReserved=function(e){return/^(?:do|if|in|for|let|new|try|var|case|else|enum|eval|false|null|this|true|void|with|break|catch|class|const|super|throw|while|yield|delete|export|import|public|return|static|switch|typeof|default|extends|finally|package|private|continue|debugger|function|arguments|interface|protected|implements|instanceof)$/.test(e)};we.safeProp=function(e){return!/^[$\w_]+$/.test(e)||we.isReserved(e)?'["'+e.replace(Fx,"\\\\").replace(Bx,'\\"')+'"]':"."+e};we.ucFirst=function(e){return e.charAt(0).toUpperCase()+e.substring(1)};var Ux=/_([a-z])/g;we.camelCase=function(e){return e.substring(0,1)+e.substring(1).replace(Ux,function(t,r){return r.toUpperCase()})};we.compareFieldsById=function(e,t){return e.id-t.id};we.decorateType=function(e,t){if(e.$type)return t&&e.$type.name!==t&&(we.decorateRoot.remove(e.$type),e.$type.name=t,we.decorateRoot.add(e.$type)),e.$type;Lh||(Lh=rl());var r=new Lh(t||e.name);return we.decorateRoot.add(r),r.ctor=e,Object.defineProperty(e,"$type",{value:r,enumerable:!1}),Object.defineProperty(e.prototype,"$type",{value:r,enumerable:!1}),r};var qx=0;we.decorateEnum=function(e){if(e.$type)return e.$type;Fh||(Fh=Pt());var t=new Fh("Enum"+qx++,e);return we.decorateRoot.add(t),Object.defineProperty(e,"$type",{value:t,enumerable:!1}),t};we.setProperty=function(e,t,r,i){function s(a,o,l){var c=o.shift();if(c==="__proto__"||c==="prototype")return a;if(o.length>0)a[c]=s(a[c]||{},o,l);else{var u=a[c];if(u&&i)return a;u&&(l=[].concat(u).concat(l)),a[c]=l}return a}if(typeof e!="object")throw TypeError("dst must be an object");if(!t)throw TypeError("path must be specified");return t=t.split("."),s(e,t,r)};Object.defineProperty(we,"decorateRoot",{get:function(){return H0.decorated||(H0.decorated=new(ol()))}})});var Fr=R(Q0=>{"use strict";var ia=Q0,Vx=Le(),zx=["double","float","int32","uint32","sint32","fixed32","sfixed32","int64","uint64","sint64","fixed64","sfixed64","bool","string","bytes"];function sa(n,e){var t=0,r={};for(e|=0;t<n.length;)r[zx[t+e]]=n[t++];return r}ia.basic=sa([1,5,0,0,0,5,5,0,0,0,1,1,0,2,2]);ia.defaults=sa([0,0,0,0,0,0,0,0,0,0,0,0,!1,"",Vx.emptyArray,null]);ia.long=sa([0,0,0,1,1],7);ia.mapKey=sa([0,0,0,5,5,0,0,0,1,1,0,2],2);ia.packed=sa([1,5,0,0,0,5,5,0,0,0,1,1,0])});var Xn=R((U6,J0)=>{"use strict";J0.exports=Fe;var oa=er();((Fe.prototype=Object.create(oa.prototype)).constructor=Fe).className="Field";var Y0=Pt(),Bh=Fr(),Ae=Le(),aa,Gx=/^required|optional|repeated$/;Fe.fromJSON=function(e,t){var r=new Fe(e,t.id,t.type,t.rule,t.extend,t.options,t.comment);return t.edition&&(r._edition=t.edition),r._defaultEdition="proto3",r};function Fe(n,e,t,r,i,s,a){if(Ae.isObject(r)?(a=i,s=r,r=i=void 0):Ae.isObject(i)&&(a=s,s=i,i=void 0),oa.call(this,n,s),!Ae.isInteger(e)||e<0)throw TypeError("id must be a non-negative integer");if(!Ae.isString(t))throw TypeError("type must be a string");if(r!==void 0&&!Gx.test(r=r.toString().toLowerCase()))throw TypeError("rule must be a string rule");if(i!==void 0&&!Ae.isString(i))throw TypeError("extend must be a string");r==="proto3_optional"&&(r="optional"),this.rule=r&&r!=="optional"?r:void 0,this.type=t,this.id=e,this.extend=i||void 0,this.repeated=r==="repeated",this.map=!1,this.message=null,this.partOf=null,this.typeDefault=null,this.defaultValue=null,this.long=Ae.Long?Bh.long[t]!==void 0:!1,this.bytes=t==="bytes",this.resolvedType=null,this.extensionField=null,this.declaringField=null,this.comment=a}Object.defineProperty(Fe.prototype,"required",{get:function(){return this._features.field_presence==="LEGACY_REQUIRED"}});Object.defineProperty(Fe.prototype,"optional",{get:function(){return!this.required}});Object.defineProperty(Fe.prototype,"delimited",{get:function(){return this.resolvedType instanceof aa&&this._features.message_encoding==="DELIMITED"}});Object.defineProperty(Fe.prototype,"packed",{get:function(){return this._features.repeated_field_encoding==="PACKED"}});Object.defineProperty(Fe.prototype,"hasPresence",{get:function(){return this.repeated||this.map?!1:this.partOf||this.declaringField||this.extensionField||this._features.field_presence!=="IMPLICIT"}});Fe.prototype.setOption=function(e,t,r){return oa.prototype.setOption.call(this,e,t,r)};Fe.prototype.toJSON=function(e){var t=e?!!e.keepComments:!1;return Ae.toObject(["edition",this._editionToJSON(),"rule",this.rule!=="optional"&&this.rule||void 0,"type",this.type,"id",this.id,"extend",this.extend,"options",this.options,"comment",t?this.comment:void 0])};Fe.prototype.resolve=function(){if(this.resolved)return this;if((this.typeDefault=Bh.defaults[this.type])===void 0?(this.resolvedType=(this.declaringField?this.declaringField.parent:this.parent).lookupTypeOrEnum(this.type),this.resolvedType instanceof aa?this.typeDefault=null:this.typeDefault=this.resolvedType.values[Object.keys(this.resolvedType.values)[0]]):this.options&&this.options.proto3_optional&&(this.typeDefault=null),this.options&&this.options.default!=null&&(this.typeDefault=this.options.default,this.resolvedType instanceof Y0&&typeof this.typeDefault=="string"&&(this.typeDefault=this.resolvedType.values[this.typeDefault])),this.options&&(this.options.packed!==void 0&&this.resolvedType&&!(this.resolvedType instanceof Y0)&&delete this.options.packed,Object.keys(this.options).length||(this.options=void 0)),this.long)this.typeDefault=Ae.Long.fromNumber(this.typeDefault,this.type.charAt(0)==="u"),Object.freeze&&Object.freeze(this.typeDefault);else if(this.bytes&&typeof this.typeDefault=="string"){var e;Ae.base64.test(this.typeDefault)?Ae.base64.decode(this.typeDefault,e=Ae.newBuffer(Ae.base64.length(this.typeDefault)),0):Ae.utf8.write(this.typeDefault,e=Ae.newBuffer(Ae.utf8.length(this.typeDefault)),0),this.typeDefault=e}return this.map?this.defaultValue=Ae.emptyObject:this.repeated?this.defaultValue=Ae.emptyArray:this.defaultValue=this.typeDefault,this.parent instanceof aa&&(this.parent.ctor.prototype[this.name]=this.defaultValue),oa.prototype.resolve.call(this)};Fe.prototype._inferLegacyProtoFeatures=function(e){if(e!=="proto2"&&e!=="proto3")return{};var t={};if(this.rule==="required"&&(t.field_presence="LEGACY_REQUIRED"),this.parent&&Bh.defaults[this.type]===void 0){var r=this.parent.get(this.type.split(".").pop());r&&r instanceof aa&&r.group&&(t.message_encoding="DELIMITED")}return this.getOption("packed")===!0?t.repeated_field_encoding="PACKED":this.getOption("packed")===!1&&(t.repeated_field_encoding="EXPANDED"),t};Fe.prototype._resolveFeatures=function(e){return oa.prototype._resolveFeatures.call(this,this._edition||e)};Fe.d=function(e,t,r,i){return typeof t=="function"?t=Ae.decorateType(t).name:t&&typeof t=="object"&&(t=Ae.decorateEnum(t).name),function(a,o){Ae.decorateType(a.constructor).add(new Fe(o,e,t,r,{default:i}))}};Fe._configure=function(e){aa=e}});var Lr=R((q6,eb)=>{"use strict";eb.exports=mt;var cl=er();((mt.prototype=Object.create(cl.prototype)).constructor=mt).className="OneOf";var Z0=Xn(),ll=Le();function mt(n,e,t,r){if(Array.isArray(e)||(t=e,e=void 0),cl.call(this,n,t),!(e===void 0||Array.isArray(e)))throw TypeError("fieldNames must be an Array");this.oneof=e||[],this.fieldsArray=[],this.comment=r}mt.fromJSON=function(e,t){return new mt(e,t.oneof,t.options,t.comment)};mt.prototype.toJSON=function(e){var t=e?!!e.keepComments:!1;return ll.toObject(["options",this.options,"oneof",this.oneof,"comment",t?this.comment:void 0])};function X0(n){if(n.parent)for(var e=0;e<n.fieldsArray.length;++e)n.fieldsArray[e].parent||n.parent.add(n.fieldsArray[e])}mt.prototype.add=function(e){if(!(e instanceof Z0))throw TypeError("field must be a Field");return e.parent&&e.parent!==this.parent&&e.parent.remove(e),this.oneof.push(e.name),this.fieldsArray.push(e),e.partOf=this,X0(this),this};mt.prototype.remove=function(e){if(!(e instanceof Z0))throw TypeError("field must be a Field");var t=this.fieldsArray.indexOf(e);if(t<0)throw Error(e+" is not a member of "+this);return this.fieldsArray.splice(t,1),t=this.oneof.indexOf(e.name),t>-1&&this.oneof.splice(t,1),e.partOf=null,this};mt.prototype.onAdd=function(e){cl.prototype.onAdd.call(this,e);for(var t=this,r=0;r<this.oneof.length;++r){var i=e.get(this.oneof[r]);i&&!i.partOf&&(i.partOf=t,t.fieldsArray.push(i))}X0(this)};mt.prototype.onRemove=function(e){for(var t=0,r;t<this.fieldsArray.length;++t)(r=this.fieldsArray[t]).parent&&r.parent.remove(r);cl.prototype.onRemove.call(this,e)};Object.defineProperty(mt.prototype,"isProto3Optional",{get:function(){if(this.fieldsArray==null||this.fieldsArray.length!==1)return!1;var n=this.fieldsArray[0];return n.options!=null&&n.options.proto3_optional===!0}});mt.d=function(){for(var e=new Array(arguments.length),t=0;t<arguments.length;)e[t]=arguments[t++];return function(i,s){ll.decorateType(i.constructor).add(new mt(s,e)),Object.defineProperty(i,s,{get:ll.oneOfGetter(e),set:ll.oneOfSetter(e)})}}});var er=R((V6,tb)=>{"use strict";tb.exports=Ge;Ge.className="ReflectionObject";var $x=Lr(),la=Le(),ul,jx={enum_type:"OPEN",field_presence:"EXPLICIT",json_format:"ALLOW",message_encoding:"LENGTH_PREFIXED",repeated_field_encoding:"PACKED",utf8_validation:"VERIFY"},Kx={enum_type:"CLOSED",field_presence:"EXPLICIT",json_format:"LEGACY_BEST_EFFORT",message_encoding:"LENGTH_PREFIXED",repeated_field_encoding:"EXPANDED",utf8_validation:"NONE"},Hx={enum_type:"OPEN",field_presence:"IMPLICIT",json_format:"ALLOW",message_encoding:"LENGTH_PREFIXED",repeated_field_encoding:"PACKED",utf8_validation:"VERIFY"};function Ge(n,e){if(!la.isString(n))throw TypeError("name must be a string");if(e&&!la.isObject(e))throw TypeError("options must be an object");this.options=e,this.parsedOptions=null,this.name=n,this._edition=null,this._defaultEdition="proto2",this._features={},this._featuresResolved=!1,this.parent=null,this.resolved=!1,this.comment=null,this.filename=null}Object.defineProperties(Ge.prototype,{root:{get:function(){for(var n=this;n.parent!==null;)n=n.parent;return n}},fullName:{get:function(){for(var n=[this.name],e=this.parent;e;)n.unshift(e.name),e=e.parent;return n.join(".")}}});Ge.prototype.toJSON=function(){throw Error()};Ge.prototype.onAdd=function(e){this.parent&&this.parent!==e&&this.parent.remove(this),this.parent=e,this.resolved=!1;var t=e.root;t instanceof ul&&t._handleAdd(this)};Ge.prototype.onRemove=function(e){var t=e.root;t instanceof ul&&t._handleRemove(this),this.parent=null,this.resolved=!1};Ge.prototype.resolve=function(){return this.resolved?this:(this.root instanceof ul&&(this.resolved=!0),this)};Ge.prototype._resolveFeaturesRecursive=function(e){return this._resolveFeatures(this._edition||e)};Ge.prototype._resolveFeatures=function(e){if(!this._featuresResolved){var t={};if(!e)throw new Error("Unknown edition for "+this.fullName);var r=Object.assign(this.options?Object.assign({},this.options.features):{},this._inferLegacyProtoFeatures(e));if(this._edition){if(e==="proto2")t=Object.assign({},Kx);else if(e==="proto3")t=Object.assign({},Hx);else if(e==="2023")t=Object.assign({},jx);else throw new Error("Unknown edition: "+e);this._features=Object.assign(t,r||{}),this._featuresResolved=!0;return}if(this.partOf instanceof $x){var i=Object.assign({},this.partOf._features);this._features=Object.assign(i,r||{})}else if(!this.declaringField)if(this.parent){var s=Object.assign({},this.parent._features);this._features=Object.assign(s,r||{})}else throw new Error("Unable to find a parent for "+this.fullName);this.extensionField&&(this.extensionField._features=this._features),this._featuresResolved=!0}};Ge.prototype._inferLegacyProtoFeatures=function(){return{}};Ge.prototype.getOption=function(e){if(this.options)return this.options[e]};Ge.prototype.setOption=function(e,t,r){return this.options||(this.options={}),/^features\./.test(e)?la.setProperty(this.options,e,t,r):(!r||this.options[e]===void 0)&&(this.getOption(e)!==t&&(this.resolved=!1),this.options[e]=t),this};Ge.prototype.setParsedOption=function(e,t,r){this.parsedOptions||(this.parsedOptions=[]);var i=this.parsedOptions;if(r){var s=i.find(function(l){return Object.prototype.hasOwnProperty.call(l,e)});if(s){var a=s[e];la.setProperty(a,r,t)}else s={},s[e]=la.setProperty({},r,t),i.push(s)}else{var o={};o[e]=t,i.push(o)}return this};Ge.prototype.setOptions=function(e,t){if(e)for(var r=Object.keys(e),i=0;i<r.length;++i)this.setOption(r[i],e[r[i]],t);return this};Ge.prototype.toString=function(){var e=this.constructor.className,t=this.fullName;return t.length?e+" "+t:e};Ge.prototype._editionToJSON=function(){if(!(!this._edition||this._edition==="proto3"))return this._edition};Ge._configure=function(n){ul=n}});var Pt=R((z6,rb)=>{"use strict";rb.exports=Lt;var Uh=er();((Lt.prototype=Object.create(Uh.prototype)).constructor=Lt).className="Enum";var nb=Ai(),dl=Le();function Lt(n,e,t,r,i,s){if(Uh.call(this,n,t),e&&typeof e!="object")throw TypeError("values must be an object");if(this.valuesById={},this.values=Object.create(this.valuesById),this.comment=r,this.comments=i||{},this.valuesOptions=s,this._valuesFeatures={},this.reserved=void 0,e)for(var a=Object.keys(e),o=0;o<a.length;++o)typeof e[a[o]]=="number"&&(this.valuesById[this.values[a[o]]=e[a[o]]]=a[o])}Lt.prototype._resolveFeatures=function(e){return e=this._edition||e,Uh.prototype._resolveFeatures.call(this,e),Object.keys(this.values).forEach(t=>{var r=Object.assign({},this._features);this._valuesFeatures[t]=Object.assign(r,this.valuesOptions&&this.valuesOptions[t]&&this.valuesOptions[t].features)}),this};Lt.fromJSON=function(e,t){var r=new Lt(e,t.values,t.options,t.comment,t.comments);return r.reserved=t.reserved,t.edition&&(r._edition=t.edition),r._defaultEdition="proto3",r};Lt.prototype.toJSON=function(e){var t=e?!!e.keepComments:!1;return dl.toObject(["edition",this._editionToJSON(),"options",this.options,"valuesOptions",this.valuesOptions,"values",this.values,"reserved",this.reserved&&this.reserved.length?this.reserved:void 0,"comment",t?this.comment:void 0,"comments",t?this.comments:void 0])};Lt.prototype.add=function(e,t,r,i){if(!dl.isString(e))throw TypeError("name must be a string");if(!dl.isInteger(t))throw TypeError("id must be an integer");if(this.values[e]!==void 0)throw Error("duplicate name '"+e+"' in "+this);if(this.isReservedId(t))throw Error("id "+t+" is reserved in "+this);if(this.isReservedName(e))throw Error("name '"+e+"' is reserved in "+this);if(this.valuesById[t]!==void 0){if(!(this.options&&this.options.allow_alias))throw Error("duplicate id "+t+" in "+this);this.values[e]=t}else this.valuesById[this.values[e]=t]=e;return i&&(this.valuesOptions===void 0&&(this.valuesOptions={}),this.valuesOptions[e]=i||null),this.comments[e]=r||null,this};Lt.prototype.remove=function(e){if(!dl.isString(e))throw TypeError("name must be a string");var t=this.values[e];if(t==null)throw Error("name '"+e+"' does not exist in "+this);return delete this.valuesById[t],delete this.values[e],delete this.comments[e],this.valuesOptions&&delete this.valuesOptions[e],this};Lt.prototype.isReservedId=function(e){return nb.isReservedId(this.reserved,e)};Lt.prototype.isReservedName=function(e){return nb.isReservedName(this.reserved,e)}});var Oh=R((G6,sb)=>{"use strict";sb.exports=Qx;var Wx=Pt(),qh=Fr(),Vh=Le();function ib(n,e,t,r){return e.delimited?n("types[%i].encode(%s,w.uint32(%i)).uint32(%i)",t,r,(e.id<<3|3)>>>0,(e.id<<3|4)>>>0):n("types[%i].encode(%s,w.uint32(%i).fork()).ldelim()",t,r,(e.id<<3|2)>>>0)}function Qx(n){for(var e=Vh.codegen(["m","w"],n.name+"$encode")("if(!w)")("w=Writer.create()"),t,r,i=n.fieldsArray.slice().sort(Vh.compareFieldsById),t=0;t<i.length;++t){var s=i[t].resolve(),a=n._fieldsArray.indexOf(s),o=s.resolvedType instanceof Wx?"int32":s.type,l=qh.basic[o];r="m"+Vh.safeProp(s.name),s.map?(e("if(%s!=null&&Object.hasOwnProperty.call(m,%j)){",r,s.name)("for(var ks=Object.keys(%s),i=0;i<ks.length;++i){",r)("w.uint32(%i).fork().uint32(%i).%s(ks[i])",(s.id<<3|2)>>>0,8|qh.mapKey[s.keyType],s.keyType),l===void 0?e("types[%i].encode(%s[ks[i]],w.uint32(18).fork()).ldelim().ldelim()",a,r):e(".uint32(%i).%s(%s[ks[i]]).ldelim()",16|l,o,r),e("}")("}")):s.repeated?(e("if(%s!=null&&%s.length){",r,r),s.packed&&qh.packed[o]!==void 0?e("w.uint32(%i).fork()",(s.id<<3|2)>>>0)("for(var i=0;i<%s.length;++i)",r)("w.%s(%s[i])",o,r)("w.ldelim()"):(e("for(var i=0;i<%s.length;++i)",r),l===void 0?ib(e,s,a,r+"[i]"):e("w.uint32(%i).%s(%s[i])",(s.id<<3|l)>>>0,o,r)),e("}")):(s.optional&&e("if(%s!=null&&Object.hasOwnProperty.call(m,%j))",r,s.name),l===void 0?ib(e,s,a,r):e("w.uint32(%i).%s(%s)",(s.id<<3|l)>>>0,o,r))}return e("return w")}});var ob=R(($6,ab)=>{"use strict";var ne=ab.exports=b0();ne.build="light";function Yx(n,e,t){return typeof e=="function"?(t=e,e=new ne.Root):e||(e=new ne.Root),e.load(n,t)}ne.load=Yx;function Jx(n,e){return e||(e=new ne.Root),e.loadSync(n)}ne.loadSync=Jx;ne.encoder=Oh();ne.decoder=Sh();ne.verifier=Th();ne.converter=Ah();ne.ReflectionObject=er();ne.Namespace=Ai();ne.Root=ol();ne.Enum=Pt();ne.Type=rl();ne.Field=Xn();ne.OneOf=Lr();ne.MapField=Jo();ne.Service=Xo();ne.Method=Zo();ne.Message=el();ne.wrappers=Rh();ne.types=Fr();ne.util=Le();ne.ReflectionObject._configure(ne.Root);ne.Namespace._configure(ne.Type,ne.Service,ne.Enum);ne.Root._configure(ne.Type);ne.Field._configure(ne.Type)});var Gh=R((j6,ub)=>{"use strict";ub.exports=cb;var zh=/[\s{}=;:[\],'"()<>]/g,Zx=/(?:"([^"\\]*(?:\\.[^"\\]*)*)")/g,Xx=/(?:'([^'\\]*(?:\\.[^'\\]*)*)')/g,eN=/^ *[*/]+ */,tN=/^\s*\*?\/*/,nN=/\n/g,rN=/\s/,iN=/\\(.?)/g,sN={0:"\0",r:"\r",n:`
`,t:"	"};function lb(n){return n.replace(iN,function(e,t){switch(t){case"\\":case"":return t;default:return sN[t]||""}})}cb.unescape=lb;function cb(n,e){n=n.toString();var t=0,r=n.length,i=1,s=0,a={},o=[],l=null;function c(S){return Error("illegal "+S+" (line "+i+")")}function u(){var S=l==="'"?Xx:Zx;S.lastIndex=t-1;var P=S.exec(n);if(!P)throw c("string");return t=S.lastIndex,T(l),l=null,lb(P[1])}function m(S){return n.charAt(S)}function d(S,P,L){var v={type:n.charAt(S++),lineEmpty:!1,leading:L},y;e?y=2:y=3;var _=S-y,b;do if(--_<0||(b=n.charAt(_))===`
`){v.lineEmpty=!0;break}while(b===" "||b==="	");for(var f=n.substring(S,P).split(nN),w=0;w<f.length;++w)f[w]=f[w].replace(e?tN:eN,"").trim();v.text=f.join(`
`).trim(),a[i]=v,s=i}function p(S){var P=E(S),L=n.substring(S,P),v=/^\s*\/\//.test(L);return v}function E(S){for(var P=S;P<r&&m(P)!==`
`;)P++;return P}function C(){if(o.length>0)return o.shift();if(l)return u();var S,P,L,v,y,_=t===0;do{if(t===r)return null;for(S=!1;rN.test(L=m(t));)if(L===`
`&&(_=!0,++i),++t===r)return null;if(m(t)==="/"){if(++t===r)throw c("comment");if(m(t)==="/")if(e){if(v=t,y=!1,p(t-1)){y=!0;do if(t=E(t),t===r||(t++,!_))break;while(p(t))}else t=Math.min(r,E(t)+1);y&&(d(v,t,_),_=!0),i++,S=!0}else{for(y=m(v=t+1)==="/";m(++t)!==`
`;)if(t===r)return null;++t,y&&(d(v,t-1,_),_=!0),++i,S=!0}else if((L=m(t))==="*"){v=t+1,y=e||m(v)==="*";do{if(L===`
`&&++i,++t===r)throw c("comment");P=L,L=m(t)}while(P!=="*"||L!=="/");++t,y&&(d(v,t-2,_),_=!0),S=!0}else return"/"}}while(S);var b=t;zh.lastIndex=0;var f=zh.test(m(b++));if(!f)for(;b<r&&!zh.test(m(b));)++b;var w=n.substring(t,t=b);return(w==='"'||w==="'")&&(l=w),w}function T(S){o.push(S)}function I(){if(!o.length){var S=C();if(S===null)return null;T(S)}return o[0]}function N(S,P){var L=I(),v=L===S;if(v)return C(),!0;if(!P)throw c("token '"+L+"', '"+S+"' expected");return!1}function A(S){var P=null,L;return S===void 0?(L=a[i-1],delete a[i-1],L&&(e||L.type==="*"||L.lineEmpty)&&(P=L.leading?L.text:null)):(s<S&&I(),L=a[S],delete a[S],L&&!L.lineEmpty&&(e||L.type==="/")&&(P=L.leading?null:L.text)),P}return Object.defineProperty({next:C,peek:I,push:T,skip:N,cmnt:A},"line",{get:function(){return i}})}});var gb=R((K6,mb)=>{"use strict";mb.exports=An;An.filename=null;An.defaults={keepCase:!1};var aN=Gh(),db=ol(),hb=rl(),fb=Xn(),oN=Jo(),pb=Lr(),lN=Pt(),cN=Xo(),uN=Zo(),dN=er(),hN=Fr(),$h=Le(),fN=/^[1-9][0-9]*$/,pN=/^-?[1-9][0-9]*$/,mN=/^0[x][0-9a-fA-F]+$/,gN=/^-?0[x][0-9a-fA-F]+$/,yN=/^0[0-7]+$/,_N=/^-?0[0-7]+$/,vN=/^(?![eE])[0-9]*(?:\.[0-9]*)?(?:[eE][+-]?[0-9]+)?$/,nn=/^[a-zA-Z_][a-zA-Z_0-9]*$/,rn=/^(?:\.?[a-zA-Z_][a-zA-Z_0-9]*)(?:\.[a-zA-Z_][a-zA-Z_0-9]*)*$/;function An(n,e,t){e instanceof db||(t=e,e=new db),t||(t=An.defaults);var r=t.preferTrailingComment||!1,i=aN(n,t.alternateCommentMode||!1),s=i.next,a=i.push,o=i.peek,l=i.skip,c=i.cmnt,u=!0,m,d,p,E="proto2",C=e,T=[],I={},N=t.keepCase?function(x){return x}:$h.camelCase;function A(){T.forEach(x=>{x._edition=E,Object.keys(I).forEach(D=>{x.getOption(D)===void 0&&x.setOption(D,I[D],!0)})})}function S(x,D,M){var q=An.filename;return M||(An.filename=null),Error("illegal "+(D||"token")+" '"+x+"' ("+(q?q+", ":"")+"line "+i.line+")")}function P(){var x=[],D;do{if((D=s())!=='"'&&D!=="'")throw S(D);x.push(s()),l(D),D=o()}while(D==='"'||D==="'");return x.join("")}function L(x){var D=s();switch(D){case"'":case'"':return a(D),P();case"true":case"TRUE":return!0;case"false":case"FALSE":return!1}try{return y(D,!0)}catch{if(x&&rn.test(D))return D;throw S(D,"value")}}function v(x,D){var M,q;do if(D&&((M=o())==='"'||M==="'")){var U=P();if(x.push(U),E>=2023)throw S(U,"id")}else try{x.push([q=_(s()),l("to",!0)?_(s()):q])}catch(pe){if(D&&rn.test(M)&&E>=2023)x.push(M);else throw pe}while(l(",",!0));var H={options:void 0};H.setOption=function(pe,je){this.options===void 0&&(this.options={}),this.options[pe]=je},k(H,function(je){if(je==="option")ae(H,je),l(";");else throw S(je)},function(){mn(H)})}function y(x,D){var M=1;switch(x.charAt(0)==="-"&&(M=-1,x=x.substring(1)),x){case"inf":case"INF":case"Inf":return M*(1/0);case"nan":case"NAN":case"Nan":case"NaN":return NaN;case"0":return 0}if(fN.test(x))return M*parseInt(x,10);if(mN.test(x))return M*parseInt(x,16);if(yN.test(x))return M*parseInt(x,8);if(vN.test(x))return M*parseFloat(x);throw S(x,"number",D)}function _(x,D){switch(x){case"max":case"MAX":case"Max":return 536870911;case"0":return 0}if(!D&&x.charAt(0)==="-")throw S(x,"id");if(pN.test(x))return parseInt(x,10);if(gN.test(x))return parseInt(x,16);if(_N.test(x))return parseInt(x,8);throw S(x,"id")}function b(){if(m!==void 0)throw S("package");if(m=s(),!rn.test(m))throw S(m,"name");C=C.define(m),l(";")}function f(){var x=o(),D;switch(x){case"weak":D=p||(p=[]),s();break;case"public":s();default:D=d||(d=[]);break}x=P(),l(";"),D.push(x)}function w(){if(l("="),E=P(),E<2023)throw S(E,"syntax");l(";")}function h(){if(l("="),E=P(),!["2023"].includes(E))throw S(E,"edition");l(";")}function g(x,D){switch(D){case"option":return ae(x,D),l(";"),!0;case"message":return J(x,D),!0;case"enum":return Je(x,D),!0;case"service":return pT(x,D),!0;case"extend":return gT(x,D),!0}return!1}function k(x,D,M){var q=i.line;if(x&&(typeof x.comment!="string"&&(x.comment=c()),x.filename=An.filename),l("{",!0)){for(var U;(U=s())!=="}";)D(U);l(";",!0)}else M&&M(),l(";"),x&&(typeof x.comment!="string"||r)&&(x.comment=c(q)||x.comment)}function J(x,D){if(!nn.test(D=s()))throw S(D,"type name");var M=new hb(D);k(M,function(U){if(!g(M,U))switch(U){case"map":Se(M,U);break;case"required":if(E!=="proto2")throw S(U);case"repeated":Y(M,U);break;case"optional":if(E==="proto3")Y(M,"proto3_optional");else{if(E!=="proto2")throw S(U);Y(M,"optional")}break;case"oneof":$e(M,U);break;case"extensions":v(M.extensions||(M.extensions=[]));break;case"reserved":v(M.reserved||(M.reserved=[]),!0);break;default:if(E==="proto2"||!rn.test(U))throw S(U);a(U),Y(M,"optional");break}}),x.add(M),x===C&&T.push(M)}function Y(x,D,M){var q=s();if(q==="group"){ue(x,D);return}for(;q.endsWith(".")||o().startsWith(".");)q+=s();if(!rn.test(q))throw S(q,"type");var U=s();if(!nn.test(U))throw S(U,"name");U=N(U),l("=");var H=new fb(U,_(s()),q,D,M);if(k(H,function(et){if(et==="option")ae(H,et),l(";");else throw S(et)},function(){mn(H)}),D==="proto3_optional"){var pe=new pb("_"+U);H.setOption("proto3_optional",!0),pe.add(H),x.add(pe)}else x.add(H);x===C&&T.push(H)}function ue(x,D){if(E>=2023)throw S("group");var M=s();if(!nn.test(M))throw S(M,"name");var q=$h.lcFirst(M);M===q&&(M=$h.ucFirst(M)),l("=");var U=_(s()),H=new hb(M);H.group=!0;var pe=new fb(q,U,M,D);pe.filename=An.filename,k(H,function(et){switch(et){case"option":ae(H,et),l(";");break;case"required":case"repeated":Y(H,et);break;case"optional":E==="proto3"?Y(H,"proto3_optional"):Y(H,"optional");break;case"message":J(H,et);break;case"enum":Je(H,et);break;case"reserved":v(H.reserved||(H.reserved=[]),!0);break;default:throw S(et)}}),x.add(H).add(pe)}function Se(x){l("<");var D=s();if(hN.mapKey[D]===void 0)throw S(D,"type");l(",");var M=s();if(!rn.test(M))throw S(M,"type");l(">");var q=s();if(!nn.test(q))throw S(q,"name");l("=");var U=new oN(N(q),_(s()),D,M);k(U,function(pe){if(pe==="option")ae(U,pe),l(";");else throw S(pe)},function(){mn(U)}),x.add(U)}function $e(x,D){if(!nn.test(D=s()))throw S(D,"name");var M=new pb(N(D));k(M,function(U){U==="option"?(ae(M,U),l(";")):(a(U),Y(M,"optional"))}),x.add(M)}function Je(x,D){if(!nn.test(D=s()))throw S(D,"name");var M=new lN(D);k(M,function(U){switch(U){case"option":ae(M,U),l(";");break;case"reserved":v(M.reserved||(M.reserved=[]),!0),M.reserved===void 0&&(M.reserved=[]);break;default:ke(M,U)}}),x.add(M),x===C&&T.push(M)}function ke(x,D){if(!nn.test(D))throw S(D,"name");l("=");var M=_(s(),!0),q={options:void 0};q.getOption=function(U){return this.options[U]},q.setOption=function(U,H){dN.prototype.setOption.call(q,U,H)},q.setParsedOption=function(){},k(q,function(H){if(H==="option")ae(q,H),l(";");else throw S(H)},function(){mn(q)}),x.add(D,M,q.comment,q.parsedOptions||q.options)}function ae(x,D){var M,q,U=!0;for(D==="option"&&(D=s());D!=="=";){if(D==="("){var H=s();l(")"),D="("+H+")"}if(U){if(U=!1,D.includes(".")&&!D.includes("(")){var pe=D.split(".");M=pe[0]+".",D=pe[1];continue}M=D}else q=q?q+=D:D;D=s()}var je=q?M.concat(q):M,et=Ze(x,je);q=q&&q[0]==="."?q.slice(1):q,M=M&&M[M.length-1]==="."?M.slice(0,-1):M,Xe(x,M,et,q)}function Ze(x,D){if(l("{",!0)){for(var M={};!l("}",!0);){if(!nn.test(Ve=s()))throw S(Ve,"name");if(Ve===null)throw S(Ve,"end of input");var q,U=Ve;if(l(":",!0),o()==="{")q=Ze(x,D+"."+Ve);else if(o()==="["){q=[];var H;if(l("[",!0)){do H=L(!0),q.push(H);while(l(",",!0));l("]"),typeof H<"u"&&ve(x,D+"."+Ve,H)}}else q=L(!0),ve(x,D+"."+Ve,q);var pe=M[U];pe&&(q=[].concat(pe).concat(q)),M[U]=q,l(",",!0),l(";",!0)}return M}var je=L(!0);return ve(x,D,je),je}function ve(x,D,M){if(C===x&&/^features\./.test(D)){I[D]=M;return}x.setOption&&x.setOption(D,M)}function Xe(x,D,M,q){x.setParsedOption&&x.setParsedOption(D,M,q)}function mn(x){if(l("[",!0)){do ae(x,"option");while(l(",",!0));l("]")}return x}function pT(x,D){if(!nn.test(D=s()))throw S(D,"service name");var M=new cN(D);k(M,function(U){if(!g(M,U))if(U==="rpc")mT(M,U);else throw S(U)}),x.add(M),x===C&&T.push(M)}function mT(x,D){var M=c(),q=D;if(!nn.test(D=s()))throw S(D,"name");var U=D,H,pe,je,et;if(l("("),l("stream",!0)&&(pe=!0),!rn.test(D=s())||(H=D,l(")"),l("returns"),l("("),l("stream",!0)&&(et=!0),!rn.test(D=s())))throw S(D);je=D,l(")");var to=new uN(U,q,H,je,pe,et);to.comment=M,k(to,function(ru){if(ru==="option")ae(to,ru),l(";");else throw S(ru)}),x.add(to)}function gT(x,D){if(!rn.test(D=s()))throw S(D,"reference");var M=D;k(null,function(U){switch(U){case"required":case"repeated":Y(x,U,M);break;case"optional":E==="proto3"?Y(x,"proto3_optional",M):Y(x,"optional",M);break;default:if(E==="proto2"||!rn.test(U))throw S(U);a(U),Y(x,"optional",M);break}})}for(var Ve;(Ve=s())!==null;)switch(Ve){case"package":if(!u)throw S(Ve);b();break;case"import":if(!u)throw S(Ve);f();break;case"syntax":if(!u)throw S(Ve);w();break;case"edition":if(!u)throw S(Ve);h();break;case"option":ae(C,Ve),l(";",!0);break;default:if(g(C,Ve)){u=!1;continue}throw S(Ve)}return A(),An.filename=null,{package:m,imports:d,weakImports:p,root:e}}});var vb=R((H6,_b)=>{"use strict";_b.exports=Ft;var bN=/\/|\./;function Ft(n,e){bN.test(n)||(n="google/protobuf/"+n+".proto",e={nested:{google:{nested:{protobuf:{nested:e}}}}}),Ft[n]=e}Ft("any",{Any:{fields:{type_url:{type:"string",id:1},value:{type:"bytes",id:2}}}});var yb;Ft("duration",{Duration:yb={fields:{seconds:{type:"int64",id:1},nanos:{type:"int32",id:2}}}});Ft("timestamp",{Timestamp:yb});Ft("empty",{Empty:{fields:{}}});Ft("struct",{Struct:{fields:{fields:{keyType:"string",type:"Value",id:1}}},Value:{oneofs:{kind:{oneof:["nullValue","numberValue","stringValue","boolValue","structValue","listValue"]}},fields:{nullValue:{type:"NullValue",id:1},numberValue:{type:"double",id:2},stringValue:{type:"string",id:3},boolValue:{type:"bool",id:4},structValue:{type:"Struct",id:5},listValue:{type:"ListValue",id:6}}},NullValue:{values:{NULL_VALUE:0}},ListValue:{fields:{values:{rule:"repeated",type:"Value",id:1}}}});Ft("wrappers",{DoubleValue:{fields:{value:{type:"double",id:1}}},FloatValue:{fields:{value:{type:"float",id:1}}},Int64Value:{fields:{value:{type:"int64",id:1}}},UInt64Value:{fields:{value:{type:"uint64",id:1}}},Int32Value:{fields:{value:{type:"int32",id:1}}},UInt32Value:{fields:{value:{type:"uint32",id:1}}},BoolValue:{fields:{value:{type:"bool",id:1}}},StringValue:{fields:{value:{type:"string",id:1}}},BytesValue:{fields:{value:{type:"bytes",id:1}}}});Ft("field_mask",{FieldMask:{fields:{paths:{rule:"repeated",type:"string",id:1}}}});Ft.get=function(e){return Ft[e]||null}});var Sb=R((W6,bb)=>{"use strict";var nr=bb.exports=ob();nr.build="full";nr.tokenize=Gh();nr.parse=gb();nr.common=vb();nr.Root._configure(nr.Type,nr.parse,nr.common)});var hl=R((Q6,Eb)=>{"use strict";Eb.exports=Sb()});var jh=R((Y6,SN)=>{SN.exports={nested:{google:{nested:{protobuf:{options:{go_package:"google.golang.org/protobuf/types/descriptorpb",java_package:"com.google.protobuf",java_outer_classname:"DescriptorProtos",csharp_namespace:"Google.Protobuf.Reflection",objc_class_prefix:"GPB",cc_enable_arenas:!0,optimize_for:"SPEED"},nested:{FileDescriptorSet:{edition:"proto2",fields:{file:{rule:"repeated",type:"FileDescriptorProto",id:1}},extensions:[[536e6,536e6]]},Edition:{edition:"proto2",values:{EDITION_UNKNOWN:0,EDITION_LEGACY:900,EDITION_PROTO2:998,EDITION_PROTO3:999,EDITION_2023:1e3,EDITION_2024:1001,EDITION_1_TEST_ONLY:1,EDITION_2_TEST_ONLY:2,EDITION_99997_TEST_ONLY:99997,EDITION_99998_TEST_ONLY:99998,EDITION_99999_TEST_ONLY:99999,EDITION_MAX:2147483647}},FileDescriptorProto:{edition:"proto2",fields:{name:{type:"string",id:1},package:{type:"string",id:2},dependency:{rule:"repeated",type:"string",id:3},publicDependency:{rule:"repeated",type:"int32",id:10},weakDependency:{rule:"repeated",type:"int32",id:11},optionDependency:{rule:"repeated",type:"string",id:15},messageType:{rule:"repeated",type:"DescriptorProto",id:4},enumType:{rule:"repeated",type:"EnumDescriptorProto",id:5},service:{rule:"repeated",type:"ServiceDescriptorProto",id:6},extension:{rule:"repeated",type:"FieldDescriptorProto",id:7},options:{type:"FileOptions",id:8},sourceCodeInfo:{type:"SourceCodeInfo",id:9},syntax:{type:"string",id:12},edition:{type:"Edition",id:14}}},DescriptorProto:{edition:"proto2",fields:{name:{type:"string",id:1},field:{rule:"repeated",type:"FieldDescriptorProto",id:2},extension:{rule:"repeated",type:"FieldDescriptorProto",id:6},nestedType:{rule:"repeated",type:"DescriptorProto",id:3},enumType:{rule:"repeated",type:"EnumDescriptorProto",id:4},extensionRange:{rule:"repeated",type:"ExtensionRange",id:5},oneofDecl:{rule:"repeated",type:"OneofDescriptorProto",id:8},options:{type:"MessageOptions",id:7},reservedRange:{rule:"repeated",type:"ReservedRange",id:9},reservedName:{rule:"repeated",type:"string",id:10},visibility:{type:"SymbolVisibility",id:11}},nested:{ExtensionRange:{fields:{start:{type:"int32",id:1},end:{type:"int32",id:2},options:{type:"ExtensionRangeOptions",id:3}}},ReservedRange:{fields:{start:{type:"int32",id:1},end:{type:"int32",id:2}}}}},ExtensionRangeOptions:{edition:"proto2",fields:{uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999},declaration:{rule:"repeated",type:"Declaration",id:2,options:{retention:"RETENTION_SOURCE"}},features:{type:"FeatureSet",id:50},verification:{type:"VerificationState",id:3,options:{default:"UNVERIFIED",retention:"RETENTION_SOURCE"}}},extensions:[[1e3,536870911]],nested:{Declaration:{fields:{number:{type:"int32",id:1},fullName:{type:"string",id:2},type:{type:"string",id:3},reserved:{type:"bool",id:5},repeated:{type:"bool",id:6}},reserved:[[4,4]]},VerificationState:{values:{DECLARATION:0,UNVERIFIED:1}}}},FieldDescriptorProto:{edition:"proto2",fields:{name:{type:"string",id:1},number:{type:"int32",id:3},label:{type:"Label",id:4},type:{type:"Type",id:5},typeName:{type:"string",id:6},extendee:{type:"string",id:2},defaultValue:{type:"string",id:7},oneofIndex:{type:"int32",id:9},jsonName:{type:"string",id:10},options:{type:"FieldOptions",id:8},proto3Optional:{type:"bool",id:17}},nested:{Type:{values:{TYPE_DOUBLE:1,TYPE_FLOAT:2,TYPE_INT64:3,TYPE_UINT64:4,TYPE_INT32:5,TYPE_FIXED64:6,TYPE_FIXED32:7,TYPE_BOOL:8,TYPE_STRING:9,TYPE_GROUP:10,TYPE_MESSAGE:11,TYPE_BYTES:12,TYPE_UINT32:13,TYPE_ENUM:14,TYPE_SFIXED32:15,TYPE_SFIXED64:16,TYPE_SINT32:17,TYPE_SINT64:18}},Label:{values:{LABEL_OPTIONAL:1,LABEL_REPEATED:3,LABEL_REQUIRED:2}}}},OneofDescriptorProto:{edition:"proto2",fields:{name:{type:"string",id:1},options:{type:"OneofOptions",id:2}}},EnumDescriptorProto:{edition:"proto2",fields:{name:{type:"string",id:1},value:{rule:"repeated",type:"EnumValueDescriptorProto",id:2},options:{type:"EnumOptions",id:3},reservedRange:{rule:"repeated",type:"EnumReservedRange",id:4},reservedName:{rule:"repeated",type:"string",id:5},visibility:{type:"SymbolVisibility",id:6}},nested:{EnumReservedRange:{fields:{start:{type:"int32",id:1},end:{type:"int32",id:2}}}}},EnumValueDescriptorProto:{edition:"proto2",fields:{name:{type:"string",id:1},number:{type:"int32",id:2},options:{type:"EnumValueOptions",id:3}}},ServiceDescriptorProto:{edition:"proto2",fields:{name:{type:"string",id:1},method:{rule:"repeated",type:"MethodDescriptorProto",id:2},options:{type:"ServiceOptions",id:3}}},MethodDescriptorProto:{edition:"proto2",fields:{name:{type:"string",id:1},inputType:{type:"string",id:2},outputType:{type:"string",id:3},options:{type:"MethodOptions",id:4},clientStreaming:{type:"bool",id:5},serverStreaming:{type:"bool",id:6}}},FileOptions:{edition:"proto2",fields:{javaPackage:{type:"string",id:1},javaOuterClassname:{type:"string",id:8},javaMultipleFiles:{type:"bool",id:10},javaGenerateEqualsAndHash:{type:"bool",id:20,options:{deprecated:!0}},javaStringCheckUtf8:{type:"bool",id:27},optimizeFor:{type:"OptimizeMode",id:9,options:{default:"SPEED"}},goPackage:{type:"string",id:11},ccGenericServices:{type:"bool",id:16},javaGenericServices:{type:"bool",id:17},pyGenericServices:{type:"bool",id:18},deprecated:{type:"bool",id:23},ccEnableArenas:{type:"bool",id:31,options:{default:!0}},objcClassPrefix:{type:"string",id:36},csharpNamespace:{type:"string",id:37},swiftPrefix:{type:"string",id:39},phpClassPrefix:{type:"string",id:40},phpNamespace:{type:"string",id:41},phpMetadataNamespace:{type:"string",id:44},rubyPackage:{type:"string",id:45},features:{type:"FeatureSet",id:50},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]],reserved:[[42,42],[38,38],"php_generic_services"],nested:{OptimizeMode:{values:{SPEED:1,CODE_SIZE:2,LITE_RUNTIME:3}}}},MessageOptions:{edition:"proto2",fields:{messageSetWireFormat:{type:"bool",id:1},noStandardDescriptorAccessor:{type:"bool",id:2},deprecated:{type:"bool",id:3},mapEntry:{type:"bool",id:7},deprecatedLegacyJsonFieldConflicts:{type:"bool",id:11,options:{deprecated:!0}},features:{type:"FeatureSet",id:12},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]],reserved:[[4,4],[5,5],[6,6],[8,8],[9,9]]},FieldOptions:{edition:"proto2",fields:{ctype:{type:"CType",id:1,options:{default:"STRING"}},packed:{type:"bool",id:2},jstype:{type:"JSType",id:6,options:{default:"JS_NORMAL"}},lazy:{type:"bool",id:5},unverifiedLazy:{type:"bool",id:15},deprecated:{type:"bool",id:3},weak:{type:"bool",id:10,options:{deprecated:!0}},debugRedact:{type:"bool",id:16},retention:{type:"OptionRetention",id:17},targets:{rule:"repeated",type:"OptionTargetType",id:19},editionDefaults:{rule:"repeated",type:"EditionDefault",id:20},features:{type:"FeatureSet",id:21},featureSupport:{type:"FeatureSupport",id:22},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]],reserved:[[4,4],[18,18]],nested:{CType:{values:{STRING:0,CORD:1,STRING_PIECE:2}},JSType:{values:{JS_NORMAL:0,JS_STRING:1,JS_NUMBER:2}},OptionRetention:{values:{RETENTION_UNKNOWN:0,RETENTION_RUNTIME:1,RETENTION_SOURCE:2}},OptionTargetType:{values:{TARGET_TYPE_UNKNOWN:0,TARGET_TYPE_FILE:1,TARGET_TYPE_EXTENSION_RANGE:2,TARGET_TYPE_MESSAGE:3,TARGET_TYPE_FIELD:4,TARGET_TYPE_ONEOF:5,TARGET_TYPE_ENUM:6,TARGET_TYPE_ENUM_ENTRY:7,TARGET_TYPE_SERVICE:8,TARGET_TYPE_METHOD:9}},EditionDefault:{fields:{edition:{type:"Edition",id:3},value:{type:"string",id:2}}},FeatureSupport:{fields:{editionIntroduced:{type:"Edition",id:1},editionDeprecated:{type:"Edition",id:2},deprecationWarning:{type:"string",id:3},editionRemoved:{type:"Edition",id:4}}}}},OneofOptions:{edition:"proto2",fields:{features:{type:"FeatureSet",id:1},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]]},EnumOptions:{edition:"proto2",fields:{allowAlias:{type:"bool",id:2},deprecated:{type:"bool",id:3},deprecatedLegacyJsonFieldConflicts:{type:"bool",id:6,options:{deprecated:!0}},features:{type:"FeatureSet",id:7},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]],reserved:[[5,5]]},EnumValueOptions:{edition:"proto2",fields:{deprecated:{type:"bool",id:1},features:{type:"FeatureSet",id:2},debugRedact:{type:"bool",id:3},featureSupport:{type:"FieldOptions.FeatureSupport",id:4},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]]},ServiceOptions:{edition:"proto2",fields:{features:{type:"FeatureSet",id:34},deprecated:{type:"bool",id:33},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]]},MethodOptions:{edition:"proto2",fields:{deprecated:{type:"bool",id:33},idempotencyLevel:{type:"IdempotencyLevel",id:34,options:{default:"IDEMPOTENCY_UNKNOWN"}},features:{type:"FeatureSet",id:35},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]],nested:{IdempotencyLevel:{values:{IDEMPOTENCY_UNKNOWN:0,NO_SIDE_EFFECTS:1,IDEMPOTENT:2}}}},UninterpretedOption:{edition:"proto2",fields:{name:{rule:"repeated",type:"NamePart",id:2},identifierValue:{type:"string",id:3},positiveIntValue:{type:"uint64",id:4},negativeIntValue:{type:"int64",id:5},doubleValue:{type:"double",id:6},stringValue:{type:"bytes",id:7},aggregateValue:{type:"string",id:8}},nested:{NamePart:{fields:{namePart:{rule:"required",type:"string",id:1},isExtension:{rule:"required",type:"bool",id:2}}}}},FeatureSet:{edition:"proto2",fields:{fieldPresence:{type:"FieldPresence",id:1,options:{retention:"RETENTION_RUNTIME",targets:"TARGET_TYPE_FILE","feature_support.edition_introduced":"EDITION_2023","edition_defaults.edition":"EDITION_2023","edition_defaults.value":"EXPLICIT"}},enumType:{type:"EnumType",id:2,options:{retention:"RETENTION_RUNTIME",targets:"TARGET_TYPE_FILE","feature_support.edition_introduced":"EDITION_2023","edition_defaults.edition":"EDITION_PROTO3","edition_defaults.value":"OPEN"}},repeatedFieldEncoding:{type:"RepeatedFieldEncoding",id:3,options:{retention:"RETENTION_RUNTIME",targets:"TARGET_TYPE_FILE","feature_support.edition_introduced":"EDITION_2023","edition_defaults.edition":"EDITION_PROTO3","edition_defaults.value":"PACKED"}},utf8Validation:{type:"Utf8Validation",id:4,options:{retention:"RETENTION_RUNTIME",targets:"TARGET_TYPE_FILE","feature_support.edition_introduced":"EDITION_2023","edition_defaults.edition":"EDITION_PROTO3","edition_defaults.value":"VERIFY"}},messageEncoding:{type:"MessageEncoding",id:5,options:{retention:"RETENTION_RUNTIME",targets:"TARGET_TYPE_FILE","feature_support.edition_introduced":"EDITION_2023","edition_defaults.edition":"EDITION_LEGACY","edition_defaults.value":"LENGTH_PREFIXED"}},jsonFormat:{type:"JsonFormat",id:6,options:{retention:"RETENTION_RUNTIME",targets:"TARGET_TYPE_FILE","feature_support.edition_introduced":"EDITION_2023","edition_defaults.edition":"EDITION_PROTO3","edition_defaults.value":"ALLOW"}},enforceNamingStyle:{type:"EnforceNamingStyle",id:7,options:{retention:"RETENTION_SOURCE",targets:"TARGET_TYPE_METHOD","feature_support.edition_introduced":"EDITION_2024","edition_defaults.edition":"EDITION_2024","edition_defaults.value":"STYLE2024"}},defaultSymbolVisibility:{type:"VisibilityFeature.DefaultSymbolVisibility",id:8,options:{retention:"RETENTION_SOURCE",targets:"TARGET_TYPE_FILE","feature_support.edition_introduced":"EDITION_2024","edition_defaults.edition":"EDITION_2024","edition_defaults.value":"EXPORT_TOP_LEVEL"}}},extensions:[[1e3,9994],[9995,9999],[1e4,1e4]],reserved:[[999,999]],nested:{FieldPresence:{values:{FIELD_PRESENCE_UNKNOWN:0,EXPLICIT:1,IMPLICIT:2,LEGACY_REQUIRED:3}},EnumType:{values:{ENUM_TYPE_UNKNOWN:0,OPEN:1,CLOSED:2}},RepeatedFieldEncoding:{values:{REPEATED_FIELD_ENCODING_UNKNOWN:0,PACKED:1,EXPANDED:2}},Utf8Validation:{values:{UTF8_VALIDATION_UNKNOWN:0,VERIFY:2,NONE:3}},MessageEncoding:{values:{MESSAGE_ENCODING_UNKNOWN:0,LENGTH_PREFIXED:1,DELIMITED:2}},JsonFormat:{values:{JSON_FORMAT_UNKNOWN:0,ALLOW:1,LEGACY_BEST_EFFORT:2}},EnforceNamingStyle:{values:{ENFORCE_NAMING_STYLE_UNKNOWN:0,STYLE2024:1,STYLE_LEGACY:2}},VisibilityFeature:{fields:{},reserved:[[1,536870911]],nested:{DefaultSymbolVisibility:{values:{DEFAULT_SYMBOL_VISIBILITY_UNKNOWN:0,EXPORT_ALL:1,EXPORT_TOP_LEVEL:2,LOCAL_ALL:3,STRICT:4}}}}}},FeatureSetDefaults:{edition:"proto2",fields:{defaults:{rule:"repeated",type:"FeatureSetEditionDefault",id:1},minimumEdition:{type:"Edition",id:4},maximumEdition:{type:"Edition",id:5}},nested:{FeatureSetEditionDefault:{fields:{edition:{type:"Edition",id:3},overridableFeatures:{type:"FeatureSet",id:4},fixedFeatures:{type:"FeatureSet",id:5}},reserved:[[1,1],[2,2],"features"]}}},SourceCodeInfo:{edition:"proto2",fields:{location:{rule:"repeated",type:"Location",id:1}},extensions:[[536e6,536e6]],nested:{Location:{fields:{path:{rule:"repeated",type:"int32",id:1,options:{packed:!0}},span:{rule:"repeated",type:"int32",id:2,options:{packed:!0}},leadingComments:{type:"string",id:3},trailingComments:{type:"string",id:4},leadingDetachedComments:{rule:"repeated",type:"string",id:6}}}}},GeneratedCodeInfo:{edition:"proto2",fields:{annotation:{rule:"repeated",type:"Annotation",id:1}},nested:{Annotation:{fields:{path:{rule:"repeated",type:"int32",id:1,options:{packed:!0}},sourceFile:{type:"string",id:2},begin:{type:"int32",id:3},end:{type:"int32",id:4},semantic:{type:"Semantic",id:5}},nested:{Semantic:{values:{NONE:0,SET:1,ALIAS:2}}}}}},SymbolVisibility:{edition:"proto2",values:{VISIBILITY_UNSET:0,VISIBILITY_LOCAL:1,VISIBILITY_EXPORT:2}}}}}}}}});var Db=R((Q,Rb)=>{"use strict";var gt=hl();Rb.exports=Q=gt.descriptor=gt.Root.fromJSON(jh()).lookup(".google.protobuf");var wb=gt.Namespace,ca=gt.Root,Rn=gt.Enum,sn=gt.Type,rr=gt.Field,EN=gt.MapField,fl=gt.OneOf,ua=gt.Service,pl=gt.Method;ca.fromDescriptor=function(e){typeof e.length=="number"&&(e=Q.FileDescriptorSet.decode(e));var t=new ca;if(e.file)for(var r,i,s=0,a;s<e.file.length;++s){i=t,(r=e.file[s]).package&&r.package.length&&(i=t.define(r.package));var o=ON(r);if(r.name&&r.name.length&&t.files.push(i.filename=r.name),r.messageType)for(a=0;a<r.messageType.length;++a)i.add(sn.fromDescriptor(r.messageType[a],o));if(r.enumType)for(a=0;a<r.enumType.length;++a)i.add(Rn.fromDescriptor(r.enumType[a],o));if(r.extension)for(a=0;a<r.extension.length;++a)i.add(rr.fromDescriptor(r.extension[a],o));if(r.service)for(a=0;a<r.service.length;++a)i.add(ua.fromDescriptor(r.service[a],o));var l=Di(r.options,Q.FileOptions);if(l){var c=Object.keys(l);for(a=0;a<c.length;++a)i.setOption(c[a],l[c[a]])}}return t.resolveAll()};ca.prototype.toDescriptor=function(e){var t=Q.FileDescriptorSet.create();return Tb(this,t.file,e),t};function Tb(n,e,t){var r=Q.FileDescriptorProto.create({name:n.filename||(n.fullName.substring(1).replace(/\./g,"_")||"root")+".proto"});kN(t,r),n instanceof ca||(r.package=n.fullName.substring(1));for(var i=0,s;i<n.nestedArray.length;++i)(s=n._nestedArray[i])instanceof sn?r.messageType.push(s.toDescriptor(t)):s instanceof Rn?r.enumType.push(s.toDescriptor()):s instanceof rr?r.extension.push(s.toDescriptor(t)):s instanceof ua?r.service.push(s.toDescriptor()):s instanceof wb&&Tb(s,e,t);r.options=xi(n.options,Q.FileOptions),r.messageType.length+r.enumType.length+r.extension.length+r.service.length&&e.push(r)}var wN=0;sn.fromDescriptor=function(e,t,r){typeof e.length=="number"&&(e=Q.DescriptorProto.decode(e));var i=new sn(e.name.length?e.name:"Type"+wN++,Di(e.options,Q.MessageOptions)),s;if(r||(i._edition=t),e.oneofDecl)for(s=0;s<e.oneofDecl.length;++s)i.add(fl.fromDescriptor(e.oneofDecl[s]));if(e.field)for(s=0;s<e.field.length;++s){var a=rr.fromDescriptor(e.field[s],t,!0);i.add(a),e.field[s].hasOwnProperty("oneofIndex")&&i.oneofsArray[e.field[s].oneofIndex].add(a)}if(e.extension)for(s=0;s<e.extension.length;++s)i.add(rr.fromDescriptor(e.extension[s],t,!0));if(e.nestedType)for(s=0;s<e.nestedType.length;++s)i.add(sn.fromDescriptor(e.nestedType[s],t,!0)),e.nestedType[s].options&&e.nestedType[s].options.mapEntry&&i.setOption("map_entry",!0);if(e.enumType)for(s=0;s<e.enumType.length;++s)i.add(Rn.fromDescriptor(e.enumType[s],t,!0));if(e.extensionRange&&e.extensionRange.length)for(i.extensions=[],s=0;s<e.extensionRange.length;++s)i.extensions.push([e.extensionRange[s].start,e.extensionRange[s].end]);if(e.reservedRange&&e.reservedRange.length||e.reservedName&&e.reservedName.length){if(i.reserved=[],e.reservedRange)for(s=0;s<e.reservedRange.length;++s)i.reserved.push([e.reservedRange[s].start,e.reservedRange[s].end]);if(e.reservedName)for(s=0;s<e.reservedName.length;++s)i.reserved.push(e.reservedName[s])}return i};sn.prototype.toDescriptor=function(e){var t=Q.DescriptorProto.create({name:this.name}),r;for(r=0;r<this.fieldsArray.length;++r){var i;if(t.field.push(i=this._fieldsArray[r].toDescriptor(e)),this._fieldsArray[r]instanceof EN){var s=Kh(this._fieldsArray[r].keyType,this._fieldsArray[r].resolvedKeyType,!1),a=Kh(this._fieldsArray[r].type,this._fieldsArray[r].resolvedType,!1),o=a===11||a===14?this._fieldsArray[r].resolvedType&&Ab(this.parent,this._fieldsArray[r].resolvedType)||this._fieldsArray[r].type:void 0;t.nestedType.push(Q.DescriptorProto.create({name:i.typeName,field:[Q.FieldDescriptorProto.create({name:"key",number:1,label:1,type:s}),Q.FieldDescriptorProto.create({name:"value",number:2,label:1,type:a,typeName:o})],options:Q.MessageOptions.create({mapEntry:!0})}))}}for(r=0;r<this.oneofsArray.length;++r)t.oneofDecl.push(this._oneofsArray[r].toDescriptor());for(r=0;r<this.nestedArray.length;++r)this._nestedArray[r]instanceof rr?t.field.push(this._nestedArray[r].toDescriptor(e)):this._nestedArray[r]instanceof sn?t.nestedType.push(this._nestedArray[r].toDescriptor(e)):this._nestedArray[r]instanceof Rn&&t.enumType.push(this._nestedArray[r].toDescriptor());if(this.extensions)for(r=0;r<this.extensions.length;++r)t.extensionRange.push(Q.DescriptorProto.ExtensionRange.create({start:this.extensions[r][0],end:this.extensions[r][1]}));if(this.reserved)for(r=0;r<this.reserved.length;++r)typeof this.reserved[r]=="string"?t.reservedName.push(this.reserved[r]):t.reservedRange.push(Q.DescriptorProto.ReservedRange.create({start:this.reserved[r][0],end:this.reserved[r][1]}));return t.options=xi(this.options,Q.MessageOptions),t};var TN=/^(?![eE])[0-9]*(?:\.[0-9]*)?(?:[eE][+-]?[0-9]+)?$/;rr.fromDescriptor=function(e,t,r){if(typeof e.length=="number"&&(e=Q.DescriptorProto.decode(e)),typeof e.number!="number")throw Error("missing field id");var i;e.typeName&&e.typeName.length?i=e.typeName:i=DN(e.type);var s;switch(e.label){case 1:s=void 0;break;case 2:s="required";break;case 3:s="repeated";break;default:throw Error("illegal label: "+e.label)}var a=e.extendee;e.extendee!==void 0&&(a=a.length?a:void 0);var o=new rr(e.name.length?e.name:"field"+e.number,e.number,i,s,a);if(r||(o._edition=t),o.options=Di(e.options,Q.FieldOptions),e.proto3_optional&&(o.options.proto3_optional=!0),e.defaultValue&&e.defaultValue.length){var l=e.defaultValue;switch(l){case"true":case"TRUE":l=!0;break;case"false":case"FALSE":l=!1;break;default:var c=TN.exec(l);c&&(l=parseInt(l));break}o.setOption("default",l)}return xN(e.type)&&(t==="proto3"?e.options&&!e.options.packed&&o.setOption("packed",!1):(!t||t==="proto2")&&e.options&&e.options.packed&&o.setOption("packed",!0)),o};rr.prototype.toDescriptor=function(e){var t=Q.FieldDescriptorProto.create({name:this.name,number:this.id});if(this.map)t.type=11,t.typeName=gt.util.ucFirst(this.name),t.label=3;else{switch(t.type=Kh(this.type,this.resolve().resolvedType,this.delimited)){case 10:case 11:case 14:t.typeName=this.resolvedType?Ab(this.parent,this.resolvedType):this.type;break}this.rule==="repeated"?t.label=3:this.required&&e==="proto2"?t.label=2:t.label=1}if(t.extendee=this.extensionField?this.extensionField.parent.fullName:this.extend,this.partOf&&(t.oneofIndex=this.parent.oneofsArray.indexOf(this.partOf))<0)throw Error("missing oneof");return this.options&&(t.options=xi(this.options,Q.FieldOptions),this.options.default!=null&&(t.defaultValue=String(this.options.default)),this.options.proto3_optional&&(t.proto3_optional=!0)),e==="proto3"?this.packed||((t.options||(t.options=Q.FieldOptions.create())).packed=!1):(!e||e==="proto2")&&this.packed&&((t.options||(t.options=Q.FieldOptions.create())).packed=!0),t};var CN=0;Rn.fromDescriptor=function(e,t,r){typeof e.length=="number"&&(e=Q.EnumDescriptorProto.decode(e));var i={};if(e.value)for(var s=0;s<e.value.length;++s){var a=e.value[s].name,o=e.value[s].number||0;i[a&&a.length?a:"NAME"+o]=o}var l=new Rn(e.name&&e.name.length?e.name:"Enum"+CN++,i,Di(e.options,Q.EnumOptions));return r||(l._edition=t),l};Rn.prototype.toDescriptor=function(){for(var e=[],t=0,r=Object.keys(this.values);t<r.length;++t)e.push(Q.EnumValueDescriptorProto.create({name:r[t],number:this.values[r[t]]}));return Q.EnumDescriptorProto.create({name:this.name,value:e,options:xi(this.options,Q.EnumOptions)})};var IN=0;fl.fromDescriptor=function(e){return typeof e.length=="number"&&(e=Q.OneofDescriptorProto.decode(e)),new fl(e.name&&e.name.length?e.name:"oneof"+IN++)};fl.prototype.toDescriptor=function(){return Q.OneofDescriptorProto.create({name:this.name})};var AN=0;ua.fromDescriptor=function(e,t,r){typeof e.length=="number"&&(e=Q.ServiceDescriptorProto.decode(e));var i=new ua(e.name&&e.name.length?e.name:"Service"+AN++,Di(e.options,Q.ServiceOptions));if(r||(i._edition=t),e.method)for(var s=0;s<e.method.length;++s)i.add(pl.fromDescriptor(e.method[s]));return i};ua.prototype.toDescriptor=function(){for(var e=[],t=0;t<this.methodsArray.length;++t)e.push(this._methodsArray[t].toDescriptor());return Q.ServiceDescriptorProto.create({name:this.name,method:e,options:xi(this.options,Q.ServiceOptions)})};var RN=0;pl.fromDescriptor=function(e){return typeof e.length=="number"&&(e=Q.MethodDescriptorProto.decode(e)),new pl(e.name&&e.name.length?e.name:"Method"+RN++,"rpc",e.inputType,e.outputType,!!e.clientStreaming,!!e.serverStreaming,Di(e.options,Q.MethodOptions))};pl.prototype.toDescriptor=function(){return Q.MethodDescriptorProto.create({name:this.name,inputType:this.resolvedRequestType?this.resolvedRequestType.fullName:this.requestType,outputType:this.resolvedResponseType?this.resolvedResponseType.fullName:this.responseType,clientStreaming:this.requestStream,serverStreaming:this.responseStream,options:xi(this.options,Q.MethodOptions)})};function DN(n){switch(n){case 1:return"double";case 2:return"float";case 3:return"int64";case 4:return"uint64";case 5:return"int32";case 6:return"fixed64";case 7:return"fixed32";case 8:return"bool";case 9:return"string";case 12:return"bytes";case 13:return"uint32";case 15:return"sfixed32";case 16:return"sfixed64";case 17:return"sint32";case 18:return"sint64"}throw Error("illegal type: "+n)}function xN(n){switch(n){case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 13:case 14:case 15:case 16:case 17:case 18:return!0}return!1}function Kh(n,e,t){switch(n){case"double":return 1;case"float":return 2;case"int64":return 3;case"uint64":return 4;case"int32":return 5;case"fixed64":return 6;case"fixed32":return 7;case"bool":return 8;case"string":return 9;case"bytes":return 12;case"uint32":return 13;case"sfixed32":return 15;case"sfixed64":return 16;case"sint32":return 17;case"sint64":return 18}if(e instanceof Rn)return 14;if(e instanceof sn)return t?10:11;throw Error("illegal type: "+n)}function Cb(n,e){for(var t={},r=0,i,s;r<e.fieldsArray.length;++r)if((s=(i=e._fieldsArray[r]).name)!=="uninterpretedOption"&&Object.prototype.hasOwnProperty.call(n,s)){var a=NN(s);i.resolvedType instanceof sn?t[a]=Cb(n[s],i.resolvedType):i.resolvedType instanceof Rn?t[a]=i.resolvedType.valuesById[n[s]]:t[a]=n[s]}return t}function Di(n,e){if(n)return Cb(e.toObject(n),e)}function Ib(n,e){for(var t={},r=Object.keys(n),i=0;i<r.length;++i){var s=r[i],a=gt.util.camelCase(s);if(Object.prototype.hasOwnProperty.call(e.fields,a)){var o=e.fields[a];o.resolvedType instanceof sn?t[a]=Ib(n[s],o.resolvedType):t[a]=n[s],o.repeated&&!Array.isArray(t[a])&&(t[a]=[t[a]])}}return t}function xi(n,e){if(n)return e.fromObject(Ib(n,e))}function Ab(n,e){var t=n.fullName.split("."),r=e.fullName.split("."),i=0,s=0,a=r.length-1;if(!(n instanceof ca)&&e instanceof wb)for(;i<t.length&&s<a&&t[i]===r[s];){var o=e.lookup(t[i++],!0);if(o!==null&&o!==e)break;++s}else for(;i<t.length&&s<a&&t[i]===r[s];++i,++s);return r.slice(s).join(".")}function NN(n){return n.substring(0,1)+n.substring(1).replace(/([A-Z])(?=[a-z]|$)/g,function(e,t){return"_"+t.toLowerCase()})}function ON(n){if(n.syntax==="editions")switch(n.edition){case Q.Edition.EDITION_2023:return"2023";default:throw new Error("Unsupported edition "+n.edition)}return n.syntax==="proto3"?"proto3":"proto2"}function kN(n,e){if(n)if(n==="proto2"||n==="proto3")e.syntax=n;else switch(e.syntax="editions",n){case"2023":e.edition=Q.Edition.EDITION_2023;break;default:throw new Error("Unsupported edition "+n)}}});var xb=R((J6,MN)=>{MN.exports={nested:{google:{nested:{protobuf:{nested:{Api:{fields:{name:{type:"string",id:1},methods:{rule:"repeated",type:"Method",id:2},options:{rule:"repeated",type:"Option",id:3},version:{type:"string",id:4},sourceContext:{type:"SourceContext",id:5},mixins:{rule:"repeated",type:"Mixin",id:6},syntax:{type:"Syntax",id:7}}},Method:{fields:{name:{type:"string",id:1},requestTypeUrl:{type:"string",id:2},requestStreaming:{type:"bool",id:3},responseTypeUrl:{type:"string",id:4},responseStreaming:{type:"bool",id:5},options:{rule:"repeated",type:"Option",id:6},syntax:{type:"Syntax",id:7}}},Mixin:{fields:{name:{type:"string",id:1},root:{type:"string",id:2}}},SourceContext:{fields:{fileName:{type:"string",id:1}}},Option:{fields:{name:{type:"string",id:1},value:{type:"Any",id:2}}},Syntax:{values:{SYNTAX_PROTO2:0,SYNTAX_PROTO3:1}}}}}}}}});var Nb=R((Z6,PN)=>{PN.exports={nested:{google:{nested:{protobuf:{nested:{SourceContext:{fields:{fileName:{type:"string",id:1}}}}}}}}}});var Ob=R((X6,LN)=>{LN.exports={nested:{google:{nested:{protobuf:{nested:{Type:{fields:{name:{type:"string",id:1},fields:{rule:"repeated",type:"Field",id:2},oneofs:{rule:"repeated",type:"string",id:3},options:{rule:"repeated",type:"Option",id:4},sourceContext:{type:"SourceContext",id:5},syntax:{type:"Syntax",id:6}}},Field:{fields:{kind:{type:"Kind",id:1},cardinality:{type:"Cardinality",id:2},number:{type:"int32",id:3},name:{type:"string",id:4},typeUrl:{type:"string",id:6},oneofIndex:{type:"int32",id:7},packed:{type:"bool",id:8},options:{rule:"repeated",type:"Option",id:9},jsonName:{type:"string",id:10},defaultValue:{type:"string",id:11}},nested:{Kind:{values:{TYPE_UNKNOWN:0,TYPE_DOUBLE:1,TYPE_FLOAT:2,TYPE_INT64:3,TYPE_UINT64:4,TYPE_INT32:5,TYPE_FIXED64:6,TYPE_FIXED32:7,TYPE_BOOL:8,TYPE_STRING:9,TYPE_GROUP:10,TYPE_MESSAGE:11,TYPE_BYTES:12,TYPE_UINT32:13,TYPE_ENUM:14,TYPE_SFIXED32:15,TYPE_SFIXED64:16,TYPE_SINT32:17,TYPE_SINT64:18}},Cardinality:{values:{CARDINALITY_UNKNOWN:0,CARDINALITY_OPTIONAL:1,CARDINALITY_REQUIRED:2,CARDINALITY_REPEATED:3}}}},Enum:{fields:{name:{type:"string",id:1},enumvalue:{rule:"repeated",type:"EnumValue",id:2},options:{rule:"repeated",type:"Option",id:3},sourceContext:{type:"SourceContext",id:4},syntax:{type:"Syntax",id:5}}},EnumValue:{fields:{name:{type:"string",id:1},number:{type:"int32",id:2},options:{rule:"repeated",type:"Option",id:3}}},Option:{fields:{name:{type:"string",id:1},value:{type:"Any",id:2}}},Syntax:{values:{SYNTAX_PROTO2:0,SYNTAX_PROTO3:1}},Any:{fields:{type_url:{type:"string",id:1},value:{type:"bytes",id:2}}},SourceContext:{fields:{fileName:{type:"string",id:1}}}}}}}}}});var Lb=R(ir=>{"use strict";Object.defineProperty(ir,"__esModule",{value:!0});ir.addCommonProtos=ir.loadProtosWithOptionsSync=ir.loadProtosWithOptions=void 0;var kb=require("fs"),Mb=require("path"),Ni=hl();function Pb(n,e){let t=n.resolvePath;n.resolvePath=(r,i)=>{if(Mb.isAbsolute(i))return i;for(let s of e){let a=Mb.join(s,i);try{return kb.accessSync(a,kb.constants.R_OK),a}catch{continue}}return process.emitWarning(`${i} not found in any of the include paths ${e}`),t(r,i)}}async function FN(n,e){let t=new Ni.Root;if(e=e||{},e.includeDirs){if(!Array.isArray(e.includeDirs))return Promise.reject(new Error("The includeDirs option must be an array"));Pb(t,e.includeDirs)}let r=await t.load(n,e);return r.resolveAll(),r}ir.loadProtosWithOptions=FN;function BN(n,e){let t=new Ni.Root;if(e=e||{},e.includeDirs){if(!Array.isArray(e.includeDirs))throw new Error("The includeDirs option must be an array");Pb(t,e.includeDirs)}let r=t.loadSync(n,e);return r.resolveAll(),r}ir.loadProtosWithOptionsSync=BN;function UN(){let n=xb(),e=jh(),t=Nb(),r=Ob();Ni.common("api",n.nested.google.nested.protobuf.nested),Ni.common("descriptor",e.nested.google.nested.protobuf.nested),Ni.common("source_context",t.nested.google.nested.protobuf.nested),Ni.common("type",r.nested.google.nested.protobuf.nested)}ir.addCommonProtos=UN});var Fb=R((da,Hh)=>{(function(n,e){function t(r){return r.default||r}typeof define=="function"&&define.amd?define([],function(){var r={};return e(r),t(r)}):typeof da=="object"?(e(da),typeof Hh=="object"&&(Hh.exports=t(da))):(function(){var r={};e(r),n.Long=t(r)})()})(typeof globalThis<"u"?globalThis:typeof self<"u"?self:da,function(n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var e=null;try{e=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}function t(h,g,k){this.low=h|0,this.high=g|0,this.unsigned=!!k}t.prototype.__isLong__,Object.defineProperty(t.prototype,"__isLong__",{value:!0});function r(h){return(h&&h.__isLong__)===!0}function i(h){var g=Math.clz32(h&-h);return h?31-g:g}t.isLong=r;var s={},a={};function o(h,g){var k,J,Y;return g?(h>>>=0,(Y=0<=h&&h<256)&&(J=a[h],J)?J:(k=c(h,0,!0),Y&&(a[h]=k),k)):(h|=0,(Y=-128<=h&&h<128)&&(J=s[h],J)?J:(k=c(h,h<0?-1:0,!1),Y&&(s[h]=k),k))}t.fromInt=o;function l(h,g){if(isNaN(h))return g?S:A;if(g){if(h<0)return S;if(h>=T)return _}else{if(h<=-I)return b;if(h+1>=I)return y}return h<0?l(-h,g).neg():c(h%C|0,h/C|0,g)}t.fromNumber=l;function c(h,g,k){return new t(h,g,k)}t.fromBits=c;var u=Math.pow;function m(h,g,k){if(h.length===0)throw Error("empty string");if(typeof g=="number"?(k=g,g=!1):g=!!g,h==="NaN"||h==="Infinity"||h==="+Infinity"||h==="-Infinity")return g?S:A;if(k=k||10,k<2||36<k)throw RangeError("radix");var J;if((J=h.indexOf("-"))>0)throw Error("interior hyphen");if(J===0)return m(h.substring(1),g,k).neg();for(var Y=l(u(k,8)),ue=A,Se=0;Se<h.length;Se+=8){var $e=Math.min(8,h.length-Se),Je=parseInt(h.substring(Se,Se+$e),k);if($e<8){var ke=l(u(k,$e));ue=ue.mul(ke).add(l(Je))}else ue=ue.mul(Y),ue=ue.add(l(Je))}return ue.unsigned=g,ue}t.fromString=m;function d(h,g){return typeof h=="number"?l(h,g):typeof h=="string"?m(h,g):c(h.low,h.high,typeof g=="boolean"?g:h.unsigned)}t.fromValue=d;var p=65536,E=1<<24,C=p*p,T=C*C,I=T/2,N=o(E),A=o(0);t.ZERO=A;var S=o(0,!0);t.UZERO=S;var P=o(1);t.ONE=P;var L=o(1,!0);t.UONE=L;var v=o(-1);t.NEG_ONE=v;var y=c(-1,2147483647,!1);t.MAX_VALUE=y;var _=c(-1,-1,!0);t.MAX_UNSIGNED_VALUE=_;var b=c(0,-2147483648,!1);t.MIN_VALUE=b;var f=t.prototype;f.toInt=function(){return this.unsigned?this.low>>>0:this.low},f.toNumber=function(){return this.unsigned?(this.high>>>0)*C+(this.low>>>0):this.high*C+(this.low>>>0)},f.toString=function(g){if(g=g||10,g<2||36<g)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(this.eq(b)){var k=l(g),J=this.div(k),Y=J.mul(k).sub(this);return J.toString(g)+Y.toInt().toString(g)}else return"-"+this.neg().toString(g);for(var ue=l(u(g,6),this.unsigned),Se=this,$e="";;){var Je=Se.div(ue),ke=Se.sub(Je.mul(ue)).toInt()>>>0,ae=ke.toString(g);if(Se=Je,Se.isZero())return ae+$e;for(;ae.length<6;)ae="0"+ae;$e=""+ae+$e}},f.getHighBits=function(){return this.high},f.getHighBitsUnsigned=function(){return this.high>>>0},f.getLowBits=function(){return this.low},f.getLowBitsUnsigned=function(){return this.low>>>0},f.getNumBitsAbs=function(){if(this.isNegative())return this.eq(b)?64:this.neg().getNumBitsAbs();for(var g=this.high!=0?this.high:this.low,k=31;k>0&&(g&1<<k)==0;k--);return this.high!=0?k+33:k+1},f.isSafeInteger=function(){var g=this.high>>21;return g?this.unsigned?!1:g===-1&&!(this.low===0&&this.high===-2097152):!0},f.isZero=function(){return this.high===0&&this.low===0},f.eqz=f.isZero,f.isNegative=function(){return!this.unsigned&&this.high<0},f.isPositive=function(){return this.unsigned||this.high>=0},f.isOdd=function(){return(this.low&1)===1},f.isEven=function(){return(this.low&1)===0},f.equals=function(g){return r(g)||(g=d(g)),this.unsigned!==g.unsigned&&this.high>>>31===1&&g.high>>>31===1?!1:this.high===g.high&&this.low===g.low},f.eq=f.equals,f.notEquals=function(g){return!this.eq(g)},f.neq=f.notEquals,f.ne=f.notEquals,f.lessThan=function(g){return this.comp(g)<0},f.lt=f.lessThan,f.lessThanOrEqual=function(g){return this.comp(g)<=0},f.lte=f.lessThanOrEqual,f.le=f.lessThanOrEqual,f.greaterThan=function(g){return this.comp(g)>0},f.gt=f.greaterThan,f.greaterThanOrEqual=function(g){return this.comp(g)>=0},f.gte=f.greaterThanOrEqual,f.ge=f.greaterThanOrEqual,f.compare=function(g){if(r(g)||(g=d(g)),this.eq(g))return 0;var k=this.isNegative(),J=g.isNegative();return k&&!J?-1:!k&&J?1:this.unsigned?g.high>>>0>this.high>>>0||g.high===this.high&&g.low>>>0>this.low>>>0?-1:1:this.sub(g).isNegative()?-1:1},f.comp=f.compare,f.negate=function(){return!this.unsigned&&this.eq(b)?b:this.not().add(P)},f.neg=f.negate,f.add=function(g){r(g)||(g=d(g));var k=this.high>>>16,J=this.high&65535,Y=this.low>>>16,ue=this.low&65535,Se=g.high>>>16,$e=g.high&65535,Je=g.low>>>16,ke=g.low&65535,ae=0,Ze=0,ve=0,Xe=0;return Xe+=ue+ke,ve+=Xe>>>16,Xe&=65535,ve+=Y+Je,Ze+=ve>>>16,ve&=65535,Ze+=J+$e,ae+=Ze>>>16,Ze&=65535,ae+=k+Se,ae&=65535,c(ve<<16|Xe,ae<<16|Ze,this.unsigned)},f.subtract=function(g){return r(g)||(g=d(g)),this.add(g.neg())},f.sub=f.subtract,f.multiply=function(g){if(this.isZero())return this;if(r(g)||(g=d(g)),e){var k=e.mul(this.low,this.high,g.low,g.high);return c(k,e.get_high(),this.unsigned)}if(g.isZero())return this.unsigned?S:A;if(this.eq(b))return g.isOdd()?b:A;if(g.eq(b))return this.isOdd()?b:A;if(this.isNegative())return g.isNegative()?this.neg().mul(g.neg()):this.neg().mul(g).neg();if(g.isNegative())return this.mul(g.neg()).neg();if(this.lt(N)&&g.lt(N))return l(this.toNumber()*g.toNumber(),this.unsigned);var J=this.high>>>16,Y=this.high&65535,ue=this.low>>>16,Se=this.low&65535,$e=g.high>>>16,Je=g.high&65535,ke=g.low>>>16,ae=g.low&65535,Ze=0,ve=0,Xe=0,mn=0;return mn+=Se*ae,Xe+=mn>>>16,mn&=65535,Xe+=ue*ae,ve+=Xe>>>16,Xe&=65535,Xe+=Se*ke,ve+=Xe>>>16,Xe&=65535,ve+=Y*ae,Ze+=ve>>>16,ve&=65535,ve+=ue*ke,Ze+=ve>>>16,ve&=65535,ve+=Se*Je,Ze+=ve>>>16,ve&=65535,Ze+=J*ae+Y*ke+ue*Je+Se*$e,Ze&=65535,c(Xe<<16|mn,Ze<<16|ve,this.unsigned)},f.mul=f.multiply,f.divide=function(g){if(r(g)||(g=d(g)),g.isZero())throw Error("division by zero");if(e){if(!this.unsigned&&this.high===-2147483648&&g.low===-1&&g.high===-1)return this;var k=(this.unsigned?e.div_u:e.div_s)(this.low,this.high,g.low,g.high);return c(k,e.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?S:A;var J,Y,ue;if(this.unsigned){if(g.unsigned||(g=g.toUnsigned()),g.gt(this))return S;if(g.gt(this.shru(1)))return L;ue=S}else{if(this.eq(b)){if(g.eq(P)||g.eq(v))return b;if(g.eq(b))return P;var Se=this.shr(1);return J=Se.div(g).shl(1),J.eq(A)?g.isNegative()?P:v:(Y=this.sub(g.mul(J)),ue=J.add(Y.div(g)),ue)}else if(g.eq(b))return this.unsigned?S:A;if(this.isNegative())return g.isNegative()?this.neg().div(g.neg()):this.neg().div(g).neg();if(g.isNegative())return this.div(g.neg()).neg();ue=A}for(Y=this;Y.gte(g);){J=Math.max(1,Math.floor(Y.toNumber()/g.toNumber()));for(var $e=Math.ceil(Math.log(J)/Math.LN2),Je=$e<=48?1:u(2,$e-48),ke=l(J),ae=ke.mul(g);ae.isNegative()||ae.gt(Y);)J-=Je,ke=l(J,this.unsigned),ae=ke.mul(g);ke.isZero()&&(ke=P),ue=ue.add(ke),Y=Y.sub(ae)}return ue},f.div=f.divide,f.modulo=function(g){if(r(g)||(g=d(g)),e){var k=(this.unsigned?e.rem_u:e.rem_s)(this.low,this.high,g.low,g.high);return c(k,e.get_high(),this.unsigned)}return this.sub(this.div(g).mul(g))},f.mod=f.modulo,f.rem=f.modulo,f.not=function(){return c(~this.low,~this.high,this.unsigned)},f.countLeadingZeros=function(){return this.high?Math.clz32(this.high):Math.clz32(this.low)+32},f.clz=f.countLeadingZeros,f.countTrailingZeros=function(){return this.low?i(this.low):i(this.high)+32},f.ctz=f.countTrailingZeros,f.and=function(g){return r(g)||(g=d(g)),c(this.low&g.low,this.high&g.high,this.unsigned)},f.or=function(g){return r(g)||(g=d(g)),c(this.low|g.low,this.high|g.high,this.unsigned)},f.xor=function(g){return r(g)||(g=d(g)),c(this.low^g.low,this.high^g.high,this.unsigned)},f.shiftLeft=function(g){return r(g)&&(g=g.toInt()),(g&=63)===0?this:g<32?c(this.low<<g,this.high<<g|this.low>>>32-g,this.unsigned):c(0,this.low<<g-32,this.unsigned)},f.shl=f.shiftLeft,f.shiftRight=function(g){return r(g)&&(g=g.toInt()),(g&=63)===0?this:g<32?c(this.low>>>g|this.high<<32-g,this.high>>g,this.unsigned):c(this.high>>g-32,this.high>=0?0:-1,this.unsigned)},f.shr=f.shiftRight,f.shiftRightUnsigned=function(g){return r(g)&&(g=g.toInt()),(g&=63)===0?this:g<32?c(this.low>>>g|this.high<<32-g,this.high>>>g,this.unsigned):g===32?c(this.high,0,this.unsigned):c(this.high>>>g-32,0,this.unsigned)},f.shru=f.shiftRightUnsigned,f.shr_u=f.shiftRightUnsigned,f.rotateLeft=function(g){var k;return r(g)&&(g=g.toInt()),(g&=63)===0?this:g===32?c(this.high,this.low,this.unsigned):g<32?(k=32-g,c(this.low<<g|this.high>>>k,this.high<<g|this.low>>>k,this.unsigned)):(g-=32,k=32-g,c(this.high<<g|this.low>>>k,this.low<<g|this.high>>>k,this.unsigned))},f.rotl=f.rotateLeft,f.rotateRight=function(g){var k;return r(g)&&(g=g.toInt()),(g&=63)===0?this:g===32?c(this.high,this.low,this.unsigned):g<32?(k=32-g,c(this.high<<k|this.low>>>g,this.low<<k|this.high>>>g,this.unsigned)):(g-=32,k=32-g,c(this.low<<k|this.high>>>g,this.high<<k|this.low>>>g,this.unsigned))},f.rotr=f.rotateRight,f.toSigned=function(){return this.unsigned?c(this.low,this.high,!1):this},f.toUnsigned=function(){return this.unsigned?this:c(this.low,this.high,!0)},f.toBytes=function(g){return g?this.toBytesLE():this.toBytesBE()},f.toBytesLE=function(){var g=this.high,k=this.low;return[k&255,k>>>8&255,k>>>16&255,k>>>24,g&255,g>>>8&255,g>>>16&255,g>>>24]},f.toBytesBE=function(){var g=this.high,k=this.low;return[g>>>24,g>>>16&255,g>>>8&255,g&255,k>>>24,k>>>16&255,k>>>8&255,k&255]},t.fromBytes=function(g,k,J){return J?t.fromBytesLE(g,k):t.fromBytesBE(g,k)},t.fromBytesLE=function(g,k){return new t(g[0]|g[1]<<8|g[2]<<16|g[3]<<24,g[4]|g[5]<<8|g[6]<<16|g[7]<<24,k)},t.fromBytesBE=function(g,k){return new t(g[4]<<24|g[5]<<16|g[6]<<8|g[7],g[0]<<24|g[1]<<16|g[2]<<8|g[3],k)},typeof BigInt=="function"&&(t.fromBigInt=function(g,k){var J=Number(BigInt.asIntN(32,g)),Y=Number(BigInt.asIntN(32,g>>BigInt(32)));return c(J,Y,k)},t.fromValue=function(g,k){return typeof g=="bigint"?t.fromBigInt(g,k):d(g,k)},f.toBigInt=function(){var g=BigInt(this.low>>>0),k=BigInt(this.unsigned?this.high>>>0:this.high);return k<<BigInt(32)|g});var w=n.default=t})});var Jh=R(xe=>{"use strict";Object.defineProperty(xe,"__esModule",{value:!0});xe.loadFileDescriptorSetFromObject=xe.loadFileDescriptorSetFromBuffer=xe.fromJSON=xe.loadSync=xe.load=xe.IdempotencyLevel=xe.isAnyExtension=xe.Long=void 0;var qN=Dv(),an=hl(),Qh=Db(),Yh=Lb(),VN=Fb();xe.Long=VN;function zN(n){return"@type"in n&&typeof n["@type"]=="string"}xe.isAnyExtension=zN;var qb;(function(n){n.IDEMPOTENCY_UNKNOWN="IDEMPOTENCY_UNKNOWN",n.NO_SIDE_EFFECTS="NO_SIDE_EFFECTS",n.IDEMPOTENT="IDEMPOTENT"})(qb=xe.IdempotencyLevel||(xe.IdempotencyLevel={}));var Vb={longs:String,enums:String,bytes:String,defaults:!0,oneofs:!0,json:!0};function GN(n,e){return n===""?e:n+"."+e}function $N(n){return n instanceof an.Service||n instanceof an.Type||n instanceof an.Enum}function jN(n){return n instanceof an.Namespace||n instanceof an.Root}function zb(n,e){let t=GN(e,n.name);return $N(n)?[[t,n]]:jN(n)&&typeof n.nested<"u"?Object.keys(n.nested).map(r=>zb(n.nested[r],t)).reduce((r,i)=>r.concat(i),[]):[]}function Bb(n,e){return function(r){return n.toObject(n.decode(r),e)}}function Ub(n){return function(t){if(Array.isArray(t))throw new Error(`Failed to serialize message: expected object with ${n.name} structure, got array instead`);let r=n.fromObject(t);return n.encode(r).finish()}}function KN(n){return(n||[]).reduce((e,t)=>{for(let[r,i]of Object.entries(t))switch(r){case"uninterpreted_option":e.uninterpreted_option.push(t.uninterpreted_option);break;default:e[r]=i}return e},{deprecated:!1,idempotency_level:qb.IDEMPOTENCY_UNKNOWN,uninterpreted_option:[]})}function HN(n,e,t,r){let i=n.resolvedRequestType,s=n.resolvedResponseType;return{path:"/"+e+"/"+n.name,requestStream:!!n.requestStream,responseStream:!!n.responseStream,requestSerialize:Ub(i),requestDeserialize:Bb(i,t),responseSerialize:Ub(s),responseDeserialize:Bb(s,t),originalName:qN(n.name),requestType:Wh(i,r),responseType:Wh(s,r),options:KN(n.parsedOptions)}}function WN(n,e,t,r){let i={};for(let s of n.methodsArray)i[s.name]=HN(s,e,t,r);return i}function Wh(n,e){let t=n.toDescriptor("proto3");return{format:"Protocol Buffer 3 DescriptorProto",type:t.$type.toObject(t,Vb),fileDescriptorProtos:e}}function QN(n,e){let t=n.toDescriptor("proto3");return{format:"Protocol Buffer 3 EnumDescriptorProto",type:t.$type.toObject(t,Vb),fileDescriptorProtos:e}}function YN(n,e,t,r){if(n instanceof an.Service)return WN(n,e,t,r);if(n instanceof an.Type)return Wh(n,r);if(n instanceof an.Enum)return QN(n,r);throw new Error("Type mismatch in reflection object handling")}function ml(n,e){let t={};n.resolveAll();let i=n.toDescriptor("proto3").file.map(s=>Buffer.from(Qh.FileDescriptorProto.encode(s).finish()));for(let[s,a]of zb(n,""))t[s]=YN(a,s,e,i);return t}function Gb(n,e){e=e||{};let t=an.Root.fromDescriptor(n);return t.resolveAll(),ml(t,e)}function JN(n,e){return(0,Yh.loadProtosWithOptions)(n,e).then(t=>ml(t,e))}xe.load=JN;function ZN(n,e){let t=(0,Yh.loadProtosWithOptionsSync)(n,e);return ml(t,e)}xe.loadSync=ZN;function XN(n,e){e=e||{};let t=an.Root.fromJSON(n);return t.resolveAll(),ml(t,e)}xe.fromJSON=XN;function eO(n,e){let t=Qh.FileDescriptorSet.decode(n);return Gb(t,e)}xe.loadFileDescriptorSetFromBuffer=eO;function tO(n,e){let t=Qh.FileDescriptorSet.fromObject(n);return Gb(t,e)}xe.loadFileDescriptorSetFromObject=tO;(0,Yh.addCommonProtos)()});var Ur=R(ge=>{"use strict";Object.defineProperty(ge,"__esModule",{value:!0});ge.setup=ge.getChannelzServiceDefinition=ge.getChannelzHandlers=ge.unregisterChannelzRef=ge.registerChannelzSocket=ge.registerChannelzServer=ge.registerChannelzSubchannel=ge.registerChannelzChannel=ge.ChannelzCallTracker=ge.ChannelzChildrenTracker=ge.ChannelzTrace=void 0;var $b=require("net"),ha=St(),pa=le(),nO=Yt(),rO=Lo(),iO=Hd();function Zh(n){return{channel_id:n.id,name:n.name}}function nf(n){return{subchannel_id:n.id,name:n.name}}function sO(n){return{server_id:n.id}}function yl(n){return{socket_id:n.id,name:n.name}}var jb=32,Xh=class{constructor(){this.events=[],this.eventsLogged=0,this.creationTimestamp=new Date}addTrace(e,t,r){let i=new Date;this.events.push({description:t,severity:e,timestamp:i,childChannel:r?.kind==="channel"?r:void 0,childSubchannel:r?.kind==="subchannel"?r:void 0}),this.events.length>=jb*2&&(this.events=this.events.slice(jb)),this.eventsLogged+=1}getTraceMessage(){return{creation_timestamp:Dn(this.creationTimestamp),num_events_logged:this.eventsLogged,events:this.events.map(e=>({description:e.description,severity:e.severity,timestamp:Dn(e.timestamp),channel_ref:e.childChannel?Zh(e.childChannel):null,subchannel_ref:e.childSubchannel?nf(e.childSubchannel):null}))}}};ge.ChannelzTrace=Xh;var ef=class{constructor(){this.channelChildren=new Map,this.subchannelChildren=new Map,this.socketChildren=new Map}refChild(e){var t,r,i;switch(e.kind){case"channel":{let s=(t=this.channelChildren.get(e.id))!==null&&t!==void 0?t:{ref:e,count:0};s.count+=1,this.channelChildren.set(e.id,s);break}case"subchannel":{let s=(r=this.subchannelChildren.get(e.id))!==null&&r!==void 0?r:{ref:e,count:0};s.count+=1,this.subchannelChildren.set(e.id,s);break}case"socket":{let s=(i=this.socketChildren.get(e.id))!==null&&i!==void 0?i:{ref:e,count:0};s.count+=1,this.socketChildren.set(e.id,s);break}}}unrefChild(e){switch(e.kind){case"channel":{let t=this.channelChildren.get(e.id);t!==void 0&&(t.count-=1,t.count===0?this.channelChildren.delete(e.id):this.channelChildren.set(e.id,t));break}case"subchannel":{let t=this.subchannelChildren.get(e.id);t!==void 0&&(t.count-=1,t.count===0?this.subchannelChildren.delete(e.id):this.subchannelChildren.set(e.id,t));break}case"socket":{let t=this.socketChildren.get(e.id);t!==void 0&&(t.count-=1,t.count===0?this.socketChildren.delete(e.id):this.socketChildren.set(e.id,t));break}}}getChildLists(){let e=[];for(let{ref:i}of this.channelChildren.values())e.push(i);let t=[];for(let{ref:i}of this.subchannelChildren.values())t.push(i);let r=[];for(let{ref:i}of this.socketChildren.values())r.push(i);return{channels:e,subchannels:t,sockets:r}}};ge.ChannelzChildrenTracker=ef;var tf=class{constructor(){this.callsStarted=0,this.callsSucceeded=0,this.callsFailed=0,this.lastCallStartedTimestamp=null}addCallStarted(){this.callsStarted+=1,this.lastCallStartedTimestamp=new Date}addCallSucceeded(){this.callsSucceeded+=1}addCallFailed(){this.callsFailed+=1}};ge.ChannelzCallTracker=tf;var aO=1;function _l(){return aO++}var fa=[],rf=[],sr=[],sf=[];function oO(n,e,t){let r=_l(),i={id:r,name:n,kind:"channel"};return t&&(fa[r]={ref:i,getInfo:e}),i}ge.registerChannelzChannel=oO;function lO(n,e,t){let r=_l(),i={id:r,name:n,kind:"subchannel"};return t&&(rf[r]={ref:i,getInfo:e}),i}ge.registerChannelzSubchannel=lO;function cO(n,e){let t=_l(),r={id:t,kind:"server"};return e&&(sr[t]={ref:r,getInfo:n}),r}ge.registerChannelzServer=cO;function uO(n,e,t){let r=_l(),i={id:r,name:n,kind:"socket"};return t&&(sf[r]={ref:i,getInfo:e}),i}ge.registerChannelzSocket=uO;function dO(n){switch(n.kind){case"channel":delete fa[n.id];return;case"subchannel":delete rf[n.id];return;case"server":delete sr[n.id];return;case"socket":delete sf[n.id];return}}ge.unregisterChannelzRef=dO;function hO(n){let e=Number.parseInt(n,16);return[e/256|0,e%256]}function Kb(n){if(n==="")return[];let e=n.split(":").map(r=>hO(r));return[].concat(...e)}function fO(n){if((0,$b.isIPv4)(n))return Buffer.from(Uint8Array.from(n.split(".").map(e=>Number.parseInt(e))));if((0,$b.isIPv6)(n)){let e,t,r=n.indexOf("::");r===-1?(e=n,t=""):(e=n.substring(0,r),t=n.substring(r+2));let i=Buffer.from(Kb(e)),s=Buffer.from(Kb(t)),a=Buffer.alloc(16-i.length-s.length,0);return Buffer.concat([i,a,s])}else return null}function Wb(n){switch(n){case ha.ConnectivityState.CONNECTING:return{state:"CONNECTING"};case ha.ConnectivityState.IDLE:return{state:"IDLE"};case ha.ConnectivityState.READY:return{state:"READY"};case ha.ConnectivityState.SHUTDOWN:return{state:"SHUTDOWN"};case ha.ConnectivityState.TRANSIENT_FAILURE:return{state:"TRANSIENT_FAILURE"};default:return{state:"UNKNOWN"}}}function Dn(n){if(!n)return null;let e=n.getTime();return{seconds:e/1e3|0,nanos:e%1e3*1e6}}function Qb(n){let e=n.getInfo();return{ref:Zh(n.ref),data:{target:e.target,state:Wb(e.state),calls_started:e.callTracker.callsStarted,calls_succeeded:e.callTracker.callsSucceeded,calls_failed:e.callTracker.callsFailed,last_call_started_timestamp:Dn(e.callTracker.lastCallStartedTimestamp),trace:e.trace.getTraceMessage()},channel_ref:e.children.channels.map(t=>Zh(t)),subchannel_ref:e.children.subchannels.map(t=>nf(t))}}function pO(n,e){let t=Number.parseInt(n.request.channel_id),r=fa[t];if(r===void 0){e({code:pa.Status.NOT_FOUND,details:"No channel data found for id "+t});return}e(null,{channel:Qb(r)})}function mO(n,e){let t=Number.parseInt(n.request.max_results),r=[],i=Number.parseInt(n.request.start_channel_id);for(;i<fa.length;i++){let s=fa[i];if(s!==void 0&&(r.push(Qb(s)),r.length>=t))break}e(null,{channel:r,end:i>=sr.length})}function Yb(n){let e=n.getInfo();return{ref:sO(n.ref),data:{calls_started:e.callTracker.callsStarted,calls_succeeded:e.callTracker.callsSucceeded,calls_failed:e.callTracker.callsFailed,last_call_started_timestamp:Dn(e.callTracker.lastCallStartedTimestamp),trace:e.trace.getTraceMessage()},listen_socket:e.listenerChildren.sockets.map(t=>yl(t))}}function gO(n,e){let t=Number.parseInt(n.request.server_id),r=sr[t];if(r===void 0){e({code:pa.Status.NOT_FOUND,details:"No server data found for id "+t});return}e(null,{server:Yb(r)})}function yO(n,e){let t=Number.parseInt(n.request.max_results),r=[],i=Number.parseInt(n.request.start_server_id);for(;i<sr.length;i++){let s=sr[i];if(s!==void 0&&(r.push(Yb(s)),r.length>=t))break}e(null,{server:r,end:i>=sr.length})}function _O(n,e){let t=Number.parseInt(n.request.subchannel_id),r=rf[t];if(r===void 0){e({code:pa.Status.NOT_FOUND,details:"No subchannel data found for id "+t});return}let i=r.getInfo(),s={ref:nf(r.ref),data:{target:i.target,state:Wb(i.state),calls_started:i.callTracker.callsStarted,calls_succeeded:i.callTracker.callsSucceeded,calls_failed:i.callTracker.callsFailed,last_call_started_timestamp:Dn(i.callTracker.lastCallStartedTimestamp),trace:i.trace.getTraceMessage()},socket_ref:i.children.sockets.map(a=>yl(a))};e(null,{subchannel:s})}function Hb(n){var e;return(0,nO.isTcpSubchannelAddress)(n)?{address:"tcpip_address",tcpip_address:{ip_address:(e=fO(n.host))!==null&&e!==void 0?e:void 0,port:n.port}}:{address:"uds_address",uds_address:{filename:n.path}}}function vO(n,e){var t,r,i,s,a;let o=Number.parseInt(n.request.socket_id),l=sf[o];if(l===void 0){e({code:pa.Status.NOT_FOUND,details:"No socket data found for id "+o});return}let c=l.getInfo(),u=c.security?{model:"tls",tls:{cipher_suite:c.security.cipherSuiteStandardName?"standard_name":"other_name",standard_name:(t=c.security.cipherSuiteStandardName)!==null&&t!==void 0?t:void 0,other_name:(r=c.security.cipherSuiteOtherName)!==null&&r!==void 0?r:void 0,local_certificate:(i=c.security.localCertificate)!==null&&i!==void 0?i:void 0,remote_certificate:(s=c.security.remoteCertificate)!==null&&s!==void 0?s:void 0}}:null,m={ref:yl(l.ref),local:c.localAddress?Hb(c.localAddress):null,remote:c.remoteAddress?Hb(c.remoteAddress):null,remote_name:(a=c.remoteName)!==null&&a!==void 0?a:void 0,security:u,data:{keep_alives_sent:c.keepAlivesSent,streams_started:c.streamsStarted,streams_succeeded:c.streamsSucceeded,streams_failed:c.streamsFailed,last_local_stream_created_timestamp:Dn(c.lastLocalStreamCreatedTimestamp),last_remote_stream_created_timestamp:Dn(c.lastRemoteStreamCreatedTimestamp),messages_received:c.messagesReceived,messages_sent:c.messagesSent,last_message_received_timestamp:Dn(c.lastMessageReceivedTimestamp),last_message_sent_timestamp:Dn(c.lastMessageSentTimestamp),local_flow_control_window:c.localFlowControlWindow?{value:c.localFlowControlWindow}:null,remote_flow_control_window:c.remoteFlowControlWindow?{value:c.remoteFlowControlWindow}:null}};e(null,{socket:m})}function bO(n,e){let t=Number.parseInt(n.request.server_id),r=sr[t];if(r===void 0){e({code:pa.Status.NOT_FOUND,details:"No server data found for id "+t});return}let i=Number.parseInt(n.request.start_socket_id),s=Number.parseInt(n.request.max_results),o=r.getInfo().sessionChildren.sockets.sort((u,m)=>u.id-m.id),l=[],c=0;for(;c<o.length&&!(o[c].id>=i&&(l.push(yl(o[c])),l.length>=s));c++);e(null,{socket_ref:l,end:c>=o.length})}function Jb(){return{GetChannel:pO,GetTopChannels:mO,GetServer:gO,GetServers:yO,GetSubchannel:_O,GetSocket:vO,GetServerSockets:bO}}ge.getChannelzHandlers=Jb;var gl=null;function Zb(){if(gl)return gl;let n=Jh().loadSync,e=n("channelz.proto",{keepCase:!0,longs:String,enums:String,defaults:!0,oneofs:!0,includeDirs:[`${__dirname}/../../proto`]});return gl=(0,iO.loadPackageDefinition)(e).grpc.channelz.v1.Channelz.service,gl}ge.getChannelzServiceDefinition=Zb;function SO(){(0,rO.registerAdminService)(Zb,Jb)}ge.setup=SO});var Xb=R(bl=>{"use strict";Object.defineProperty(bl,"__esModule",{value:!0});bl.Subchannel=void 0;var he=St(),EO=$s(),af=be(),vl=le(),wO=ht(),TO=Yt(),Oi=Ur(),CO="subchannel",IO=~(1<<31),of=class{constructor(e,t,r,i,s){var a;this.channelTarget=e,this.subchannelAddress=t,this.options=r,this.credentials=i,this.connector=s,this.connectivityState=he.ConnectivityState.IDLE,this.transport=null,this.continueConnecting=!1,this.stateListeners=new Set,this.refcount=0,this.channelzEnabled=!0,this.callTracker=new Oi.ChannelzCallTracker,this.childrenTracker=new Oi.ChannelzChildrenTracker,this.streamTracker=new Oi.ChannelzCallTracker;let o={initialDelay:r["grpc.initial_reconnect_backoff_ms"],maxDelay:r["grpc.max_reconnect_backoff_ms"]};this.backoffTimeout=new EO.BackoffTimeout(()=>{this.handleBackoffTimer()},o),this.backoffTimeout.unref(),this.subchannelAddressString=(0,TO.subchannelAddressToString)(t),this.keepaliveTime=(a=r["grpc.keepalive_time_ms"])!==null&&a!==void 0?a:-1,r["grpc.enable_channelz"]===0&&(this.channelzEnabled=!1),this.channelzTrace=new Oi.ChannelzTrace,this.channelzRef=(0,Oi.registerChannelzSubchannel)(this.subchannelAddressString,()=>this.getChannelzInfo(),this.channelzEnabled),this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Subchannel created"),this.trace("Subchannel constructed with options "+JSON.stringify(r,void 0,2))}getChannelzInfo(){return{state:this.connectivityState,trace:this.channelzTrace,callTracker:this.callTracker,children:this.childrenTracker.getChildLists(),target:this.subchannelAddressString}}trace(e){af.trace(vl.LogVerbosity.DEBUG,CO,"("+this.channelzRef.id+") "+this.subchannelAddressString+" "+e)}refTrace(e){af.trace(vl.LogVerbosity.DEBUG,"subchannel_refcount","("+this.channelzRef.id+") "+this.subchannelAddressString+" "+e)}handleBackoffTimer(){this.continueConnecting?this.transitionToState([he.ConnectivityState.TRANSIENT_FAILURE],he.ConnectivityState.CONNECTING):this.transitionToState([he.ConnectivityState.TRANSIENT_FAILURE],he.ConnectivityState.IDLE)}startBackoff(){this.backoffTimeout.runOnce()}stopBackoff(){this.backoffTimeout.stop(),this.backoffTimeout.reset()}startConnectingInternal(){let e=this.options;if(e["grpc.keepalive_time_ms"]){let t=Math.min(this.keepaliveTime,IO);e=Object.assign(Object.assign({},e),{"grpc.keepalive_time_ms":t})}this.connector.connect(this.subchannelAddress,this.credentials,e).then(t=>{this.transitionToState([he.ConnectivityState.CONNECTING],he.ConnectivityState.READY)?(this.transport=t,this.channelzEnabled&&this.childrenTracker.refChild(t.getChannelzRef()),t.addDisconnectListener(r=>{this.transitionToState([he.ConnectivityState.READY],he.ConnectivityState.IDLE),r&&this.keepaliveTime>0&&(this.keepaliveTime*=2,af.log(vl.LogVerbosity.ERROR,`Connection to ${(0,wO.uriToString)(this.channelTarget)} at ${this.subchannelAddressString} rejected by server because of excess pings. Increasing ping interval to ${this.keepaliveTime} ms`))})):t.shutdown()},t=>{this.transitionToState([he.ConnectivityState.CONNECTING],he.ConnectivityState.TRANSIENT_FAILURE,`${t}`)})}transitionToState(e,t,r){var i,s;if(e.indexOf(this.connectivityState)===-1)return!1;this.trace(he.ConnectivityState[this.connectivityState]+" -> "+he.ConnectivityState[t]),this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Connectivity state change to "+he.ConnectivityState[t]);let a=this.connectivityState;switch(this.connectivityState=t,t){case he.ConnectivityState.READY:this.stopBackoff();break;case he.ConnectivityState.CONNECTING:this.startBackoff(),this.startConnectingInternal(),this.continueConnecting=!1;break;case he.ConnectivityState.TRANSIENT_FAILURE:this.channelzEnabled&&this.transport&&this.childrenTracker.unrefChild(this.transport.getChannelzRef()),(i=this.transport)===null||i===void 0||i.shutdown(),this.transport=null,this.backoffTimeout.isRunning()||process.nextTick(()=>{this.handleBackoffTimer()});break;case he.ConnectivityState.IDLE:this.channelzEnabled&&this.transport&&this.childrenTracker.unrefChild(this.transport.getChannelzRef()),(s=this.transport)===null||s===void 0||s.shutdown(),this.transport=null;break;default:throw new Error(`Invalid state: unknown ConnectivityState ${t}`)}for(let o of this.stateListeners)o(this,a,t,this.keepaliveTime,r);return!0}ref(){this.refTrace("refcount "+this.refcount+" -> "+(this.refcount+1)),this.refcount+=1}unref(){this.refTrace("refcount "+this.refcount+" -> "+(this.refcount-1)),this.refcount-=1,this.refcount===0&&(this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Shutting down"),this.channelzEnabled&&(0,Oi.unregisterChannelzRef)(this.channelzRef),process.nextTick(()=>{this.transitionToState([he.ConnectivityState.CONNECTING,he.ConnectivityState.READY],he.ConnectivityState.IDLE)}))}unrefIfOneRef(){return this.refcount===1?(this.unref(),!0):!1}createCall(e,t,r,i){if(!this.transport)throw new Error("Cannot create call, subchannel not READY");let s;return this.channelzEnabled?(this.callTracker.addCallStarted(),this.streamTracker.addCallStarted(),s={onCallEnd:a=>{a.code===vl.Status.OK?this.callTracker.addCallSucceeded():this.callTracker.addCallFailed()}}):s={},this.transport.createCall(e,t,r,i,s)}startConnecting(){process.nextTick(()=>{this.transitionToState([he.ConnectivityState.IDLE],he.ConnectivityState.CONNECTING)||this.connectivityState===he.ConnectivityState.TRANSIENT_FAILURE&&(this.continueConnecting=!0)})}getConnectivityState(){return this.connectivityState}addConnectivityStateListener(e){this.stateListeners.add(e)}removeConnectivityStateListener(e){this.stateListeners.delete(e)}resetBackoff(){process.nextTick(()=>{this.backoffTimeout.reset(),this.transitionToState([he.ConnectivityState.TRANSIENT_FAILURE],he.ConnectivityState.CONNECTING)})}getAddress(){return this.subchannelAddressString}getChannelzRef(){return this.channelzRef}getRealSubchannel(){return this}realSubchannelEquals(e){return e.getRealSubchannel()===this}throttleKeepalive(e){e>this.keepaliveTime&&(this.keepaliveTime=e)}};bl.Subchannel=of});var df=R(lr=>{"use strict";Object.defineProperty(lr,"__esModule",{value:!0});lr.setup=lr.DEFAULT_PORT=void 0;var eS=Wt(),nS=require("dns"),rS=require("util"),AO=bd(),lf=le(),cf=st(),RO=be(),DO=le(),ar=ht(),tS=require("net"),xO=$s(),NO="dns_resolver";function or(n){RO.trace(DO.LogVerbosity.DEBUG,NO,n)}lr.DEFAULT_PORT=443;var OO=3e4,kO=rS.promisify(nS.resolveTxt),MO=rS.promisify(nS.lookup);function PO(...n){let e=[];for(let t=0;t<Math.max.apply(null,n.map(r=>r.length));t++)for(let r of n)t<r.length&&e.push(r[t]);return e}var uf=class{constructor(e,t,r){var i,s,a;this.target=e,this.listener=t,this.pendingLookupPromise=null,this.pendingTxtPromise=null,this.latestLookupResult=null,this.latestServiceConfig=null,this.latestServiceConfigError=null,this.continueResolving=!1,this.isNextResolutionTimerRunning=!1,this.isServiceConfigEnabled=!0,this.returnedIpResult=!1,or("Resolver constructed for target "+(0,ar.uriToString)(e));let o=(0,ar.splitHostPort)(e.path);o===null?(this.ipResult=null,this.dnsHostname=null,this.port=null):(0,tS.isIPv4)(o.host)||(0,tS.isIPv6)(o.host)?(this.ipResult=[{host:o.host,port:(i=o.port)!==null&&i!==void 0?i:lr.DEFAULT_PORT}],this.dnsHostname=null,this.port=null):(this.ipResult=null,this.dnsHostname=o.host,this.port=(s=o.port)!==null&&s!==void 0?s:lr.DEFAULT_PORT),this.percentage=Math.random()*100,r["grpc.service_config_disable_resolution"]===1&&(this.isServiceConfigEnabled=!1),this.defaultResolutionError={code:lf.Status.UNAVAILABLE,details:`Name resolution failed for target ${(0,ar.uriToString)(this.target)}`,metadata:new cf.Metadata};let l={initialDelay:r["grpc.initial_reconnect_backoff_ms"],maxDelay:r["grpc.max_reconnect_backoff_ms"]};this.backoff=new xO.BackoffTimeout(()=>{this.continueResolving&&this.startResolutionWithBackoff()},l),this.backoff.unref(),this.minTimeBetweenResolutionsMs=(a=r["grpc.dns_min_time_between_resolutions_ms"])!==null&&a!==void 0?a:OO,this.nextResolutionTimer=setTimeout(()=>{},0),clearTimeout(this.nextResolutionTimer)}startResolution(){if(this.ipResult!==null){this.returnedIpResult||(or("Returning IP address for target "+(0,ar.uriToString)(this.target)),setImmediate(()=>{this.listener.onSuccessfulResolution(this.ipResult,null,null,null,{})}),this.returnedIpResult=!0),this.backoff.stop(),this.backoff.reset(),this.stopNextResolutionTimer();return}if(this.dnsHostname===null)or("Failed to parse DNS address "+(0,ar.uriToString)(this.target)),setImmediate(()=>{this.listener.onError({code:lf.Status.UNAVAILABLE,details:`Failed to parse DNS address ${(0,ar.uriToString)(this.target)}`,metadata:new cf.Metadata})}),this.stopNextResolutionTimer();else{if(this.pendingLookupPromise!==null)return;or("Looking up DNS hostname "+this.dnsHostname),this.latestLookupResult=null;let e=this.dnsHostname;this.pendingLookupPromise=MO(e,{all:!0}),this.pendingLookupPromise.then(t=>{if(this.pendingLookupPromise===null)return;this.pendingLookupPromise=null,this.backoff.reset(),this.backoff.stop();let r=t.filter(a=>a.family===4),i=t.filter(a=>a.family===6);this.latestLookupResult=PO(i,r).map(a=>({host:a.address,port:+this.port}));let s="["+this.latestLookupResult.map(a=>a.host+":"+a.port).join(",")+"]";if(or("Resolved addresses for target "+(0,ar.uriToString)(this.target)+": "+s),this.latestLookupResult.length===0){this.listener.onError(this.defaultResolutionError);return}this.listener.onSuccessfulResolution(this.latestLookupResult,this.latestServiceConfig,this.latestServiceConfigError,null,{})},t=>{this.pendingLookupPromise!==null&&(or("Resolution error for target "+(0,ar.uriToString)(this.target)+": "+t.message),this.pendingLookupPromise=null,this.stopNextResolutionTimer(),this.listener.onError(this.defaultResolutionError))}),this.isServiceConfigEnabled&&this.pendingTxtPromise===null&&(this.pendingTxtPromise=kO(e),this.pendingTxtPromise.then(t=>{if(this.pendingTxtPromise!==null){this.pendingTxtPromise=null;try{this.latestServiceConfig=(0,AO.extractAndSelectServiceConfig)(t,this.percentage)}catch(r){this.latestServiceConfigError={code:lf.Status.UNAVAILABLE,details:`Parsing service config failed with error ${r.message}`,metadata:new cf.Metadata}}this.latestLookupResult!==null&&this.listener.onSuccessfulResolution(this.latestLookupResult,this.latestServiceConfig,this.latestServiceConfigError,null,{})}},t=>{}))}}startNextResolutionTimer(){var e,t;clearTimeout(this.nextResolutionTimer),this.nextResolutionTimer=(t=(e=setTimeout(()=>{this.stopNextResolutionTimer(),this.continueResolving&&this.startResolutionWithBackoff()},this.minTimeBetweenResolutionsMs)).unref)===null||t===void 0?void 0:t.call(e),this.isNextResolutionTimerRunning=!0}stopNextResolutionTimer(){clearTimeout(this.nextResolutionTimer),this.isNextResolutionTimerRunning=!1}startResolutionWithBackoff(){this.pendingLookupPromise===null&&(this.continueResolving=!1,this.backoff.runOnce(),this.startNextResolutionTimer(),this.startResolution())}updateResolution(){this.pendingLookupPromise===null&&(this.isNextResolutionTimerRunning||this.backoff.isRunning()?(this.isNextResolutionTimerRunning?or('resolution update delayed by "min time between resolutions" rate limit'):or("resolution update delayed by backoff timer until "+this.backoff.getEndTime().toISOString()),this.continueResolving=!0):this.startResolutionWithBackoff())}destroy(){this.continueResolving=!1,this.backoff.reset(),this.backoff.stop(),this.stopNextResolutionTimer(),this.pendingLookupPromise=null,this.pendingTxtPromise=null,this.latestLookupResult=null,this.latestServiceConfig=null,this.latestServiceConfigError=null,this.returnedIpResult=!1}static getDefaultAuthority(e){return e.path}};function LO(){(0,eS.registerResolver)("dns",uf),(0,eS.registerDefaultScheme)("dns")}lr.setup=LO});var hf=R(Pi=>{"use strict";Object.defineProperty(Pi,"__esModule",{value:!0});Pi.getProxiedConnection=Pi.mapProxyName=void 0;var ma=be(),ki=le(),FO=Wt(),BO=require("http"),UO=require("tls"),qO=be(),iS=Yt(),Mi=ht(),VO=require("url"),zO=df(),GO="proxy";function cr(n){qO.trace(ki.LogVerbosity.DEBUG,GO,n)}function $O(){let n="",e="";if(process.env.grpc_proxy)e="grpc_proxy",n=process.env.grpc_proxy;else if(process.env.https_proxy)e="https_proxy",n=process.env.https_proxy;else if(process.env.http_proxy)e="http_proxy",n=process.env.http_proxy;else return{};let t;try{t=new VO.URL(n)}catch{return(0,ma.log)(ki.LogVerbosity.ERROR,`cannot parse value of "${e}" env var`),{}}if(t.protocol!=="http:")return(0,ma.log)(ki.LogVerbosity.ERROR,`"${t.protocol}" scheme not supported in proxy URI`),{};let r=null;t.username&&(t.password?((0,ma.log)(ki.LogVerbosity.INFO,"userinfo found in proxy URI"),r=`${t.username}:${t.password}`):r=t.username);let i=t.hostname,s=t.port;s===""&&(s="80");let a={address:`${i}:${s}`};return r&&(a.creds=r),cr("Proxy server "+a.address+" set by environment variable "+e),a}function jO(){let n=process.env.no_grpc_proxy,e="no_grpc_proxy";return n||(n=process.env.no_proxy,e="no_proxy"),n?(cr("No proxy server list set by environment variable "+e),n.split(",")):[]}function KO(n,e){var t;let r={target:n,extraOptions:{}};if(((t=e["grpc.enable_http_proxy"])!==null&&t!==void 0?t:1)===0||n.scheme==="unix")return r;let i=$O();if(!i.address)return r;let s=(0,Mi.splitHostPort)(n.path);if(!s)return r;let a=s.host;for(let l of jO())if(l===a)return cr("Not using proxy for target in no_proxy list: "+(0,Mi.uriToString)(n)),r;let o={"grpc.http_connect_target":(0,Mi.uriToString)(n)};return i.creds&&(o["grpc.http_connect_creds"]=i.creds),{target:{scheme:"dns",path:i.address},extraOptions:o}}Pi.mapProxyName=KO;function HO(n,e,t){var r;if(!("grpc.http_connect_target"in e))return Promise.resolve({});let i=e["grpc.http_connect_target"],s=(0,Mi.parseUri)(i);if(s===null)return Promise.resolve({});let a=(0,Mi.splitHostPort)(s.path);if(a===null)return Promise.resolve({});let o=`${a.host}:${(r=a.port)!==null&&r!==void 0?r:zO.DEFAULT_PORT}`,l={method:"CONNECT",path:o},c={Host:o};(0,iS.isTcpSubchannelAddress)(n)?(l.host=n.host,l.port=n.port):l.socketPath=n.path,"grpc.http_connect_creds"in e&&(c["Proxy-Authorization"]="Basic "+Buffer.from(e["grpc.http_connect_creds"]).toString("base64")),l.headers=c;let u=(0,iS.subchannelAddressToString)(n);return cr("Using proxy "+u+" to connect to "+l.path),new Promise((m,d)=>{let p=BO.request(l);p.once("connect",(E,C,T)=>{var I;if(p.removeAllListeners(),C.removeAllListeners(),E.statusCode===200)if(cr("Successfully connected to "+l.path+" through proxy "+u),"secureContext"in t){let N=(0,FO.getDefaultAuthority)(s),A=(0,Mi.splitHostPort)(N),S=(I=A?.host)!==null&&I!==void 0?I:N,P=UO.connect(Object.assign({host:S,servername:S,socket:C},t),()=>{cr("Successfully established a TLS connection to "+l.path+" through proxy "+u),m({socket:P,realTarget:s})});P.on("error",L=>{cr("Failed to establish a TLS connection to "+l.path+" through proxy "+u+" with error "+L.message),d()})}else cr("Successfully established a plaintext connection to "+l.path+" through proxy "+u),m({socket:C,realTarget:s});else(0,ma.log)(ki.LogVerbosity.ERROR,"Failed to connect to "+l.path+" through proxy "+u+" with status "+E.statusCode),d()}),p.once("error",E=>{p.removeAllListeners(),(0,ma.log)(ki.LogVerbosity.ERROR,"Failed to connect to proxy "+u+" with error "+E.message),d()}),p.end()})}Pi.getProxiedConnection=HO});var pf=R(Sl=>{"use strict";Object.defineProperty(Sl,"__esModule",{value:!0});Sl.StreamDecoder=void 0;var on;(function(n){n[n.NO_DATA=0]="NO_DATA",n[n.READING_SIZE=1]="READING_SIZE",n[n.READING_MESSAGE=2]="READING_MESSAGE"})(on||(on={}));var ff=class{constructor(e){this.maxReadMessageLength=e,this.readState=on.NO_DATA,this.readCompressFlag=Buffer.alloc(1),this.readPartialSize=Buffer.alloc(4),this.readSizeRemaining=4,this.readMessageSize=0,this.readPartialMessage=[],this.readMessageRemaining=0}write(e){let t=0,r,i=[];for(;t<e.length;)switch(this.readState){case on.NO_DATA:this.readCompressFlag=e.slice(t,t+1),t+=1,this.readState=on.READING_SIZE,this.readPartialSize.fill(0),this.readSizeRemaining=4,this.readMessageSize=0,this.readMessageRemaining=0,this.readPartialMessage=[];break;case on.READING_SIZE:if(r=Math.min(e.length-t,this.readSizeRemaining),e.copy(this.readPartialSize,4-this.readSizeRemaining,t,t+r),this.readSizeRemaining-=r,t+=r,this.readSizeRemaining===0){if(this.readMessageSize=this.readPartialSize.readUInt32BE(0),this.maxReadMessageLength!==-1&&this.readMessageSize>this.maxReadMessageLength)throw new Error(`Received message larger than max (${this.readMessageSize} vs ${this.maxReadMessageLength})`);if(this.readMessageRemaining=this.readMessageSize,this.readMessageRemaining>0)this.readState=on.READING_MESSAGE;else{let s=Buffer.concat([this.readCompressFlag,this.readPartialSize],5);this.readState=on.NO_DATA,i.push(s)}}break;case on.READING_MESSAGE:if(r=Math.min(e.length-t,this.readMessageRemaining),this.readPartialMessage.push(e.slice(t,t+r)),this.readMessageRemaining-=r,t+=r,this.readMessageRemaining===0){let s=[this.readCompressFlag,this.readPartialSize].concat(this.readPartialMessage),a=Buffer.concat(s,this.readMessageSize+5);this.readState=on.NO_DATA,i.push(a)}break;default:throw new Error("Unexpected read state")}return i}};Sl.StreamDecoder=ff});var sS=R(El=>{"use strict";Object.defineProperty(El,"__esModule",{value:!0});El.Http2SubchannelCall=void 0;var xn=require("http2"),WO=require("os"),ce=le(),ur=st(),QO=pf(),YO=be(),JO=le(),ZO="subchannel_call";function XO(n){for(let[e,t]of Object.entries(WO.constants.errno))if(t===n)return e;return"Unknown system error "+n}var mf=class{constructor(e,t,r,i,s){var a;this.http2Stream=e,this.callEventTracker=t,this.listener=r,this.transport=i,this.callId=s,this.isReadFilterPending=!1,this.isPushPending=!1,this.canPush=!1,this.readsClosed=!1,this.statusOutput=!1,this.unpushedReadMessages=[],this.mappedStatusCode=ce.Status.UNKNOWN,this.finalStatus=null,this.internalError=null;let o=(a=i.getOptions()["grpc.max_receive_message_length"])!==null&&a!==void 0?a:ce.DEFAULT_MAX_RECEIVE_MESSAGE_LENGTH;this.decoder=new QO.StreamDecoder(o),e.on("response",(l,c)=>{let u="";for(let m of Object.keys(l))u+="		"+m+": "+l[m]+`
`;switch(this.trace(`Received server headers:
`+u),l[":status"]){case 400:this.mappedStatusCode=ce.Status.INTERNAL;break;case 401:this.mappedStatusCode=ce.Status.UNAUTHENTICATED;break;case 403:this.mappedStatusCode=ce.Status.PERMISSION_DENIED;break;case 404:this.mappedStatusCode=ce.Status.UNIMPLEMENTED;break;case 429:case 502:case 503:case 504:this.mappedStatusCode=ce.Status.UNAVAILABLE;break;default:this.mappedStatusCode=ce.Status.UNKNOWN}if(c&xn.constants.NGHTTP2_FLAG_END_STREAM)this.handleTrailers(l);else{let m;try{m=ur.Metadata.fromHttp2Headers(l)}catch(d){this.endCall({code:ce.Status.UNKNOWN,details:d.message,metadata:new ur.Metadata});return}this.listener.onReceiveMetadata(m)}}),e.on("trailers",l=>{this.handleTrailers(l)}),e.on("data",l=>{if(this.statusOutput)return;this.trace("receive HTTP/2 data frame of length "+l.length);let c;try{c=this.decoder.write(l)}catch(u){this.cancelWithStatus(ce.Status.RESOURCE_EXHAUSTED,u.message);return}for(let u of c)this.trace("parsed message of length "+u.length),this.callEventTracker.addMessageReceived(),this.tryPush(u)}),e.on("end",()=>{this.readsClosed=!0,this.maybeOutputStatus()}),e.on("close",()=>{process.nextTick(()=>{var l;if(this.trace("HTTP/2 stream closed with code "+e.rstCode),((l=this.finalStatus)===null||l===void 0?void 0:l.code)===ce.Status.OK)return;let c,u="";switch(e.rstCode){case xn.constants.NGHTTP2_NO_ERROR:if(this.finalStatus!==null)return;c=ce.Status.INTERNAL,u=`Received RST_STREAM with code ${e.rstCode}`;break;case xn.constants.NGHTTP2_REFUSED_STREAM:c=ce.Status.UNAVAILABLE,u="Stream refused by server";break;case xn.constants.NGHTTP2_CANCEL:c=ce.Status.CANCELLED,u="Call cancelled";break;case xn.constants.NGHTTP2_ENHANCE_YOUR_CALM:c=ce.Status.RESOURCE_EXHAUSTED,u="Bandwidth exhausted or memory limit exceeded";break;case xn.constants.NGHTTP2_INADEQUATE_SECURITY:c=ce.Status.PERMISSION_DENIED,u="Protocol not secure enough";break;case xn.constants.NGHTTP2_INTERNAL_ERROR:c=ce.Status.INTERNAL,this.internalError===null?u=`Received RST_STREAM with code ${e.rstCode} (Internal server error)`:this.internalError.code==="ECONNRESET"||this.internalError.code==="ETIMEDOUT"?(c=ce.Status.UNAVAILABLE,u=this.internalError.message):u=`Received RST_STREAM with code ${e.rstCode} triggered by internal client error: ${this.internalError.message}`;break;default:c=ce.Status.INTERNAL,u=`Received RST_STREAM with code ${e.rstCode}`}this.endCall({code:c,details:u,metadata:new ur.Metadata,rstCode:e.rstCode})})}),e.on("error",l=>{l.code!=="ERR_HTTP2_STREAM_ERROR"&&(this.trace("Node error event: message="+l.message+" code="+l.code+" errno="+XO(l.errno)+" syscall="+l.syscall),this.internalError=l),this.callEventTracker.onStreamEnd(!1)})}onDisconnect(){this.endCall({code:ce.Status.UNAVAILABLE,details:"Connection dropped",metadata:new ur.Metadata})}outputStatus(){this.statusOutput||(this.statusOutput=!0,this.trace("ended with status: code="+this.finalStatus.code+' details="'+this.finalStatus.details+'"'),this.callEventTracker.onCallEnd(this.finalStatus),process.nextTick(()=>{this.listener.onReceiveStatus(this.finalStatus)}),this.http2Stream.resume())}trace(e){YO.trace(JO.LogVerbosity.DEBUG,ZO,"["+this.callId+"] "+e)}endCall(e){(this.finalStatus===null||this.finalStatus.code===ce.Status.OK)&&(this.finalStatus=e,this.maybeOutputStatus()),this.destroyHttp2Stream()}maybeOutputStatus(){this.finalStatus!==null&&(this.finalStatus.code!==ce.Status.OK||this.readsClosed&&this.unpushedReadMessages.length===0&&!this.isReadFilterPending&&!this.isPushPending)&&this.outputStatus()}push(e){this.trace("pushing to reader message of length "+(e instanceof Buffer?e.length:null)),this.canPush=!1,this.isPushPending=!0,process.nextTick(()=>{this.isPushPending=!1,!this.statusOutput&&(this.listener.onReceiveMessage(e),this.maybeOutputStatus())})}tryPush(e){this.canPush?(this.http2Stream.pause(),this.push(e)):(this.trace("unpushedReadMessages.push message of length "+e.length),this.unpushedReadMessages.push(e))}handleTrailers(e){this.callEventTracker.onStreamEnd(!0);let t="";for(let l of Object.keys(e))t+="		"+l+": "+e[l]+`
`;this.trace(`Received server trailers:
`+t);let r;try{r=ur.Metadata.fromHttp2Headers(e)}catch{r=new ur.Metadata}let i=r.getMap(),s=this.mappedStatusCode;if(s===ce.Status.UNKNOWN&&typeof i["grpc-status"]=="string"){let l=Number(i["grpc-status"]);l in ce.Status&&(s=l,this.trace("received status code "+l+" from server")),r.remove("grpc-status")}let a="";if(typeof i["grpc-message"]=="string"){try{a=decodeURI(i["grpc-message"])}catch{a=i["grpc-message"]}r.remove("grpc-message"),this.trace('received status details string "'+a+'" from server')}let o={code:s,details:a,metadata:r};this.endCall(o)}destroyHttp2Stream(){var e;if(!this.http2Stream.destroyed){let t;((e=this.finalStatus)===null||e===void 0?void 0:e.code)===ce.Status.OK?t=xn.constants.NGHTTP2_NO_ERROR:t=xn.constants.NGHTTP2_CANCEL,this.trace("close http2 stream with code "+t),this.http2Stream.close(t)}}cancelWithStatus(e,t){this.trace("cancelWithStatus code: "+e+' details: "'+t+'"'),this.endCall({code:e,details:t,metadata:new ur.Metadata})}getStatus(){return this.finalStatus}getPeer(){return this.transport.getPeerName()}getCallNumber(){return this.callId}startRead(){if(this.finalStatus!==null&&this.finalStatus.code!==ce.Status.OK){this.readsClosed=!0,this.maybeOutputStatus();return}if(this.canPush=!0,this.unpushedReadMessages.length>0){let e=this.unpushedReadMessages.shift();this.push(e);return}this.http2Stream.resume()}sendMessageWithContext(e,t){this.trace("write() called with message of length "+t.length);let r=i=>{process.nextTick(()=>{var s;let a=ce.Status.UNAVAILABLE;i?.code==="ERR_STREAM_WRITE_AFTER_END"&&(a=ce.Status.INTERNAL),i&&this.cancelWithStatus(a,`Write error: ${i.message}`),(s=e.callback)===null||s===void 0||s.call(e)})};this.trace("sending data chunk of length "+t.length),this.callEventTracker.addMessageSent();try{this.http2Stream.write(t,r)}catch(i){this.endCall({code:ce.Status.UNAVAILABLE,details:`Write failed with error ${i.message}`,metadata:new ur.Metadata})}}halfClose(){this.trace("end() called"),this.trace("calling end() on HTTP/2 stream"),this.http2Stream.end()}};El.Http2SubchannelCall=mf});var gf=R(wl=>{"use strict";Object.defineProperty(wl,"__esModule",{value:!0});wl.getNextCallNumber=void 0;var ek=0;function tk(){return ek++}wl.getNextCallNumber=tk});var lS=R(Cl=>{"use strict";Object.defineProperty(Cl,"__esModule",{value:!0});Cl.Http2SubchannelConnector=void 0;var Sf=require("http2"),aS=require("tls"),yf=Ur(),ga=le(),nk=hf(),Fi=be(),oS=Wt(),Tl=Yt(),Li=ht(),rk=require("net"),ik=sS(),sk=gf(),_f="transport",ak="transport_flowctrl",ok=nd().version,{HTTP2_HEADER_AUTHORITY:lk,HTTP2_HEADER_CONTENT_TYPE:ck,HTTP2_HEADER_METHOD:uk,HTTP2_HEADER_PATH:dk,HTTP2_HEADER_TE:hk,HTTP2_HEADER_USER_AGENT:fk}=Sf.constants,pk=2e4,mk=Buffer.from("too_many_pings","ascii"),vf=class{constructor(e,t,r,i){this.session=e,this.options=r,this.remoteName=i,this.keepaliveTimeMs=-1,this.keepaliveTimeoutMs=pk,this.keepaliveTimerId=null,this.pendingSendKeepalivePing=!1,this.keepaliveTimeoutId=null,this.keepaliveWithoutCalls=!1,this.activeCalls=new Set,this.disconnectListeners=[],this.disconnectHandled=!1,this.channelzEnabled=!0,this.streamTracker=new yf.ChannelzCallTracker,this.keepalivesSent=0,this.messagesSent=0,this.messagesReceived=0,this.lastMessageSentTimestamp=null,this.lastMessageReceivedTimestamp=null,this.subchannelAddressString=(0,Tl.subchannelAddressToString)(t),r["grpc.enable_channelz"]===0&&(this.channelzEnabled=!1),this.channelzRef=(0,yf.registerChannelzSocket)(this.subchannelAddressString,()=>this.getChannelzInfo(),this.channelzEnabled),this.userAgent=[r["grpc.primary_user_agent"],`grpc-node-js/${ok}`,r["grpc.secondary_user_agent"]].filter(s=>s).join(" "),"grpc.keepalive_time_ms"in r&&(this.keepaliveTimeMs=r["grpc.keepalive_time_ms"]),"grpc.keepalive_timeout_ms"in r&&(this.keepaliveTimeoutMs=r["grpc.keepalive_timeout_ms"]),"grpc.keepalive_permit_without_calls"in r?this.keepaliveWithoutCalls=r["grpc.keepalive_permit_without_calls"]===1:this.keepaliveWithoutCalls=!1,e.once("close",()=>{this.trace("session closed"),this.stopKeepalivePings(),this.handleDisconnect()}),e.once("goaway",(s,a,o)=>{let l=!1;s===Sf.constants.NGHTTP2_ENHANCE_YOUR_CALM&&o&&o.equals(mk)&&(l=!0),this.trace("connection closed by GOAWAY with code "+s+" and data "+o?.toString()),this.reportDisconnectToOwner(l)}),e.once("error",s=>{this.trace("connection closed with error "+s.message)}),Fi.isTracerEnabled(_f)&&(e.on("remoteSettings",s=>{this.trace("new settings received"+(this.session!==e?" on the old connection":"")+": "+JSON.stringify(s))}),e.on("localSettings",s=>{this.trace("local settings acknowledged by remote"+(this.session!==e?" on the old connection":"")+": "+JSON.stringify(s))})),this.keepaliveWithoutCalls&&this.maybeStartKeepalivePingTimer()}getChannelzInfo(){var e,t,r;let i=this.session.socket,s=i.remoteAddress?(0,Tl.stringToSubchannelAddress)(i.remoteAddress,i.remotePort):null,a=i.localAddress?(0,Tl.stringToSubchannelAddress)(i.localAddress,i.localPort):null,o;if(this.session.encrypted){let c=i,u=c.getCipher(),m=c.getCertificate(),d=c.getPeerCertificate();o={cipherSuiteStandardName:(e=u.standardName)!==null&&e!==void 0?e:null,cipherSuiteOtherName:u.standardName?null:u.name,localCertificate:m&&"raw"in m?m.raw:null,remoteCertificate:d&&"raw"in d?d.raw:null}}else o=null;return{remoteAddress:s,localAddress:a,security:o,remoteName:this.remoteName,streamsStarted:this.streamTracker.callsStarted,streamsSucceeded:this.streamTracker.callsSucceeded,streamsFailed:this.streamTracker.callsFailed,messagesSent:this.messagesSent,messagesReceived:this.messagesReceived,keepAlivesSent:this.keepalivesSent,lastLocalStreamCreatedTimestamp:this.streamTracker.lastCallStartedTimestamp,lastRemoteStreamCreatedTimestamp:null,lastMessageSentTimestamp:this.lastMessageSentTimestamp,lastMessageReceivedTimestamp:this.lastMessageReceivedTimestamp,localFlowControlWindow:(t=this.session.state.localWindowSize)!==null&&t!==void 0?t:null,remoteFlowControlWindow:(r=this.session.state.remoteWindowSize)!==null&&r!==void 0?r:null}}trace(e){Fi.trace(ga.LogVerbosity.DEBUG,_f,"("+this.channelzRef.id+") "+this.subchannelAddressString+" "+e)}keepaliveTrace(e){Fi.trace(ga.LogVerbosity.DEBUG,"keepalive","("+this.channelzRef.id+") "+this.subchannelAddressString+" "+e)}flowControlTrace(e){Fi.trace(ga.LogVerbosity.DEBUG,ak,"("+this.channelzRef.id+") "+this.subchannelAddressString+" "+e)}internalsTrace(e){Fi.trace(ga.LogVerbosity.DEBUG,"transport_internals","("+this.channelzRef.id+") "+this.subchannelAddressString+" "+e)}reportDisconnectToOwner(e){this.disconnectHandled||(this.disconnectHandled=!0,this.disconnectListeners.forEach(t=>t(e)))}handleDisconnect(){this.reportDisconnectToOwner(!1),setImmediate(()=>{for(let e of this.activeCalls)e.onDisconnect()})}addDisconnectListener(e){this.disconnectListeners.push(e)}clearKeepaliveTimer(){this.keepaliveTimerId&&(clearTimeout(this.keepaliveTimerId),this.keepaliveTimerId=null)}clearKeepaliveTimeout(){this.keepaliveTimeoutId&&(clearTimeout(this.keepaliveTimeoutId),this.keepaliveTimeoutId=null)}canSendPing(){return this.keepaliveTimeMs>0&&(this.keepaliveWithoutCalls||this.activeCalls.size>0)}maybeSendPing(){var e,t;if(this.clearKeepaliveTimer(),!this.canSendPing()){this.pendingSendKeepalivePing=!0;return}this.channelzEnabled&&(this.keepalivesSent+=1),this.keepaliveTrace("Sending ping with timeout "+this.keepaliveTimeoutMs+"ms"),this.keepaliveTimeoutId||(this.keepaliveTimeoutId=setTimeout(()=>{this.keepaliveTrace("Ping timeout passed without response"),this.handleDisconnect()},this.keepaliveTimeoutMs),(t=(e=this.keepaliveTimeoutId).unref)===null||t===void 0||t.call(e));try{this.session.ping((r,i,s)=>{r&&(this.keepaliveTrace("Ping failed with error "+r.message),this.handleDisconnect()),this.keepaliveTrace("Received ping response"),this.clearKeepaliveTimeout(),this.maybeStartKeepalivePingTimer()})}catch{this.handleDisconnect()}}maybeStartKeepalivePingTimer(){var e,t;this.canSendPing()&&(this.pendingSendKeepalivePing?(this.pendingSendKeepalivePing=!1,this.maybeSendPing()):!this.keepaliveTimerId&&!this.keepaliveTimeoutId&&(this.keepaliveTrace("Starting keepalive timer for "+this.keepaliveTimeMs+"ms"),this.keepaliveTimerId=(t=(e=setTimeout(()=>{this.maybeSendPing()},this.keepaliveTimeMs)).unref)===null||t===void 0?void 0:t.call(e)))}stopKeepalivePings(){this.keepaliveTimerId&&(clearTimeout(this.keepaliveTimerId),this.keepaliveTimerId=null),this.clearKeepaliveTimeout()}removeActiveCall(e){this.activeCalls.delete(e),this.activeCalls.size===0&&this.session.unref()}addActiveCall(e){this.activeCalls.add(e),this.activeCalls.size===1&&(this.session.ref(),this.keepaliveWithoutCalls||this.maybeStartKeepalivePingTimer())}createCall(e,t,r,i,s){let a=e.toHttp2Headers();a[lk]=t,a[fk]=this.userAgent,a[ck]="application/grpc",a[uk]="POST",a[dk]=r,a[hk]="trailers";let o;try{o=this.session.request(a)}catch(u){throw this.handleDisconnect(),u}this.flowControlTrace("local window size: "+this.session.state.localWindowSize+" remote window size: "+this.session.state.remoteWindowSize),this.internalsTrace("session.closed="+this.session.closed+" session.destroyed="+this.session.destroyed+" session.socket.destroyed="+this.session.socket.destroyed);let l,c;return this.channelzEnabled?(this.streamTracker.addCallStarted(),l={addMessageSent:()=>{var u;this.messagesSent+=1,this.lastMessageSentTimestamp=new Date,(u=s.addMessageSent)===null||u===void 0||u.call(s)},addMessageReceived:()=>{var u;this.messagesReceived+=1,this.lastMessageReceivedTimestamp=new Date,(u=s.addMessageReceived)===null||u===void 0||u.call(s)},onCallEnd:u=>{var m;(m=s.onCallEnd)===null||m===void 0||m.call(s,u),this.removeActiveCall(c)},onStreamEnd:u=>{var m;u?this.streamTracker.addCallSucceeded():this.streamTracker.addCallFailed(),(m=s.onStreamEnd)===null||m===void 0||m.call(s,u)}}):l={addMessageSent:()=>{var u;(u=s.addMessageSent)===null||u===void 0||u.call(s)},addMessageReceived:()=>{var u;(u=s.addMessageReceived)===null||u===void 0||u.call(s)},onCallEnd:u=>{var m;(m=s.onCallEnd)===null||m===void 0||m.call(s,u),this.removeActiveCall(c)},onStreamEnd:u=>{var m;(m=s.onStreamEnd)===null||m===void 0||m.call(s,u)}},c=new ik.Http2SubchannelCall(o,l,i,this,(0,sk.getNextCallNumber)()),this.addActiveCall(c),c}getChannelzRef(){return this.channelzRef}getPeerName(){return this.subchannelAddressString}getOptions(){return this.options}shutdown(){this.session.close(),(0,yf.unregisterChannelzRef)(this.channelzRef)}},bf=class{constructor(e){this.channelTarget=e,this.session=null,this.isShutdown=!1}trace(e){Fi.trace(ga.LogVerbosity.DEBUG,_f,(0,Li.uriToString)(this.channelTarget)+" "+e)}createSession(e,t,r,i){return this.isShutdown?Promise.reject():new Promise((s,a)=>{var o,l,c;let u;i.realTarget?(u=(0,Li.uriToString)(i.realTarget),this.trace("creating HTTP/2 session through proxy to "+(0,Li.uriToString)(i.realTarget))):(u=null,this.trace("creating HTTP/2 session to "+(0,Tl.subchannelAddressToString)(e)));let m=(0,oS.getDefaultAuthority)((o=i.realTarget)!==null&&o!==void 0?o:this.channelTarget),d=t._getConnectionOptions()||{};d.maxSendHeaderBlockLength=Number.MAX_SAFE_INTEGER,"grpc-node.max_session_memory"in r?d.maxSessionMemory=r["grpc-node.max_session_memory"]:d.maxSessionMemory=Number.MAX_SAFE_INTEGER;let p="http://";if("secureContext"in d){if(p="https://",r["grpc.ssl_target_name_override"]){let T=r["grpc.ssl_target_name_override"];d.checkServerIdentity=(I,N)=>(0,aS.checkServerIdentity)(T,N),d.servername=T}else{let T=(c=(l=(0,Li.splitHostPort)(m))===null||l===void 0?void 0:l.host)!==null&&c!==void 0?c:"localhost";d.servername=T}i.socket&&(d.createConnection=(T,I)=>i.socket)}else d.createConnection=(T,I)=>i.socket?i.socket:rk.connect(e);d=Object.assign(Object.assign(Object.assign({},d),e),{enableTrace:r["grpc-node.tls_enable_trace"]===1});let E=Sf.connect(p+m,d);this.session=E;let C="Failed to connect";E.unref(),E.once("connect",()=>{E.removeAllListeners(),s(new vf(E,e,r,u)),this.session=null}),E.once("close",()=>{this.session=null,setImmediate(()=>{a(`${C} (${new Date().toISOString()})`)})}),E.once("error",T=>{C=T.message,this.trace("connection failed with error "+C)})})}connect(e,t,r){var i,s;if(this.isShutdown)return Promise.reject();let a=t._getConnectionOptions()||{};if("secureContext"in a){if(a.ALPNProtocols=["h2"],r["grpc.ssl_target_name_override"]){let o=r["grpc.ssl_target_name_override"];a.checkServerIdentity=(l,c)=>(0,aS.checkServerIdentity)(o,c),a.servername=o}else if("grpc.http_connect_target"in r){let o=(0,oS.getDefaultAuthority)((i=(0,Li.parseUri)(r["grpc.http_connect_target"]))!==null&&i!==void 0?i:{path:"localhost"}),l=(0,Li.splitHostPort)(o);a.servername=(s=l?.host)!==null&&s!==void 0?s:o}r["grpc-node.tls_enable_trace"]&&(a.enableTrace=!0)}return(0,nk.getProxiedConnection)(e,r,a).then(o=>this.createSession(e,t,r,o))}shutdown(){var e;this.isShutdown=!0,(e=this.session)===null||e===void 0||e.close(),this.session=null}};Cl.Http2SubchannelConnector=bf});var cS=R(Bi=>{"use strict";Object.defineProperty(Bi,"__esModule",{value:!0});Bi.getSubchannelPool=Bi.SubchannelPool=void 0;var gk=J_(),yk=Xb(),_k=Yt(),vk=ht(),bk=lS(),Sk=1e4,ya=class{constructor(){this.pool=Object.create(null),this.cleanupTimer=null}unrefUnusedSubchannels(){let e=!0;for(let t in this.pool){let i=this.pool[t].filter(s=>!s.subchannel.unrefIfOneRef());i.length>0&&(e=!1),this.pool[t]=i}e&&this.cleanupTimer!==null&&(clearInterval(this.cleanupTimer),this.cleanupTimer=null)}ensureCleanupTask(){var e,t;this.cleanupTimer===null&&(this.cleanupTimer=setInterval(()=>{this.unrefUnusedSubchannels()},Sk),(t=(e=this.cleanupTimer).unref)===null||t===void 0||t.call(e))}getOrCreateSubchannel(e,t,r,i){this.ensureCleanupTask();let s=(0,vk.uriToString)(e);if(s in this.pool){let o=this.pool[s];for(let l of o)if((0,_k.subchannelAddressEqual)(t,l.subchannelAddress)&&(0,gk.channelOptionsEqual)(r,l.channelArguments)&&i._equals(l.channelCredentials))return l.subchannel}let a=new yk.Subchannel(e,t,r,i,new bk.Http2SubchannelConnector(e));return s in this.pool||(this.pool[s]=[]),this.pool[s].push({subchannelAddress:t,channelArguments:r,channelCredentials:i,subchannel:a}),a.ref(),a}};Bi.SubchannelPool=ya;var Ek=new ya;function wk(n){return n?Ek:new ya}Bi.getSubchannelPool=wk});var wf=R(Ui=>{"use strict";Object.defineProperty(Ui,"__esModule",{value:!0});Ui.FilterStackFactory=Ui.FilterStack=void 0;var Il=class{constructor(e){this.filters=e}sendMetadata(e){let t=e;for(let r=0;r<this.filters.length;r++)t=this.filters[r].sendMetadata(t);return t}receiveMetadata(e){let t=e;for(let r=this.filters.length-1;r>=0;r--)t=this.filters[r].receiveMetadata(t);return t}sendMessage(e){let t=e;for(let r=0;r<this.filters.length;r++)t=this.filters[r].sendMessage(t);return t}receiveMessage(e){let t=e;for(let r=this.filters.length-1;r>=0;r--)t=this.filters[r].receiveMessage(t);return t}receiveTrailers(e){let t=e;for(let r=this.filters.length-1;r>=0;r--)t=this.filters[r].receiveTrailers(t);return t}push(e){this.filters.unshift(...e)}getFilters(){return this.filters}};Ui.FilterStack=Il;var Ef=class n{constructor(e){this.factories=e}push(e){this.factories.unshift(...e)}clone(){return new n([...this.factories])}createFilter(){return new Il(this.factories.map(e=>e.createFilter()))}};Ui.FilterStackFactory=Ef});var Tf=R(Al=>{"use strict";Object.defineProperty(Al,"__esModule",{value:!0});Al.CompressionAlgorithms=void 0;var uS;(function(n){n[n.identity=0]="identity",n[n.deflate=1]="deflate",n[n.gzip=2]="gzip"})(uS||(Al.CompressionAlgorithms=uS={}))});var If=R(Rl=>{"use strict";Object.defineProperty(Rl,"__esModule",{value:!0});Rl.BaseFilter=void 0;var Cf=class{async sendMetadata(e){return e}receiveMetadata(e){return e}async sendMessage(e){return e}async receiveMessage(e){return e}receiveTrailers(e){return e}};Rl.BaseFilter=Cf});var fS=R(Vi=>{"use strict";Object.defineProperty(Vi,"__esModule",{value:!0});Vi.CompressionFilterFactory=Vi.CompressionFilter=void 0;var Dl=require("zlib"),hS=Tf(),xl=le(),Tk=If(),Ck=be(),Ik=n=>typeof n=="number"&&typeof hS.CompressionAlgorithms[n]=="string",qi=class{async writeMessage(e,t){let r=e;t&&(r=await this.compressMessage(r));let i=Buffer.allocUnsafe(r.length+5);return i.writeUInt8(t?1:0,0),i.writeUInt32BE(r.length,1),r.copy(i,5),i}async readMessage(e){let t=e.readUInt8(0)===1,r=e.slice(5);return t&&(r=await this.decompressMessage(r)),r}},qr=class extends qi{async compressMessage(e){return e}async writeMessage(e,t){let r=Buffer.allocUnsafe(e.length+5);return r.writeUInt8(0,0),r.writeUInt32BE(e.length,1),e.copy(r,5),r}decompressMessage(e){return Promise.reject(new Error('Received compressed message but "grpc-encoding" header was identity'))}},Af=class extends qi{constructor(e){super(),this.maxRecvMessageLength=e}compressMessage(e){return new Promise((t,r)=>{Dl.deflate(e,(i,s)=>{i?r(i):t(s)})})}decompressMessage(e){return new Promise((t,r)=>{let i=0,s=[],a=Dl.createInflate();a.on("data",o=>{s.push(o),i+=o.byteLength,this.maxRecvMessageLength!==-1&&i>this.maxRecvMessageLength&&(a.destroy(),r({code:xl.Status.RESOURCE_EXHAUSTED,details:`Received message that decompresses to a size larger than ${this.maxRecvMessageLength}`}))}),a.on("end",()=>{t(Buffer.concat(s))}),a.write(e),a.end()})}},Rf=class extends qi{constructor(e){super(),this.maxRecvMessageLength=e}compressMessage(e){return new Promise((t,r)=>{Dl.gzip(e,(i,s)=>{i?r(i):t(s)})})}decompressMessage(e){return new Promise((t,r)=>{let i=0,s=[],a=Dl.createGunzip();a.on("data",o=>{s.push(o),i+=o.byteLength,this.maxRecvMessageLength!==-1&&i>this.maxRecvMessageLength&&(a.destroy(),r({code:xl.Status.RESOURCE_EXHAUSTED,details:`Received message that decompresses to a size larger than ${this.maxRecvMessageLength}`}))}),a.on("end",()=>{t(Buffer.concat(s))}),a.write(e),a.end()})}},Df=class extends qi{constructor(e){super(),this.compressionName=e}compressMessage(e){return Promise.reject(new Error(`Received message compressed with unsupported compression method ${this.compressionName}`))}decompressMessage(e){return Promise.reject(new Error(`Compression method not supported: ${this.compressionName}`))}};function dS(n,e){switch(n){case"identity":return new qr;case"deflate":return new Af(e);case"gzip":return new Rf(e);default:return new Df(n)}}var Nl=class extends Tk.BaseFilter{constructor(e,t){var r,i;super(),this.sharedFilterConfig=t,this.sendCompression=new qr,this.receiveCompression=new qr,this.currentCompressionAlgorithm="identity";let s=e["grpc.default_compression_algorithm"];if(this.maxReceiveMessageLength=(r=e["grpc.max_receive_message_length"])!==null&&r!==void 0?r:xl.DEFAULT_MAX_RECEIVE_MESSAGE_LENGTH,s!==void 0)if(Ik(s)){let a=hS.CompressionAlgorithms[s],o=(i=t.serverSupportedEncodingHeader)===null||i===void 0?void 0:i.split(",");(!o||o.includes(a))&&(this.currentCompressionAlgorithm=a,this.sendCompression=dS(this.currentCompressionAlgorithm,-1))}else Ck.log(xl.LogVerbosity.ERROR,`Invalid value provided for grpc.default_compression_algorithm option: ${s}`)}async sendMetadata(e){let t=await e;return t.set("grpc-accept-encoding","identity,deflate,gzip"),t.set("accept-encoding","identity"),this.currentCompressionAlgorithm==="identity"?t.remove("grpc-encoding"):t.set("grpc-encoding",this.currentCompressionAlgorithm),t}receiveMetadata(e){let t=e.get("grpc-encoding");if(t.length>0){let i=t[0];typeof i=="string"&&(this.receiveCompression=dS(i,this.maxReceiveMessageLength))}e.remove("grpc-encoding");let r=e.get("grpc-accept-encoding")[0];return r&&(this.sharedFilterConfig.serverSupportedEncodingHeader=r,r.split(",").includes(this.currentCompressionAlgorithm)||(this.sendCompression=new qr,this.currentCompressionAlgorithm="identity")),e.remove("grpc-accept-encoding"),e}async sendMessage(e){var t;let r=await e,i;return this.sendCompression instanceof qr?i=!1:i=(((t=r.flags)!==null&&t!==void 0?t:0)&2)===0,{message:await this.sendCompression.writeMessage(r.message,i),flags:r.flags}}async receiveMessage(e){return this.receiveCompression.readMessage(await e)}};Vi.CompressionFilter=Nl;var xf=class{constructor(e,t){this.options=t,this.sharedFilterConfig={}}createFilter(){return new Nl(this.options,this.sharedFilterConfig)}};Vi.CompressionFilterFactory=xf});var Ol=R(ln=>{"use strict";Object.defineProperty(ln,"__esModule",{value:!0});ln.deadlineToString=ln.getRelativeTimeout=ln.getDeadlineTimeoutString=ln.minDeadline=void 0;function Ak(...n){let e=1/0;for(let t of n){let r=t instanceof Date?t.getTime():t;r<e&&(e=r)}return e}ln.minDeadline=Ak;var Rk=[["m",1],["S",1e3],["M",60*1e3],["H",3600*1e3]];function Dk(n){let e=new Date().getTime();n instanceof Date&&(n=n.getTime());let t=Math.max(n-e,0);for(let[r,i]of Rk){let s=t/i;if(s<1e8)return String(Math.ceil(s))+r}throw new Error("Deadline is too far in the future")}ln.getDeadlineTimeoutString=Dk;var xk=2147483647;function Nk(n){let e=n instanceof Date?n.getTime():n,t=new Date().getTime(),r=e-t;return r<0?0:r>xk?1/0:r}ln.getRelativeTimeout=Nk;function Ok(n){if(n instanceof Date)return n.toISOString();{let e=new Date(n);return Number.isNaN(e.getTime())?""+n:e.toISOString()}}ln.deadlineToString=Ok});var Ml=R(kl=>{"use strict";Object.defineProperty(kl,"__esModule",{value:!0});kl.restrictControlPlaneStatusCode=void 0;var cn=le(),kk=[cn.Status.OK,cn.Status.INVALID_ARGUMENT,cn.Status.NOT_FOUND,cn.Status.ALREADY_EXISTS,cn.Status.FAILED_PRECONDITION,cn.Status.ABORTED,cn.Status.OUT_OF_RANGE,cn.Status.DATA_LOSS];function Mk(n,e){return kk.includes(n)?{code:cn.Status.INTERNAL,details:`Invalid status from control plane: ${n} ${cn.Status[n]} ${e}`}:{code:n,details:e}}kl.restrictControlPlaneStatusCode=Mk});var mS=R(Fl=>{"use strict";Object.defineProperty(Fl,"__esModule",{value:!0});Fl.LoadBalancingCall=void 0;var pS=St(),Pl=le(),Pk=Ol(),Ll=st(),_a=Qn(),Lk=ht(),Fk=be(),Nf=Ml(),Bk=require("http2"),Uk="load_balancing_call",Of=class{constructor(e,t,r,i,s,a,o){var l,c;this.channel=e,this.callConfig=t,this.methodName=r,this.host=i,this.credentials=s,this.deadline=a,this.callNumber=o,this.child=null,this.readPending=!1,this.pendingMessage=null,this.pendingHalfClose=!1,this.ended=!1,this.metadata=null,this.listener=null,this.onCallEnded=null;let u=this.methodName.split("/"),m="";u.length>=2&&(m=u[1]);let d=(c=(l=(0,Lk.splitHostPort)(this.host))===null||l===void 0?void 0:l.host)!==null&&c!==void 0?c:"localhost";this.serviceUrl=`https://${d}/${m}`}trace(e){Fk.trace(Pl.LogVerbosity.DEBUG,Uk,"["+this.callNumber+"] "+e)}outputStatus(e,t){var r,i;if(!this.ended){this.ended=!0,this.trace("ended with status: code="+e.code+' details="'+e.details+'"');let s=Object.assign(Object.assign({},e),{progress:t});(r=this.listener)===null||r===void 0||r.onReceiveStatus(s),(i=this.onCallEnded)===null||i===void 0||i.call(this,s.code)}}doPick(){var e,t;if(this.ended)return;if(!this.metadata)throw new Error("doPick called before start");this.trace("Pick called");let r=this.channel.doPick(this.metadata,this.callConfig.pickInformation),i=r.subchannel?"("+r.subchannel.getChannelzRef().id+") "+r.subchannel.getAddress():""+r.subchannel;switch(this.trace("Pick result: "+_a.PickResultType[r.pickResultType]+" subchannel: "+i+" status: "+((e=r.status)===null||e===void 0?void 0:e.code)+" "+((t=r.status)===null||t===void 0?void 0:t.details)),r.pickResultType){case _a.PickResultType.COMPLETE:this.credentials.generateMetadata({service_url:this.serviceUrl}).then(o=>{var l,c,u;if(this.ended){this.trace("Credentials metadata generation finished after call ended");return}let m=this.metadata.clone();if(m.merge(o),m.get("authorization").length>1&&this.outputStatus({code:Pl.Status.INTERNAL,details:'"authorization" metadata cannot have multiple values',metadata:new Ll.Metadata},"PROCESSED"),r.subchannel.getConnectivityState()!==pS.ConnectivityState.READY){this.trace("Picked subchannel "+i+" has state "+pS.ConnectivityState[r.subchannel.getConnectivityState()]+" after getting credentials metadata. Retrying pick"),this.doPick();return}this.deadline!==1/0&&m.set("grpc-timeout",(0,Pk.getDeadlineTimeoutString)(this.deadline));try{this.child=r.subchannel.getRealSubchannel().createCall(m,this.host,this.methodName,{onReceiveMetadata:d=>{this.trace("Received metadata"),this.listener.onReceiveMetadata(d)},onReceiveMessage:d=>{this.trace("Received message"),this.listener.onReceiveMessage(d)},onReceiveStatus:d=>{this.trace("Received status"),d.rstCode===Bk.constants.NGHTTP2_REFUSED_STREAM?this.outputStatus(d,"REFUSED"):this.outputStatus(d,"PROCESSED")}})}catch(d){this.trace("Failed to start call on picked subchannel "+i+" with error "+d.message),this.outputStatus({code:Pl.Status.INTERNAL,details:"Failed to start HTTP/2 stream with error "+d.message,metadata:new Ll.Metadata},"NOT_STARTED");return}(c=(l=this.callConfig).onCommitted)===null||c===void 0||c.call(l),(u=r.onCallStarted)===null||u===void 0||u.call(r),this.onCallEnded=r.onCallEnded,this.trace("Created child call ["+this.child.getCallNumber()+"]"),this.readPending&&this.child.startRead(),this.pendingMessage&&this.child.sendMessageWithContext(this.pendingMessage.context,this.pendingMessage.message),this.pendingHalfClose&&this.child.halfClose()},o=>{let{code:l,details:c}=(0,Nf.restrictControlPlaneStatusCode)(typeof o.code=="number"?o.code:Pl.Status.UNKNOWN,`Getting metadata from plugin failed with error: ${o.message}`);this.outputStatus({code:l,details:c,metadata:new Ll.Metadata},"PROCESSED")});break;case _a.PickResultType.DROP:let{code:s,details:a}=(0,Nf.restrictControlPlaneStatusCode)(r.status.code,r.status.details);setImmediate(()=>{this.outputStatus({code:s,details:a,metadata:r.status.metadata},"DROP")});break;case _a.PickResultType.TRANSIENT_FAILURE:if(this.metadata.getOptions().waitForReady)this.channel.queueCallForPick(this);else{let{code:o,details:l}=(0,Nf.restrictControlPlaneStatusCode)(r.status.code,r.status.details);setImmediate(()=>{this.outputStatus({code:o,details:l,metadata:r.status.metadata},"PROCESSED")})}break;case _a.PickResultType.QUEUE:this.channel.queueCallForPick(this)}}cancelWithStatus(e,t){var r;this.trace("cancelWithStatus code: "+e+' details: "'+t+'"'),(r=this.child)===null||r===void 0||r.cancelWithStatus(e,t),this.outputStatus({code:e,details:t,metadata:new Ll.Metadata},"PROCESSED")}getPeer(){var e,t;return(t=(e=this.child)===null||e===void 0?void 0:e.getPeer())!==null&&t!==void 0?t:this.channel.getTarget()}start(e,t){this.trace("start called"),this.listener=t,this.metadata=e,this.doPick()}sendMessageWithContext(e,t){this.trace("write() called with message of length "+t.length),this.child?this.child.sendMessageWithContext(e,t):this.pendingMessage={context:e,message:t}}startRead(){this.trace("startRead called"),this.child?this.child.startRead():this.readPending=!0}halfClose(){this.trace("halfClose called"),this.child?this.child.halfClose():this.pendingHalfClose=!0}setCredentials(e){throw new Error("Method not implemented.")}getCallNumber(){return this.callNumber}};Fl.LoadBalancingCall=Of});var yS=R(Ul=>{"use strict";Object.defineProperty(Ul,"__esModule",{value:!0});Ul.ResolvingCall=void 0;var zi=le(),Bl=Ol(),gS=st(),qk=be(),Vk=Ml(),zk="resolving_call",kf=class{constructor(e,t,r,i,s,a){this.channel=e,this.method=t,this.filterStackFactory=i,this.credentials=s,this.callNumber=a,this.child=null,this.readPending=!1,this.pendingMessage=null,this.pendingHalfClose=!1,this.ended=!1,this.readFilterPending=!1,this.writeFilterPending=!1,this.pendingChildStatus=null,this.metadata=null,this.listener=null,this.statusWatchers=[],this.deadlineTimer=setTimeout(()=>{},0),this.filterStack=null,this.deadline=r.deadline,this.host=r.host,r.parentCall&&(r.flags&zi.Propagate.CANCELLATION&&r.parentCall.on("cancelled",()=>{this.cancelWithStatus(zi.Status.CANCELLED,"Cancelled by parent call")}),r.flags&zi.Propagate.DEADLINE&&(this.trace("Propagating deadline from parent: "+r.parentCall.getDeadline()),this.deadline=(0,Bl.minDeadline)(this.deadline,r.parentCall.getDeadline()))),this.trace("Created"),this.runDeadlineTimer()}trace(e){qk.trace(zi.LogVerbosity.DEBUG,zk,"["+this.callNumber+"] "+e)}runDeadlineTimer(){clearTimeout(this.deadlineTimer),this.trace("Deadline: "+(0,Bl.deadlineToString)(this.deadline));let e=(0,Bl.getRelativeTimeout)(this.deadline);if(e!==1/0){this.trace("Deadline will be reached in "+e+"ms");let t=()=>{this.cancelWithStatus(zi.Status.DEADLINE_EXCEEDED,"Deadline exceeded")};e<=0?process.nextTick(t):this.deadlineTimer=setTimeout(t,e)}}outputStatus(e){if(!this.ended){this.ended=!0,this.filterStack||(this.filterStack=this.filterStackFactory.createFilter()),clearTimeout(this.deadlineTimer);let t=this.filterStack.receiveTrailers(e);this.trace("ended with status: code="+t.code+' details="'+t.details+'"'),this.statusWatchers.forEach(r=>r(t)),process.nextTick(()=>{var r;(r=this.listener)===null||r===void 0||r.onReceiveStatus(t)})}}sendMessageOnChild(e,t){if(!this.child)throw new Error("sendMessageonChild called with child not populated");let r=this.child;this.writeFilterPending=!0,this.filterStack.sendMessage(Promise.resolve({message:t,flags:e.flags})).then(i=>{this.writeFilterPending=!1,r.sendMessageWithContext(e,i.message),this.pendingHalfClose&&r.halfClose()},i=>{this.cancelWithStatus(i.code,i.details)})}getConfig(){if(this.ended)return;if(!this.metadata||!this.listener)throw new Error("getConfig called before start");let e=this.channel.getConfig(this.method,this.metadata);if(e.type==="NONE"){this.channel.queueCallForConfig(this);return}else if(e.type==="ERROR"){this.metadata.getOptions().waitForReady?this.channel.queueCallForConfig(this):this.outputStatus(e.error);return}let t=e.config;if(t.status!==zi.Status.OK){let{code:r,details:i}=(0,Vk.restrictControlPlaneStatusCode)(t.status,"Failed to route call to method "+this.method);this.outputStatus({code:r,details:i,metadata:new gS.Metadata});return}if(t.methodConfig.timeout){let r=new Date;r.setSeconds(r.getSeconds()+t.methodConfig.timeout.seconds),r.setMilliseconds(r.getMilliseconds()+t.methodConfig.timeout.nanos/1e6),this.deadline=(0,Bl.minDeadline)(this.deadline,r),this.runDeadlineTimer()}this.filterStackFactory.push(t.dynamicFilterFactories),this.filterStack=this.filterStackFactory.createFilter(),this.filterStack.sendMetadata(Promise.resolve(this.metadata)).then(r=>{this.child=this.channel.createInnerCall(t,this.method,this.host,this.credentials,this.deadline),this.trace("Created child ["+this.child.getCallNumber()+"]"),this.child.start(r,{onReceiveMetadata:i=>{this.trace("Received metadata"),this.listener.onReceiveMetadata(this.filterStack.receiveMetadata(i))},onReceiveMessage:i=>{this.trace("Received message"),this.readFilterPending=!0,this.filterStack.receiveMessage(i).then(s=>{this.trace("Finished filtering received message"),this.readFilterPending=!1,this.listener.onReceiveMessage(s),this.pendingChildStatus&&this.outputStatus(this.pendingChildStatus)},s=>{this.cancelWithStatus(s.code,s.details)})},onReceiveStatus:i=>{this.trace("Received status"),this.readFilterPending?this.pendingChildStatus=i:this.outputStatus(i)}}),this.readPending&&this.child.startRead(),this.pendingMessage?this.sendMessageOnChild(this.pendingMessage.context,this.pendingMessage.message):this.pendingHalfClose&&this.child.halfClose()},r=>{this.outputStatus(r)})}reportResolverError(e){var t;!((t=this.metadata)===null||t===void 0)&&t.getOptions().waitForReady?this.channel.queueCallForConfig(this):this.outputStatus(e)}cancelWithStatus(e,t){var r;this.trace("cancelWithStatus code: "+e+' details: "'+t+'"'),(r=this.child)===null||r===void 0||r.cancelWithStatus(e,t),this.outputStatus({code:e,details:t,metadata:new gS.Metadata})}getPeer(){var e,t;return(t=(e=this.child)===null||e===void 0?void 0:e.getPeer())!==null&&t!==void 0?t:this.channel.getTarget()}start(e,t){this.trace("start called"),this.metadata=e.clone(),this.listener=t,this.getConfig()}sendMessageWithContext(e,t){this.trace("write() called with message of length "+t.length),this.child?this.sendMessageOnChild(e,t):this.pendingMessage={context:e,message:t}}startRead(){this.trace("startRead called"),this.child?this.child.startRead():this.readPending=!0}halfClose(){this.trace("halfClose called"),this.child&&!this.writeFilterPending?this.child.halfClose():this.pendingHalfClose=!0}setCredentials(e){this.credentials=this.credentials.compose(e)}addStatusWatcher(e){this.statusWatchers.push(e)}getCallNumber(){return this.callNumber}};Ul.ResolvingCall=kf});var _S=R(dr=>{"use strict";Object.defineProperty(dr,"__esModule",{value:!0});dr.RetryingCall=dr.MessageBufferTracker=dr.RetryThrottler=void 0;var ql=le(),Gk=st(),$k=be(),jk="retrying_call",Pf=class{constructor(e,t,r){this.maxTokens=e,this.tokenRatio=t,r?this.tokens=r.tokens*(e/r.maxTokens):this.tokens=e}addCallSucceeded(){this.tokens=Math.max(this.tokens+this.tokenRatio,this.maxTokens)}addCallFailed(){this.tokens=Math.min(this.tokens-1,0)}canRetryCall(){return this.tokens>this.maxTokens/2}};dr.RetryThrottler=Pf;var Lf=class{constructor(e,t){this.totalLimit=e,this.limitPerCall=t,this.totalAllocated=0,this.allocatedPerCall=new Map}allocate(e,t){var r;let i=(r=this.allocatedPerCall.get(t))!==null&&r!==void 0?r:0;return this.limitPerCall-i<e||this.totalLimit-this.totalAllocated<e?!1:(this.allocatedPerCall.set(t,i+e),this.totalAllocated+=e,!0)}free(e,t){var r;if(this.totalAllocated<e)throw new Error(`Invalid buffer allocation state: call ${t} freed ${e} > total allocated ${this.totalAllocated}`);this.totalAllocated-=e;let i=(r=this.allocatedPerCall.get(t))!==null&&r!==void 0?r:0;if(i<e)throw new Error(`Invalid buffer allocation state: call ${t} freed ${e} > allocated for call ${i}`);this.allocatedPerCall.set(t,i-e)}freeAll(e){var t;let r=(t=this.allocatedPerCall.get(e))!==null&&t!==void 0?t:0;if(this.totalAllocated<r)throw new Error(`Invalid buffer allocation state: call ${e} allocated ${r} > total allocated ${this.totalAllocated}`);this.totalAllocated-=r,this.allocatedPerCall.delete(e)}};dr.MessageBufferTracker=Lf;var Mf="grpc-previous-rpc-attempts",Ff=class{constructor(e,t,r,i,s,a,o,l,c){if(this.channel=e,this.callConfig=t,this.methodName=r,this.host=i,this.credentials=s,this.deadline=a,this.callNumber=o,this.bufferTracker=l,this.retryThrottler=c,this.listener=null,this.initialMetadata=null,this.underlyingCalls=[],this.writeBuffer=[],this.writeBufferOffset=0,this.readStarted=!1,this.transparentRetryUsed=!1,this.attempts=0,this.hedgingTimer=null,this.committedCallIndex=null,this.initialRetryBackoffSec=0,this.nextRetryBackoffSec=0,t.methodConfig.retryPolicy){this.state="RETRY";let u=t.methodConfig.retryPolicy;this.nextRetryBackoffSec=this.initialRetryBackoffSec=Number(u.initialBackoff.substring(0,u.initialBackoff.length-1))}else t.methodConfig.hedgingPolicy?this.state="HEDGING":this.state="TRANSPARENT_ONLY"}getCallNumber(){return this.callNumber}trace(e){$k.trace(ql.LogVerbosity.DEBUG,jk,"["+this.callNumber+"] "+e)}reportStatus(e){this.trace("ended with status: code="+e.code+' details="'+e.details+'"'),this.bufferTracker.freeAll(this.callNumber),this.writeBufferOffset=this.writeBufferOffset+this.writeBuffer.length,this.writeBuffer=[],process.nextTick(()=>{var t;(t=this.listener)===null||t===void 0||t.onReceiveStatus({code:e.code,details:e.details,metadata:e.metadata})})}cancelWithStatus(e,t){this.trace("cancelWithStatus code: "+e+' details: "'+t+'"'),this.reportStatus({code:e,details:t,metadata:new Gk.Metadata});for(let{call:r}of this.underlyingCalls)r.cancelWithStatus(e,t)}getPeer(){return this.committedCallIndex!==null?this.underlyingCalls[this.committedCallIndex].call.getPeer():"unknown"}getBufferEntry(e){var t;return(t=this.writeBuffer[e-this.writeBufferOffset])!==null&&t!==void 0?t:{entryType:"FREED",allocated:!1}}getNextBufferIndex(){return this.writeBufferOffset+this.writeBuffer.length}clearSentMessages(){if(this.state!=="COMMITTED")return;let e=this.underlyingCalls[this.committedCallIndex].nextMessageToSend;for(let t=this.writeBufferOffset;t<e;t++){let r=this.getBufferEntry(t);r.allocated&&this.bufferTracker.free(r.message.message.length,this.callNumber)}this.writeBuffer=this.writeBuffer.slice(e-this.writeBufferOffset),this.writeBufferOffset=e}commitCall(e){if(this.state!=="COMMITTED"&&this.underlyingCalls[e].state!=="COMPLETED"){this.trace("Committing call ["+this.underlyingCalls[e].call.getCallNumber()+"] at index "+e),this.state="COMMITTED",this.committedCallIndex=e;for(let t=0;t<this.underlyingCalls.length;t++)t!==e&&this.underlyingCalls[t].state!=="COMPLETED"&&(this.underlyingCalls[t].state="COMPLETED",this.underlyingCalls[t].call.cancelWithStatus(ql.Status.CANCELLED,"Discarded in favor of other hedged attempt"));this.clearSentMessages()}}commitCallWithMostMessages(){if(this.state==="COMMITTED")return;let e=-1,t=-1;for(let[r,i]of this.underlyingCalls.entries())i.state==="ACTIVE"&&i.nextMessageToSend>e&&(e=i.nextMessageToSend,t=r);t===-1?this.state="TRANSPARENT_ONLY":this.commitCall(t)}isStatusCodeInList(e,t){return e.some(r=>r===t||r.toString().toLowerCase()===ql.Status[t].toLowerCase())}getNextRetryBackoffMs(){var e;let t=(e=this.callConfig)===null||e===void 0?void 0:e.methodConfig.retryPolicy;if(!t)return 0;let r=Math.random()*this.nextRetryBackoffSec*1e3,i=Number(t.maxBackoff.substring(0,t.maxBackoff.length-1));return this.nextRetryBackoffSec=Math.min(this.nextRetryBackoffSec*t.backoffMultiplier,i),r}maybeRetryCall(e,t){if(this.state!=="RETRY"){t(!1);return}let r=this.callConfig.methodConfig.retryPolicy;if(this.attempts>=Math.min(r.maxAttempts,5)){t(!1);return}let i;if(e===null)i=this.getNextRetryBackoffMs();else if(e<0){this.state="TRANSPARENT_ONLY",t(!1);return}else i=e,this.nextRetryBackoffSec=this.initialRetryBackoffSec;setTimeout(()=>{var s,a;if(this.state!=="RETRY"){t(!1);return}(!((a=(s=this.retryThrottler)===null||s===void 0?void 0:s.canRetryCall())!==null&&a!==void 0)||a)&&(t(!0),this.attempts+=1,this.startNewAttempt())},i)}countActiveCalls(){let e=0;for(let t of this.underlyingCalls)t?.state==="ACTIVE"&&(e+=1);return e}handleProcessedStatus(e,t,r){var i,s,a;switch(this.state){case"COMMITTED":case"TRANSPARENT_ONLY":this.commitCall(t),this.reportStatus(e);break;case"HEDGING":if(this.isStatusCodeInList((i=this.callConfig.methodConfig.hedgingPolicy.nonFatalStatusCodes)!==null&&i!==void 0?i:[],e.code)){(s=this.retryThrottler)===null||s===void 0||s.addCallFailed();let o;if(r===null)o=0;else if(r<0){this.state="TRANSPARENT_ONLY",this.commitCall(t),this.reportStatus(e);return}else o=r;setTimeout(()=>{this.maybeStartHedgingAttempt(),this.countActiveCalls()===0&&(this.commitCall(t),this.reportStatus(e))},o)}else this.commitCall(t),this.reportStatus(e);break;case"RETRY":this.isStatusCodeInList(this.callConfig.methodConfig.retryPolicy.retryableStatusCodes,e.code)?((a=this.retryThrottler)===null||a===void 0||a.addCallFailed(),this.maybeRetryCall(r,o=>{o||(this.commitCall(t),this.reportStatus(e))})):(this.commitCall(t),this.reportStatus(e));break}}getPushback(e){let t=e.get("grpc-retry-pushback-ms");if(t.length===0)return null;try{return parseInt(t[0])}catch{return-1}}handleChildStatus(e,t){var r;if(this.underlyingCalls[t].state==="COMPLETED")return;if(this.trace("state="+this.state+" handling status with progress "+e.progress+" from child ["+this.underlyingCalls[t].call.getCallNumber()+"] in state "+this.underlyingCalls[t].state),this.underlyingCalls[t].state="COMPLETED",e.code===ql.Status.OK){(r=this.retryThrottler)===null||r===void 0||r.addCallSucceeded(),this.commitCall(t),this.reportStatus(e);return}if(this.state==="COMMITTED"){this.reportStatus(e);return}let i=this.getPushback(e.metadata);switch(e.progress){case"NOT_STARTED":this.startNewAttempt();break;case"REFUSED":this.transparentRetryUsed?this.handleProcessedStatus(e,t,i):(this.transparentRetryUsed=!0,this.startNewAttempt());break;case"DROP":this.commitCall(t),this.reportStatus(e);break;case"PROCESSED":this.handleProcessedStatus(e,t,i);break}}maybeStartHedgingAttempt(){if(this.state!=="HEDGING"||!this.callConfig.methodConfig.hedgingPolicy)return;let e=this.callConfig.methodConfig.hedgingPolicy;this.attempts>=Math.min(e.maxAttempts,5)||(this.attempts+=1,this.startNewAttempt(),this.maybeStartHedgingTimer())}maybeStartHedgingTimer(){var e,t,r;if(this.hedgingTimer&&clearTimeout(this.hedgingTimer),this.state!=="HEDGING"||!this.callConfig.methodConfig.hedgingPolicy)return;let i=this.callConfig.methodConfig.hedgingPolicy;if(this.attempts>=Math.min(i.maxAttempts,5))return;let s=(e=i.hedgingDelay)!==null&&e!==void 0?e:"0s",a=Number(s.substring(0,s.length-1));this.hedgingTimer=setTimeout(()=>{this.maybeStartHedgingAttempt()},a*1e3),(r=(t=this.hedgingTimer).unref)===null||r===void 0||r.call(t)}startNewAttempt(){let e=this.channel.createLoadBalancingCall(this.callConfig,this.methodName,this.host,this.credentials,this.deadline);this.trace("Created child call ["+e.getCallNumber()+"] for attempt "+this.attempts);let t=this.underlyingCalls.length;this.underlyingCalls.push({state:"ACTIVE",call:e,nextMessageToSend:0});let r=this.attempts-1,i=this.initialMetadata.clone();r>0&&i.set(Mf,`${r}`);let s=!1;e.start(i,{onReceiveMetadata:a=>{this.trace("Received metadata from child ["+e.getCallNumber()+"]"),this.commitCall(t),s=!0,r>0&&a.set(Mf,`${r}`),this.underlyingCalls[t].state==="ACTIVE"&&this.listener.onReceiveMetadata(a)},onReceiveMessage:a=>{this.trace("Received message from child ["+e.getCallNumber()+"]"),this.commitCall(t),this.underlyingCalls[t].state==="ACTIVE"&&this.listener.onReceiveMessage(a)},onReceiveStatus:a=>{this.trace("Received status from child ["+e.getCallNumber()+"]"),!s&&r>0&&a.metadata.set(Mf,`${r}`),this.handleChildStatus(a,t)}}),this.sendNextChildMessage(t),this.readStarted&&e.startRead()}start(e,t){this.trace("start called"),this.listener=t,this.initialMetadata=e,this.attempts+=1,this.startNewAttempt(),this.maybeStartHedgingTimer()}handleChildWriteCompleted(e){var t,r;let i=this.underlyingCalls[e],s=i.nextMessageToSend;(r=(t=this.getBufferEntry(s)).callback)===null||r===void 0||r.call(t),this.clearSentMessages(),i.nextMessageToSend+=1,this.sendNextChildMessage(e)}sendNextChildMessage(e){let t=this.underlyingCalls[e];if(t.state!=="COMPLETED"&&this.getBufferEntry(t.nextMessageToSend)){let r=this.getBufferEntry(t.nextMessageToSend);switch(r.entryType){case"MESSAGE":t.call.sendMessageWithContext({callback:i=>{this.handleChildWriteCompleted(e)}},r.message.message);break;case"HALF_CLOSE":t.nextMessageToSend+=1,t.call.halfClose();break;case"FREED":break}}}sendMessageWithContext(e,t){var r;this.trace("write() called with message of length "+t.length);let i={message:t,flags:e.flags},s=this.getNextBufferIndex(),a={entryType:"MESSAGE",message:i,allocated:this.bufferTracker.allocate(t.length,this.callNumber)};if(this.writeBuffer.push(a),a.allocated){(r=e.callback)===null||r===void 0||r.call(e);for(let[o,l]of this.underlyingCalls.entries())l.state==="ACTIVE"&&l.nextMessageToSend===s&&l.call.sendMessageWithContext({callback:c=>{this.handleChildWriteCompleted(o)}},t)}else{if(this.commitCallWithMostMessages(),this.committedCallIndex===null)return;let o=this.underlyingCalls[this.committedCallIndex];a.callback=e.callback,o.state==="ACTIVE"&&o.nextMessageToSend===s&&o.call.sendMessageWithContext({callback:l=>{this.handleChildWriteCompleted(this.committedCallIndex)}},t)}}startRead(){this.trace("startRead called"),this.readStarted=!0;for(let e of this.underlyingCalls)e?.state==="ACTIVE"&&e.call.startRead()}halfClose(){this.trace("halfClose called");let e=this.getNextBufferIndex();this.writeBuffer.push({entryType:"HALF_CLOSE",allocated:!1});for(let t of this.underlyingCalls)t?.state==="ACTIVE"&&t.nextMessageToSend===e&&(t.nextMessageToSend+=1,t.call.halfClose())}setCredentials(e){throw new Error("Method not implemented.")}getMethod(){return this.methodName}getHost(){return this.host}};dr.RetryingCall=Ff});var zl=R(Vl=>{"use strict";Object.defineProperty(Vl,"__esModule",{value:!0});Vl.BaseSubchannelWrapper=void 0;var Bf=class{constructor(e){this.child=e}getConnectivityState(){return this.child.getConnectivityState()}addConnectivityStateListener(e){this.child.addConnectivityStateListener(e)}removeConnectivityStateListener(e){this.child.removeConnectivityStateListener(e)}startConnecting(){this.child.startConnecting()}getAddress(){return this.child.getAddress()}throttleKeepalive(e){this.child.throttleKeepalive(e)}ref(){this.child.ref()}unref(){this.child.unref()}getChannelzRef(){return this.child.getChannelzRef()}getRealSubchannel(){return this.child.getRealSubchannel()}realSubchannelEquals(e){return this.getRealSubchannel()===e.getRealSubchannel()}};Vl.BaseSubchannelWrapper=Bf});var SS=R(jl=>{"use strict";Object.defineProperty(jl,"__esModule",{value:!0});jl.InternalChannel=void 0;var Kk=Ao(),Hk=Y_(),Wk=cS(),vS=Qn(),va=le(),Qk=wf(),Yk=fS(),bS=Wt(),Uf=be(),Jk=hf(),Gl=ht(),un=St(),ba=Ur(),Zk=mS(),Xk=Ol(),e2=yS(),qf=gf(),t2=Ml(),Vf=_S(),n2=zl(),r2=2147483647,i2=1e3,s2=1800*1e3,$l=new Map,a2=1<<24,o2=1<<20,zf=class extends n2.BaseSubchannelWrapper{constructor(e,t){super(e),this.channel=t,this.refCount=0,this.subchannelStateListener=(r,i,s,a)=>{t.throttleKeepalive(a)},e.addConnectivityStateListener(this.subchannelStateListener)}ref(){this.child.ref(),this.refCount+=1}unref(){this.child.unref(),this.refCount-=1,this.refCount<=0&&(this.child.removeConnectivityStateListener(this.subchannelStateListener),this.channel.removeWrappedSubchannel(this))}},Gf=class{constructor(e,t,r){var i,s,a,o,l,c,u,m;if(this.credentials=t,this.options=r,this.connectivityState=un.ConnectivityState.IDLE,this.currentPicker=new vS.UnavailablePicker,this.configSelectionQueue=[],this.pickQueue=[],this.connectivityStateWatchers=[],this.configSelector=null,this.currentResolutionError=null,this.wrappedSubchannels=new Set,this.callCount=0,this.idleTimer=null,this.channelzEnabled=!0,this.callTracker=new ba.ChannelzCallTracker,this.childrenTracker=new ba.ChannelzChildrenTracker,typeof e!="string")throw new TypeError("Channel target must be a string");if(!(t instanceof Kk.ChannelCredentials))throw new TypeError("Channel credentials must be a ChannelCredentials object");if(r&&typeof r!="object")throw new TypeError("Channel options must be an object");this.originalTarget=e;let d=(0,Gl.parseUri)(e);if(d===null)throw new Error(`Could not parse target name "${e}"`);let p=(0,bS.mapUriDefaultScheme)(d);if(p===null)throw new Error(`Could not find a default scheme for target name "${e}"`);this.callRefTimer=setInterval(()=>{},r2),(s=(i=this.callRefTimer).unref)===null||s===void 0||s.call(i),this.options["grpc.enable_channelz"]===0&&(this.channelzEnabled=!1),this.channelzTrace=new ba.ChannelzTrace,this.channelzRef=(0,ba.registerChannelzChannel)(e,()=>this.getChannelzInfo(),this.channelzEnabled),this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Channel created"),this.options["grpc.default_authority"]?this.defaultAuthority=this.options["grpc.default_authority"]:this.defaultAuthority=(0,bS.getDefaultAuthority)(p);let E=(0,Jk.mapProxyName)(p,r);this.target=E.target,this.options=Object.assign({},this.options,E.extraOptions),this.subchannelPool=(0,Wk.getSubchannelPool)(((a=r["grpc.use_local_subchannel_pool"])!==null&&a!==void 0?a:0)===0),this.retryBufferTracker=new Vf.MessageBufferTracker((o=r["grpc.retry_buffer_size"])!==null&&o!==void 0?o:a2,(l=r["grpc.per_rpc_retry_buffer_size"])!==null&&l!==void 0?l:o2),this.keepaliveTime=(c=r["grpc.keepalive_time_ms"])!==null&&c!==void 0?c:-1,this.idleTimeoutMs=Math.max((u=r["grpc.client_idle_timeout_ms"])!==null&&u!==void 0?u:s2,i2);let C={createSubchannel:(I,N)=>{let A=this.subchannelPool.getOrCreateSubchannel(this.target,I,Object.assign({},this.options,N),this.credentials);A.throttleKeepalive(this.keepaliveTime),this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Created subchannel or used existing subchannel",A.getChannelzRef());let S=new zf(A,this);return this.wrappedSubchannels.add(S),S},updateState:(I,N)=>{this.currentPicker=N;let A=this.pickQueue.slice();this.pickQueue=[],A.length>0&&this.callRefTimerUnref();for(let S of A)S.doPick();this.updateState(I)},requestReresolution:()=>{throw new Error("Resolving load balancer should never call requestReresolution")},addChannelzChild:I=>{this.channelzEnabled&&this.childrenTracker.refChild(I)},removeChannelzChild:I=>{this.channelzEnabled&&this.childrenTracker.unrefChild(I)}};this.resolvingLoadBalancer=new Hk.ResolvingLoadBalancer(this.target,C,r,(I,N)=>{I.retryThrottling?$l.set(this.getTarget(),new Vf.RetryThrottler(I.retryThrottling.maxTokens,I.retryThrottling.tokenRatio,$l.get(this.getTarget()))):$l.delete(this.getTarget()),this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Address resolution succeeded"),this.configSelector=N,this.currentResolutionError=null,process.nextTick(()=>{let A=this.configSelectionQueue;this.configSelectionQueue=[],A.length>0&&this.callRefTimerUnref();for(let S of A)S.getConfig()})},I=>{this.channelzEnabled&&this.channelzTrace.addTrace("CT_WARNING","Address resolution failed with code "+I.code+' and details "'+I.details+'"'),this.configSelectionQueue.length>0&&this.trace("Name resolution failed with calls queued for config selection"),this.configSelector===null&&(this.currentResolutionError=Object.assign(Object.assign({},(0,t2.restrictControlPlaneStatusCode)(I.code,I.details)),{metadata:I.metadata}));let N=this.configSelectionQueue;this.configSelectionQueue=[],N.length>0&&this.callRefTimerUnref();for(let A of N)A.reportResolverError(I)}),this.filterStackFactory=new Qk.FilterStackFactory([new Yk.CompressionFilterFactory(this,this.options)]),this.trace("Channel constructed with options "+JSON.stringify(r,void 0,2));let T=new Error;(0,Uf.trace)(va.LogVerbosity.DEBUG,"channel_stacktrace","("+this.channelzRef.id+`) Channel constructed 
`+((m=T.stack)===null||m===void 0?void 0:m.substring(T.stack.indexOf(`
`)+1))),this.lastActivityTimestamp=new Date}getChannelzInfo(){return{target:this.originalTarget,state:this.connectivityState,trace:this.channelzTrace,callTracker:this.callTracker,children:this.childrenTracker.getChildLists()}}trace(e,t){(0,Uf.trace)(t??va.LogVerbosity.DEBUG,"channel","("+this.channelzRef.id+") "+(0,Gl.uriToString)(this.target)+" "+e)}callRefTimerRef(){var e,t,r,i;!((t=(e=this.callRefTimer).hasRef)===null||t===void 0)&&t.call(e)||(this.trace("callRefTimer.ref | configSelectionQueue.length="+this.configSelectionQueue.length+" pickQueue.length="+this.pickQueue.length),(i=(r=this.callRefTimer).ref)===null||i===void 0||i.call(r))}callRefTimerUnref(){var e,t;(!this.callRefTimer.hasRef||this.callRefTimer.hasRef())&&(this.trace("callRefTimer.unref | configSelectionQueue.length="+this.configSelectionQueue.length+" pickQueue.length="+this.pickQueue.length),(t=(e=this.callRefTimer).unref)===null||t===void 0||t.call(e))}removeConnectivityStateWatcher(e){let t=this.connectivityStateWatchers.findIndex(r=>r===e);t>=0&&this.connectivityStateWatchers.splice(t,1)}updateState(e){(0,Uf.trace)(va.LogVerbosity.DEBUG,"connectivity_state","("+this.channelzRef.id+") "+(0,Gl.uriToString)(this.target)+" "+un.ConnectivityState[this.connectivityState]+" -> "+un.ConnectivityState[e]),this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Connectivity state change to "+un.ConnectivityState[e]),this.connectivityState=e;let t=this.connectivityStateWatchers.slice();for(let r of t)e!==r.currentState&&(r.timer&&clearTimeout(r.timer),this.removeConnectivityStateWatcher(r),r.callback());e!==un.ConnectivityState.TRANSIENT_FAILURE&&(this.currentResolutionError=null)}throttleKeepalive(e){if(e>this.keepaliveTime){this.keepaliveTime=e;for(let t of this.wrappedSubchannels)t.throttleKeepalive(e)}}removeWrappedSubchannel(e){this.wrappedSubchannels.delete(e)}doPick(e,t){return this.currentPicker.pick({metadata:e,extraPickInfo:t})}queueCallForPick(e){this.pickQueue.push(e),this.callRefTimerRef()}getConfig(e,t){return this.resolvingLoadBalancer.exitIdle(),this.configSelector?{type:"SUCCESS",config:this.configSelector(e,t)}:this.currentResolutionError?{type:"ERROR",error:this.currentResolutionError}:{type:"NONE"}}queueCallForConfig(e){this.configSelectionQueue.push(e),this.callRefTimerRef()}enterIdle(){this.resolvingLoadBalancer.destroy(),this.updateState(un.ConnectivityState.IDLE),this.currentPicker=new vS.QueuePicker(this.resolvingLoadBalancer),this.idleTimer&&(clearTimeout(this.idleTimer),this.idleTimer=null)}startIdleTimeout(e){var t,r;this.idleTimer=setTimeout(()=>{if(this.callCount>0){this.startIdleTimeout(this.idleTimeoutMs);return}let s=new Date().valueOf()-this.lastActivityTimestamp.valueOf();s>=this.idleTimeoutMs?(this.trace("Idle timer triggered after "+this.idleTimeoutMs+"ms of inactivity"),this.enterIdle()):this.startIdleTimeout(this.idleTimeoutMs-s)},e),(r=(t=this.idleTimer).unref)===null||r===void 0||r.call(t)}maybeStartIdleTimer(){this.connectivityState!==un.ConnectivityState.SHUTDOWN&&!this.idleTimer&&this.startIdleTimeout(this.idleTimeoutMs)}onCallStart(){this.channelzEnabled&&this.callTracker.addCallStarted(),this.callCount+=1}onCallEnd(e){this.channelzEnabled&&(e.code===va.Status.OK?this.callTracker.addCallSucceeded():this.callTracker.addCallFailed()),this.callCount-=1,this.lastActivityTimestamp=new Date,this.maybeStartIdleTimer()}createLoadBalancingCall(e,t,r,i,s){let a=(0,qf.getNextCallNumber)();return this.trace("createLoadBalancingCall ["+a+'] method="'+t+'"'),new Zk.LoadBalancingCall(this,e,t,r,i,s,a)}createRetryingCall(e,t,r,i,s){let a=(0,qf.getNextCallNumber)();return this.trace("createRetryingCall ["+a+'] method="'+t+'"'),new Vf.RetryingCall(this,e,t,r,i,s,a,this.retryBufferTracker,$l.get(this.getTarget()))}createInnerCall(e,t,r,i,s){return this.options["grpc.enable_retries"]===0?this.createLoadBalancingCall(e,t,r,i,s):this.createRetryingCall(e,t,r,i,s)}createResolvingCall(e,t,r,i,s){let a=(0,qf.getNextCallNumber)();this.trace("createResolvingCall ["+a+'] method="'+e+'", deadline='+(0,Xk.deadlineToString)(t));let o={deadline:t,flags:s??va.Propagate.DEFAULTS,host:r??this.defaultAuthority,parentCall:i},l=new e2.ResolvingCall(this,e,o,this.filterStackFactory.clone(),this.credentials._getCallCredentials(),a);return this.onCallStart(),l.addStatusWatcher(c=>{this.onCallEnd(c)}),l}close(){this.resolvingLoadBalancer.destroy(),this.updateState(un.ConnectivityState.SHUTDOWN),clearInterval(this.callRefTimer),this.idleTimer&&clearTimeout(this.idleTimer),this.channelzEnabled&&(0,ba.unregisterChannelzRef)(this.channelzRef),this.subchannelPool.unrefUnusedSubchannels()}getTarget(){return(0,Gl.uriToString)(this.target)}getConnectivityState(e){let t=this.connectivityState;return e&&(this.resolvingLoadBalancer.exitIdle(),this.lastActivityTimestamp=new Date,this.maybeStartIdleTimer()),t}watchConnectivityState(e,t,r){if(this.connectivityState===un.ConnectivityState.SHUTDOWN)throw new Error("Channel has been shut down");let i=null;if(t!==1/0){let a=t instanceof Date?t:new Date(t),o=new Date;if(t===-1/0||a<=o){process.nextTick(r,new Error("Deadline passed without connectivity state change"));return}i=setTimeout(()=>{this.removeConnectivityStateWatcher(s),r(new Error("Deadline passed without connectivity state change"))},a.getTime()-o.getTime())}let s={currentState:e,callback:r,timer:i};this.connectivityStateWatchers.push(s)}getChannelzRef(){return this.channelzRef}createCall(e,t,r,i,s){if(typeof e!="string")throw new TypeError("Channel#createCall: method must be a string");if(!(typeof t=="number"||t instanceof Date))throw new TypeError("Channel#createCall: deadline must be a number or Date");if(this.connectivityState===un.ConnectivityState.SHUTDOWN)throw new Error("Channel has been shut down");return this.createResolvingCall(e,t,r,i,s)}};jl.InternalChannel=Gf});var jd=R(Kl=>{"use strict";Object.defineProperty(Kl,"__esModule",{value:!0});Kl.ChannelImplementation=void 0;var l2=Ao(),c2=SS(),$f=class{constructor(e,t,r){if(typeof e!="string")throw new TypeError("Channel target must be a string");if(!(t instanceof l2.ChannelCredentials))throw new TypeError("Channel credentials must be a ChannelCredentials object");if(r&&typeof r!="object")throw new TypeError("Channel options must be an object");this.internalChannel=new c2.InternalChannel(e,t,r)}close(){this.internalChannel.close()}getTarget(){return this.internalChannel.getTarget()}getConnectivityState(e){return this.internalChannel.getConnectivityState(e)}watchConnectivityState(e,t,r){this.internalChannel.watchConnectivityState(e,t,r)}getChannelzRef(){return this.internalChannel.getChannelzRef()}createCall(e,t,r,i,s){if(typeof e!="string")throw new TypeError("Channel#createCall: method must be a string");if(!(typeof t=="number"||t instanceof Date))throw new TypeError("Channel#createCall: deadline must be a number or Date");return this.internalChannel.createCall(e,t,r,i,s)}};Kl.ChannelImplementation=$f});var xS=R(Rt=>{"use strict";Object.defineProperty(Rt,"__esModule",{value:!0});Rt.Http2ServerCallStream=Rt.ServerDuplexStreamImpl=Rt.ServerWritableStreamImpl=Rt.ServerReadableStreamImpl=Rt.ServerUnaryCallImpl=void 0;var AS=require("events"),Gi=require("http2"),Hf=require("stream"),ES=require("zlib"),fe=le(),Wf=st(),u2=pf(),RS=be(),Ea=So(),DS="server_call";function Sa(n){RS.trace(fe.LogVerbosity.DEBUG,DS,n)}var d2="grpc-accept-encoding",h2="grpc-encoding",wS="grpc-message",TS="grpc-status",CS="grpc-timeout",f2=/(\d{1,8})\s*([HMSmun])/,p2={H:36e5,M:6e4,S:1e3,m:1,u:.001,n:1e-6},m2={[d2]:"identity,deflate,gzip",[h2]:"identity"},IS={[Gi.constants.HTTP2_HEADER_STATUS]:Gi.constants.HTTP_STATUS_OK,[Gi.constants.HTTP2_HEADER_CONTENT_TYPE]:"application/grpc+proto"},g2={waitForTrailers:!0},jf=class extends AS.EventEmitter{constructor(e,t,r){super(),this.call=e,this.metadata=t,this.request=r,this.cancelled=!1,this.call.setupSurfaceCall(this)}getPeer(){return this.call.getPeer()}sendMetadata(e){this.call.sendMetadata(e)}getDeadline(){return this.call.getDeadline()}getPath(){return this.call.getPath()}};Rt.ServerUnaryCallImpl=jf;var Hl=class extends Hf.Readable{constructor(e,t,r,i){super({objectMode:!0}),this.call=e,this.metadata=t,this.deserialize=r,this.cancelled=!1,this.call.setupSurfaceCall(this),this.call.setupReadable(this,i)}_read(e){this.call.consumeUnpushedMessages(this)&&this.call.resume()}getPeer(){return this.call.getPeer()}sendMetadata(e){this.call.sendMetadata(e)}getDeadline(){return this.call.getDeadline()}getPath(){return this.call.getPath()}};Rt.ServerReadableStreamImpl=Hl;var wa=class extends Hf.Writable{constructor(e,t,r,i){super({objectMode:!0}),this.call=e,this.metadata=t,this.serialize=r,this.request=i,this.cancelled=!1,this.trailingMetadata=new Wf.Metadata,this.call.setupSurfaceCall(this),this.on("error",s=>{this.call.sendError(s),this.end()})}getPeer(){return this.call.getPeer()}sendMetadata(e){this.call.sendMetadata(e)}getDeadline(){return this.call.getDeadline()}getPath(){return this.call.getPath()}_write(e,t,r){try{let i=this.call.serializeMessage(e);if(!this.call.write(i)){this.call.once("drain",r);return}}catch(i){this.emit("error",{details:(0,Ea.getErrorMessage)(i),code:fe.Status.INTERNAL})}r()}_final(e){this.call.sendStatus({code:fe.Status.OK,details:"OK",metadata:this.trailingMetadata}),e(null)}end(e){return e&&(this.trailingMetadata=e),super.end()}};Rt.ServerWritableStreamImpl=wa;var $i=class extends Hf.Duplex{constructor(e,t,r,i,s){super({objectMode:!0}),this.call=e,this.metadata=t,this.serialize=r,this.deserialize=i,this.cancelled=!1,this.trailingMetadata=new Wf.Metadata,this.call.setupSurfaceCall(this),this.call.setupReadable(this,s),this.on("error",a=>{this.call.sendError(a),this.end()})}getPeer(){return this.call.getPeer()}sendMetadata(e){this.call.sendMetadata(e)}getDeadline(){return this.call.getDeadline()}getPath(){return this.call.getPath()}end(e){return e&&(this.trailingMetadata=e),super.end()}};Rt.ServerDuplexStreamImpl=$i;$i.prototype._read=Hl.prototype._read;$i.prototype._write=wa.prototype._write;$i.prototype._final=wa.prototype._final;var Kf=class extends AS.EventEmitter{constructor(e,t,r){super(),this.stream=e,this.handler=t,this.cancelled=!1,this.deadlineTimer=null,this.statusSent=!1,this.deadline=1/0,this.wantTrailers=!1,this.metadataSent=!1,this.canPush=!1,this.isPushPending=!1,this.bufferedMessages=[],this.messagesToPush=[],this.maxSendMessageSize=fe.DEFAULT_MAX_SEND_MESSAGE_LENGTH,this.maxReceiveMessageSize=fe.DEFAULT_MAX_RECEIVE_MESSAGE_LENGTH,this.stream.once("error",i=>{}),this.stream.once("close",()=>{var i;Sa("Request to method "+((i=this.handler)===null||i===void 0?void 0:i.path)+" stream closed with rstCode "+this.stream.rstCode),this.statusSent||(this.cancelled=!0,this.emit("cancelled","cancelled"),this.emit("streamEnd",!1),this.sendStatus({code:fe.Status.CANCELLED,details:"Cancelled by client",metadata:null}),this.deadlineTimer&&clearTimeout(this.deadlineTimer))}),this.stream.on("drain",()=>{this.emit("drain")}),"grpc.max_send_message_length"in r&&(this.maxSendMessageSize=r["grpc.max_send_message_length"]),"grpc.max_receive_message_length"in r&&(this.maxReceiveMessageSize=r["grpc.max_receive_message_length"])}checkCancelled(){return(this.stream.destroyed||this.stream.closed)&&(this.cancelled=!0),this.cancelled}getDecompressedMessage(e,t){let r=e.subarray(5);if(t==="identity")return r;if(t==="deflate"||t==="gzip"){let i;return t==="deflate"?i=ES.createInflate():i=ES.createGunzip(),new Promise((s,a)=>{let o=0,l=[];i.on("data",c=>{l.push(c),o+=c.byteLength,this.maxReceiveMessageSize!==-1&&o>this.maxReceiveMessageSize&&(i.destroy(),a({code:fe.Status.RESOURCE_EXHAUSTED,details:`Received message that decompresses to a size larger than ${this.maxReceiveMessageSize}`}))}),i.on("end",()=>{s(Buffer.concat(l))}),i.write(r),i.end()})}else return Promise.reject({code:fe.Status.UNIMPLEMENTED,details:`Received message compressed with unsupported encoding "${t}"`})}sendMetadata(e){if(this.checkCancelled()||this.metadataSent)return;this.metadataSent=!0;let t=e?e.toHttp2Headers():null,r=Object.assign(Object.assign(Object.assign({},IS),m2),t);this.stream.respond(r,g2)}receiveMetadata(e){let t=Wf.Metadata.fromHttp2Headers(e);RS.isTracerEnabled(DS)&&Sa("Request to "+this.handler.path+" received headers "+JSON.stringify(t.toJSON()));let r=t.get(CS);if(r.length>0){let i=r[0].toString().match(f2);if(i===null){let o=new Error("Invalid deadline");return o.code=fe.Status.OUT_OF_RANGE,this.sendError(o),t}let s=+i[1]*p2[i[2]]|0,a=new Date;this.deadline=a.setMilliseconds(a.getMilliseconds()+s),this.deadlineTimer=setTimeout(y2,s,this),t.remove(CS)}return t.remove(Gi.constants.HTTP2_HEADER_ACCEPT_ENCODING),t.remove(Gi.constants.HTTP2_HEADER_TE),t.remove(Gi.constants.HTTP2_HEADER_CONTENT_TYPE),t.remove("grpc-accept-encoding"),t}receiveUnaryMessage(e){return new Promise((t,r)=>{let{stream:i}=this,s=0,a=this,o=[],l=this.maxReceiveMessageSize;this.stream.on("data",c),this.stream.on("end",u),this.stream.on("error",u);function c(m){if(s+=m.byteLength,l!==-1&&s>l){i.removeListener("data",c),i.removeListener("end",u),i.removeListener("error",u),r({code:fe.Status.RESOURCE_EXHAUSTED,details:`Received message larger than max (${s} vs. ${l})`});return}o.push(m)}function u(m){if(i.removeListener("data",c),i.removeListener("end",u),i.removeListener("error",u),m!==void 0){r({code:fe.Status.INTERNAL,details:m.message});return}if(s===0){r({code:fe.Status.INTERNAL,details:"received empty unary message"});return}a.emit("receiveMessage");let d=Buffer.concat(o,s),E=d.readUInt8(0)===1?e:"identity",C=a.getDecompressedMessage(d,E);if(Buffer.isBuffer(C)){t(a.deserializeMessageWithInternalError(C));return}C.then(T=>t(a.deserializeMessageWithInternalError(T)),T=>r(T.code?T:{code:fe.Status.INTERNAL,details:`Received "grpc-encoding" header "${e}" but ${e} decompression failed`}))}})}async deserializeMessageWithInternalError(e){try{return this.deserializeMessage(e)}catch(t){throw{details:(0,Ea.getErrorMessage)(t),code:fe.Status.INTERNAL}}}serializeMessage(e){let t=this.handler.serialize(e),r=t.byteLength,i=Buffer.allocUnsafe(r+5);return i.writeUInt8(0,0),i.writeUInt32BE(r,1),t.copy(i,5),i}deserializeMessage(e){return this.handler.deserialize(e)}async sendUnaryMessage(e,t,r,i){if(!this.checkCancelled()){if(r===void 0&&(r=null),e){!Object.prototype.hasOwnProperty.call(e,"metadata")&&r&&(e.metadata=r),this.sendError(e);return}try{let s=this.serializeMessage(t);this.write(s),this.sendStatus({code:fe.Status.OK,details:"OK",metadata:r})}catch(s){this.sendError({details:(0,Ea.getErrorMessage)(s),code:fe.Status.INTERNAL})}}}sendStatus(e){var t,r;if(this.emit("callEnd",e.code),this.emit("streamEnd",e.code===fe.Status.OK),!this.checkCancelled())if(Sa("Request to method "+((t=this.handler)===null||t===void 0?void 0:t.path)+" ended with status code: "+fe.Status[e.code]+" details: "+e.details),this.deadlineTimer&&clearTimeout(this.deadlineTimer),this.stream.headersSent)this.wantTrailers||(this.wantTrailers=!0,this.stream.once("wantTrailers",()=>{var i;let s=Object.assign({[TS]:e.code,[wS]:encodeURI(e.details)},(i=e.metadata)===null||i===void 0?void 0:i.toHttp2Headers());this.stream.sendTrailers(s),this.statusSent=!0}),this.stream.end());else{let i=Object.assign(Object.assign({[TS]:e.code,[wS]:encodeURI(e.details)},IS),(r=e.metadata)===null||r===void 0?void 0:r.toHttp2Headers());this.stream.respond(i,{endStream:!0}),this.statusSent=!0}}sendError(e){let t={code:fe.Status.UNKNOWN,details:"message"in e?e.message:"Unknown Error",metadata:"metadata"in e&&e.metadata!==void 0?e.metadata:null};"code"in e&&typeof e.code=="number"&&Number.isInteger(e.code)&&(t.code=e.code,"details"in e&&typeof e.details=="string"&&(t.details=e.details)),this.sendStatus(t)}write(e){if(!this.checkCancelled()){if(this.maxSendMessageSize!==-1&&e.length>this.maxSendMessageSize){this.sendError({code:fe.Status.RESOURCE_EXHAUSTED,details:`Sent message larger than max (${e.length} vs. ${this.maxSendMessageSize})`});return}return this.sendMetadata(),this.emit("sendMessage"),this.stream.write(e)}}resume(){this.stream.resume()}setupSurfaceCall(e){this.once("cancelled",t=>{e.cancelled=!0,e.emit("cancelled",t)}),this.once("callEnd",t=>e.emit("callEnd",t))}setupReadable(e,t){let r=new u2.StreamDecoder(this.maxReceiveMessageSize),i=!1,s=!1,a=!1,o=async()=>{!a&&i&&!s&&(a=!0,await this.pushOrBufferMessage(e,null))};this.stream.on("data",async l=>{let c;try{c=r.write(l)}catch(u){this.sendError({code:fe.Status.RESOURCE_EXHAUSTED,details:u.message});return}s=!0,this.stream.pause();for(let u of c){this.emit("receiveMessage");let d=u.readUInt8(0)===1?t:"identity",p;try{p=await this.getDecompressedMessage(u,d)}catch(E){this.sendError(E);return}if(!p)return;await this.pushOrBufferMessage(e,p)}s=!1,this.stream.resume(),await o()}),this.stream.once("end",async()=>{i=!0,await o()})}consumeUnpushedMessages(e){for(this.canPush=!0;this.messagesToPush.length>0;){let t=this.messagesToPush.shift(),r=e.push(t);if(t===null||r===!1){this.canPush=!1;break}}return this.canPush}async pushOrBufferMessage(e,t){this.isPushPending?this.bufferedMessages.push(t):await this.pushMessage(e,t)}async pushMessage(e,t){if(t===null){Sa("Received end of stream"),this.canPush?e.push(null):this.messagesToPush.push(null);return}Sa("Received message of length "+t.length),this.isPushPending=!0;try{let r=await this.deserializeMessage(t);this.canPush?e.push(r)||(this.canPush=!1,this.stream.pause()):this.messagesToPush.push(r)}catch(r){this.bufferedMessages.length=0;let i=(0,Ea.getErrorCode)(r);(i===null||i<fe.Status.OK||i>fe.Status.UNAUTHENTICATED)&&(i=fe.Status.INTERNAL),e.emit("error",{details:(0,Ea.getErrorMessage)(r),code:i})}this.isPushPending=!1,this.bufferedMessages.length>0&&await this.pushMessage(e,this.bufferedMessages.shift())}getPeer(){var e;let t=(e=this.stream.session)===null||e===void 0?void 0:e.socket;return t?.remoteAddress?t.remotePort?`${t.remoteAddress}:${t.remotePort}`:t.remoteAddress:"unknown"}getDeadline(){return this.deadline}getPath(){return this.handler.path}};Rt.Http2ServerCallStream=Kf;function y2(n){let e=new Error("Deadline exceeded");e.code=fe.Status.DEADLINE_EXCEEDED,n.sendError(e),n.cancelled=!0,n.emit("cancelled","deadline")}});var Jf=R(Wl=>{"use strict";Object.defineProperty(Wl,"__esModule",{value:!0});Wl.ServerCredentials=void 0;var NS=md(),Ta=class{static createInsecure(){return new Qf}static createSsl(e,t,r=!1){if(e!==null&&!Buffer.isBuffer(e))throw new TypeError("rootCerts must be null or a Buffer");if(!Array.isArray(t))throw new TypeError("keyCertPairs must be an array");if(typeof r!="boolean")throw new TypeError("checkClientCertificate must be a boolean");let i=[],s=[];for(let a=0;a<t.length;a++){let o=t[a];if(o===null||typeof o!="object")throw new TypeError(`keyCertPair[${a}] must be an object`);if(!Buffer.isBuffer(o.private_key))throw new TypeError(`keyCertPair[${a}].private_key must be a Buffer`);if(!Buffer.isBuffer(o.cert_chain))throw new TypeError(`keyCertPair[${a}].cert_chain must be a Buffer`);i.push(o.cert_chain),s.push(o.private_key)}return new Yf({ca:e||(0,NS.getDefaultRootsData)()||void 0,cert:i,key:s,requestCert:r,ciphers:NS.CIPHER_SUITES})}};Wl.ServerCredentials=Ta;var Qf=class extends Ta{_isSecure(){return!1}_getSettings(){return null}},Yf=class extends Ta{constructor(e){super(),this.options=e}_isSecure(){return!0}_getSettings(){return this.options}}});var MS=R(Jl=>{"use strict";Object.defineProperty(Jl,"__esModule",{value:!0});Jl.Server=void 0;var hr=require("http2"),Nn=le(),Vr=xS(),_2=Jf(),OS=Wt(),Ql=be(),Bt=Yt(),v2=ht(),lt=Ur(),Yl=~(1<<31),b2=~(1<<31),S2=2e4,{HTTP2_HEADER_PATH:kS}=hr.constants,E2="server";function w2(){}function Zf(n){return{code:Nn.Status.UNIMPLEMENTED,details:`The server does not implement the method ${n}`}}function T2(n,e){let t=Zf(e);switch(n){case"unary":return(r,i)=>{i(t,null)};case"clientStream":return(r,i)=>{i(t,null)};case"serverStream":return r=>{r.emit("error",t)};case"bidi":return r=>{r.emit("error",t)};default:throw new Error(`Invalid handlerType ${n}`)}}var Xf=class{constructor(e){var t,r,i,s;this.http2ServerList=[],this.handlers=new Map,this.sessions=new Map,this.started=!1,this.shutdown=!1,this.serverAddressString="null",this.channelzEnabled=!0,this.channelzTrace=new lt.ChannelzTrace,this.callTracker=new lt.ChannelzCallTracker,this.listenerChildrenTracker=new lt.ChannelzChildrenTracker,this.sessionChildrenTracker=new lt.ChannelzChildrenTracker,this.options=e??{},this.options["grpc.enable_channelz"]===0&&(this.channelzEnabled=!1),this.channelzRef=(0,lt.registerChannelzServer)(()=>this.getChannelzInfo(),this.channelzEnabled),this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Server created"),this.maxConnectionAgeMs=(t=this.options["grpc.max_connection_age_ms"])!==null&&t!==void 0?t:Yl,this.maxConnectionAgeGraceMs=(r=this.options["grpc.max_connection_age_grace_ms"])!==null&&r!==void 0?r:Yl,this.keepaliveTimeMs=(i=this.options["grpc.keepalive_time_ms"])!==null&&i!==void 0?i:b2,this.keepaliveTimeoutMs=(s=this.options["grpc.keepalive_timeout_ms"])!==null&&s!==void 0?s:S2,this.trace("Server constructed")}getChannelzInfo(){return{trace:this.channelzTrace,callTracker:this.callTracker,listenerChildren:this.listenerChildrenTracker.getChildLists(),sessionChildren:this.sessionChildrenTracker.getChildLists()}}getChannelzSessionInfoGetter(e){return()=>{var t,r,i;let s=this.sessions.get(e),a=e.socket,o=a.remoteAddress?(0,Bt.stringToSubchannelAddress)(a.remoteAddress,a.remotePort):null,l=a.localAddress?(0,Bt.stringToSubchannelAddress)(a.localAddress,a.localPort):null,c;if(e.encrypted){let m=a,d=m.getCipher(),p=m.getCertificate(),E=m.getPeerCertificate();c={cipherSuiteStandardName:(t=d.standardName)!==null&&t!==void 0?t:null,cipherSuiteOtherName:d.standardName?null:d.name,localCertificate:p&&"raw"in p?p.raw:null,remoteCertificate:E&&"raw"in E?E.raw:null}}else c=null;return{remoteAddress:o,localAddress:l,security:c,remoteName:null,streamsStarted:s.streamTracker.callsStarted,streamsSucceeded:s.streamTracker.callsSucceeded,streamsFailed:s.streamTracker.callsFailed,messagesSent:s.messagesSent,messagesReceived:s.messagesReceived,keepAlivesSent:0,lastLocalStreamCreatedTimestamp:null,lastRemoteStreamCreatedTimestamp:s.streamTracker.lastCallStartedTimestamp,lastMessageSentTimestamp:s.lastMessageSentTimestamp,lastMessageReceivedTimestamp:s.lastMessageReceivedTimestamp,localFlowControlWindow:(r=e.state.localWindowSize)!==null&&r!==void 0?r:null,remoteFlowControlWindow:(i=e.state.remoteWindowSize)!==null&&i!==void 0?i:null}}}trace(e){Ql.trace(Nn.LogVerbosity.DEBUG,E2,"("+this.channelzRef.id+") "+e)}addProtoService(){throw new Error("Not implemented. Use addService() instead")}addService(e,t){if(e===null||typeof e!="object"||t===null||typeof t!="object")throw new Error("addService() requires two objects as arguments");let r=Object.keys(e);if(r.length===0)throw new Error("Cannot add an empty service to a server");r.forEach(i=>{let s=e[i],a;s.requestStream?s.responseStream?a="bidi":a="clientStream":s.responseStream?a="serverStream":a="unary";let o=t[i],l;if(o===void 0&&typeof s.originalName=="string"&&(o=t[s.originalName]),o!==void 0?l=o.bind(t):l=T2(a,i),this.register(s.path,l,s.responseSerialize,s.requestDeserialize,a)===!1)throw new Error(`Method handler for ${s.path} already provided.`)})}removeService(e){if(e===null||typeof e!="object")throw new Error("removeService() requires object as argument");Object.keys(e).forEach(r=>{let i=e[r];this.unregister(i.path)})}bind(e,t){throw new Error("Not implemented. Use bindAsync() instead")}bindAsync(e,t,r){if(this.started===!0)throw new Error("server is already started");if(this.shutdown)throw new Error("bindAsync called after shutdown");if(typeof e!="string")throw new TypeError("port must be a string");if(t===null||!(t instanceof _2.ServerCredentials))throw new TypeError("creds must be a ServerCredentials object");if(typeof r!="function")throw new TypeError("callback must be a function");let i=(0,v2.parseUri)(e);if(i===null)throw new Error(`Could not parse port "${e}"`);let s=(0,OS.mapUriDefaultScheme)(i);if(s===null)throw new Error(`Could not get a default scheme for port "${e}"`);let a={maxSendHeaderBlockLength:Number.MAX_SAFE_INTEGER};"grpc-node.max_session_memory"in this.options?a.maxSessionMemory=this.options["grpc-node.max_session_memory"]:a.maxSessionMemory=Number.MAX_SAFE_INTEGER,"grpc.max_concurrent_streams"in this.options&&(a.settings={maxConcurrentStreams:this.options["grpc.max_concurrent_streams"]});let o=(p,E)=>{process.nextTick(()=>r(p,E))},l=()=>{let p;if(t._isSecure()){let E=Object.assign(a,t._getSettings());E.enableTrace=this.options["grpc-node.tls_enable_trace"]===1,p=hr.createSecureServer(E),p.on("secureConnection",C=>{C.on("error",T=>{this.trace("An incoming TLS connection closed with error: "+T.message)})})}else p=hr.createServer(a);return p.setTimeout(0,w2),this._setupHandlers(p),p},c=(p,E,C)=>p.length===0?Promise.resolve({port:E,count:C}):Promise.all(p.map(T=>{this.trace("Attempting to bind "+(0,Bt.subchannelAddressToString)(T));let I;(0,Bt.isTcpSubchannelAddress)(T)?I={host:T.host,port:E}:I=T;let N=l();return new Promise((A,S)=>{let P=L=>{this.trace("Failed to bind "+(0,Bt.subchannelAddressToString)(T)+" with error "+L.message),A(L)};N.once("error",P),N.listen(I,()=>{if(this.shutdown){N.close(),A(new Error("bindAsync failed because server is shutdown"));return}let L=N.address(),v;typeof L=="string"?v={path:L}:v={host:L.address,port:L.port};let y=(0,lt.registerChannelzSocket)((0,Bt.subchannelAddressToString)(v),()=>({localAddress:v,remoteAddress:null,security:null,remoteName:null,streamsStarted:0,streamsSucceeded:0,streamsFailed:0,messagesSent:0,messagesReceived:0,keepAlivesSent:0,lastLocalStreamCreatedTimestamp:null,lastRemoteStreamCreatedTimestamp:null,lastMessageSentTimestamp:null,lastMessageReceivedTimestamp:null,localFlowControlWindow:null,remoteFlowControlWindow:null}),this.channelzEnabled);this.channelzEnabled&&this.listenerChildrenTracker.refChild(y),this.http2ServerList.push({server:N,channelzRef:y}),this.trace("Successfully bound "+(0,Bt.subchannelAddressToString)(v)),A("port"in v?v.port:E),N.removeListener("error",P)})})})).then(T=>{let I=0;for(let N of T)if(typeof N=="number"&&(I+=1,N!==E))throw new Error("Invalid state: multiple port numbers added from single address");return{port:E,count:I+C}}),u=p=>{if(p.length===0)return Promise.resolve({port:0,count:0});let E=p[0],C=l();return new Promise((T,I)=>{let N=A=>{this.trace("Failed to bind "+(0,Bt.subchannelAddressToString)(E)+" with error "+A.message),T(u(p.slice(1)))};C.once("error",N),C.listen(E,()=>{if(this.shutdown){C.close(),T({port:0,count:0});return}let A=C.address(),S={host:A.address,port:A.port},P=(0,lt.registerChannelzSocket)((0,Bt.subchannelAddressToString)(S),()=>({localAddress:S,remoteAddress:null,security:null,remoteName:null,streamsStarted:0,streamsSucceeded:0,streamsFailed:0,messagesSent:0,messagesReceived:0,keepAlivesSent:0,lastLocalStreamCreatedTimestamp:null,lastRemoteStreamCreatedTimestamp:null,lastMessageSentTimestamp:null,lastMessageReceivedTimestamp:null,localFlowControlWindow:null,remoteFlowControlWindow:null}),this.channelzEnabled);this.channelzEnabled&&this.listenerChildrenTracker.refChild(P),this.http2ServerList.push({server:C,channelzRef:P}),this.trace("Successfully bound "+(0,Bt.subchannelAddressToString)(S)),T(c(p.slice(1),A.port,1)),C.removeListener("error",N)})})},m={onSuccessfulResolution:(p,E,C)=>{if(m.onSuccessfulResolution=()=>{},this.shutdown&&o(new Error("bindAsync failed because server is shutdown"),0),p.length===0){o(new Error(`No addresses resolved for port ${e}`),0);return}let T;(0,Bt.isTcpSubchannelAddress)(p[0])?p[0].port===0?T=u(p):T=c(p,p[0].port,0):T=c(p,1,0),T.then(I=>{if(I.count===0){let N=`No address added out of total ${p.length} resolved`;Ql.log(Nn.LogVerbosity.ERROR,N),o(new Error(N),0)}else I.count<p.length&&Ql.log(Nn.LogVerbosity.INFO,`WARNING Only ${I.count} addresses added out of total ${p.length} resolved`),o(null,I.port)},I=>{let N=`No address added out of total ${p.length} resolved`;Ql.log(Nn.LogVerbosity.ERROR,N),o(new Error(N),0)})},onError:p=>{o(new Error(p.details),0)}};(0,OS.createResolver)(s,m,this.options).updateResolution()}forceShutdown(){for(let{server:e,channelzRef:t}of this.http2ServerList)e.listening&&e.close(()=>{this.channelzEnabled&&(this.listenerChildrenTracker.unrefChild(t),(0,lt.unregisterChannelzRef)(t))});this.started=!1,this.shutdown=!0,this.sessions.forEach((e,t)=>{t.destroy(hr.constants.NGHTTP2_CANCEL)}),this.sessions.clear(),this.channelzEnabled&&(0,lt.unregisterChannelzRef)(this.channelzRef)}register(e,t,r,i,s){return this.handlers.has(e)?!1:(this.handlers.set(e,{func:t,serialize:r,deserialize:i,type:s,path:e}),!0)}unregister(e){return this.handlers.delete(e)}start(){if(this.http2ServerList.length===0||this.http2ServerList.every(({server:e})=>e.listening!==!0))throw new Error("server must be bound in order to start");if(this.started===!0)throw new Error("server is already started");this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Starting"),this.started=!0}tryShutdown(e){let t=s=>{this.channelzEnabled&&(0,lt.unregisterChannelzRef)(this.channelzRef),e(s)},r=0;function i(){r--,r===0&&t()}this.started=!1,this.shutdown=!0;for(let{server:s,channelzRef:a}of this.http2ServerList)s.listening&&(r++,s.close(()=>{this.channelzEnabled&&(this.listenerChildrenTracker.unrefChild(a),(0,lt.unregisterChannelzRef)(a)),i()}));this.sessions.forEach((s,a)=>{a.closed||(r+=1,a.close(i))}),r===0&&t()}addHttp2Port(){throw new Error("Not yet implemented")}getChannelzRef(){return this.channelzRef}_verifyContentType(e,t){let r=t[hr.constants.HTTP2_HEADER_CONTENT_TYPE];return typeof r!="string"||!r.startsWith("application/grpc")?(e.respond({[hr.constants.HTTP2_HEADER_STATUS]:hr.constants.HTTP_STATUS_UNSUPPORTED_MEDIA_TYPE},{endStream:!0}),!1):!0}_retrieveHandler(e){this.trace("Received call to method "+e+" at address "+this.serverAddressString);let t=this.handlers.get(e);return t===void 0?(this.trace("No handler registered for method "+e+". Sending UNIMPLEMENTED status."),null):t}_respondWithError(e,t,r=null){let i=new Vr.Http2ServerCallStream(t,null,this.options);e.code===void 0&&(e.code=Nn.Status.INTERNAL),this.channelzEnabled&&(this.callTracker.addCallFailed(),r?.streamTracker.addCallFailed()),i.sendError(e)}_channelzHandler(e,t){let r=this.sessions.get(e.session);if(this.callTracker.addCallStarted(),r?.streamTracker.addCallStarted(),!this._verifyContentType(e,t)){this.callTracker.addCallFailed(),r?.streamTracker.addCallFailed();return}let i=t[kS],s=this._retrieveHandler(i);if(!s){this._respondWithError(Zf(i),e,r);return}let a=new Vr.Http2ServerCallStream(e,s,this.options);a.once("callEnd",o=>{o===Nn.Status.OK?this.callTracker.addCallSucceeded():this.callTracker.addCallFailed()}),r&&(a.once("streamEnd",o=>{o?r.streamTracker.addCallSucceeded():r.streamTracker.addCallFailed()}),a.on("sendMessage",()=>{r.messagesSent+=1,r.lastMessageSentTimestamp=new Date}),a.on("receiveMessage",()=>{r.messagesReceived+=1,r.lastMessageReceivedTimestamp=new Date})),this._runHandlerForCall(a,s,t)||(this.callTracker.addCallFailed(),r?.streamTracker.addCallFailed(),a.sendError({code:Nn.Status.INTERNAL,details:`Unknown handler type: ${s.type}`}))}_streamHandler(e,t){if(this._verifyContentType(e,t)!==!0)return;let r=t[kS],i=this._retrieveHandler(r);if(!i){this._respondWithError(Zf(r),e,null);return}let s=new Vr.Http2ServerCallStream(e,i,this.options);this._runHandlerForCall(s,i,t)||s.sendError({code:Nn.Status.INTERNAL,details:`Unknown handler type: ${i.type}`})}_runHandlerForCall(e,t,r){var i;let s=e.receiveMetadata(r),a=(i=s.get("grpc-encoding")[0])!==null&&i!==void 0?i:"identity";s.remove("grpc-encoding");let{type:o}=t;if(o==="unary")C2(e,t,s,a);else if(o==="clientStream")I2(e,t,s,a);else if(o==="serverStream")A2(e,t,s,a);else if(o==="bidi")R2(e,t,s,a);else return!1;return!0}_setupHandlers(e){if(e===null)return;let t=e.address(),r="null";t&&(typeof t=="string"?r=t:r=t.address+":"+t.port),this.serverAddressString=r;let i=this.channelzEnabled?this._channelzHandler:this._streamHandler;e.on("stream",i.bind(this)),e.on("session",s=>{var a,o,l,c,u;if(!this.started){s.destroy();return}let m=(0,lt.registerChannelzSocket)((a=s.socket.remoteAddress)!==null&&a!==void 0?a:"unknown",this.getChannelzSessionInfoGetter(s),this.channelzEnabled),d={ref:m,streamTracker:new lt.ChannelzCallTracker,messagesSent:0,messagesReceived:0,lastMessageSentTimestamp:null,lastMessageReceivedTimestamp:null};this.sessions.set(s,d);let p=s.socket.remoteAddress;this.channelzEnabled&&(this.channelzTrace.addTrace("CT_INFO","Connection established by client "+p),this.sessionChildrenTracker.refChild(m));let E=null,C=null,T=!1;if(this.maxConnectionAgeMs!==Yl){let N=this.maxConnectionAgeMs/10,A=Math.random()*N*2-N;E=(l=(o=setTimeout(()=>{var S,P;T=!0,this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Connection dropped by max connection age from "+p);try{s.goaway(hr.constants.NGHTTP2_NO_ERROR,~(1<<31),Buffer.from("max_age"))}catch{s.destroy();return}s.close(),this.maxConnectionAgeGraceMs!==Yl&&(C=(P=(S=setTimeout(()=>{s.destroy()},this.maxConnectionAgeGraceMs)).unref)===null||P===void 0?void 0:P.call(S))},this.maxConnectionAgeMs+A)).unref)===null||l===void 0?void 0:l.call(o)}let I=(u=(c=setInterval(()=>{var N,A;let S=(A=(N=setTimeout(()=>{T=!0,this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Connection dropped by keepalive timeout from "+p),s.close()},this.keepaliveTimeoutMs)).unref)===null||A===void 0?void 0:A.call(N);try{s.ping((P,L,v)=>{clearTimeout(S)})}catch{s.destroy()}},this.keepaliveTimeMs)).unref)===null||u===void 0?void 0:u.call(c);s.on("close",()=>{this.channelzEnabled&&(T||this.channelzTrace.addTrace("CT_INFO","Connection dropped by client "+p),this.sessionChildrenTracker.unrefChild(m),(0,lt.unregisterChannelzRef)(m)),E&&clearTimeout(E),C&&clearTimeout(C),I&&clearTimeout(I),this.sessions.delete(s)})})}};Jl.Server=Xf;async function C2(n,e,t,r){try{let i=await n.receiveUnaryMessage(r);if(i===void 0||n.cancelled)return;let s=new Vr.ServerUnaryCallImpl(n,t,i);e.func(s,(a,o,l,c)=>{n.sendUnaryMessage(a,o,l,c)})}catch(i){n.sendError(i)}}function I2(n,e,t,r){let i=new Vr.ServerReadableStreamImpl(n,t,e.deserialize,r);function s(a,o,l,c){i.destroy(),n.sendUnaryMessage(a,o,l,c)}n.cancelled||(i.on("error",s),e.func(i,s))}async function A2(n,e,t,r){try{let i=await n.receiveUnaryMessage(r);if(i===void 0||n.cancelled)return;let s=new Vr.ServerWritableStreamImpl(n,t,e.serialize,i);e.func(s)}catch(i){n.sendError(i)}}function R2(n,e,t,r){let i=new Vr.ServerDuplexStreamImpl(n,t,e.serialize,e.deserialize,r);n.cancelled||e.func(i)}});var PS=R(Zl=>{"use strict";Object.defineProperty(Zl,"__esModule",{value:!0});Zl.StatusBuilder=void 0;var ep=class{constructor(){this.code=null,this.details=null,this.metadata=null}withCode(e){return this.code=e,this}withDetails(e){return this.details=e,this}withMetadata(e){return this.metadata=e,this}build(){let e={};return this.code!==null&&(e.code=this.code),this.details!==null&&(e.details=this.details),this.metadata!==null&&(e.metadata=this.metadata),e}};Zl.StatusBuilder=ep});var tp=R(fr=>{"use strict";Object.defineProperty(fr,"__esModule",{value:!0});fr.isDuration=fr.durationToMs=fr.msToDuration=void 0;function D2(n){return{seconds:n/1e3|0,nanos:n%1e3*1e6|0}}fr.msToDuration=D2;function x2(n){return n.seconds*1e3+n.nanos/1e6|0}fr.durationToMs=x2;function N2(n){return typeof n.seconds=="number"&&typeof n.nanos=="number"}fr.isDuration=N2});var cp=R(pr=>{"use strict";var np;Object.defineProperty(pr,"__esModule",{value:!0});pr.setup=pr.OutlierDetectionLoadBalancer=pr.OutlierDetectionLoadBalancingConfig=void 0;var ec=St(),FS=le(),zr=tp(),BS=up(),US=jn(),O2=Mo(),k2=Qn(),LS=Yt(),M2=zl(),P2=be(),L2="outlier_detection";function Be(n){P2.trace(FS.LogVerbosity.DEBUG,L2,n)}var lp="outlier_detection",F2=((np=process.env.GRPC_EXPERIMENTAL_ENABLE_OUTLIER_DETECTION)!==null&&np!==void 0?np:"true")==="true",B2={stdev_factor:1900,enforcement_percentage:100,minimum_hosts:5,request_volume:100},U2={threshold:85,enforcement_percentage:100,minimum_hosts:5,request_volume:50};function ji(n,e,t,r){if(e in n&&typeof n[e]!==t){let i=r?`${r}.${e}`:e;throw new Error(`outlier detection config ${i} parse error: expected ${t}, got ${typeof n[e]}`)}}function rp(n,e,t){let r=t?`${t}.${e}`:e;if(e in n){if(!(0,zr.isDuration)(n[e]))throw new Error(`outlier detection config ${r} parse error: expected Duration, got ${typeof n[e]}`);if(!(n[e].seconds>=0&&n[e].seconds<=315576e6&&n[e].nanos>=0&&n[e].nanos<=999999999))throw new Error(`outlier detection config ${r} parse error: values out of range for non-negative Duaration`)}}function Xl(n,e,t){let r=t?`${t}.${e}`:e;if(ji(n,e,"number",t),e in n&&!(n[e]>=0&&n[e]<=100))throw new Error(`outlier detection config ${r} parse error: value out of range for percentage (0-100)`)}var Ca=class n{constructor(e,t,r,i,s,a,o){if(this.childPolicy=o,o.length>0&&o[0].getLoadBalancerName()==="pick_first")throw new Error("outlier_detection LB policy cannot have a pick_first child policy");this.intervalMs=e??1e4,this.baseEjectionTimeMs=t??3e4,this.maxEjectionTimeMs=r??3e5,this.maxEjectionPercent=i??10,this.successRateEjection=s?Object.assign(Object.assign({},B2),s):null,this.failurePercentageEjection=a?Object.assign(Object.assign({},U2),a):null}getLoadBalancerName(){return lp}toJsonObject(){return{interval:(0,zr.msToDuration)(this.intervalMs),base_ejection_time:(0,zr.msToDuration)(this.baseEjectionTimeMs),max_ejection_time:(0,zr.msToDuration)(this.maxEjectionTimeMs),max_ejection_percent:this.maxEjectionPercent,success_rate_ejection:this.successRateEjection,failure_percentage_ejection:this.failurePercentageEjection,child_policy:this.childPolicy.map(e=>e.toJsonObject())}}getIntervalMs(){return this.intervalMs}getBaseEjectionTimeMs(){return this.baseEjectionTimeMs}getMaxEjectionTimeMs(){return this.maxEjectionTimeMs}getMaxEjectionPercent(){return this.maxEjectionPercent}getSuccessRateEjectionConfig(){return this.successRateEjection}getFailurePercentageEjectionConfig(){return this.failurePercentageEjection}getChildPolicy(){return this.childPolicy}copyWithChildPolicy(e){return new n(this.intervalMs,this.baseEjectionTimeMs,this.maxEjectionTimeMs,this.maxEjectionPercent,this.successRateEjection,this.failurePercentageEjection,e)}static createFromJson(e){var t;if(rp(e,"interval"),rp(e,"base_ejection_time"),rp(e,"max_ejection_time"),Xl(e,"max_ejection_percent"),"success_rate_ejection"in e){if(typeof e.success_rate_ejection!="object")throw new Error("outlier detection config success_rate_ejection must be an object");ji(e.success_rate_ejection,"stdev_factor","number","success_rate_ejection"),Xl(e.success_rate_ejection,"enforcement_percentage","success_rate_ejection"),ji(e.success_rate_ejection,"minimum_hosts","number","success_rate_ejection"),ji(e.success_rate_ejection,"request_volume","number","success_rate_ejection")}if("failure_percentage_ejection"in e){if(typeof e.failure_percentage_ejection!="object")throw new Error("outlier detection config failure_percentage_ejection must be an object");Xl(e.failure_percentage_ejection,"threshold","failure_percentage_ejection"),Xl(e.failure_percentage_ejection,"enforcement_percentage","failure_percentage_ejection"),ji(e.failure_percentage_ejection,"minimum_hosts","number","failure_percentage_ejection"),ji(e.failure_percentage_ejection,"request_volume","number","failure_percentage_ejection")}return new n(e.interval?(0,zr.durationToMs)(e.interval):null,e.base_ejection_time?(0,zr.durationToMs)(e.base_ejection_time):null,e.max_ejection_time?(0,zr.durationToMs)(e.max_ejection_time):null,(t=e.max_ejection_percent)!==null&&t!==void 0?t:null,e.success_rate_ejection,e.failure_percentage_ejection,e.child_policy.map(US.validateLoadBalancingConfig))}};pr.OutlierDetectionLoadBalancingConfig=Ca;var sp=class extends M2.BaseSubchannelWrapper{constructor(e,t){super(e),this.mapEntry=t,this.stateListeners=[],this.ejected=!1,this.refCount=0,this.childSubchannelState=e.getConnectivityState(),e.addConnectivityStateListener((r,i,s,a)=>{if(this.childSubchannelState=s,!this.ejected)for(let o of this.stateListeners)o(this,i,s,a)})}getConnectivityState(){return this.ejected?ec.ConnectivityState.TRANSIENT_FAILURE:this.childSubchannelState}addConnectivityStateListener(e){this.stateListeners.push(e)}removeConnectivityStateListener(e){let t=this.stateListeners.indexOf(e);t>-1&&this.stateListeners.splice(t,1)}ref(){this.child.ref(),this.refCount+=1}unref(){if(this.child.unref(),this.refCount-=1,this.refCount<=0&&this.mapEntry){let e=this.mapEntry.subchannelWrappers.indexOf(this);e>=0&&this.mapEntry.subchannelWrappers.splice(e,1)}}eject(){this.ejected=!0;for(let e of this.stateListeners)e(this,this.childSubchannelState,ec.ConnectivityState.TRANSIENT_FAILURE,-1)}uneject(){this.ejected=!1;for(let e of this.stateListeners)e(this,ec.ConnectivityState.TRANSIENT_FAILURE,this.childSubchannelState,-1)}getMapEntry(){return this.mapEntry}getWrappedSubchannel(){return this.child}};function ip(){return{success:0,failure:0}}var ap=class{constructor(){this.activeBucket=ip(),this.inactiveBucket=ip()}addSuccess(){this.activeBucket.success+=1}addFailure(){this.activeBucket.failure+=1}switchBuckets(){this.inactiveBucket=this.activeBucket,this.activeBucket=ip()}getLastSuccesses(){return this.inactiveBucket.success}getLastFailures(){return this.inactiveBucket.failure}},op=class{constructor(e,t){this.wrappedPicker=e,this.countCalls=t}pick(e){let t=this.wrappedPicker.pick(e);if(t.pickResultType===k2.PickResultType.COMPLETE){let r=t.subchannel,i=r.getMapEntry();if(i){let s=t.onCallEnded;return this.countCalls&&(s=a=>{var o;a===FS.Status.OK?i.counter.addSuccess():i.counter.addFailure(),(o=t.onCallEnded)===null||o===void 0||o.call(t,a)}),Object.assign(Object.assign({},t),{subchannel:r.getWrappedSubchannel(),onCallEnded:s})}else return Object.assign(Object.assign({},t),{subchannel:r.getWrappedSubchannel()})}else return t}},tc=class{constructor(e){this.addressMap=new Map,this.latestConfig=null,this.timerStartTime=null,this.childBalancer=new O2.ChildLoadBalancerHandler((0,BS.createChildChannelControlHelper)(e,{createSubchannel:(t,r)=>{let i=e.createSubchannel(t,r),s=this.addressMap.get((0,LS.subchannelAddressToString)(t)),a=new sp(i,s);return s?.currentEjectionTimestamp!==null&&a.eject(),s?.subchannelWrappers.push(a),a},updateState:(t,r)=>{t===ec.ConnectivityState.READY?e.updateState(t,new op(r,this.isCountingEnabled())):e.updateState(t,r)}})),this.ejectionTimer=setInterval(()=>{},0),clearInterval(this.ejectionTimer)}isCountingEnabled(){return this.latestConfig!==null&&(this.latestConfig.getSuccessRateEjectionConfig()!==null||this.latestConfig.getFailurePercentageEjectionConfig()!==null)}getCurrentEjectionPercent(){let e=0;for(let t of this.addressMap.values())t.currentEjectionTimestamp!==null&&(e+=1);return e*100/this.addressMap.size}runSuccessRateCheck(e){if(!this.latestConfig)return;let t=this.latestConfig.getSuccessRateEjectionConfig();if(!t)return;Be("Running success rate check");let r=t.request_volume,i=0,s=[];for(let[m,d]of this.addressMap){let p=d.counter.getLastSuccesses(),E=d.counter.getLastFailures();Be("Stats for "+m+": successes="+p+" failures="+E+" targetRequestVolume="+r),p+E>=r&&(i+=1,s.push(p/(p+E)))}if(Be("Found "+i+" success rate candidates; currentEjectionPercent="+this.getCurrentEjectionPercent()+" successRates=["+s+"]"),i<t.minimum_hosts)return;let a=s.reduce((m,d)=>m+d)/s.length,o=0;for(let m of s){let d=m-a;o+=d*d}let l=o/s.length,c=Math.sqrt(l),u=a-c*(t.stdev_factor/1e3);Be("stdev="+c+" ejectionThreshold="+u);for(let[m,d]of this.addressMap.entries()){if(this.getCurrentEjectionPercent()>=this.latestConfig.getMaxEjectionPercent())break;let p=d.counter.getLastSuccesses(),E=d.counter.getLastFailures();if(p+E<r)continue;let C=p/(p+E);if(Be("Checking candidate "+m+" successRate="+C),C<u){let T=Math.random()*100;Be("Candidate "+m+" randomNumber="+T+" enforcement_percentage="+t.enforcement_percentage),T<t.enforcement_percentage&&(Be("Ejecting candidate "+m),this.eject(d,e))}}}runFailurePercentageCheck(e){if(!this.latestConfig)return;let t=this.latestConfig.getFailurePercentageEjectionConfig();if(!t)return;Be("Running failure percentage check. threshold="+t.threshold+" request volume threshold="+t.request_volume);let r=0;for(let i of this.addressMap.values()){let s=i.counter.getLastSuccesses(),a=i.counter.getLastFailures();s+a>=t.request_volume&&(r+=1)}if(!(r<t.minimum_hosts))for(let[i,s]of this.addressMap.entries()){if(this.getCurrentEjectionPercent()>=this.latestConfig.getMaxEjectionPercent())break;let a=s.counter.getLastSuccesses(),o=s.counter.getLastFailures();if(Be("Candidate successes="+a+" failures="+o),a+o<t.request_volume)continue;if(o*100/(o+a)>t.threshold){let c=Math.random()*100;Be("Candidate "+i+" randomNumber="+c+" enforcement_percentage="+t.enforcement_percentage),c<t.enforcement_percentage&&(Be("Ejecting candidate "+i),this.eject(s,e))}}}eject(e,t){e.currentEjectionTimestamp=new Date,e.ejectionTimeMultiplier+=1;for(let r of e.subchannelWrappers)r.eject()}uneject(e){e.currentEjectionTimestamp=null;for(let t of e.subchannelWrappers)t.uneject()}switchAllBuckets(){for(let e of this.addressMap.values())e.counter.switchBuckets()}startTimer(e){var t,r;this.ejectionTimer=setTimeout(()=>this.runChecks(),e),(r=(t=this.ejectionTimer).unref)===null||r===void 0||r.call(t)}runChecks(){let e=new Date;if(Be("Ejection timer running"),this.switchAllBuckets(),!!this.latestConfig){this.timerStartTime=e,this.startTimer(this.latestConfig.getIntervalMs()),this.runSuccessRateCheck(e),this.runFailurePercentageCheck(e);for(let[t,r]of this.addressMap.entries())if(r.currentEjectionTimestamp===null)r.ejectionTimeMultiplier>0&&(r.ejectionTimeMultiplier-=1);else{let i=this.latestConfig.getBaseEjectionTimeMs(),s=this.latestConfig.getMaxEjectionTimeMs(),a=new Date(r.currentEjectionTimestamp.getTime());a.setMilliseconds(a.getMilliseconds()+Math.min(i*r.ejectionTimeMultiplier,Math.max(i,s))),a<new Date&&(Be("Unejecting "+t),this.uneject(r))}}}updateAddressList(e,t,r){if(!(t instanceof Ca))return;let i=new Set;for(let a of e)i.add((0,LS.subchannelAddressToString)(a));for(let a of i)this.addressMap.has(a)||(Be("Adding map entry for "+a),this.addressMap.set(a,{counter:new ap,currentEjectionTimestamp:null,ejectionTimeMultiplier:0,subchannelWrappers:[]}));for(let a of this.addressMap.keys())i.has(a)||(Be("Removing map entry for "+a),this.addressMap.delete(a));let s=(0,US.getFirstUsableConfig)(t.getChildPolicy(),!0);if(this.childBalancer.updateAddressList(e,s,r),t.getSuccessRateEjectionConfig()||t.getFailurePercentageEjectionConfig())if(this.timerStartTime){Be("Previous timer existed. Replacing timer"),clearTimeout(this.ejectionTimer);let a=t.getIntervalMs()-(new Date().getTime()-this.timerStartTime.getTime());this.startTimer(a)}else Be("Starting new timer"),this.timerStartTime=new Date,this.startTimer(t.getIntervalMs()),this.switchAllBuckets();else{Be("Counting disabled. Cancelling timer."),this.timerStartTime=null,clearTimeout(this.ejectionTimer);for(let a of this.addressMap.values())this.uneject(a),a.ejectionTimeMultiplier=0}this.latestConfig=t}exitIdle(){this.childBalancer.exitIdle()}resetBackoff(){this.childBalancer.resetBackoff()}destroy(){clearTimeout(this.ejectionTimer),this.childBalancer.destroy()}getTypeName(){return lp}};pr.OutlierDetectionLoadBalancer=tc;function q2(){F2&&(0,BS.registerLoadBalancerType)(lp,tc,Ca)}pr.setup=q2});var up=R(j=>{"use strict";Object.defineProperty(j,"__esModule",{value:!0});j.OutlierDetectionLoadBalancingConfig=j.BaseSubchannelWrapper=j.registerAdminService=j.FilterStackFactory=j.BaseFilter=j.PickResultType=j.QueuePicker=j.UnavailablePicker=j.ChildLoadBalancerHandler=j.subchannelAddressToString=j.validateLoadBalancingConfig=j.getFirstUsableConfig=j.registerLoadBalancerType=j.createChildChannelControlHelper=j.BackoffTimeout=j.durationToMs=j.uriToString=j.createResolver=j.registerResolver=j.log=j.trace=void 0;var qS=be();Object.defineProperty(j,"trace",{enumerable:!0,get:function(){return qS.trace}});Object.defineProperty(j,"log",{enumerable:!0,get:function(){return qS.log}});var VS=Wt();Object.defineProperty(j,"registerResolver",{enumerable:!0,get:function(){return VS.registerResolver}});Object.defineProperty(j,"createResolver",{enumerable:!0,get:function(){return VS.createResolver}});var V2=ht();Object.defineProperty(j,"uriToString",{enumerable:!0,get:function(){return V2.uriToString}});var z2=tp();Object.defineProperty(j,"durationToMs",{enumerable:!0,get:function(){return z2.durationToMs}});var G2=$s();Object.defineProperty(j,"BackoffTimeout",{enumerable:!0,get:function(){return G2.BackoffTimeout}});var nc=jn();Object.defineProperty(j,"createChildChannelControlHelper",{enumerable:!0,get:function(){return nc.createChildChannelControlHelper}});Object.defineProperty(j,"registerLoadBalancerType",{enumerable:!0,get:function(){return nc.registerLoadBalancerType}});Object.defineProperty(j,"getFirstUsableConfig",{enumerable:!0,get:function(){return nc.getFirstUsableConfig}});Object.defineProperty(j,"validateLoadBalancingConfig",{enumerable:!0,get:function(){return nc.validateLoadBalancingConfig}});var $2=Yt();Object.defineProperty(j,"subchannelAddressToString",{enumerable:!0,get:function(){return $2.subchannelAddressToString}});var j2=Mo();Object.defineProperty(j,"ChildLoadBalancerHandler",{enumerable:!0,get:function(){return j2.ChildLoadBalancerHandler}});var dp=Qn();Object.defineProperty(j,"UnavailablePicker",{enumerable:!0,get:function(){return dp.UnavailablePicker}});Object.defineProperty(j,"QueuePicker",{enumerable:!0,get:function(){return dp.QueuePicker}});Object.defineProperty(j,"PickResultType",{enumerable:!0,get:function(){return dp.PickResultType}});var K2=If();Object.defineProperty(j,"BaseFilter",{enumerable:!0,get:function(){return K2.BaseFilter}});var H2=wf();Object.defineProperty(j,"FilterStackFactory",{enumerable:!0,get:function(){return H2.FilterStackFactory}});var W2=Lo();Object.defineProperty(j,"registerAdminService",{enumerable:!0,get:function(){return W2.registerAdminService}});var Q2=zl();Object.defineProperty(j,"BaseSubchannelWrapper",{enumerable:!0,get:function(){return Q2.BaseSubchannelWrapper}});var Y2=cp();Object.defineProperty(j,"OutlierDetectionLoadBalancingConfig",{enumerable:!0,get:function(){return Y2.OutlierDetectionLoadBalancingConfig}})});var zS=R(rc=>{"use strict";Object.defineProperty(rc,"__esModule",{value:!0});rc.setup=void 0;var J2=Wt(),hp=class{constructor(e,t,r){this.listener=t,this.addresses=[],this.hasReturnedResult=!1;let i;e.authority===""?i="/"+e.path:i=e.path,this.addresses=[{path:i}]}updateResolution(){this.hasReturnedResult||(this.hasReturnedResult=!0,process.nextTick(this.listener.onSuccessfulResolution,this.addresses,null,null,null,{}))}destroy(){}static getDefaultAuthority(e){return"localhost"}};function Z2(){(0,J2.registerResolver)("unix",hp)}rc.setup=Z2});var HS=R(ac=>{"use strict";Object.defineProperty(ac,"__esModule",{value:!0});ac.setup=void 0;var GS=require("net"),ic=le(),fp=st(),$S=Wt(),jS=ht(),X2=be(),eM="ip_resolver";function KS(n){X2.trace(ic.LogVerbosity.DEBUG,eM,n)}var pp="ipv4",mp="ipv6",tM=443,sc=class{constructor(e,t,r){var i;this.listener=t,this.addresses=[],this.error=null,this.hasReturnedResult=!1,KS("Resolver constructed for target "+(0,jS.uriToString)(e));let s=[];if(!(e.scheme===pp||e.scheme===mp)){this.error={code:ic.Status.UNAVAILABLE,details:`Unrecognized scheme ${e.scheme} in IP resolver`,metadata:new fp.Metadata};return}let a=e.path.split(",");for(let o of a){let l=(0,jS.splitHostPort)(o);if(l===null){this.error={code:ic.Status.UNAVAILABLE,details:`Failed to parse ${e.scheme} address ${o}`,metadata:new fp.Metadata};return}if(e.scheme===pp&&!(0,GS.isIPv4)(l.host)||e.scheme===mp&&!(0,GS.isIPv6)(l.host)){this.error={code:ic.Status.UNAVAILABLE,details:`Failed to parse ${e.scheme} address ${o}`,metadata:new fp.Metadata};return}s.push({host:l.host,port:(i=l.port)!==null&&i!==void 0?i:tM})}this.addresses=s,KS("Parsed "+e.scheme+" address list "+this.addresses)}updateResolution(){this.hasReturnedResult||(this.hasReturnedResult=!0,process.nextTick(()=>{this.error?this.listener.onError(this.error):this.listener.onSuccessfulResolution(this.addresses,null,null,null,{})}))}destroy(){this.hasReturnedResult=!1}static getDefaultAuthority(e){return e.path.split(",")[0]}};function nM(){(0,$S.registerResolver)(pp,sc),(0,$S.registerResolver)(mp,sc)}ac.setup=nM});var YS=R(dn=>{"use strict";Object.defineProperty(dn,"__esModule",{value:!0});dn.setup=dn.PickFirstLoadBalancer=dn.shuffled=dn.PickFirstLoadBalancingConfig=void 0;var WS=jn(),We=St(),oc=Qn(),rM=be(),iM=le(),sM="pick_first";function gp(n){rM.trace(iM.LogVerbosity.DEBUG,sM,n)}var Ia="pick_first",aM=250,Aa=class n{constructor(e){this.shuffleAddressList=e}getLoadBalancerName(){return Ia}toJsonObject(){return{[Ia]:{shuffleAddressList:this.shuffleAddressList}}}getShuffleAddressList(){return this.shuffleAddressList}static createFromJson(e){if("shuffleAddressList"in e&&typeof e.shuffleAddressList!="boolean")throw new Error("pick_first config field shuffleAddressList must be a boolean if provided");return new n(e.shuffleAddressList===!0)}};dn.PickFirstLoadBalancingConfig=Aa;var yp=class{constructor(e){this.subchannel=e}pick(e){return{pickResultType:oc.PickResultType.COMPLETE,subchannel:this.subchannel,status:null,onCallStarted:null,onCallEnded:null}}};function QS(n){let e=n.slice();for(let t=e.length-1;t>1;t--){let r=Math.floor(Math.random()*(t+1)),i=e[t];e[t]=e[r],e[r]=i}return e}dn.shuffled=QS;var lc=class{constructor(e){this.channelControlHelper=e,this.children=[],this.currentState=We.ConnectivityState.IDLE,this.currentSubchannelIndex=0,this.currentPick=null,this.subchannelStateListener=(t,r,i,s,a)=>{this.onSubchannelStateUpdate(t,r,i,a)},this.triedAllSubchannels=!1,this.stickyTransientFailureMode=!1,this.requestedResolutionSinceLastUpdate=!1,this.lastError=null,this.latestAddressList=null,this.connectionDelayTimeout=setTimeout(()=>{},0),clearTimeout(this.connectionDelayTimeout)}allChildrenHaveReportedTF(){return this.children.every(e=>e.hasReportedTransientFailure)}calculateAndReportNewState(){this.currentPick?this.updateState(We.ConnectivityState.READY,new yp(this.currentPick)):this.children.length===0?this.updateState(We.ConnectivityState.IDLE,new oc.QueuePicker(this)):this.stickyTransientFailureMode?this.updateState(We.ConnectivityState.TRANSIENT_FAILURE,new oc.UnavailablePicker({details:`No connection established. Last error: ${this.lastError}`})):this.updateState(We.ConnectivityState.CONNECTING,new oc.QueuePicker(this))}requestReresolution(){this.requestedResolutionSinceLastUpdate=!0,this.channelControlHelper.requestReresolution()}maybeEnterStickyTransientFailureMode(){if(this.allChildrenHaveReportedTF()&&(this.requestedResolutionSinceLastUpdate||this.requestReresolution(),!this.stickyTransientFailureMode)){this.stickyTransientFailureMode=!0;for(let{subchannel:e}of this.children)e.startConnecting();this.calculateAndReportNewState()}}removeCurrentPick(){if(this.currentPick!==null){let e=this.currentPick;this.currentPick=null,e.unref(),e.removeConnectivityStateListener(this.subchannelStateListener),this.channelControlHelper.removeChannelzChild(e.getChannelzRef())}}onSubchannelStateUpdate(e,t,r,i){var s;if(!((s=this.currentPick)===null||s===void 0)&&s.realSubchannelEquals(e)){r!==We.ConnectivityState.READY&&(this.removeCurrentPick(),this.calculateAndReportNewState(),this.requestReresolution());return}for(let[a,o]of this.children.entries())if(e.realSubchannelEquals(o.subchannel)){r===We.ConnectivityState.READY&&this.pickSubchannel(o.subchannel),r===We.ConnectivityState.TRANSIENT_FAILURE&&(o.hasReportedTransientFailure=!0,i&&(this.lastError=i),this.maybeEnterStickyTransientFailureMode(),a===this.currentSubchannelIndex&&this.startNextSubchannelConnecting(a+1)),o.subchannel.startConnecting();return}}startNextSubchannelConnecting(e){if(clearTimeout(this.connectionDelayTimeout),!this.triedAllSubchannels){for(let[t,r]of this.children.entries())if(t>=e){let i=r.subchannel.getConnectivityState();if(i===We.ConnectivityState.IDLE||i===We.ConnectivityState.CONNECTING){this.startConnecting(t);return}}this.triedAllSubchannels=!0,this.maybeEnterStickyTransientFailureMode()}}startConnecting(e){var t,r;clearTimeout(this.connectionDelayTimeout),this.currentSubchannelIndex=e,this.children[e].subchannel.getConnectivityState()===We.ConnectivityState.IDLE&&(gp("Start connecting to subchannel with address "+this.children[e].subchannel.getAddress()),process.nextTick(()=>{var i;(i=this.children[e])===null||i===void 0||i.subchannel.startConnecting()})),this.connectionDelayTimeout=(r=(t=setTimeout(()=>{this.startNextSubchannelConnecting(e+1)},aM)).unref)===null||r===void 0?void 0:r.call(t)}pickSubchannel(e){this.currentPick&&e.realSubchannelEquals(this.currentPick)||(gp("Pick subchannel with address "+e.getAddress()),this.stickyTransientFailureMode=!1,this.currentPick!==null&&(this.currentPick.unref(),this.channelControlHelper.removeChannelzChild(this.currentPick.getChannelzRef()),this.currentPick.removeConnectivityStateListener(this.subchannelStateListener)),this.currentPick=e,e.ref(),this.channelControlHelper.addChannelzChild(e.getChannelzRef()),this.resetSubchannelList(),clearTimeout(this.connectionDelayTimeout),this.calculateAndReportNewState())}updateState(e,t){gp(We.ConnectivityState[this.currentState]+" -> "+We.ConnectivityState[e]),this.currentState=e,this.channelControlHelper.updateState(e,t)}resetSubchannelList(){for(let e of this.children)this.currentPick&&e.subchannel.realSubchannelEquals(this.currentPick)||e.subchannel.removeConnectivityStateListener(this.subchannelStateListener),e.subchannel.unref(),this.channelControlHelper.removeChannelzChild(e.subchannel.getChannelzRef());this.currentSubchannelIndex=0,this.children=[],this.triedAllSubchannels=!1,this.requestedResolutionSinceLastUpdate=!1}connectToAddressList(e){let t=e.map(r=>({subchannel:this.channelControlHelper.createSubchannel(r,{}),hasReportedTransientFailure:!1}));for(let{subchannel:r}of t)r.ref(),this.channelControlHelper.addChannelzChild(r.getChannelzRef());this.resetSubchannelList(),this.children=t;for(let{subchannel:r}of this.children)if(r.addConnectivityStateListener(this.subchannelStateListener),r.getConnectivityState()===We.ConnectivityState.READY){this.pickSubchannel(r);return}for(let r of this.children)r.subchannel.getConnectivityState()===We.ConnectivityState.TRANSIENT_FAILURE&&(r.hasReportedTransientFailure=!0);this.startNextSubchannelConnecting(0),this.calculateAndReportNewState()}updateAddressList(e,t){t instanceof Aa&&(t.getShuffleAddressList()&&(e=QS(e)),this.latestAddressList=e,this.connectToAddressList(e))}exitIdle(){this.currentState===We.ConnectivityState.IDLE&&this.latestAddressList&&this.connectToAddressList(this.latestAddressList)}resetBackoff(){}destroy(){this.resetSubchannelList(),this.removeCurrentPick()}getTypeName(){return Ia}};dn.PickFirstLoadBalancer=lc;function oM(){(0,WS.registerLoadBalancerType)(Ia,lc,Aa),(0,WS.registerDefaultLoadBalancerType)(Ia)}dn.setup=oM});var ZS=R(Ki=>{"use strict";Object.defineProperty(Ki,"__esModule",{value:!0});Ki.setup=Ki.RoundRobinLoadBalancer=void 0;var lM=jn(),Qe=St(),cc=Qn(),cM=Yt(),uM=be(),dM=le(),hM="round_robin";function JS(n){uM.trace(dM.LogVerbosity.DEBUG,hM,n)}var uc="round_robin",_p=class n{getLoadBalancerName(){return uc}constructor(){}toJsonObject(){return{[uc]:{}}}static createFromJson(e){return new n}},vp=class{constructor(e,t=0){this.subchannelList=e,this.nextIndex=t}pick(e){let t=this.subchannelList[this.nextIndex];return this.nextIndex=(this.nextIndex+1)%this.subchannelList.length,{pickResultType:cc.PickResultType.COMPLETE,subchannel:t,status:null,onCallStarted:null,onCallEnded:null}}peekNextSubchannel(){return this.subchannelList[this.nextIndex]}},dc=class{constructor(e){this.channelControlHelper=e,this.subchannels=[],this.currentState=Qe.ConnectivityState.IDLE,this.currentReadyPicker=null,this.lastError=null,this.subchannelStateListener=(t,r,i,s,a)=>{this.calculateAndUpdateState(),(i===Qe.ConnectivityState.TRANSIENT_FAILURE||i===Qe.ConnectivityState.IDLE)&&(a&&(this.lastError=a),this.channelControlHelper.requestReresolution(),t.startConnecting())}}countSubchannelsWithState(e){return this.subchannels.filter(t=>t.getConnectivityState()===e).length}calculateAndUpdateState(){if(this.countSubchannelsWithState(Qe.ConnectivityState.READY)>0){let e=this.subchannels.filter(r=>r.getConnectivityState()===Qe.ConnectivityState.READY),t=0;this.currentReadyPicker!==null&&(t=e.indexOf(this.currentReadyPicker.peekNextSubchannel()),t<0&&(t=0)),this.updateState(Qe.ConnectivityState.READY,new vp(e,t))}else this.countSubchannelsWithState(Qe.ConnectivityState.CONNECTING)>0?this.updateState(Qe.ConnectivityState.CONNECTING,new cc.QueuePicker(this)):this.countSubchannelsWithState(Qe.ConnectivityState.TRANSIENT_FAILURE)>0?this.updateState(Qe.ConnectivityState.TRANSIENT_FAILURE,new cc.UnavailablePicker({details:`No connection established. Last error: ${this.lastError}`})):this.updateState(Qe.ConnectivityState.IDLE,new cc.QueuePicker(this))}updateState(e,t){JS(Qe.ConnectivityState[this.currentState]+" -> "+Qe.ConnectivityState[e]),e===Qe.ConnectivityState.READY?this.currentReadyPicker=t:this.currentReadyPicker=null,this.currentState=e,this.channelControlHelper.updateState(e,t)}resetSubchannelList(){for(let e of this.subchannels)e.removeConnectivityStateListener(this.subchannelStateListener),e.unref(),this.channelControlHelper.removeChannelzChild(e.getChannelzRef());this.subchannels=[]}updateAddressList(e,t){this.resetSubchannelList(),JS("Connect to address list "+e.map(r=>(0,cM.subchannelAddressToString)(r))),this.subchannels=e.map(r=>this.channelControlHelper.createSubchannel(r,{}));for(let r of this.subchannels){r.ref(),r.addConnectivityStateListener(this.subchannelStateListener),this.channelControlHelper.addChannelzChild(r.getChannelzRef());let i=r.getConnectivityState();(i===Qe.ConnectivityState.IDLE||i===Qe.ConnectivityState.TRANSIENT_FAILURE)&&r.startConnecting()}this.calculateAndUpdateState()}exitIdle(){for(let e of this.subchannels)e.startConnecting()}resetBackoff(){}destroy(){this.resetSubchannelList()}getTypeName(){return uc}};Ki.RoundRobinLoadBalancer=dc;function fM(){(0,lM.registerLoadBalancerType)(uc,dc,_p)}Ki.setup=fM});var nE=R(B=>{"use strict";Object.defineProperty(B,"__esModule",{value:!0});B.experimental=B.addAdminServicesToServer=B.getChannelzHandlers=B.getChannelzServiceDefinition=B.InterceptorConfigurationError=B.InterceptingCall=B.RequesterBuilder=B.ListenerBuilder=B.StatusBuilder=B.getClientChannel=B.ServerCredentials=B.Server=B.setLogVerbosity=B.setLogger=B.load=B.loadObject=B.CallCredentials=B.ChannelCredentials=B.waitForClientReady=B.closeClient=B.Channel=B.makeGenericClientConstructor=B.makeClientConstructor=B.loadPackageDefinition=B.Client=B.compressionAlgorithms=B.propagate=B.connectivityState=B.status=B.logVerbosity=B.Metadata=B.credentials=void 0;var hc=fd();Object.defineProperty(B,"CallCredentials",{enumerable:!0,get:function(){return hc.CallCredentials}});var pM=jd();Object.defineProperty(B,"Channel",{enumerable:!0,get:function(){return pM.ChannelImplementation}});var mM=Tf();Object.defineProperty(B,"compressionAlgorithms",{enumerable:!0,get:function(){return mM.CompressionAlgorithms}});var gM=St();Object.defineProperty(B,"connectivityState",{enumerable:!0,get:function(){return gM.ConnectivityState}});var fc=Ao();Object.defineProperty(B,"ChannelCredentials",{enumerable:!0,get:function(){return fc.ChannelCredentials}});var XS=$d();Object.defineProperty(B,"Client",{enumerable:!0,get:function(){return XS.Client}});var bp=le();Object.defineProperty(B,"logVerbosity",{enumerable:!0,get:function(){return bp.LogVerbosity}});Object.defineProperty(B,"status",{enumerable:!0,get:function(){return bp.Status}});Object.defineProperty(B,"propagate",{enumerable:!0,get:function(){return bp.Propagate}});var eE=be(),Sp=Hd();Object.defineProperty(B,"loadPackageDefinition",{enumerable:!0,get:function(){return Sp.loadPackageDefinition}});Object.defineProperty(B,"makeClientConstructor",{enumerable:!0,get:function(){return Sp.makeClientConstructor}});Object.defineProperty(B,"makeGenericClientConstructor",{enumerable:!0,get:function(){return Sp.makeClientConstructor}});var yM=st();Object.defineProperty(B,"Metadata",{enumerable:!0,get:function(){return yM.Metadata}});var _M=MS();Object.defineProperty(B,"Server",{enumerable:!0,get:function(){return _M.Server}});var vM=Jf();Object.defineProperty(B,"ServerCredentials",{enumerable:!0,get:function(){return vM.ServerCredentials}});var bM=PS();Object.defineProperty(B,"StatusBuilder",{enumerable:!0,get:function(){return bM.StatusBuilder}});B.credentials={combineChannelCredentials:(n,...e)=>e.reduce((t,r)=>t.compose(r),n),combineCallCredentials:(n,...e)=>e.reduce((t,r)=>t.compose(r),n),createInsecure:fc.ChannelCredentials.createInsecure,createSsl:fc.ChannelCredentials.createSsl,createFromSecureContext:fc.ChannelCredentials.createFromSecureContext,createFromMetadataGenerator:hc.CallCredentials.createFromMetadataGenerator,createFromGoogleCredential:hc.CallCredentials.createFromGoogleCredential,createEmpty:hc.CallCredentials.createEmpty};var SM=n=>n.close();B.closeClient=SM;var EM=(n,e,t)=>n.waitForReady(e,t);B.waitForClientReady=EM;var wM=(n,e)=>{throw new Error("Not available in this library. Use @grpc/proto-loader and loadPackageDefinition instead")};B.loadObject=wM;var TM=(n,e,t)=>{throw new Error("Not available in this library. Use @grpc/proto-loader and loadPackageDefinition instead")};B.load=TM;var CM=n=>{eE.setLogger(n)};B.setLogger=CM;var IM=n=>{eE.setLoggerVerbosity(n)};B.setLogVerbosity=IM;var AM=n=>XS.Client.prototype.getChannel.call(n);B.getClientChannel=AM;var pc=Vd();Object.defineProperty(B,"ListenerBuilder",{enumerable:!0,get:function(){return pc.ListenerBuilder}});Object.defineProperty(B,"RequesterBuilder",{enumerable:!0,get:function(){return pc.RequesterBuilder}});Object.defineProperty(B,"InterceptingCall",{enumerable:!0,get:function(){return pc.InterceptingCall}});Object.defineProperty(B,"InterceptorConfigurationError",{enumerable:!0,get:function(){return pc.InterceptorConfigurationError}});var tE=Ur();Object.defineProperty(B,"getChannelzServiceDefinition",{enumerable:!0,get:function(){return tE.getChannelzServiceDefinition}});Object.defineProperty(B,"getChannelzHandlers",{enumerable:!0,get:function(){return tE.getChannelzHandlers}});var RM=Lo();Object.defineProperty(B,"addAdminServicesToServer",{enumerable:!0,get:function(){return RM.addAdminServicesToServer}});var DM=up();B.experimental=DM;var xM=df(),NM=zS(),OM=HS(),kM=YS(),MM=ZS(),PM=cp(),LM=Ur();xM.setup(),NM.setup(),OM.setup(),kM.setup(),MM.setup(),PM.setup(),LM.setup()});var X3={};ET(X3,{default:()=>nu});module.exports=wT(X3);var yt=require("obsidian");var eo=iu(require("crypto"));function ri(n){let e=n.length;for(;--e>=0;)n[e]=0}var TT=0,by=1,CT=2,IT=3,AT=258,Ru=29,Ps=256,As=Ps+1+Ru,ei=30,Du=19,Sy=2*As+1,wr=15,su=16,RT=7,xu=256,Ey=16,wy=17,Ty=18,vu=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),lo=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),DT=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),Cy=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),xT=512,yn=new Array((As+2)*2);ri(yn);var Ts=new Array(ei*2);ri(Ts);var Rs=new Array(xT);ri(Rs);var Ds=new Array(AT-IT+1);ri(Ds);var Nu=new Array(Ru);ri(Nu);var co=new Array(ei);ri(co);function au(n,e,t,r,i){this.static_tree=n,this.extra_bits=e,this.extra_base=t,this.elems=r,this.max_length=i,this.has_stree=n&&n.length}var Iy,Ay,Ry;function ou(n,e){this.dyn_tree=n,this.max_code=0,this.stat_desc=e}var Dy=n=>n<256?Rs[n]:Rs[256+(n>>>7)],xs=(n,e)=>{n.pending_buf[n.pending++]=e&255,n.pending_buf[n.pending++]=e>>>8&255},it=(n,e,t)=>{n.bi_valid>su-t?(n.bi_buf|=e<<n.bi_valid&65535,xs(n,n.bi_buf),n.bi_buf=e>>su-n.bi_valid,n.bi_valid+=t-su):(n.bi_buf|=e<<n.bi_valid&65535,n.bi_valid+=t)},$t=(n,e,t)=>{it(n,t[e*2],t[e*2+1])},xy=(n,e)=>{let t=0;do t|=n&1,n>>>=1,t<<=1;while(--e>0);return t>>>1},NT=n=>{n.bi_valid===16?(xs(n,n.bi_buf),n.bi_buf=0,n.bi_valid=0):n.bi_valid>=8&&(n.pending_buf[n.pending++]=n.bi_buf&255,n.bi_buf>>=8,n.bi_valid-=8)},OT=(n,e)=>{let t=e.dyn_tree,r=e.max_code,i=e.stat_desc.static_tree,s=e.stat_desc.has_stree,a=e.stat_desc.extra_bits,o=e.stat_desc.extra_base,l=e.stat_desc.max_length,c,u,m,d,p,E,C=0;for(d=0;d<=wr;d++)n.bl_count[d]=0;for(t[n.heap[n.heap_max]*2+1]=0,c=n.heap_max+1;c<Sy;c++)u=n.heap[c],d=t[t[u*2+1]*2+1]+1,d>l&&(d=l,C++),t[u*2+1]=d,!(u>r)&&(n.bl_count[d]++,p=0,u>=o&&(p=a[u-o]),E=t[u*2],n.opt_len+=E*(d+p),s&&(n.static_len+=E*(i[u*2+1]+p)));if(C!==0){do{for(d=l-1;n.bl_count[d]===0;)d--;n.bl_count[d]--,n.bl_count[d+1]+=2,n.bl_count[l]--,C-=2}while(C>0);for(d=l;d!==0;d--)for(u=n.bl_count[d];u!==0;)m=n.heap[--c],!(m>r)&&(t[m*2+1]!==d&&(n.opt_len+=(d-t[m*2+1])*t[m*2],t[m*2+1]=d),u--)}},Ny=(n,e,t)=>{let r=new Array(wr+1),i=0,s,a;for(s=1;s<=wr;s++)i=i+t[s-1]<<1,r[s]=i;for(a=0;a<=e;a++){let o=n[a*2+1];o!==0&&(n[a*2]=xy(r[o]++,o))}},kT=()=>{let n,e,t,r,i,s=new Array(wr+1);for(t=0,r=0;r<Ru-1;r++)for(Nu[r]=t,n=0;n<1<<vu[r];n++)Ds[t++]=r;for(Ds[t-1]=r,i=0,r=0;r<16;r++)for(co[r]=i,n=0;n<1<<lo[r];n++)Rs[i++]=r;for(i>>=7;r<ei;r++)for(co[r]=i<<7,n=0;n<1<<lo[r]-7;n++)Rs[256+i++]=r;for(e=0;e<=wr;e++)s[e]=0;for(n=0;n<=143;)yn[n*2+1]=8,n++,s[8]++;for(;n<=255;)yn[n*2+1]=9,n++,s[9]++;for(;n<=279;)yn[n*2+1]=7,n++,s[7]++;for(;n<=287;)yn[n*2+1]=8,n++,s[8]++;for(Ny(yn,As+1,s),n=0;n<ei;n++)Ts[n*2+1]=5,Ts[n*2]=xy(n,5);Iy=new au(yn,vu,Ps+1,As,wr),Ay=new au(Ts,lo,0,ei,wr),Ry=new au(new Array(0),DT,0,Du,RT)},Oy=n=>{let e;for(e=0;e<As;e++)n.dyn_ltree[e*2]=0;for(e=0;e<ei;e++)n.dyn_dtree[e*2]=0;for(e=0;e<Du;e++)n.bl_tree[e*2]=0;n.dyn_ltree[xu*2]=1,n.opt_len=n.static_len=0,n.sym_next=n.matches=0},ky=n=>{n.bi_valid>8?xs(n,n.bi_buf):n.bi_valid>0&&(n.pending_buf[n.pending++]=n.bi_buf),n.bi_buf=0,n.bi_valid=0},Lg=(n,e,t,r)=>{let i=e*2,s=t*2;return n[i]<n[s]||n[i]===n[s]&&r[e]<=r[t]},lu=(n,e,t)=>{let r=n.heap[t],i=t<<1;for(;i<=n.heap_len&&(i<n.heap_len&&Lg(e,n.heap[i+1],n.heap[i],n.depth)&&i++,!Lg(e,r,n.heap[i],n.depth));)n.heap[t]=n.heap[i],t=i,i<<=1;n.heap[t]=r},Fg=(n,e,t)=>{let r,i,s=0,a,o;if(n.sym_next!==0)do r=n.pending_buf[n.sym_buf+s++]&255,r+=(n.pending_buf[n.sym_buf+s++]&255)<<8,i=n.pending_buf[n.sym_buf+s++],r===0?$t(n,i,e):(a=Ds[i],$t(n,a+Ps+1,e),o=vu[a],o!==0&&(i-=Nu[a],it(n,i,o)),r--,a=Dy(r),$t(n,a,t),o=lo[a],o!==0&&(r-=co[a],it(n,r,o)));while(s<n.sym_next);$t(n,xu,e)},bu=(n,e)=>{let t=e.dyn_tree,r=e.stat_desc.static_tree,i=e.stat_desc.has_stree,s=e.stat_desc.elems,a,o,l=-1,c;for(n.heap_len=0,n.heap_max=Sy,a=0;a<s;a++)t[a*2]!==0?(n.heap[++n.heap_len]=l=a,n.depth[a]=0):t[a*2+1]=0;for(;n.heap_len<2;)c=n.heap[++n.heap_len]=l<2?++l:0,t[c*2]=1,n.depth[c]=0,n.opt_len--,i&&(n.static_len-=r[c*2+1]);for(e.max_code=l,a=n.heap_len>>1;a>=1;a--)lu(n,t,a);c=s;do a=n.heap[1],n.heap[1]=n.heap[n.heap_len--],lu(n,t,1),o=n.heap[1],n.heap[--n.heap_max]=a,n.heap[--n.heap_max]=o,t[c*2]=t[a*2]+t[o*2],n.depth[c]=(n.depth[a]>=n.depth[o]?n.depth[a]:n.depth[o])+1,t[a*2+1]=t[o*2+1]=c,n.heap[1]=c++,lu(n,t,1);while(n.heap_len>=2);n.heap[--n.heap_max]=n.heap[1],OT(n,e),Ny(t,l,n.bl_count)},Bg=(n,e,t)=>{let r,i=-1,s,a=e[1],o=0,l=7,c=4;for(a===0&&(l=138,c=3),e[(t+1)*2+1]=65535,r=0;r<=t;r++)s=a,a=e[(r+1)*2+1],!(++o<l&&s===a)&&(o<c?n.bl_tree[s*2]+=o:s!==0?(s!==i&&n.bl_tree[s*2]++,n.bl_tree[Ey*2]++):o<=10?n.bl_tree[wy*2]++:n.bl_tree[Ty*2]++,o=0,i=s,a===0?(l=138,c=3):s===a?(l=6,c=3):(l=7,c=4))},Ug=(n,e,t)=>{let r,i=-1,s,a=e[1],o=0,l=7,c=4;for(a===0&&(l=138,c=3),r=0;r<=t;r++)if(s=a,a=e[(r+1)*2+1],!(++o<l&&s===a)){if(o<c)do $t(n,s,n.bl_tree);while(--o!==0);else s!==0?(s!==i&&($t(n,s,n.bl_tree),o--),$t(n,Ey,n.bl_tree),it(n,o-3,2)):o<=10?($t(n,wy,n.bl_tree),it(n,o-3,3)):($t(n,Ty,n.bl_tree),it(n,o-11,7));o=0,i=s,a===0?(l=138,c=3):s===a?(l=6,c=3):(l=7,c=4)}},MT=n=>{let e;for(Bg(n,n.dyn_ltree,n.l_desc.max_code),Bg(n,n.dyn_dtree,n.d_desc.max_code),bu(n,n.bl_desc),e=Du-1;e>=3&&n.bl_tree[Cy[e]*2+1]===0;e--);return n.opt_len+=3*(e+1)+5+5+4,e},PT=(n,e,t,r)=>{let i;for(it(n,e-257,5),it(n,t-1,5),it(n,r-4,4),i=0;i<r;i++)it(n,n.bl_tree[Cy[i]*2+1],3);Ug(n,n.dyn_ltree,e-1),Ug(n,n.dyn_dtree,t-1)},LT=n=>{let e=4093624447,t;for(t=0;t<=31;t++,e>>>=1)if(e&1&&n.dyn_ltree[t*2]!==0)return 0;if(n.dyn_ltree[18]!==0||n.dyn_ltree[20]!==0||n.dyn_ltree[26]!==0)return 1;for(t=32;t<Ps;t++)if(n.dyn_ltree[t*2]!==0)return 1;return 0},qg=!1,FT=n=>{qg||(kT(),qg=!0),n.l_desc=new ou(n.dyn_ltree,Iy),n.d_desc=new ou(n.dyn_dtree,Ay),n.bl_desc=new ou(n.bl_tree,Ry),n.bi_buf=0,n.bi_valid=0,Oy(n)},My=(n,e,t,r)=>{it(n,(TT<<1)+(r?1:0),3),ky(n),xs(n,t),xs(n,~t),t&&n.pending_buf.set(n.window.subarray(e,e+t),n.pending),n.pending+=t},BT=n=>{it(n,by<<1,3),$t(n,xu,yn),NT(n)},UT=(n,e,t,r)=>{let i,s,a=0;n.level>0?(n.strm.data_type===2&&(n.strm.data_type=LT(n)),bu(n,n.l_desc),bu(n,n.d_desc),a=MT(n),i=n.opt_len+3+7>>>3,s=n.static_len+3+7>>>3,s<=i&&(i=s)):i=s=t+5,t+4<=i&&e!==-1?My(n,e,t,r):n.strategy===4||s===i?(it(n,(by<<1)+(r?1:0),3),Fg(n,yn,Ts)):(it(n,(CT<<1)+(r?1:0),3),PT(n,n.l_desc.max_code+1,n.d_desc.max_code+1,a+1),Fg(n,n.dyn_ltree,n.dyn_dtree)),Oy(n),r&&ky(n)},qT=(n,e,t)=>(n.pending_buf[n.sym_buf+n.sym_next++]=e,n.pending_buf[n.sym_buf+n.sym_next++]=e>>8,n.pending_buf[n.sym_buf+n.sym_next++]=t,e===0?n.dyn_ltree[t*2]++:(n.matches++,e--,n.dyn_ltree[(Ds[t]+Ps+1)*2]++,n.dyn_dtree[Dy(e)*2]++),n.sym_next===n.sym_end),VT=FT,zT=My,GT=UT,$T=qT,jT=BT,KT={_tr_init:VT,_tr_stored_block:zT,_tr_flush_block:GT,_tr_tally:$T,_tr_align:jT},HT=(n,e,t,r)=>{let i=n&65535|0,s=n>>>16&65535|0,a=0;for(;t!==0;){a=t>2e3?2e3:t,t-=a;do i=i+e[r++]|0,s=s+i|0;while(--a);i%=65521,s%=65521}return i|s<<16|0},Ns=HT,WT=()=>{let n,e=[];for(var t=0;t<256;t++){n=t;for(var r=0;r<8;r++)n=n&1?3988292384^n>>>1:n>>>1;e[t]=n}return e},QT=new Uint32Array(WT()),YT=(n,e,t,r)=>{let i=QT,s=r+t;n^=-1;for(let a=r;a<s;a++)n=n>>>8^i[(n^e[a])&255];return n^-1},Me=YT,Ir={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},ii={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8},{_tr_init:JT,_tr_stored_block:Su,_tr_flush_block:ZT,_tr_tally:Bn,_tr_align:XT}=KT,{Z_NO_FLUSH:Un,Z_PARTIAL_FLUSH:eC,Z_FULL_FLUSH:tC,Z_FINISH:_t,Z_BLOCK:Vg,Z_OK:ze,Z_STREAM_END:zg,Z_STREAM_ERROR:jt,Z_DATA_ERROR:nC,Z_BUF_ERROR:cu,Z_DEFAULT_COMPRESSION:rC,Z_FILTERED:iC,Z_HUFFMAN_ONLY:ro,Z_RLE:sC,Z_FIXED:aC,Z_DEFAULT_STRATEGY:oC,Z_UNKNOWN:lC,Z_DEFLATED:fo}=ii,cC=9,uC=15,dC=8,hC=29,fC=256,Eu=fC+1+hC,pC=30,mC=19,gC=2*Eu+1,yC=15,Z=3,Fn=258,Kt=Fn+Z+1,_C=32,ti=42,Ou=57,wu=69,Tu=73,Cu=91,Iu=103,Tr=113,Es=666,tt=1,si=2,Ar=3,ai=4,vC=3,Cr=(n,e)=>(n.msg=Ir[e],e),Gg=n=>n*2-(n>4?9:0),Ln=n=>{let e=n.length;for(;--e>=0;)n[e]=0},bC=n=>{let e,t,r,i=n.w_size;e=n.hash_size,r=e;do t=n.head[--r],n.head[r]=t>=i?t-i:0;while(--e);e=i,r=e;do t=n.prev[--r],n.prev[r]=t>=i?t-i:0;while(--e)},SC=(n,e,t)=>(e<<n.hash_shift^t)&n.hash_mask,qn=SC,ut=n=>{let e=n.state,t=e.pending;t>n.avail_out&&(t=n.avail_out),t!==0&&(n.output.set(e.pending_buf.subarray(e.pending_out,e.pending_out+t),n.next_out),n.next_out+=t,e.pending_out+=t,n.total_out+=t,n.avail_out-=t,e.pending-=t,e.pending===0&&(e.pending_out=0))},dt=(n,e)=>{ZT(n,n.block_start>=0?n.block_start:-1,n.strstart-n.block_start,e),n.block_start=n.strstart,ut(n.strm)},oe=(n,e)=>{n.pending_buf[n.pending++]=e},Ss=(n,e)=>{n.pending_buf[n.pending++]=e>>>8&255,n.pending_buf[n.pending++]=e&255},Au=(n,e,t,r)=>{let i=n.avail_in;return i>r&&(i=r),i===0?0:(n.avail_in-=i,e.set(n.input.subarray(n.next_in,n.next_in+i),t),n.state.wrap===1?n.adler=Ns(n.adler,e,i,t):n.state.wrap===2&&(n.adler=Me(n.adler,e,i,t)),n.next_in+=i,n.total_in+=i,i)},Py=(n,e)=>{let t=n.max_chain_length,r=n.strstart,i,s,a=n.prev_length,o=n.nice_match,l=n.strstart>n.w_size-Kt?n.strstart-(n.w_size-Kt):0,c=n.window,u=n.w_mask,m=n.prev,d=n.strstart+Fn,p=c[r+a-1],E=c[r+a];n.prev_length>=n.good_match&&(t>>=2),o>n.lookahead&&(o=n.lookahead);do if(i=e,!(c[i+a]!==E||c[i+a-1]!==p||c[i]!==c[r]||c[++i]!==c[r+1])){r+=2,i++;do;while(c[++r]===c[++i]&&c[++r]===c[++i]&&c[++r]===c[++i]&&c[++r]===c[++i]&&c[++r]===c[++i]&&c[++r]===c[++i]&&c[++r]===c[++i]&&c[++r]===c[++i]&&r<d);if(s=Fn-(d-r),r=d-Fn,s>a){if(n.match_start=e,a=s,s>=o)break;p=c[r+a-1],E=c[r+a]}}while((e=m[e&u])>l&&--t!==0);return a<=n.lookahead?a:n.lookahead},ni=n=>{let e=n.w_size,t,r,i;do{if(r=n.window_size-n.lookahead-n.strstart,n.strstart>=e+(e-Kt)&&(n.window.set(n.window.subarray(e,e+e-r),0),n.match_start-=e,n.strstart-=e,n.block_start-=e,n.insert>n.strstart&&(n.insert=n.strstart),bC(n),r+=e),n.strm.avail_in===0)break;if(t=Au(n.strm,n.window,n.strstart+n.lookahead,r),n.lookahead+=t,n.lookahead+n.insert>=Z)for(i=n.strstart-n.insert,n.ins_h=n.window[i],n.ins_h=qn(n,n.ins_h,n.window[i+1]);n.insert&&(n.ins_h=qn(n,n.ins_h,n.window[i+Z-1]),n.prev[i&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=i,i++,n.insert--,!(n.lookahead+n.insert<Z)););}while(n.lookahead<Kt&&n.strm.avail_in!==0)},Ly=(n,e)=>{let t=n.pending_buf_size-5>n.w_size?n.w_size:n.pending_buf_size-5,r,i,s,a=0,o=n.strm.avail_in;do{if(r=65535,s=n.bi_valid+42>>3,n.strm.avail_out<s||(s=n.strm.avail_out-s,i=n.strstart-n.block_start,r>i+n.strm.avail_in&&(r=i+n.strm.avail_in),r>s&&(r=s),r<t&&(r===0&&e!==_t||e===Un||r!==i+n.strm.avail_in)))break;a=e===_t&&r===i+n.strm.avail_in?1:0,Su(n,0,0,a),n.pending_buf[n.pending-4]=r,n.pending_buf[n.pending-3]=r>>8,n.pending_buf[n.pending-2]=~r,n.pending_buf[n.pending-1]=~r>>8,ut(n.strm),i&&(i>r&&(i=r),n.strm.output.set(n.window.subarray(n.block_start,n.block_start+i),n.strm.next_out),n.strm.next_out+=i,n.strm.avail_out-=i,n.strm.total_out+=i,n.block_start+=i,r-=i),r&&(Au(n.strm,n.strm.output,n.strm.next_out,r),n.strm.next_out+=r,n.strm.avail_out-=r,n.strm.total_out+=r)}while(a===0);return o-=n.strm.avail_in,o&&(o>=n.w_size?(n.matches=2,n.window.set(n.strm.input.subarray(n.strm.next_in-n.w_size,n.strm.next_in),0),n.strstart=n.w_size,n.insert=n.strstart):(n.window_size-n.strstart<=o&&(n.strstart-=n.w_size,n.window.set(n.window.subarray(n.w_size,n.w_size+n.strstart),0),n.matches<2&&n.matches++,n.insert>n.strstart&&(n.insert=n.strstart)),n.window.set(n.strm.input.subarray(n.strm.next_in-o,n.strm.next_in),n.strstart),n.strstart+=o,n.insert+=o>n.w_size-n.insert?n.w_size-n.insert:o),n.block_start=n.strstart),n.high_water<n.strstart&&(n.high_water=n.strstart),a?ai:e!==Un&&e!==_t&&n.strm.avail_in===0&&n.strstart===n.block_start?si:(s=n.window_size-n.strstart,n.strm.avail_in>s&&n.block_start>=n.w_size&&(n.block_start-=n.w_size,n.strstart-=n.w_size,n.window.set(n.window.subarray(n.w_size,n.w_size+n.strstart),0),n.matches<2&&n.matches++,s+=n.w_size,n.insert>n.strstart&&(n.insert=n.strstart)),s>n.strm.avail_in&&(s=n.strm.avail_in),s&&(Au(n.strm,n.window,n.strstart,s),n.strstart+=s,n.insert+=s>n.w_size-n.insert?n.w_size-n.insert:s),n.high_water<n.strstart&&(n.high_water=n.strstart),s=n.bi_valid+42>>3,s=n.pending_buf_size-s>65535?65535:n.pending_buf_size-s,t=s>n.w_size?n.w_size:s,i=n.strstart-n.block_start,(i>=t||(i||e===_t)&&e!==Un&&n.strm.avail_in===0&&i<=s)&&(r=i>s?s:i,a=e===_t&&n.strm.avail_in===0&&r===i?1:0,Su(n,n.block_start,r,a),n.block_start+=r,ut(n.strm)),a?Ar:tt)},uu=(n,e)=>{let t,r;for(;;){if(n.lookahead<Kt){if(ni(n),n.lookahead<Kt&&e===Un)return tt;if(n.lookahead===0)break}if(t=0,n.lookahead>=Z&&(n.ins_h=qn(n,n.ins_h,n.window[n.strstart+Z-1]),t=n.prev[n.strstart&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=n.strstart),t!==0&&n.strstart-t<=n.w_size-Kt&&(n.match_length=Py(n,t)),n.match_length>=Z)if(r=Bn(n,n.strstart-n.match_start,n.match_length-Z),n.lookahead-=n.match_length,n.match_length<=n.max_lazy_match&&n.lookahead>=Z){n.match_length--;do n.strstart++,n.ins_h=qn(n,n.ins_h,n.window[n.strstart+Z-1]),t=n.prev[n.strstart&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=n.strstart;while(--n.match_length!==0);n.strstart++}else n.strstart+=n.match_length,n.match_length=0,n.ins_h=n.window[n.strstart],n.ins_h=qn(n,n.ins_h,n.window[n.strstart+1]);else r=Bn(n,0,n.window[n.strstart]),n.lookahead--,n.strstart++;if(r&&(dt(n,!1),n.strm.avail_out===0))return tt}return n.insert=n.strstart<Z-1?n.strstart:Z-1,e===_t?(dt(n,!0),n.strm.avail_out===0?Ar:ai):n.sym_next&&(dt(n,!1),n.strm.avail_out===0)?tt:si},Zr=(n,e)=>{let t,r,i;for(;;){if(n.lookahead<Kt){if(ni(n),n.lookahead<Kt&&e===Un)return tt;if(n.lookahead===0)break}if(t=0,n.lookahead>=Z&&(n.ins_h=qn(n,n.ins_h,n.window[n.strstart+Z-1]),t=n.prev[n.strstart&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=n.strstart),n.prev_length=n.match_length,n.prev_match=n.match_start,n.match_length=Z-1,t!==0&&n.prev_length<n.max_lazy_match&&n.strstart-t<=n.w_size-Kt&&(n.match_length=Py(n,t),n.match_length<=5&&(n.strategy===iC||n.match_length===Z&&n.strstart-n.match_start>4096)&&(n.match_length=Z-1)),n.prev_length>=Z&&n.match_length<=n.prev_length){i=n.strstart+n.lookahead-Z,r=Bn(n,n.strstart-1-n.prev_match,n.prev_length-Z),n.lookahead-=n.prev_length-1,n.prev_length-=2;do++n.strstart<=i&&(n.ins_h=qn(n,n.ins_h,n.window[n.strstart+Z-1]),t=n.prev[n.strstart&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=n.strstart);while(--n.prev_length!==0);if(n.match_available=0,n.match_length=Z-1,n.strstart++,r&&(dt(n,!1),n.strm.avail_out===0))return tt}else if(n.match_available){if(r=Bn(n,0,n.window[n.strstart-1]),r&&dt(n,!1),n.strstart++,n.lookahead--,n.strm.avail_out===0)return tt}else n.match_available=1,n.strstart++,n.lookahead--}return n.match_available&&(r=Bn(n,0,n.window[n.strstart-1]),n.match_available=0),n.insert=n.strstart<Z-1?n.strstart:Z-1,e===_t?(dt(n,!0),n.strm.avail_out===0?Ar:ai):n.sym_next&&(dt(n,!1),n.strm.avail_out===0)?tt:si},EC=(n,e)=>{let t,r,i,s,a=n.window;for(;;){if(n.lookahead<=Fn){if(ni(n),n.lookahead<=Fn&&e===Un)return tt;if(n.lookahead===0)break}if(n.match_length=0,n.lookahead>=Z&&n.strstart>0&&(i=n.strstart-1,r=a[i],r===a[++i]&&r===a[++i]&&r===a[++i])){s=n.strstart+Fn;do;while(r===a[++i]&&r===a[++i]&&r===a[++i]&&r===a[++i]&&r===a[++i]&&r===a[++i]&&r===a[++i]&&r===a[++i]&&i<s);n.match_length=Fn-(s-i),n.match_length>n.lookahead&&(n.match_length=n.lookahead)}if(n.match_length>=Z?(t=Bn(n,1,n.match_length-Z),n.lookahead-=n.match_length,n.strstart+=n.match_length,n.match_length=0):(t=Bn(n,0,n.window[n.strstart]),n.lookahead--,n.strstart++),t&&(dt(n,!1),n.strm.avail_out===0))return tt}return n.insert=0,e===_t?(dt(n,!0),n.strm.avail_out===0?Ar:ai):n.sym_next&&(dt(n,!1),n.strm.avail_out===0)?tt:si},wC=(n,e)=>{let t;for(;;){if(n.lookahead===0&&(ni(n),n.lookahead===0)){if(e===Un)return tt;break}if(n.match_length=0,t=Bn(n,0,n.window[n.strstart]),n.lookahead--,n.strstart++,t&&(dt(n,!1),n.strm.avail_out===0))return tt}return n.insert=0,e===_t?(dt(n,!0),n.strm.avail_out===0?Ar:ai):n.sym_next&&(dt(n,!1),n.strm.avail_out===0)?tt:si};function Gt(n,e,t,r,i){this.good_length=n,this.max_lazy=e,this.nice_length=t,this.max_chain=r,this.func=i}var ws=[new Gt(0,0,0,0,Ly),new Gt(4,4,8,4,uu),new Gt(4,5,16,8,uu),new Gt(4,6,32,32,uu),new Gt(4,4,16,16,Zr),new Gt(8,16,32,32,Zr),new Gt(8,16,128,128,Zr),new Gt(8,32,128,256,Zr),new Gt(32,128,258,1024,Zr),new Gt(32,258,258,4096,Zr)],TC=n=>{n.window_size=2*n.w_size,Ln(n.head),n.max_lazy_match=ws[n.level].max_lazy,n.good_match=ws[n.level].good_length,n.nice_match=ws[n.level].nice_length,n.max_chain_length=ws[n.level].max_chain,n.strstart=0,n.block_start=0,n.lookahead=0,n.insert=0,n.match_length=n.prev_length=Z-1,n.match_available=0,n.ins_h=0};function CC(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=fo,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(gC*2),this.dyn_dtree=new Uint16Array((2*pC+1)*2),this.bl_tree=new Uint16Array((2*mC+1)*2),Ln(this.dyn_ltree),Ln(this.dyn_dtree),Ln(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(yC+1),this.heap=new Uint16Array(2*Eu+1),Ln(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(2*Eu+1),Ln(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}var Ls=n=>{if(!n)return 1;let e=n.state;return!e||e.strm!==n||e.status!==ti&&e.status!==Ou&&e.status!==wu&&e.status!==Tu&&e.status!==Cu&&e.status!==Iu&&e.status!==Tr&&e.status!==Es?1:0},Fy=n=>{if(Ls(n))return Cr(n,jt);n.total_in=n.total_out=0,n.data_type=lC;let e=n.state;return e.pending=0,e.pending_out=0,e.wrap<0&&(e.wrap=-e.wrap),e.status=e.wrap===2?Ou:e.wrap?ti:Tr,n.adler=e.wrap===2?0:1,e.last_flush=-2,JT(e),ze},By=n=>{let e=Fy(n);return e===ze&&TC(n.state),e},IC=(n,e)=>Ls(n)||n.state.wrap!==2?jt:(n.state.gzhead=e,ze),Uy=(n,e,t,r,i,s)=>{if(!n)return jt;let a=1;if(e===rC&&(e=6),r<0?(a=0,r=-r):r>15&&(a=2,r-=16),i<1||i>cC||t!==fo||r<8||r>15||e<0||e>9||s<0||s>aC||r===8&&a!==1)return Cr(n,jt);r===8&&(r=9);let o=new CC;return n.state=o,o.strm=n,o.status=ti,o.wrap=a,o.gzhead=null,o.w_bits=r,o.w_size=1<<o.w_bits,o.w_mask=o.w_size-1,o.hash_bits=i+7,o.hash_size=1<<o.hash_bits,o.hash_mask=o.hash_size-1,o.hash_shift=~~((o.hash_bits+Z-1)/Z),o.window=new Uint8Array(o.w_size*2),o.head=new Uint16Array(o.hash_size),o.prev=new Uint16Array(o.w_size),o.lit_bufsize=1<<i+6,o.pending_buf_size=o.lit_bufsize*4,o.pending_buf=new Uint8Array(o.pending_buf_size),o.sym_buf=o.lit_bufsize,o.sym_end=(o.lit_bufsize-1)*3,o.level=e,o.strategy=s,o.method=t,By(n)},AC=(n,e)=>Uy(n,e,fo,uC,dC,oC),RC=(n,e)=>{if(Ls(n)||e>Vg||e<0)return n?Cr(n,jt):jt;let t=n.state;if(!n.output||n.avail_in!==0&&!n.input||t.status===Es&&e!==_t)return Cr(n,n.avail_out===0?cu:jt);let r=t.last_flush;if(t.last_flush=e,t.pending!==0){if(ut(n),n.avail_out===0)return t.last_flush=-1,ze}else if(n.avail_in===0&&Gg(e)<=Gg(r)&&e!==_t)return Cr(n,cu);if(t.status===Es&&n.avail_in!==0)return Cr(n,cu);if(t.status===ti&&t.wrap===0&&(t.status=Tr),t.status===ti){let i=fo+(t.w_bits-8<<4)<<8,s=-1;if(t.strategy>=ro||t.level<2?s=0:t.level<6?s=1:t.level===6?s=2:s=3,i|=s<<6,t.strstart!==0&&(i|=_C),i+=31-i%31,Ss(t,i),t.strstart!==0&&(Ss(t,n.adler>>>16),Ss(t,n.adler&65535)),n.adler=1,t.status=Tr,ut(n),t.pending!==0)return t.last_flush=-1,ze}if(t.status===Ou){if(n.adler=0,oe(t,31),oe(t,139),oe(t,8),t.gzhead)oe(t,(t.gzhead.text?1:0)+(t.gzhead.hcrc?2:0)+(t.gzhead.extra?4:0)+(t.gzhead.name?8:0)+(t.gzhead.comment?16:0)),oe(t,t.gzhead.time&255),oe(t,t.gzhead.time>>8&255),oe(t,t.gzhead.time>>16&255),oe(t,t.gzhead.time>>24&255),oe(t,t.level===9?2:t.strategy>=ro||t.level<2?4:0),oe(t,t.gzhead.os&255),t.gzhead.extra&&t.gzhead.extra.length&&(oe(t,t.gzhead.extra.length&255),oe(t,t.gzhead.extra.length>>8&255)),t.gzhead.hcrc&&(n.adler=Me(n.adler,t.pending_buf,t.pending,0)),t.gzindex=0,t.status=wu;else if(oe(t,0),oe(t,0),oe(t,0),oe(t,0),oe(t,0),oe(t,t.level===9?2:t.strategy>=ro||t.level<2?4:0),oe(t,vC),t.status=Tr,ut(n),t.pending!==0)return t.last_flush=-1,ze}if(t.status===wu){if(t.gzhead.extra){let i=t.pending,s=(t.gzhead.extra.length&65535)-t.gzindex;for(;t.pending+s>t.pending_buf_size;){let o=t.pending_buf_size-t.pending;if(t.pending_buf.set(t.gzhead.extra.subarray(t.gzindex,t.gzindex+o),t.pending),t.pending=t.pending_buf_size,t.gzhead.hcrc&&t.pending>i&&(n.adler=Me(n.adler,t.pending_buf,t.pending-i,i)),t.gzindex+=o,ut(n),t.pending!==0)return t.last_flush=-1,ze;i=0,s-=o}let a=new Uint8Array(t.gzhead.extra);t.pending_buf.set(a.subarray(t.gzindex,t.gzindex+s),t.pending),t.pending+=s,t.gzhead.hcrc&&t.pending>i&&(n.adler=Me(n.adler,t.pending_buf,t.pending-i,i)),t.gzindex=0}t.status=Tu}if(t.status===Tu){if(t.gzhead.name){let i=t.pending,s;do{if(t.pending===t.pending_buf_size){if(t.gzhead.hcrc&&t.pending>i&&(n.adler=Me(n.adler,t.pending_buf,t.pending-i,i)),ut(n),t.pending!==0)return t.last_flush=-1,ze;i=0}t.gzindex<t.gzhead.name.length?s=t.gzhead.name.charCodeAt(t.gzindex++)&255:s=0,oe(t,s)}while(s!==0);t.gzhead.hcrc&&t.pending>i&&(n.adler=Me(n.adler,t.pending_buf,t.pending-i,i)),t.gzindex=0}t.status=Cu}if(t.status===Cu){if(t.gzhead.comment){let i=t.pending,s;do{if(t.pending===t.pending_buf_size){if(t.gzhead.hcrc&&t.pending>i&&(n.adler=Me(n.adler,t.pending_buf,t.pending-i,i)),ut(n),t.pending!==0)return t.last_flush=-1,ze;i=0}t.gzindex<t.gzhead.comment.length?s=t.gzhead.comment.charCodeAt(t.gzindex++)&255:s=0,oe(t,s)}while(s!==0);t.gzhead.hcrc&&t.pending>i&&(n.adler=Me(n.adler,t.pending_buf,t.pending-i,i))}t.status=Iu}if(t.status===Iu){if(t.gzhead.hcrc){if(t.pending+2>t.pending_buf_size&&(ut(n),t.pending!==0))return t.last_flush=-1,ze;oe(t,n.adler&255),oe(t,n.adler>>8&255),n.adler=0}if(t.status=Tr,ut(n),t.pending!==0)return t.last_flush=-1,ze}if(n.avail_in!==0||t.lookahead!==0||e!==Un&&t.status!==Es){let i=t.level===0?Ly(t,e):t.strategy===ro?wC(t,e):t.strategy===sC?EC(t,e):ws[t.level].func(t,e);if((i===Ar||i===ai)&&(t.status=Es),i===tt||i===Ar)return n.avail_out===0&&(t.last_flush=-1),ze;if(i===si&&(e===eC?XT(t):e!==Vg&&(Su(t,0,0,!1),e===tC&&(Ln(t.head),t.lookahead===0&&(t.strstart=0,t.block_start=0,t.insert=0))),ut(n),n.avail_out===0))return t.last_flush=-1,ze}return e!==_t?ze:t.wrap<=0?zg:(t.wrap===2?(oe(t,n.adler&255),oe(t,n.adler>>8&255),oe(t,n.adler>>16&255),oe(t,n.adler>>24&255),oe(t,n.total_in&255),oe(t,n.total_in>>8&255),oe(t,n.total_in>>16&255),oe(t,n.total_in>>24&255)):(Ss(t,n.adler>>>16),Ss(t,n.adler&65535)),ut(n),t.wrap>0&&(t.wrap=-t.wrap),t.pending!==0?ze:zg)},DC=n=>{if(Ls(n))return jt;let e=n.state.status;return n.state=null,e===Tr?Cr(n,nC):ze},xC=(n,e)=>{let t=e.length;if(Ls(n))return jt;let r=n.state,i=r.wrap;if(i===2||i===1&&r.status!==ti||r.lookahead)return jt;if(i===1&&(n.adler=Ns(n.adler,e,t,0)),r.wrap=0,t>=r.w_size){i===0&&(Ln(r.head),r.strstart=0,r.block_start=0,r.insert=0);let l=new Uint8Array(r.w_size);l.set(e.subarray(t-r.w_size,t),0),e=l,t=r.w_size}let s=n.avail_in,a=n.next_in,o=n.input;for(n.avail_in=t,n.next_in=0,n.input=e,ni(r);r.lookahead>=Z;){let l=r.strstart,c=r.lookahead-(Z-1);do r.ins_h=qn(r,r.ins_h,r.window[l+Z-1]),r.prev[l&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=l,l++;while(--c);r.strstart=l,r.lookahead=Z-1,ni(r)}return r.strstart+=r.lookahead,r.block_start=r.strstart,r.insert=r.lookahead,r.lookahead=0,r.match_length=r.prev_length=Z-1,r.match_available=0,n.next_in=a,n.input=o,n.avail_in=s,r.wrap=i,ze},NC=AC,OC=Uy,kC=By,MC=Fy,PC=IC,LC=RC,FC=DC,BC=xC,UC="pako deflate (from Nodeca project)",Cs={deflateInit:NC,deflateInit2:OC,deflateReset:kC,deflateResetKeep:MC,deflateSetHeader:PC,deflate:LC,deflateEnd:FC,deflateSetDictionary:BC,deflateInfo:UC},qC=(n,e)=>Object.prototype.hasOwnProperty.call(n,e),VC=function(n){let e=Array.prototype.slice.call(arguments,1);for(;e.length;){let t=e.shift();if(t){if(typeof t!="object")throw new TypeError(t+"must be non-object");for(let r in t)qC(t,r)&&(n[r]=t[r])}}return n},zC=n=>{let e=0;for(let r=0,i=n.length;r<i;r++)e+=n[r].length;let t=new Uint8Array(e);for(let r=0,i=0,s=n.length;r<s;r++){let a=n[r];t.set(a,i),i+=a.length}return t},po={assign:VC,flattenChunks:zC},qy=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{qy=!1}var Os=new Uint8Array(256);for(let n=0;n<256;n++)Os[n]=n>=252?6:n>=248?5:n>=240?4:n>=224?3:n>=192?2:1;Os[254]=Os[254]=1;var GC=n=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(n);let e,t,r,i,s,a=n.length,o=0;for(i=0;i<a;i++)t=n.charCodeAt(i),(t&64512)===55296&&i+1<a&&(r=n.charCodeAt(i+1),(r&64512)===56320&&(t=65536+(t-55296<<10)+(r-56320),i++)),o+=t<128?1:t<2048?2:t<65536?3:4;for(e=new Uint8Array(o),s=0,i=0;s<o;i++)t=n.charCodeAt(i),(t&64512)===55296&&i+1<a&&(r=n.charCodeAt(i+1),(r&64512)===56320&&(t=65536+(t-55296<<10)+(r-56320),i++)),t<128?e[s++]=t:t<2048?(e[s++]=192|t>>>6,e[s++]=128|t&63):t<65536?(e[s++]=224|t>>>12,e[s++]=128|t>>>6&63,e[s++]=128|t&63):(e[s++]=240|t>>>18,e[s++]=128|t>>>12&63,e[s++]=128|t>>>6&63,e[s++]=128|t&63);return e},$C=(n,e)=>{if(e<65534&&n.subarray&&qy)return String.fromCharCode.apply(null,n.length===e?n:n.subarray(0,e));let t="";for(let r=0;r<e;r++)t+=String.fromCharCode(n[r]);return t},jC=(n,e)=>{let t=e||n.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(n.subarray(0,e));let r,i,s=new Array(t*2);for(i=0,r=0;r<t;){let a=n[r++];if(a<128){s[i++]=a;continue}let o=Os[a];if(o>4){s[i++]=65533,r+=o-1;continue}for(a&=o===2?31:o===3?15:7;o>1&&r<t;)a=a<<6|n[r++]&63,o--;if(o>1){s[i++]=65533;continue}a<65536?s[i++]=a:(a-=65536,s[i++]=55296|a>>10&1023,s[i++]=56320|a&1023)}return $C(s,i)},KC=(n,e)=>{e=e||n.length,e>n.length&&(e=n.length);let t=e-1;for(;t>=0&&(n[t]&192)===128;)t--;return t<0||t===0?e:t+Os[n[t]]>e?t:e},ks={string2buf:GC,buf2string:jC,utf8border:KC};function HC(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var Vy=HC,zy=Object.prototype.toString,{Z_NO_FLUSH:WC,Z_SYNC_FLUSH:QC,Z_FULL_FLUSH:YC,Z_FINISH:JC,Z_OK:uo,Z_STREAM_END:ZC,Z_DEFAULT_COMPRESSION:XC,Z_DEFAULT_STRATEGY:e1,Z_DEFLATED:t1}=ii;function Fs(n){this.options=po.assign({level:XC,method:t1,chunkSize:16384,windowBits:15,memLevel:8,strategy:e1},n||{});let e=this.options;e.raw&&e.windowBits>0?e.windowBits=-e.windowBits:e.gzip&&e.windowBits>0&&e.windowBits<16&&(e.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Vy,this.strm.avail_out=0;let t=Cs.deflateInit2(this.strm,e.level,e.method,e.windowBits,e.memLevel,e.strategy);if(t!==uo)throw new Error(Ir[t]);if(e.header&&Cs.deflateSetHeader(this.strm,e.header),e.dictionary){let r;if(typeof e.dictionary=="string"?r=ks.string2buf(e.dictionary):zy.call(e.dictionary)==="[object ArrayBuffer]"?r=new Uint8Array(e.dictionary):r=e.dictionary,t=Cs.deflateSetDictionary(this.strm,r),t!==uo)throw new Error(Ir[t]);this._dict_set=!0}}Fs.prototype.push=function(n,e){let t=this.strm,r=this.options.chunkSize,i,s;if(this.ended)return!1;for(e===~~e?s=e:s=e===!0?JC:WC,typeof n=="string"?t.input=ks.string2buf(n):zy.call(n)==="[object ArrayBuffer]"?t.input=new Uint8Array(n):t.input=n,t.next_in=0,t.avail_in=t.input.length;;){if(t.avail_out===0&&(t.output=new Uint8Array(r),t.next_out=0,t.avail_out=r),(s===QC||s===YC)&&t.avail_out<=6){this.onData(t.output.subarray(0,t.next_out)),t.avail_out=0;continue}if(i=Cs.deflate(t,s),i===ZC)return t.next_out>0&&this.onData(t.output.subarray(0,t.next_out)),i=Cs.deflateEnd(this.strm),this.onEnd(i),this.ended=!0,i===uo;if(t.avail_out===0){this.onData(t.output);continue}if(s>0&&t.next_out>0){this.onData(t.output.subarray(0,t.next_out)),t.avail_out=0;continue}if(t.avail_in===0)break}return!0};Fs.prototype.onData=function(n){this.chunks.push(n)};Fs.prototype.onEnd=function(n){n===uo&&(this.result=po.flattenChunks(this.chunks)),this.chunks=[],this.err=n,this.msg=this.strm.msg};function ku(n,e){let t=new Fs(e);if(t.push(n,!0),t.err)throw t.msg||Ir[t.err];return t.result}function n1(n,e){return e=e||{},e.raw=!0,ku(n,e)}function r1(n,e){return e=e||{},e.gzip=!0,ku(n,e)}var i1=Fs,s1=ku,a1=n1,o1=r1,l1=ii,c1={Deflate:i1,deflate:s1,deflateRaw:a1,gzip:o1,constants:l1},io=16209,u1=16191,d1=function(e,t){let r,i,s,a,o,l,c,u,m,d,p,E,C,T,I,N,A,S,P,L,v,y,_,b,f=e.state;r=e.next_in,_=e.input,i=r+(e.avail_in-5),s=e.next_out,b=e.output,a=s-(t-e.avail_out),o=s+(e.avail_out-257),l=f.dmax,c=f.wsize,u=f.whave,m=f.wnext,d=f.window,p=f.hold,E=f.bits,C=f.lencode,T=f.distcode,I=(1<<f.lenbits)-1,N=(1<<f.distbits)-1;e:do{E<15&&(p+=_[r++]<<E,E+=8,p+=_[r++]<<E,E+=8),A=C[p&I];t:for(;;){if(S=A>>>24,p>>>=S,E-=S,S=A>>>16&255,S===0)b[s++]=A&65535;else if(S&16){P=A&65535,S&=15,S&&(E<S&&(p+=_[r++]<<E,E+=8),P+=p&(1<<S)-1,p>>>=S,E-=S),E<15&&(p+=_[r++]<<E,E+=8,p+=_[r++]<<E,E+=8),A=T[p&N];n:for(;;){if(S=A>>>24,p>>>=S,E-=S,S=A>>>16&255,S&16){if(L=A&65535,S&=15,E<S&&(p+=_[r++]<<E,E+=8,E<S&&(p+=_[r++]<<E,E+=8)),L+=p&(1<<S)-1,L>l){e.msg="invalid distance too far back",f.mode=io;break e}if(p>>>=S,E-=S,S=s-a,L>S){if(S=L-S,S>u&&f.sane){e.msg="invalid distance too far back",f.mode=io;break e}if(v=0,y=d,m===0){if(v+=c-S,S<P){P-=S;do b[s++]=d[v++];while(--S);v=s-L,y=b}}else if(m<S){if(v+=c+m-S,S-=m,S<P){P-=S;do b[s++]=d[v++];while(--S);if(v=0,m<P){S=m,P-=S;do b[s++]=d[v++];while(--S);v=s-L,y=b}}}else if(v+=m-S,S<P){P-=S;do b[s++]=d[v++];while(--S);v=s-L,y=b}for(;P>2;)b[s++]=y[v++],b[s++]=y[v++],b[s++]=y[v++],P-=3;P&&(b[s++]=y[v++],P>1&&(b[s++]=y[v++]))}else{v=s-L;do b[s++]=b[v++],b[s++]=b[v++],b[s++]=b[v++],P-=3;while(P>2);P&&(b[s++]=b[v++],P>1&&(b[s++]=b[v++]))}}else if((S&64)===0){A=T[(A&65535)+(p&(1<<S)-1)];continue n}else{e.msg="invalid distance code",f.mode=io;break e}break}}else if((S&64)===0){A=C[(A&65535)+(p&(1<<S)-1)];continue t}else if(S&32){f.mode=u1;break e}else{e.msg="invalid literal/length code",f.mode=io;break e}break}}while(r<i&&s<o);P=E>>3,r-=P,E-=P<<3,p&=(1<<E)-1,e.next_in=r,e.next_out=s,e.avail_in=r<i?5+(i-r):5-(r-i),e.avail_out=s<o?257+(o-s):257-(s-o),f.hold=p,f.bits=E},Xr=15,$g=852,jg=592,Kg=0,du=1,Hg=2,h1=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),f1=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),p1=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),m1=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),g1=(n,e,t,r,i,s,a,o)=>{let l=o.bits,c=0,u=0,m=0,d=0,p=0,E=0,C=0,T=0,I=0,N=0,A,S,P,L,v,y=null,_,b=new Uint16Array(Xr+1),f=new Uint16Array(Xr+1),w=null,h,g,k;for(c=0;c<=Xr;c++)b[c]=0;for(u=0;u<r;u++)b[e[t+u]]++;for(p=l,d=Xr;d>=1&&b[d]===0;d--);if(p>d&&(p=d),d===0)return i[s++]=1<<24|64<<16|0,i[s++]=1<<24|64<<16|0,o.bits=1,0;for(m=1;m<d&&b[m]===0;m++);for(p<m&&(p=m),T=1,c=1;c<=Xr;c++)if(T<<=1,T-=b[c],T<0)return-1;if(T>0&&(n===Kg||d!==1))return-1;for(f[1]=0,c=1;c<Xr;c++)f[c+1]=f[c]+b[c];for(u=0;u<r;u++)e[t+u]!==0&&(a[f[e[t+u]]++]=u);if(n===Kg?(y=w=a,_=20):n===du?(y=h1,w=f1,_=257):(y=p1,w=m1,_=0),N=0,u=0,c=m,v=s,E=p,C=0,P=-1,I=1<<p,L=I-1,n===du&&I>$g||n===Hg&&I>jg)return 1;for(;;){h=c-C,a[u]+1<_?(g=0,k=a[u]):a[u]>=_?(g=w[a[u]-_],k=y[a[u]-_]):(g=96,k=0),A=1<<c-C,S=1<<E,m=S;do S-=A,i[v+(N>>C)+S]=h<<24|g<<16|k|0;while(S!==0);for(A=1<<c-1;N&A;)A>>=1;if(A!==0?(N&=A-1,N+=A):N=0,u++,--b[c]===0){if(c===d)break;c=e[t+a[u]]}if(c>p&&(N&L)!==P){for(C===0&&(C=p),v+=m,E=c-C,T=1<<E;E+C<d&&(T-=b[E+C],!(T<=0));)E++,T<<=1;if(I+=1<<E,n===du&&I>$g||n===Hg&&I>jg)return 1;P=N&L,i[P]=p<<24|E<<16|v-s|0}}return N!==0&&(i[v+N]=c-C<<24|64<<16|0),o.bits=p,0},Is=g1,y1=0,Gy=1,$y=2,{Z_FINISH:Wg,Z_BLOCK:_1,Z_TREES:so,Z_OK:Rr,Z_STREAM_END:v1,Z_NEED_DICT:b1,Z_STREAM_ERROR:vt,Z_DATA_ERROR:jy,Z_MEM_ERROR:Ky,Z_BUF_ERROR:S1,Z_DEFLATED:Qg}=ii,mo=16180,Yg=16181,Jg=16182,Zg=16183,Xg=16184,ey=16185,ty=16186,ny=16187,ry=16188,iy=16189,ho=16190,gn=16191,hu=16192,sy=16193,fu=16194,ay=16195,oy=16196,ly=16197,cy=16198,ao=16199,oo=16200,uy=16201,dy=16202,hy=16203,fy=16204,py=16205,pu=16206,my=16207,gy=16208,me=16209,Hy=16210,Wy=16211,E1=852,w1=592,T1=15,C1=T1,yy=n=>(n>>>24&255)+(n>>>8&65280)+((n&65280)<<8)+((n&255)<<24);function I1(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}var Dr=n=>{if(!n)return 1;let e=n.state;return!e||e.strm!==n||e.mode<mo||e.mode>Wy?1:0},Qy=n=>{if(Dr(n))return vt;let e=n.state;return n.total_in=n.total_out=e.total=0,n.msg="",e.wrap&&(n.adler=e.wrap&1),e.mode=mo,e.last=0,e.havedict=0,e.flags=-1,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new Int32Array(E1),e.distcode=e.distdyn=new Int32Array(w1),e.sane=1,e.back=-1,Rr},Yy=n=>{if(Dr(n))return vt;let e=n.state;return e.wsize=0,e.whave=0,e.wnext=0,Qy(n)},Jy=(n,e)=>{let t;if(Dr(n))return vt;let r=n.state;return e<0?(t=0,e=-e):(t=(e>>4)+5,e<48&&(e&=15)),e&&(e<8||e>15)?vt:(r.window!==null&&r.wbits!==e&&(r.window=null),r.wrap=t,r.wbits=e,Yy(n))},Zy=(n,e)=>{if(!n)return vt;let t=new I1;n.state=t,t.strm=n,t.window=null,t.mode=mo;let r=Jy(n,e);return r!==Rr&&(n.state=null),r},A1=n=>Zy(n,C1),_y=!0,mu,gu,R1=n=>{if(_y){mu=new Int32Array(512),gu=new Int32Array(32);let e=0;for(;e<144;)n.lens[e++]=8;for(;e<256;)n.lens[e++]=9;for(;e<280;)n.lens[e++]=7;for(;e<288;)n.lens[e++]=8;for(Is(Gy,n.lens,0,288,mu,0,n.work,{bits:9}),e=0;e<32;)n.lens[e++]=5;Is($y,n.lens,0,32,gu,0,n.work,{bits:5}),_y=!1}n.lencode=mu,n.lenbits=9,n.distcode=gu,n.distbits=5},Xy=(n,e,t,r)=>{let i,s=n.state;return s.window===null&&(s.wsize=1<<s.wbits,s.wnext=0,s.whave=0,s.window=new Uint8Array(s.wsize)),r>=s.wsize?(s.window.set(e.subarray(t-s.wsize,t),0),s.wnext=0,s.whave=s.wsize):(i=s.wsize-s.wnext,i>r&&(i=r),s.window.set(e.subarray(t-r,t-r+i),s.wnext),r-=i,r?(s.window.set(e.subarray(t-r,t),0),s.wnext=r,s.whave=s.wsize):(s.wnext+=i,s.wnext===s.wsize&&(s.wnext=0),s.whave<s.wsize&&(s.whave+=i))),0},D1=(n,e)=>{let t,r,i,s,a,o,l,c,u,m,d,p,E,C,T=0,I,N,A,S,P,L,v,y,_=new Uint8Array(4),b,f,w=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(Dr(n)||!n.output||!n.input&&n.avail_in!==0)return vt;t=n.state,t.mode===gn&&(t.mode=hu),a=n.next_out,i=n.output,l=n.avail_out,s=n.next_in,r=n.input,o=n.avail_in,c=t.hold,u=t.bits,m=o,d=l,y=Rr;e:for(;;)switch(t.mode){case mo:if(t.wrap===0){t.mode=hu;break}for(;u<16;){if(o===0)break e;o--,c+=r[s++]<<u,u+=8}if(t.wrap&2&&c===35615){t.wbits===0&&(t.wbits=15),t.check=0,_[0]=c&255,_[1]=c>>>8&255,t.check=Me(t.check,_,2,0),c=0,u=0,t.mode=Yg;break}if(t.head&&(t.head.done=!1),!(t.wrap&1)||(((c&255)<<8)+(c>>8))%31){n.msg="incorrect header check",t.mode=me;break}if((c&15)!==Qg){n.msg="unknown compression method",t.mode=me;break}if(c>>>=4,u-=4,v=(c&15)+8,t.wbits===0&&(t.wbits=v),v>15||v>t.wbits){n.msg="invalid window size",t.mode=me;break}t.dmax=1<<t.wbits,t.flags=0,n.adler=t.check=1,t.mode=c&512?iy:gn,c=0,u=0;break;case Yg:for(;u<16;){if(o===0)break e;o--,c+=r[s++]<<u,u+=8}if(t.flags=c,(t.flags&255)!==Qg){n.msg="unknown compression method",t.mode=me;break}if(t.flags&57344){n.msg="unknown header flags set",t.mode=me;break}t.head&&(t.head.text=c>>8&1),t.flags&512&&t.wrap&4&&(_[0]=c&255,_[1]=c>>>8&255,t.check=Me(t.check,_,2,0)),c=0,u=0,t.mode=Jg;case Jg:for(;u<32;){if(o===0)break e;o--,c+=r[s++]<<u,u+=8}t.head&&(t.head.time=c),t.flags&512&&t.wrap&4&&(_[0]=c&255,_[1]=c>>>8&255,_[2]=c>>>16&255,_[3]=c>>>24&255,t.check=Me(t.check,_,4,0)),c=0,u=0,t.mode=Zg;case Zg:for(;u<16;){if(o===0)break e;o--,c+=r[s++]<<u,u+=8}t.head&&(t.head.xflags=c&255,t.head.os=c>>8),t.flags&512&&t.wrap&4&&(_[0]=c&255,_[1]=c>>>8&255,t.check=Me(t.check,_,2,0)),c=0,u=0,t.mode=Xg;case Xg:if(t.flags&1024){for(;u<16;){if(o===0)break e;o--,c+=r[s++]<<u,u+=8}t.length=c,t.head&&(t.head.extra_len=c),t.flags&512&&t.wrap&4&&(_[0]=c&255,_[1]=c>>>8&255,t.check=Me(t.check,_,2,0)),c=0,u=0}else t.head&&(t.head.extra=null);t.mode=ey;case ey:if(t.flags&1024&&(p=t.length,p>o&&(p=o),p&&(t.head&&(v=t.head.extra_len-t.length,t.head.extra||(t.head.extra=new Uint8Array(t.head.extra_len)),t.head.extra.set(r.subarray(s,s+p),v)),t.flags&512&&t.wrap&4&&(t.check=Me(t.check,r,p,s)),o-=p,s+=p,t.length-=p),t.length))break e;t.length=0,t.mode=ty;case ty:if(t.flags&2048){if(o===0)break e;p=0;do v=r[s+p++],t.head&&v&&t.length<65536&&(t.head.name+=String.fromCharCode(v));while(v&&p<o);if(t.flags&512&&t.wrap&4&&(t.check=Me(t.check,r,p,s)),o-=p,s+=p,v)break e}else t.head&&(t.head.name=null);t.length=0,t.mode=ny;case ny:if(t.flags&4096){if(o===0)break e;p=0;do v=r[s+p++],t.head&&v&&t.length<65536&&(t.head.comment+=String.fromCharCode(v));while(v&&p<o);if(t.flags&512&&t.wrap&4&&(t.check=Me(t.check,r,p,s)),o-=p,s+=p,v)break e}else t.head&&(t.head.comment=null);t.mode=ry;case ry:if(t.flags&512){for(;u<16;){if(o===0)break e;o--,c+=r[s++]<<u,u+=8}if(t.wrap&4&&c!==(t.check&65535)){n.msg="header crc mismatch",t.mode=me;break}c=0,u=0}t.head&&(t.head.hcrc=t.flags>>9&1,t.head.done=!0),n.adler=t.check=0,t.mode=gn;break;case iy:for(;u<32;){if(o===0)break e;o--,c+=r[s++]<<u,u+=8}n.adler=t.check=yy(c),c=0,u=0,t.mode=ho;case ho:if(t.havedict===0)return n.next_out=a,n.avail_out=l,n.next_in=s,n.avail_in=o,t.hold=c,t.bits=u,b1;n.adler=t.check=1,t.mode=gn;case gn:if(e===_1||e===so)break e;case hu:if(t.last){c>>>=u&7,u-=u&7,t.mode=pu;break}for(;u<3;){if(o===0)break e;o--,c+=r[s++]<<u,u+=8}switch(t.last=c&1,c>>>=1,u-=1,c&3){case 0:t.mode=sy;break;case 1:if(R1(t),t.mode=ao,e===so){c>>>=2,u-=2;break e}break;case 2:t.mode=oy;break;case 3:n.msg="invalid block type",t.mode=me}c>>>=2,u-=2;break;case sy:for(c>>>=u&7,u-=u&7;u<32;){if(o===0)break e;o--,c+=r[s++]<<u,u+=8}if((c&65535)!==(c>>>16^65535)){n.msg="invalid stored block lengths",t.mode=me;break}if(t.length=c&65535,c=0,u=0,t.mode=fu,e===so)break e;case fu:t.mode=ay;case ay:if(p=t.length,p){if(p>o&&(p=o),p>l&&(p=l),p===0)break e;i.set(r.subarray(s,s+p),a),o-=p,s+=p,l-=p,a+=p,t.length-=p;break}t.mode=gn;break;case oy:for(;u<14;){if(o===0)break e;o--,c+=r[s++]<<u,u+=8}if(t.nlen=(c&31)+257,c>>>=5,u-=5,t.ndist=(c&31)+1,c>>>=5,u-=5,t.ncode=(c&15)+4,c>>>=4,u-=4,t.nlen>286||t.ndist>30){n.msg="too many length or distance symbols",t.mode=me;break}t.have=0,t.mode=ly;case ly:for(;t.have<t.ncode;){for(;u<3;){if(o===0)break e;o--,c+=r[s++]<<u,u+=8}t.lens[w[t.have++]]=c&7,c>>>=3,u-=3}for(;t.have<19;)t.lens[w[t.have++]]=0;if(t.lencode=t.lendyn,t.lenbits=7,b={bits:t.lenbits},y=Is(y1,t.lens,0,19,t.lencode,0,t.work,b),t.lenbits=b.bits,y){n.msg="invalid code lengths set",t.mode=me;break}t.have=0,t.mode=cy;case cy:for(;t.have<t.nlen+t.ndist;){for(;T=t.lencode[c&(1<<t.lenbits)-1],I=T>>>24,N=T>>>16&255,A=T&65535,!(I<=u);){if(o===0)break e;o--,c+=r[s++]<<u,u+=8}if(A<16)c>>>=I,u-=I,t.lens[t.have++]=A;else{if(A===16){for(f=I+2;u<f;){if(o===0)break e;o--,c+=r[s++]<<u,u+=8}if(c>>>=I,u-=I,t.have===0){n.msg="invalid bit length repeat",t.mode=me;break}v=t.lens[t.have-1],p=3+(c&3),c>>>=2,u-=2}else if(A===17){for(f=I+3;u<f;){if(o===0)break e;o--,c+=r[s++]<<u,u+=8}c>>>=I,u-=I,v=0,p=3+(c&7),c>>>=3,u-=3}else{for(f=I+7;u<f;){if(o===0)break e;o--,c+=r[s++]<<u,u+=8}c>>>=I,u-=I,v=0,p=11+(c&127),c>>>=7,u-=7}if(t.have+p>t.nlen+t.ndist){n.msg="invalid bit length repeat",t.mode=me;break}for(;p--;)t.lens[t.have++]=v}}if(t.mode===me)break;if(t.lens[256]===0){n.msg="invalid code -- missing end-of-block",t.mode=me;break}if(t.lenbits=9,b={bits:t.lenbits},y=Is(Gy,t.lens,0,t.nlen,t.lencode,0,t.work,b),t.lenbits=b.bits,y){n.msg="invalid literal/lengths set",t.mode=me;break}if(t.distbits=6,t.distcode=t.distdyn,b={bits:t.distbits},y=Is($y,t.lens,t.nlen,t.ndist,t.distcode,0,t.work,b),t.distbits=b.bits,y){n.msg="invalid distances set",t.mode=me;break}if(t.mode=ao,e===so)break e;case ao:t.mode=oo;case oo:if(o>=6&&l>=258){n.next_out=a,n.avail_out=l,n.next_in=s,n.avail_in=o,t.hold=c,t.bits=u,d1(n,d),a=n.next_out,i=n.output,l=n.avail_out,s=n.next_in,r=n.input,o=n.avail_in,c=t.hold,u=t.bits,t.mode===gn&&(t.back=-1);break}for(t.back=0;T=t.lencode[c&(1<<t.lenbits)-1],I=T>>>24,N=T>>>16&255,A=T&65535,!(I<=u);){if(o===0)break e;o--,c+=r[s++]<<u,u+=8}if(N&&(N&240)===0){for(S=I,P=N,L=A;T=t.lencode[L+((c&(1<<S+P)-1)>>S)],I=T>>>24,N=T>>>16&255,A=T&65535,!(S+I<=u);){if(o===0)break e;o--,c+=r[s++]<<u,u+=8}c>>>=S,u-=S,t.back+=S}if(c>>>=I,u-=I,t.back+=I,t.length=A,N===0){t.mode=py;break}if(N&32){t.back=-1,t.mode=gn;break}if(N&64){n.msg="invalid literal/length code",t.mode=me;break}t.extra=N&15,t.mode=uy;case uy:if(t.extra){for(f=t.extra;u<f;){if(o===0)break e;o--,c+=r[s++]<<u,u+=8}t.length+=c&(1<<t.extra)-1,c>>>=t.extra,u-=t.extra,t.back+=t.extra}t.was=t.length,t.mode=dy;case dy:for(;T=t.distcode[c&(1<<t.distbits)-1],I=T>>>24,N=T>>>16&255,A=T&65535,!(I<=u);){if(o===0)break e;o--,c+=r[s++]<<u,u+=8}if((N&240)===0){for(S=I,P=N,L=A;T=t.distcode[L+((c&(1<<S+P)-1)>>S)],I=T>>>24,N=T>>>16&255,A=T&65535,!(S+I<=u);){if(o===0)break e;o--,c+=r[s++]<<u,u+=8}c>>>=S,u-=S,t.back+=S}if(c>>>=I,u-=I,t.back+=I,N&64){n.msg="invalid distance code",t.mode=me;break}t.offset=A,t.extra=N&15,t.mode=hy;case hy:if(t.extra){for(f=t.extra;u<f;){if(o===0)break e;o--,c+=r[s++]<<u,u+=8}t.offset+=c&(1<<t.extra)-1,c>>>=t.extra,u-=t.extra,t.back+=t.extra}if(t.offset>t.dmax){n.msg="invalid distance too far back",t.mode=me;break}t.mode=fy;case fy:if(l===0)break e;if(p=d-l,t.offset>p){if(p=t.offset-p,p>t.whave&&t.sane){n.msg="invalid distance too far back",t.mode=me;break}p>t.wnext?(p-=t.wnext,E=t.wsize-p):E=t.wnext-p,p>t.length&&(p=t.length),C=t.window}else C=i,E=a-t.offset,p=t.length;p>l&&(p=l),l-=p,t.length-=p;do i[a++]=C[E++];while(--p);t.length===0&&(t.mode=oo);break;case py:if(l===0)break e;i[a++]=t.length,l--,t.mode=oo;break;case pu:if(t.wrap){for(;u<32;){if(o===0)break e;o--,c|=r[s++]<<u,u+=8}if(d-=l,n.total_out+=d,t.total+=d,t.wrap&4&&d&&(n.adler=t.check=t.flags?Me(t.check,i,d,a-d):Ns(t.check,i,d,a-d)),d=l,t.wrap&4&&(t.flags?c:yy(c))!==t.check){n.msg="incorrect data check",t.mode=me;break}c=0,u=0}t.mode=my;case my:if(t.wrap&&t.flags){for(;u<32;){if(o===0)break e;o--,c+=r[s++]<<u,u+=8}if(t.wrap&4&&c!==(t.total&4294967295)){n.msg="incorrect length check",t.mode=me;break}c=0,u=0}t.mode=gy;case gy:y=v1;break e;case me:y=jy;break e;case Hy:return Ky;case Wy:default:return vt}return n.next_out=a,n.avail_out=l,n.next_in=s,n.avail_in=o,t.hold=c,t.bits=u,(t.wsize||d!==n.avail_out&&t.mode<me&&(t.mode<pu||e!==Wg))&&Xy(n,n.output,n.next_out,d-n.avail_out),m-=n.avail_in,d-=n.avail_out,n.total_in+=m,n.total_out+=d,t.total+=d,t.wrap&4&&d&&(n.adler=t.check=t.flags?Me(t.check,i,d,n.next_out-d):Ns(t.check,i,d,n.next_out-d)),n.data_type=t.bits+(t.last?64:0)+(t.mode===gn?128:0)+(t.mode===ao||t.mode===fu?256:0),(m===0&&d===0||e===Wg)&&y===Rr&&(y=S1),y},x1=n=>{if(Dr(n))return vt;let e=n.state;return e.window&&(e.window=null),n.state=null,Rr},N1=(n,e)=>{if(Dr(n))return vt;let t=n.state;return(t.wrap&2)===0?vt:(t.head=e,e.done=!1,Rr)},O1=(n,e)=>{let t=e.length,r,i,s;return Dr(n)||(r=n.state,r.wrap!==0&&r.mode!==ho)?vt:r.mode===ho&&(i=1,i=Ns(i,e,t,0),i!==r.check)?jy:(s=Xy(n,e,t,t),s?(r.mode=Hy,Ky):(r.havedict=1,Rr))},k1=Yy,M1=Jy,P1=Qy,L1=A1,F1=Zy,B1=D1,U1=x1,q1=N1,V1=O1,z1="pako inflate (from Nodeca project)",_n={inflateReset:k1,inflateReset2:M1,inflateResetKeep:P1,inflateInit:L1,inflateInit2:F1,inflate:B1,inflateEnd:U1,inflateGetHeader:q1,inflateSetDictionary:V1,inflateInfo:z1};function G1(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var $1=G1,e_=Object.prototype.toString,{Z_NO_FLUSH:j1,Z_FINISH:K1,Z_OK:Ms,Z_STREAM_END:yu,Z_NEED_DICT:_u,Z_STREAM_ERROR:H1,Z_DATA_ERROR:vy,Z_MEM_ERROR:W1}=ii;function Bs(n){this.options=po.assign({chunkSize:1024*64,windowBits:15,to:""},n||{});let e=this.options;e.raw&&e.windowBits>=0&&e.windowBits<16&&(e.windowBits=-e.windowBits,e.windowBits===0&&(e.windowBits=-15)),e.windowBits>=0&&e.windowBits<16&&!(n&&n.windowBits)&&(e.windowBits+=32),e.windowBits>15&&e.windowBits<48&&(e.windowBits&15)===0&&(e.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Vy,this.strm.avail_out=0;let t=_n.inflateInit2(this.strm,e.windowBits);if(t!==Ms)throw new Error(Ir[t]);if(this.header=new $1,_n.inflateGetHeader(this.strm,this.header),e.dictionary&&(typeof e.dictionary=="string"?e.dictionary=ks.string2buf(e.dictionary):e_.call(e.dictionary)==="[object ArrayBuffer]"&&(e.dictionary=new Uint8Array(e.dictionary)),e.raw&&(t=_n.inflateSetDictionary(this.strm,e.dictionary),t!==Ms)))throw new Error(Ir[t])}Bs.prototype.push=function(n,e){let t=this.strm,r=this.options.chunkSize,i=this.options.dictionary,s,a,o;if(this.ended)return!1;for(e===~~e?a=e:a=e===!0?K1:j1,e_.call(n)==="[object ArrayBuffer]"?t.input=new Uint8Array(n):t.input=n,t.next_in=0,t.avail_in=t.input.length;;){for(t.avail_out===0&&(t.output=new Uint8Array(r),t.next_out=0,t.avail_out=r),s=_n.inflate(t,a),s===_u&&i&&(s=_n.inflateSetDictionary(t,i),s===Ms?s=_n.inflate(t,a):s===vy&&(s=_u));t.avail_in>0&&s===yu&&t.state.wrap>0&&n[t.next_in]!==0;)_n.inflateReset(t),s=_n.inflate(t,a);switch(s){case H1:case vy:case _u:case W1:return this.onEnd(s),this.ended=!0,!1}if(o=t.avail_out,t.next_out&&(t.avail_out===0||s===yu))if(this.options.to==="string"){let l=ks.utf8border(t.output,t.next_out),c=t.next_out-l,u=ks.buf2string(t.output,l);t.next_out=c,t.avail_out=r-c,c&&t.output.set(t.output.subarray(l,l+c),0),this.onData(u)}else this.onData(t.output.length===t.next_out?t.output:t.output.subarray(0,t.next_out));if(!(s===Ms&&o===0)){if(s===yu)return s=_n.inflateEnd(this.strm),this.onEnd(s),this.ended=!0,!0;if(t.avail_in===0)break}}return!0};Bs.prototype.onData=function(n){this.chunks.push(n)};Bs.prototype.onEnd=function(n){n===Ms&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=po.flattenChunks(this.chunks)),this.chunks=[],this.err=n,this.msg=this.strm.msg};function Mu(n,e){let t=new Bs(e);if(t.push(n),t.err)throw t.msg||Ir[t.err];return t.result}function Q1(n,e){return e=e||{},e.raw=!0,Mu(n,e)}var Y1=Bs,J1=Mu,Z1=Q1,X1=Mu,eI=ii,tI={Inflate:Y1,inflate:J1,inflateRaw:Z1,ungzip:X1,constants:eI},{Deflate:n4,deflate:r4,deflateRaw:i4,gzip:s4}=c1,{Inflate:a4,inflate:nI,inflateRaw:o4,ungzip:l4}=tI;var t_=nI;var n_=()=>{};var iI={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"};var s_=function(n){let e=[],t=0;for(let r=0;r<n.length;r++){let i=n.charCodeAt(r);i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):(i&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},sI=function(n){let e=[],t=0,r=0;for(;t<n.length;){let i=n[t++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){let s=n[t++];e[r++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){let s=n[t++],a=n[t++],o=n[t++],l=((i&7)<<18|(s&63)<<12|(a&63)<<6|o&63)-65536;e[r++]=String.fromCharCode(55296+(l>>10)),e[r++]=String.fromCharCode(56320+(l&1023))}else{let s=n[t++],a=n[t++];e[r++]=String.fromCharCode((i&15)<<12|(s&63)<<6|a&63)}}return e.join("")},a_={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();let t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<n.length;i+=3){let s=n[i],a=i+1<n.length,o=a?n[i+1]:0,l=i+2<n.length,c=l?n[i+2]:0,u=s>>2,m=(s&3)<<4|o>>4,d=(o&15)<<2|c>>6,p=c&63;l||(p=64,a||(d=64)),r.push(t[u],t[m],t[d],t[p])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(s_(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):sI(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();let t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<n.length;){let s=t[n.charAt(i++)],o=i<n.length?t[n.charAt(i)]:0;++i;let c=i<n.length?t[n.charAt(i)]:64;++i;let m=i<n.length?t[n.charAt(i)]:64;if(++i,s==null||o==null||c==null||m==null)throw new Pu;let d=s<<2|o>>4;if(r.push(d),c!==64){let p=o<<4&240|c>>2;if(r.push(p),m!==64){let E=c<<6&192|m;r.push(E)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}},Pu=class extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}},aI=function(n){let e=s_(n);return a_.encodeByteArray(e,!0)},qs=function(n){return aI(n).replace(/\./g,"")},o_=function(n){try{return a_.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function l_(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}var oI=()=>l_().__FIREBASE_DEFAULTS__,lI=()=>{if(typeof process>"u"||typeof process.env>"u")return;let n=process.env.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},cI=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}let e=n&&o_(n[1]);return e&&JSON.parse(e)},Lu=()=>{try{return n_()||oI()||lI()||cI()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},uI=n=>Lu()?.emulatorHosts?.[n],c_=n=>{let e=uI(n);if(!e)return;let t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);let r=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),r]:[e.substring(0,t),r]},Fu=()=>Lu()?.config;var go=class{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}};function Bu(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function u_(n){return(await fetch(n,{credentials:"include"})).ok}function d_(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');let t={alg:"none",type:"JWT"},r=e||"demo-project",i=n.iat||0,s=n.sub||n.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");let a={iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}},...n};return[qs(JSON.stringify(t)),qs(JSON.stringify(a)),""].join(".")}var Us={};function dI(){let n={prod:[],emulator:[]};for(let e of Object.keys(Us))Us[e]?n.emulator.push(e):n.prod.push(e);return n}function hI(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}var r_=!1;function h_(n,e){if(typeof window>"u"||typeof document>"u"||!Bu(window.location.host)||Us[n]===e||Us[n]||r_)return;Us[n]=e;function t(d){return`__firebase__banner__${d}`}let r="__firebase__banner",s=dI().prod.length>0;function a(){let d=document.getElementById(r);d&&d.remove()}function o(d){d.style.display="flex",d.style.background="#7faaf0",d.style.position="fixed",d.style.bottom="5px",d.style.left="5px",d.style.padding=".5em",d.style.borderRadius="5px",d.style.alignItems="center"}function l(d,p){d.setAttribute("width","24"),d.setAttribute("id",p),d.setAttribute("height","24"),d.setAttribute("viewBox","0 0 24 24"),d.setAttribute("fill","none"),d.style.marginLeft="-6px"}function c(){let d=document.createElement("span");return d.style.cursor="pointer",d.style.marginLeft="16px",d.style.fontSize="24px",d.innerHTML=" &times;",d.onclick=()=>{r_=!0,a()},d}function u(d,p){d.setAttribute("id",p),d.innerText="Learn more",d.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",d.setAttribute("target","__blank"),d.style.paddingLeft="5px",d.style.textDecoration="underline"}function m(){let d=hI(r),p=t("text"),E=document.getElementById(p)||document.createElement("span"),C=t("learnmore"),T=document.getElementById(C)||document.createElement("a"),I=t("preprendIcon"),N=document.getElementById(I)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(d.created){let A=d.element;o(A),u(T,C);let S=c();l(N,I),A.append(N,E,T,S),document.body.appendChild(A)}s?(E.innerText="Preview backend disconnected.",N.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(N.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,E.innerText="Preview backend running in this workspace."),E.setAttribute("id",p)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",m):m()}function f_(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function fI(){let n=Lu()?.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function p_(){return!fI()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Uu(){try{return typeof indexedDB=="object"}catch{return!1}}function m_(){return new Promise((n,e)=>{try{let t=!0,r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},i.onupgradeneeded=()=>{t=!1},i.onerror=()=>{e(i.error?.message||"")}}catch(t){e(t)}})}var pI="FirebaseError",vn=class n extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=pI,Object.setPrototypeOf(this,n.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Vs.prototype.create)}},Vs=class{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){let r=t[0]||{},i=`${this.service}/${e}`,s=this.errors[e],a=s?mI(s,r):"Error",o=`${this.serviceName}: ${a} (${i}).`;return new vn(i,o,r)}};function mI(n,e){return n.replace(gI,(t,r)=>{let i=e[r];return i!=null?String(i):`<${r}?>`})}var gI=/\{\$([^}]+)}/g;function oi(n,e){if(n===e)return!0;let t=Object.keys(n),r=Object.keys(e);for(let i of t){if(!r.includes(i))return!1;let s=n[i],a=e[i];if(i_(s)&&i_(a)){if(!oi(s,a))return!1}else if(s!==a)return!1}for(let i of r)if(!t.includes(i))return!1;return!0}function i_(n){return n!==null&&typeof n=="object"}var d4=14400*1e3;function yo(n){return n&&n._delegate?n._delegate:n}iI.NODE_CLIENT=!0;var bn=class{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}};var xr="[DEFAULT]";var qu=class{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){let t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){let r=new go;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{let i=this.getOrInitializeService({instanceIdentifier:t});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){let t=this.normalizeInstanceIdentifier(e?.identifier),r=e?.optional??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(i){if(r)return null;throw i}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(_I(e))try{this.getOrInitializeService({instanceIdentifier:xr})}catch{}for(let[t,r]of this.instancesDeferred.entries()){let i=this.normalizeInstanceIdentifier(t);try{let s=this.getOrInitializeService({instanceIdentifier:i});r.resolve(s)}catch{}}}}clearInstance(e=xr){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){let e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=xr){return this.instances.has(e)}getOptions(e=xr){return this.instancesOptions.get(e)||{}}initialize(e={}){let{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);let i=this.getOrInitializeService({instanceIdentifier:r,options:t});for(let[s,a]of this.instancesDeferred.entries()){let o=this.normalizeInstanceIdentifier(s);r===o&&a.resolve(i)}return i}onInit(e,t){let r=this.normalizeInstanceIdentifier(t),i=this.onInitCallbacks.get(r)??new Set;i.add(e),this.onInitCallbacks.set(r,i);let s=this.instances.get(r);return s&&e(s,r),()=>{i.delete(e)}}invokeOnInitCallbacks(e,t){let r=this.onInitCallbacks.get(t);if(r)for(let i of r)try{i(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:yI(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=xr){return this.component?this.component.multipleInstances?e:xr:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}};function yI(n){return n===xr?void 0:n}function _I(n){return n.instantiationMode==="EAGER"}var _o=class{constructor(e){this.name=e,this.providers=new Map}addComponent(e){let t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);let t=new qu(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}};var vI=[],X;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(X||(X={}));var bI={debug:X.DEBUG,verbose:X.VERBOSE,info:X.INFO,warn:X.WARN,error:X.ERROR,silent:X.SILENT},SI=X.INFO,EI={[X.DEBUG]:"log",[X.VERBOSE]:"log",[X.INFO]:"info",[X.WARN]:"warn",[X.ERROR]:"error"},wI=(n,e,...t)=>{if(e<n.logLevel)return;let r=new Date().toISOString(),i=EI[e];if(i)console[i](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)},li=class{constructor(e){this.name=e,this._logLevel=SI,this._logHandler=wI,this._userLogHandler=null,vI.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in X))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?bI[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,X.DEBUG,...e),this._logHandler(this,X.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,X.VERBOSE,...e),this._logHandler(this,X.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,X.INFO,...e),this._logHandler(this,X.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,X.WARN,...e),this._logHandler(this,X.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,X.ERROR,...e),this._logHandler(this,X.ERROR,...e)}};var TI=(n,e)=>e.some(t=>n instanceof t),g_,y_;function CI(){return g_||(g_=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function II(){return y_||(y_=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}var __=new WeakMap,zu=new WeakMap,v_=new WeakMap,Vu=new WeakMap,$u=new WeakMap;function AI(n){let e=new Promise((t,r)=>{let i=()=>{n.removeEventListener("success",s),n.removeEventListener("error",a)},s=()=>{t(Ht(n.result)),i()},a=()=>{r(n.error),i()};n.addEventListener("success",s),n.addEventListener("error",a)});return e.then(t=>{t instanceof IDBCursor&&__.set(t,n)}).catch(()=>{}),$u.set(e,n),e}function RI(n){if(zu.has(n))return;let e=new Promise((t,r)=>{let i=()=>{n.removeEventListener("complete",s),n.removeEventListener("error",a),n.removeEventListener("abort",a)},s=()=>{t(),i()},a=()=>{r(n.error||new DOMException("AbortError","AbortError")),i()};n.addEventListener("complete",s),n.addEventListener("error",a),n.addEventListener("abort",a)});zu.set(n,e)}var Gu={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return zu.get(n);if(e==="objectStoreNames")return n.objectStoreNames||v_.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Ht(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function b_(n){Gu=n(Gu)}function DI(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){let r=n.call(vo(this),e,...t);return v_.set(r,e.sort?e.sort():[e]),Ht(r)}:II().includes(n)?function(...e){return n.apply(vo(this),e),Ht(__.get(this))}:function(...e){return Ht(n.apply(vo(this),e))}}function xI(n){return typeof n=="function"?DI(n):(n instanceof IDBTransaction&&RI(n),TI(n,CI())?new Proxy(n,Gu):n)}function Ht(n){if(n instanceof IDBRequest)return AI(n);if(Vu.has(n))return Vu.get(n);let e=xI(n);return e!==n&&(Vu.set(n,e),$u.set(e,n)),e}var vo=n=>$u.get(n);function E_(n,e,{blocked:t,upgrade:r,blocking:i,terminated:s}={}){let a=indexedDB.open(n,e),o=Ht(a);return r&&a.addEventListener("upgradeneeded",l=>{r(Ht(a.result),l.oldVersion,l.newVersion,Ht(a.transaction),l)}),t&&a.addEventListener("blocked",l=>t(l.oldVersion,l.newVersion,l)),o.then(l=>{s&&l.addEventListener("close",()=>s()),i&&l.addEventListener("versionchange",c=>i(c.oldVersion,c.newVersion,c))}).catch(()=>{}),o}var NI=["get","getKey","getAll","getAllKeys","count"],OI=["put","add","delete","clear"],ju=new Map;function S_(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(ju.get(e))return ju.get(e);let t=e.replace(/FromIndex$/,""),r=e!==t,i=OI.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(i||NI.includes(t)))return;let s=async function(a,...o){let l=this.transaction(a,i?"readwrite":"readonly"),c=l.store;return r&&(c=c.index(o.shift())),(await Promise.all([c[t](...o),i&&l.done]))[0]};return ju.set(e,s),s}b_(n=>({...n,get:(e,t,r)=>S_(e,t)||n.get(e,t,r),has:(e,t)=>!!S_(e,t)||n.has(e,t)}));var Hu=class{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(kI(t)){let r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}};function kI(n){return n.getComponent()?.type==="VERSION"}var Wu="@firebase/app",w_="0.14.6";var Sn=new li("@firebase/app"),MI="@firebase/app-compat",PI="@firebase/analytics-compat",LI="@firebase/analytics",FI="@firebase/app-check-compat",BI="@firebase/app-check",UI="@firebase/auth",qI="@firebase/auth-compat",VI="@firebase/database",zI="@firebase/data-connect",GI="@firebase/database-compat",$I="@firebase/functions",jI="@firebase/functions-compat",KI="@firebase/installations",HI="@firebase/installations-compat",WI="@firebase/messaging",QI="@firebase/messaging-compat",YI="@firebase/performance",JI="@firebase/performance-compat",ZI="@firebase/remote-config",XI="@firebase/remote-config-compat",eA="@firebase/storage",tA="@firebase/storage-compat",nA="@firebase/firestore",rA="@firebase/ai",iA="@firebase/firestore-compat",sA="firebase",aA="12.6.0";var Qu="[DEFAULT]",oA={[Wu]:"fire-core",[MI]:"fire-core-compat",[LI]:"fire-analytics",[PI]:"fire-analytics-compat",[BI]:"fire-app-check",[FI]:"fire-app-check-compat",[UI]:"fire-auth",[qI]:"fire-auth-compat",[VI]:"fire-rtdb",[zI]:"fire-data-connect",[GI]:"fire-rtdb-compat",[$I]:"fire-fn",[jI]:"fire-fn-compat",[KI]:"fire-iid",[HI]:"fire-iid-compat",[WI]:"fire-fcm",[QI]:"fire-fcm-compat",[YI]:"fire-perf",[JI]:"fire-perf-compat",[ZI]:"fire-rc",[XI]:"fire-rc-compat",[eA]:"fire-gcs",[tA]:"fire-gcs-compat",[nA]:"fire-fst",[iA]:"fire-fst-compat",[rA]:"fire-vertex","fire-js":"fire-js",[sA]:"fire-js-all"};var bo=new Map,lA=new Map,Yu=new Map;function T_(n,e){try{n.container.addComponent(e)}catch(t){Sn.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function zs(n){let e=n.name;if(Yu.has(e))return Sn.debug(`There were multiple attempts to register component ${e}.`),!1;Yu.set(e,n);for(let t of bo.values())T_(t,n);for(let t of lA.values())T_(t,n);return!0}function R_(n,e){let t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function D_(n){return n==null?!1:n.settings!==void 0}var cA={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Vn=new Vs("app","Firebase",cA);var Ju=class{constructor(e,t,r){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new bn("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Vn.create("app-deleted",{appName:this._name})}};var x_=aA;function ed(n,e={}){let t=n;typeof e!="object"&&(e={name:e});let r={name:Qu,automaticDataCollectionEnabled:!0,...e},i=r.name;if(typeof i!="string"||!i)throw Vn.create("bad-app-name",{appName:String(i)});if(t||(t=Fu()),!t)throw Vn.create("no-options");let s=bo.get(i);if(s){if(oi(t,s.options)&&oi(r,s.config))return s;throw Vn.create("duplicate-app",{appName:i})}let a=new _o(i);for(let l of Yu.values())a.addComponent(l);let o=new Ju(t,r,a);return bo.set(i,o),o}function N_(n=Qu){let e=bo.get(n);if(!e&&n===Qu&&Fu())return ed();if(!e)throw Vn.create("no-app",{appName:n});return e}function zn(n,e,t){let r=oA[n]??n;t&&(r+=`-${t}`);let i=r.match(/\s|\//),s=e.match(/\s|\//);if(i||s){let a=[`Unable to register library "${r}" with version "${e}":`];i&&a.push(`library name "${r}" contains illegal characters (whitespace or "/")`),i&&s&&a.push("and"),s&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Sn.warn(a.join(" "));return}zs(new bn(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}var uA="firebase-heartbeat-database",dA=1,Gs="firebase-heartbeat-store",Ku=null;function O_(){return Ku||(Ku=E_(uA,dA,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(Gs)}catch(t){console.warn(t)}}}}).catch(n=>{throw Vn.create("idb-open",{originalErrorMessage:n.message})})),Ku}async function hA(n){try{let t=(await O_()).transaction(Gs),r=await t.objectStore(Gs).get(k_(n));return await t.done,r}catch(e){if(e instanceof vn)Sn.warn(e.message);else{let t=Vn.create("idb-get",{originalErrorMessage:e?.message});Sn.warn(t.message)}}}async function C_(n,e){try{let r=(await O_()).transaction(Gs,"readwrite");await r.objectStore(Gs).put(e,k_(n)),await r.done}catch(t){if(t instanceof vn)Sn.warn(t.message);else{let r=Vn.create("idb-set",{originalErrorMessage:t?.message});Sn.warn(r.message)}}}function k_(n){return`${n.name}!${n.options.appId}`}var fA=1024,pA=30,Zu=class{constructor(e){this.container=e,this._heartbeatsCache=null;let t=this.container.getProvider("app").getImmediate();this._storage=new Xu(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){try{let t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=I_();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some(i=>i.date===r))return;if(this._heartbeatsCache.heartbeats.push({date:r,agent:t}),this._heartbeatsCache.heartbeats.length>pA){let i=gA(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(i,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){Sn.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";let e=I_(),{heartbeatsToSend:t,unsentEntries:r}=mA(this._heartbeatsCache.heartbeats),i=qs(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(e){return Sn.warn(e),""}}};function I_(){return new Date().toISOString().substring(0,10)}function mA(n,e=fA){let t=[],r=n.slice();for(let i of n){let s=t.find(a=>a.agent===i.agent);if(s){if(s.dates.push(i.date),A_(t)>e){s.dates.pop();break}}else if(t.push({agent:i.agent,dates:[i.date]}),A_(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}var Xu=class{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return Uu()?m_().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){let t=await hA(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){let r=await this.read();return C_(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){let r=await this.read();return C_(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}};function A_(n){return qs(JSON.stringify({version:2,heartbeats:n})).length}function gA(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let r=1;r<n.length;r++)n[r].date<t&&(t=n[r].date,e=r);return e}function yA(n){zs(new bn("platform-logger",e=>new Hu(e),"PRIVATE")),zs(new bn("heartbeat",e=>new Zu(e),"PRIVATE")),zn(Wu,w_,n),zn(Wu,w_,"esm2020"),zn("fire-js","")}yA("");var _A="firebase",vA="12.6.0";zn(_A,vA,"app");var Ya=require("util");var M_=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},P_={};var En,td;(function(){var n;function e(v,y){function _(){}_.prototype=y.prototype,v.F=y.prototype,v.prototype=new _,v.prototype.constructor=v,v.D=function(b,f,w){for(var h=Array(arguments.length-2),g=2;g<arguments.length;g++)h[g-2]=arguments[g];return y.prototype[f].apply(b,h)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(r,t),r.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(v,y,_){_||(_=0);let b=Array(16);if(typeof y=="string")for(var f=0;f<16;++f)b[f]=y.charCodeAt(_++)|y.charCodeAt(_++)<<8|y.charCodeAt(_++)<<16|y.charCodeAt(_++)<<24;else for(f=0;f<16;++f)b[f]=y[_++]|y[_++]<<8|y[_++]<<16|y[_++]<<24;y=v.g[0],_=v.g[1],f=v.g[2];let w=v.g[3],h;h=y+(w^_&(f^w))+b[0]+3614090360&4294967295,y=_+(h<<7&4294967295|h>>>25),h=w+(f^y&(_^f))+b[1]+3905402710&4294967295,w=y+(h<<12&4294967295|h>>>20),h=f+(_^w&(y^_))+b[2]+606105819&4294967295,f=w+(h<<17&4294967295|h>>>15),h=_+(y^f&(w^y))+b[3]+3250441966&4294967295,_=f+(h<<22&4294967295|h>>>10),h=y+(w^_&(f^w))+b[4]+4118548399&4294967295,y=_+(h<<7&4294967295|h>>>25),h=w+(f^y&(_^f))+b[5]+1200080426&4294967295,w=y+(h<<12&4294967295|h>>>20),h=f+(_^w&(y^_))+b[6]+2821735955&4294967295,f=w+(h<<17&4294967295|h>>>15),h=_+(y^f&(w^y))+b[7]+4249261313&4294967295,_=f+(h<<22&4294967295|h>>>10),h=y+(w^_&(f^w))+b[8]+1770035416&4294967295,y=_+(h<<7&4294967295|h>>>25),h=w+(f^y&(_^f))+b[9]+2336552879&4294967295,w=y+(h<<12&4294967295|h>>>20),h=f+(_^w&(y^_))+b[10]+4294925233&4294967295,f=w+(h<<17&4294967295|h>>>15),h=_+(y^f&(w^y))+b[11]+2304563134&4294967295,_=f+(h<<22&4294967295|h>>>10),h=y+(w^_&(f^w))+b[12]+1804603682&4294967295,y=_+(h<<7&4294967295|h>>>25),h=w+(f^y&(_^f))+b[13]+4254626195&4294967295,w=y+(h<<12&4294967295|h>>>20),h=f+(_^w&(y^_))+b[14]+2792965006&4294967295,f=w+(h<<17&4294967295|h>>>15),h=_+(y^f&(w^y))+b[15]+1236535329&4294967295,_=f+(h<<22&4294967295|h>>>10),h=y+(f^w&(_^f))+b[1]+4129170786&4294967295,y=_+(h<<5&4294967295|h>>>27),h=w+(_^f&(y^_))+b[6]+3225465664&4294967295,w=y+(h<<9&4294967295|h>>>23),h=f+(y^_&(w^y))+b[11]+643717713&4294967295,f=w+(h<<14&4294967295|h>>>18),h=_+(w^y&(f^w))+b[0]+3921069994&4294967295,_=f+(h<<20&4294967295|h>>>12),h=y+(f^w&(_^f))+b[5]+3593408605&4294967295,y=_+(h<<5&4294967295|h>>>27),h=w+(_^f&(y^_))+b[10]+38016083&4294967295,w=y+(h<<9&4294967295|h>>>23),h=f+(y^_&(w^y))+b[15]+3634488961&4294967295,f=w+(h<<14&4294967295|h>>>18),h=_+(w^y&(f^w))+b[4]+3889429448&4294967295,_=f+(h<<20&4294967295|h>>>12),h=y+(f^w&(_^f))+b[9]+568446438&4294967295,y=_+(h<<5&4294967295|h>>>27),h=w+(_^f&(y^_))+b[14]+3275163606&4294967295,w=y+(h<<9&4294967295|h>>>23),h=f+(y^_&(w^y))+b[3]+4107603335&4294967295,f=w+(h<<14&4294967295|h>>>18),h=_+(w^y&(f^w))+b[8]+1163531501&4294967295,_=f+(h<<20&4294967295|h>>>12),h=y+(f^w&(_^f))+b[13]+2850285829&4294967295,y=_+(h<<5&4294967295|h>>>27),h=w+(_^f&(y^_))+b[2]+4243563512&4294967295,w=y+(h<<9&4294967295|h>>>23),h=f+(y^_&(w^y))+b[7]+1735328473&4294967295,f=w+(h<<14&4294967295|h>>>18),h=_+(w^y&(f^w))+b[12]+2368359562&4294967295,_=f+(h<<20&4294967295|h>>>12),h=y+(_^f^w)+b[5]+4294588738&4294967295,y=_+(h<<4&4294967295|h>>>28),h=w+(y^_^f)+b[8]+2272392833&4294967295,w=y+(h<<11&4294967295|h>>>21),h=f+(w^y^_)+b[11]+1839030562&4294967295,f=w+(h<<16&4294967295|h>>>16),h=_+(f^w^y)+b[14]+4259657740&4294967295,_=f+(h<<23&4294967295|h>>>9),h=y+(_^f^w)+b[1]+2763975236&4294967295,y=_+(h<<4&4294967295|h>>>28),h=w+(y^_^f)+b[4]+1272893353&4294967295,w=y+(h<<11&4294967295|h>>>21),h=f+(w^y^_)+b[7]+4139469664&4294967295,f=w+(h<<16&4294967295|h>>>16),h=_+(f^w^y)+b[10]+3200236656&4294967295,_=f+(h<<23&4294967295|h>>>9),h=y+(_^f^w)+b[13]+681279174&4294967295,y=_+(h<<4&4294967295|h>>>28),h=w+(y^_^f)+b[0]+3936430074&4294967295,w=y+(h<<11&4294967295|h>>>21),h=f+(w^y^_)+b[3]+3572445317&4294967295,f=w+(h<<16&4294967295|h>>>16),h=_+(f^w^y)+b[6]+76029189&4294967295,_=f+(h<<23&4294967295|h>>>9),h=y+(_^f^w)+b[9]+3654602809&4294967295,y=_+(h<<4&4294967295|h>>>28),h=w+(y^_^f)+b[12]+3873151461&4294967295,w=y+(h<<11&4294967295|h>>>21),h=f+(w^y^_)+b[15]+530742520&4294967295,f=w+(h<<16&4294967295|h>>>16),h=_+(f^w^y)+b[2]+3299628645&4294967295,_=f+(h<<23&4294967295|h>>>9),h=y+(f^(_|~w))+b[0]+4096336452&4294967295,y=_+(h<<6&4294967295|h>>>26),h=w+(_^(y|~f))+b[7]+1126891415&4294967295,w=y+(h<<10&4294967295|h>>>22),h=f+(y^(w|~_))+b[14]+2878612391&4294967295,f=w+(h<<15&4294967295|h>>>17),h=_+(w^(f|~y))+b[5]+4237533241&4294967295,_=f+(h<<21&4294967295|h>>>11),h=y+(f^(_|~w))+b[12]+1700485571&4294967295,y=_+(h<<6&4294967295|h>>>26),h=w+(_^(y|~f))+b[3]+2399980690&4294967295,w=y+(h<<10&4294967295|h>>>22),h=f+(y^(w|~_))+b[10]+4293915773&4294967295,f=w+(h<<15&4294967295|h>>>17),h=_+(w^(f|~y))+b[1]+2240044497&4294967295,_=f+(h<<21&4294967295|h>>>11),h=y+(f^(_|~w))+b[8]+1873313359&4294967295,y=_+(h<<6&4294967295|h>>>26),h=w+(_^(y|~f))+b[15]+4264355552&4294967295,w=y+(h<<10&4294967295|h>>>22),h=f+(y^(w|~_))+b[6]+2734768916&4294967295,f=w+(h<<15&4294967295|h>>>17),h=_+(w^(f|~y))+b[13]+1309151649&4294967295,_=f+(h<<21&4294967295|h>>>11),h=y+(f^(_|~w))+b[4]+4149444226&4294967295,y=_+(h<<6&4294967295|h>>>26),h=w+(_^(y|~f))+b[11]+3174756917&4294967295,w=y+(h<<10&4294967295|h>>>22),h=f+(y^(w|~_))+b[2]+718787259&4294967295,f=w+(h<<15&4294967295|h>>>17),h=_+(w^(f|~y))+b[9]+3951481745&4294967295,v.g[0]=v.g[0]+y&4294967295,v.g[1]=v.g[1]+(f+(h<<21&4294967295|h>>>11))&4294967295,v.g[2]=v.g[2]+f&4294967295,v.g[3]=v.g[3]+w&4294967295}r.prototype.v=function(v,y){y===void 0&&(y=v.length);let _=y-this.blockSize,b=this.C,f=this.h,w=0;for(;w<y;){if(f==0)for(;w<=_;)i(this,v,w),w+=this.blockSize;if(typeof v=="string"){for(;w<y;)if(b[f++]=v.charCodeAt(w++),f==this.blockSize){i(this,b),f=0;break}}else for(;w<y;)if(b[f++]=v[w++],f==this.blockSize){i(this,b),f=0;break}}this.h=f,this.o+=y},r.prototype.A=function(){var v=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);v[0]=128;for(var y=1;y<v.length-8;++y)v[y]=0;y=this.o*8;for(var _=v.length-8;_<v.length;++_)v[_]=y&255,y/=256;for(this.v(v),v=Array(16),y=0,_=0;_<4;++_)for(let b=0;b<32;b+=8)v[y++]=this.g[_]>>>b&255;return v};function s(v,y){var _=o;return Object.prototype.hasOwnProperty.call(_,v)?_[v]:_[v]=y(v)}function a(v,y){this.h=y;let _=[],b=!0;for(let f=v.length-1;f>=0;f--){let w=v[f]|0;b&&w==y||(_[f]=w,b=!1)}this.g=_}var o={};function l(v){return-128<=v&&v<128?s(v,function(y){return new a([y|0],y<0?-1:0)}):new a([v|0],v<0?-1:0)}function c(v){if(isNaN(v)||!isFinite(v))return m;if(v<0)return T(c(-v));let y=[],_=1;for(let b=0;v>=_;b++)y[b]=v/_|0,_*=4294967296;return new a(y,0)}function u(v,y){if(v.length==0)throw Error("number format error: empty string");if(y=y||10,y<2||36<y)throw Error("radix out of range: "+y);if(v.charAt(0)=="-")return T(u(v.substring(1),y));if(v.indexOf("-")>=0)throw Error('number format error: interior "-" character');let _=c(Math.pow(y,8)),b=m;for(let w=0;w<v.length;w+=8){var f=Math.min(8,v.length-w);let h=parseInt(v.substring(w,w+f),y);f<8?(f=c(Math.pow(y,f)),b=b.j(f).add(c(h))):(b=b.j(_),b=b.add(c(h)))}return b}var m=l(0),d=l(1),p=l(16777216);n=a.prototype,n.m=function(){if(C(this))return-T(this).m();let v=0,y=1;for(let _=0;_<this.g.length;_++){let b=this.i(_);v+=(b>=0?b:4294967296+b)*y,y*=4294967296}return v},n.toString=function(v){if(v=v||10,v<2||36<v)throw Error("radix out of range: "+v);if(E(this))return"0";if(C(this))return"-"+T(this).toString(v);let y=c(Math.pow(v,6));var _=this;let b="";for(;;){let f=S(_,y).g;_=I(_,f.j(y));let w=((_.g.length>0?_.g[0]:_.h)>>>0).toString(v);if(_=f,E(_))return w+b;for(;w.length<6;)w="0"+w;b=w+b}},n.i=function(v){return v<0?0:v<this.g.length?this.g[v]:this.h};function E(v){if(v.h!=0)return!1;for(let y=0;y<v.g.length;y++)if(v.g[y]!=0)return!1;return!0}function C(v){return v.h==-1}n.l=function(v){return v=I(this,v),C(v)?-1:E(v)?0:1};function T(v){let y=v.g.length,_=[];for(let b=0;b<y;b++)_[b]=~v.g[b];return new a(_,~v.h).add(d)}n.abs=function(){return C(this)?T(this):this},n.add=function(v){let y=Math.max(this.g.length,v.g.length),_=[],b=0;for(let f=0;f<=y;f++){let w=b+(this.i(f)&65535)+(v.i(f)&65535),h=(w>>>16)+(this.i(f)>>>16)+(v.i(f)>>>16);b=h>>>16,w&=65535,h&=65535,_[f]=h<<16|w}return new a(_,_[_.length-1]&-2147483648?-1:0)};function I(v,y){return v.add(T(y))}n.j=function(v){if(E(this)||E(v))return m;if(C(this))return C(v)?T(this).j(T(v)):T(T(this).j(v));if(C(v))return T(this.j(T(v)));if(this.l(p)<0&&v.l(p)<0)return c(this.m()*v.m());let y=this.g.length+v.g.length,_=[];for(var b=0;b<2*y;b++)_[b]=0;for(b=0;b<this.g.length;b++)for(let f=0;f<v.g.length;f++){let w=this.i(b)>>>16,h=this.i(b)&65535,g=v.i(f)>>>16,k=v.i(f)&65535;_[2*b+2*f]+=h*k,N(_,2*b+2*f),_[2*b+2*f+1]+=w*k,N(_,2*b+2*f+1),_[2*b+2*f+1]+=h*g,N(_,2*b+2*f+1),_[2*b+2*f+2]+=w*g,N(_,2*b+2*f+2)}for(v=0;v<y;v++)_[v]=_[2*v+1]<<16|_[2*v];for(v=y;v<2*y;v++)_[v]=0;return new a(_,0)};function N(v,y){for(;(v[y]&65535)!=v[y];)v[y+1]+=v[y]>>>16,v[y]&=65535,y++}function A(v,y){this.g=v,this.h=y}function S(v,y){if(E(y))throw Error("division by zero");if(E(v))return new A(m,m);if(C(v))return y=S(T(v),y),new A(T(y.g),T(y.h));if(C(y))return y=S(v,T(y)),new A(T(y.g),y.h);if(v.g.length>30){if(C(v)||C(y))throw Error("slowDivide_ only works with positive integers.");for(var _=d,b=y;b.l(v)<=0;)_=P(_),b=P(b);var f=L(_,1),w=L(b,1);for(b=L(b,2),_=L(_,2);!E(b);){var h=w.add(b);h.l(v)<=0&&(f=f.add(_),w=h),b=L(b,1),_=L(_,1)}return y=I(v,f.j(y)),new A(f,y)}for(f=m;v.l(y)>=0;){for(_=Math.max(1,Math.floor(v.m()/y.m())),b=Math.ceil(Math.log(_)/Math.LN2),b=b<=48?1:Math.pow(2,b-48),w=c(_),h=w.j(y);C(h)||h.l(v)>0;)_-=b,w=c(_),h=w.j(y);E(w)&&(w=d),f=f.add(w),v=I(v,h)}return new A(f,v)}n.B=function(v){return S(this,v).h},n.and=function(v){let y=Math.max(this.g.length,v.g.length),_=[];for(let b=0;b<y;b++)_[b]=this.i(b)&v.i(b);return new a(_,this.h&v.h)},n.or=function(v){let y=Math.max(this.g.length,v.g.length),_=[];for(let b=0;b<y;b++)_[b]=this.i(b)|v.i(b);return new a(_,this.h|v.h)},n.xor=function(v){let y=Math.max(this.g.length,v.g.length),_=[];for(let b=0;b<y;b++)_[b]=this.i(b)^v.i(b);return new a(_,this.h^v.h)};function P(v){let y=v.g.length+1,_=[];for(let b=0;b<y;b++)_[b]=v.i(b)<<1|v.i(b-1)>>>31;return new a(_,v.h)}function L(v,y){let _=y>>5;y%=32;let b=v.g.length-_,f=[];for(let w=0;w<b;w++)f[w]=y>0?v.i(w+_)>>>y|v.i(w+_+1)<<32-y:v.i(w+_);return new a(f,v.h)}r.prototype.digest=r.prototype.A,r.prototype.reset=r.prototype.u,r.prototype.update=r.prototype.v,td=P_.Md5=r,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.B,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=c,a.fromString=u,En=P_.Integer=a}).apply(typeof M_<"u"?M_:typeof self<"u"?self:typeof window<"u"?window:{});var qE=require("crypto"),Kr=iu(nE(),1),VE=iu(Jh(),1),rE="@firebase/firestore",iE="4.9.2";var qe=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};qe.UNAUTHENTICATED=new qe(null);qe.GOOGLE_CREDENTIALS=new qe("google-credentials-uid");qe.FIRST_PARTY=new qe("first-party-uid");qe.MOCK_USER=new qe("mock-user");var FM="12.3.0";var ys=FM;function BM(n){ys=n}function UM(n){return(0,Ya.inspect)(n,{depth:100})}var Hr=new li("@firebase/firestore");function Hi(){return Hr.logLevel}function V(n,...e){if(Hr.logLevel<=X.DEBUG){let t=e.map(cg);Hr.debug(`Firestore (${ys}): ${n}`,...t)}}function Vt(n,...e){if(Hr.logLevel<=X.ERROR){let t=e.map(cg);Hr.error(`Firestore (${ys}): ${n}`,...t)}}function Zi(n,...e){if(Hr.logLevel<=X.WARN){let t=e.map(cg);Hr.warn(`Firestore (${ys}): ${n}`,...t)}}function cg(n){if(typeof n=="string")return n;try{return UM(n)}catch{return n}}function K(n,e,t){let r="Unexpected state";typeof e=="string"?r=e:t=e,zE(n,r,t)}function zE(n,e,t){let r=`FIRESTORE (${ys}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{let i=JSON.stringify(t);r+=" CONTEXT: "+i}catch{r+=" CONTEXT: "+t}throw Vt(r),new Error(r)}function _e(n,e,t,r){let i="Unexpected state";typeof t=="string"?i=t:r=t,n||zE(e,i,r)}function re(n,e){return n}var F={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},G=class extends vn{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}};var hn=class{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}};var bc=class{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}},xp=class{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(qe.UNAUTHENTICATED))}shutdown(){}},Np=class{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}},Op=class{constructor(e){this.authProvider=e,this.currentUser=qe.UNAUTHENTICATED,this.tokenCounter=0,this.forceRefresh=!1,this.auth=null}start(e,t){_e(this.tokenListener===void 0,42304);let r=this.tokenCounter,i=l=>this.tokenCounter!==r?(r=this.tokenCounter,t(l)):Promise.resolve(),s=new hn;this.tokenListener=()=>{this.tokenCounter++,this.currentUser=this.getUser(),s.resolve(),s=new hn,e.enqueueRetryable(()=>i(this.currentUser))};let a=()=>{let l=s;e.enqueueRetryable(async()=>{await l.promise,await i(this.currentUser)})},o=l=>{V("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.tokenListener&&(this.auth.addAuthTokenListener(this.tokenListener),a())};this.authProvider.onInit(l=>o(l)),setTimeout(()=>{if(!this.auth){let l=this.authProvider.getImmediate({optional:!0});l?o(l):(V("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new hn)}},0),a()}getToken(){let e=this.tokenCounter,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(r=>this.tokenCounter!==e?(V("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(_e(typeof r.accessToken=="string",31837,{tokenData:r}),new bc(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.tokenListener&&this.auth.removeAuthTokenListener(this.tokenListener),this.tokenListener=void 0}getUser(){let e=this.auth&&this.auth.getUid();return _e(e===null||typeof e=="string",2055,{currentUid:e}),new qe(e)}},kp=class{constructor(e,t,r){this.sessionIndex=e,this.iamToken=t,this.authTokenFactory=r,this.type="FirstParty",this.user=qe.FIRST_PARTY,this._headers=new Map}getAuthToken(){return this.authTokenFactory?this.authTokenFactory():null}get headers(){this._headers.set("X-Goog-AuthUser",this.sessionIndex);let e=this.getAuthToken();return e&&this._headers.set("Authorization",e),this.iamToken&&this._headers.set("X-Goog-Iam-Authorization-Token",this.iamToken),this._headers}},Mp=class{constructor(e,t,r){this.sessionIndex=e,this.iamToken=t,this.authTokenFactory=r}getToken(){return Promise.resolve(new kp(this.sessionIndex,this.iamToken,this.authTokenFactory))}start(e,t){e.enqueueRetryable(()=>t(qe.FIRST_PARTY))}shutdown(){}invalidateToken(){}},Sc=class{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}},Pp=class{constructor(e,t){this.appCheckProvider=t,this.forceRefresh=!1,this.appCheck=null,this.latestAppCheckToken=null,this.serverAppAppCheckToken=null,D_(e)&&e.settings.appCheckToken&&(this.serverAppAppCheckToken=e.settings.appCheckToken)}start(e,t){_e(this.tokenListener===void 0,3512);let r=s=>{s.error!=null&&V("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);let a=s.token!==this.latestAppCheckToken;return this.latestAppCheckToken=s.token,V("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?t(s.token):Promise.resolve()};this.tokenListener=s=>{e.enqueueRetryable(()=>r(s))};let i=s=>{V("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.tokenListener&&this.appCheck.addTokenListener(this.tokenListener)};this.appCheckProvider.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){let s=this.appCheckProvider.getImmediate({optional:!0});s?i(s):V("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.serverAppAppCheckToken)return Promise.resolve(new Sc(this.serverAppAppCheckToken));let e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(_e(typeof t.token=="string",44558,{tokenResult:t}),this.latestAppCheckToken=t.token,new Sc(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.tokenListener&&this.appCheck.removeTokenListener(this.tokenListener),this.tokenListener=void 0}};function qM(n){if(!n)return new xp;switch(n.type){case"firstParty":return new Mp(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new G(F.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}function VM(n){return(0,qE.randomBytes)(n)}var ts=class{static newId(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length,r="",i=20;for(;r.length<i;){let s=VM(40);for(let a=0;a<s.length;++a)r.length<i&&s[a]<t&&(r+=e.charAt(s[a]%e.length))}return r}};function ee(n,e){return n<e?-1:n>e?1:0}function ug(n,e){let t=Math.min(n.length,e.length);for(let r=0;r<t;r++){let i=n.charAt(r),s=e.charAt(r);if(i!==s)return Ep(i)===Ep(s)?ee(i,s):Ep(i)?1:-1}return ee(n.length,e.length)}var zM=55296,GM=57343;function Ep(n){let e=n.charCodeAt(0);return e>=zM&&e<=GM}function Wr(n,e,t){return n.length!==e.length?!1:n.every((r,i)=>t(r,e[i]))}var sE="__name__",Ec=class n{constructor(e,t,r){t===void 0?t=0:t>e.length&&K(637,{offset:t,range:e.length}),r===void 0?r=e.length-t:r>e.length-t&&K(1746,{length:r,range:e.length-t}),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return n.comparator(this,e)===0}child(e){let t=this.segments.slice(this.offset,this.limit());return e instanceof n?e.forEach(r=>{t.push(r)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){let r=Math.min(e.length,t.length);for(let i=0;i<r;i++){let s=n.compareSegments(e.get(i),t.get(i));if(s!==0)return s}return ee(e.length,t.length)}static compareSegments(e,t){let r=n.isNumericId(e),i=n.isNumericId(t);return r&&!i?-1:!r&&i?1:r&&i?n.extractNumericId(e).compare(n.extractNumericId(t)):ug(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return En.fromString(e.substring(4,e.length-2))}},Te=class n extends Ec{construct(e,t,r){return new n(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){let t=[];for(let r of e){if(r.indexOf("//")>=0)throw new G(F.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(i=>i.length>0))}return new n(t)}static emptyPath(){return new n([])}},$M=/^[_a-zA-Z][_a-zA-Z0-9]*$/,xt=class n extends Ec{construct(e,t,r){return new n(e,t,r)}static isValidIdentifier(e){return $M.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),n.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===sE}static keyField(){return new n([sE])}static fromServerFormat(e){let t=[],r="",i=0,s=()=>{if(r.length===0)throw new G(F.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""},a=!1;for(;i<e.length;){let o=e[i];if(o==="\\"){if(i+1===e.length)throw new G(F.INVALID_ARGUMENT,"Path has trailing escape character: "+e);let l=e[i+1];if(!(l==="\\"||l==="."||l==="`"))throw new G(F.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=l,i+=2}else o==="`"?(a=!a,i++):o==="."&&!a?(s(),i++):(r+=o,i++)}if(s(),a)throw new G(F.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new n(t)}static emptyPath(){return new n([])}};var $=class n{constructor(e){this.path=e}static fromPath(e){return new n(Te.fromString(e))}static fromName(e){return new n(Te.fromString(e).popFirst(5))}static empty(){return new n(Te.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Te.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return Te.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2===0}static fromSegments(e){return new n(new Te(e.slice()))}};function jM(n,e,t){if(!t)throw new G(F.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function KM(n,e,t,r){if(e===!0&&r===!0)throw new G(F.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function aE(n){if(!$.isDocumentKey(n))throw new G(F.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function GE(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function dg(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{let e=HM(n);return e?`a custom ${e} object`:"an object"}}else return typeof n=="function"?"a function":K(12329,{type:typeof n})}function HM(n){return n.constructor?n.constructor.name:null}function Lp(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new G(F.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let t=dg(n);throw new G(F.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function De(n,e){let t={typeString:n};return e&&(t.value=e),t}function Ja(n,e){if(!GE(n))throw new G(F.INVALID_ARGUMENT,"JSON must be an object");let t;for(let r in e)if(e[r]){let i=e[r].typeString,s="value"in e[r]?{value:e[r].value}:void 0;if(!(r in n)){t=`JSON missing required field: '${r}'`;break}let a=n[r];if(i&&typeof a!==i){t=`JSON field '${r}' must be a ${i}.`;break}else if(s!==void 0&&a!==s.value){t=`Expected '${r}' field to equal '${s.value}'`;break}}if(t)throw new G(F.INVALID_ARGUMENT,t);return!0}var oE=-62135596800,lE=1e6,Ce=class n{static now(){return n.fromMillis(Date.now())}static fromDate(e){return n.fromMillis(e.getTime())}static fromMillis(e){let t=Math.floor(e/1e3),r=Math.floor((e-t*1e3)*lE);return new n(t,r)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new G(F.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new G(F.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<oE)throw new G(F.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new G(F.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return this.seconds*1e3+this.nanoseconds/lE}_compareTo(e){return this.seconds===e.seconds?ee(this.nanoseconds,e.nanoseconds):ee(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:n._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Ja(e,n._jsonSchema))return new n(e.seconds,e.nanoseconds)}valueOf(){let e=this.seconds-oE,t=String(e).padStart(12,"0"),r=String(this.nanoseconds).padStart(9,"0");return t+"."+r}};Ce._jsonSchemaVersion="firestore/timestamp/1.0";Ce._jsonSchema={type:De("string",Ce._jsonSchemaVersion),seconds:De("number"),nanoseconds:De("number")};var W=class n{static fromTimestamp(e){return new n(e)}static min(){return new n(new Ce(0,0))}static max(){return new n(new Ce(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return this.timestamp.seconds*1e6+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}};var Oa=-1;var Fp=class{constructor(e,t,r,i){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=i}};Fp.UNKNOWN_ID=-1;function WM(n,e){let t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,i=W.fromTimestamp(r===1e9?new Ce(t+1,0):new Ce(t,r));return new Qr(i,$.empty(),e)}function QM(n){return new Qr(n.readTime,n.key,Oa)}var Qr=class n{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new n(W.min(),$.empty(),Oa)}static max(){return new n(W.max(),$.empty(),Oa)}};function YM(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0||(t=$.comparator(n.documentKey,e.documentKey),t!==0)?t:ee(n.largestBatchId,e.largestBatchId)}var JM="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",Bp=class{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}};async function Hc(n){if(n.code===F.FAILED_PRECONDITION&&n.message===JM)V("LocalStore","Unexpectedly lost primary lease");else throw n}var O=class n{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&K(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new n((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(t,s).next(r,i)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{let t=e();return t instanceof n?t:n.resolve(t)}catch(t){return n.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):n.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):n.reject(t)}static resolve(e){return new n((t,r)=>{t(e)})}static reject(e){return new n((t,r)=>{r(e)})}static waitFor(e){return new n((t,r)=>{let i=0,s=0,a=!1;e.forEach(o=>{++i,o.next(()=>{++s,a&&s===i&&t()},l=>r(l))}),a=!0,s===i&&t()})}static or(e){let t=n.resolve(!1);for(let r of e)t=t.next(i=>i?n.resolve(i):r());return t}static forEach(e,t){let r=[];return e.forEach((i,s)=>{r.push(t.call(this,i,s))}),this.waitFor(r)}static mapArray(e,t){return new n((r,i)=>{let s=e.length,a=new Array(s),o=0;for(let l=0;l<s;l++){let c=l;t(e[c]).next(u=>{a[c]=u,++o,o===s&&r(a)},u=>i(u))}})}static doWhile(e,t){return new n((r,i)=>{let s=()=>{e()===!0?t().next(()=>{s()},i):r()};s()})}};function ZM(n){let e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function _s(n){return n.name==="IndexedDbTransactionError"}var zU=15*1e3,GU=60*1e3;var ns=class{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=r=>this.setPreviousValue(r),this.writeNewSequenceNumber=r=>t.writeSequenceNumber(r))}setPreviousValue(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){let e=++this.previousValue;return this.writeNewSequenceNumber&&this.writeNewSequenceNumber(e),e}};ns.INVALID=-1;var _c="",XM="",eP="",tP="";function nP(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=cE(e)),e=rP(n.get(t),e);return cE(e)}function rP(n,e){let t=e,r=n.length;for(let i=0;i<r;i++){let s=n.charAt(i);switch(s){case"\0":t+=_c+eP;break;case _c:t+=_c+tP;break;default:t+=s}}return t}function cE(n){return n+_c+XM}var iP="remoteDocuments";var $E="owner";var jE="mutationQueues";var KE="mutations";var HE="documentMutations",sP="remoteDocumentsV14";var WE="remoteDocumentGlobal";var QE="targets";var YE="targetDocuments";var JE="targetGlobal",ZE="collectionParents";var XE="clientMetadata";var ew="bundles";var tw="namedQueries";var aP="indexConfiguration";var oP="indexState";var lP="indexEntries";var nw="documentOverlays";var cP="globals";var uP=[jE,KE,HE,iP,QE,$E,JE,YE],dP=uP,hP=[...dP,XE],fP=[...hP,WE],pP=[...fP,ZE],mP=[...pP,ew,tw],$U=[...mP,nw],gP=[jE,KE,HE,sP,QE,$E,JE,YE,XE,WE,ZE,ew,tw,nw],yP=gP,_P=[...yP,aP,oP,lP];var jU=[..._P,cP];function uE(n){let e=0;for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function vs(n,e){for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function rw(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}var Ie=class n{constructor(e,t){this.comparator=e,this.root=t||fn.EMPTY}insert(e,t){return new n(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,fn.BLACK,null,null))}remove(e){return new n(this.comparator,this.root.remove(e,this.comparator).copy(null,null,fn.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){let r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){let i=this.comparator(e,r.key);if(i===0)return t+r.left.size;i<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){let e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Yi(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Yi(this.root,e,this.comparator,!1)}getReverseIterator(){return new Yi(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Yi(this.root,e,this.comparator,!0)}},Yi=class{constructor(e,t,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?r(e.key,t):1,t&&i&&(s*=-1),s<0)this.isReverse?e=e.left:e=e.right;else if(s===0){this.nodeStack.push(e);break}else this.nodeStack.push(e),this.isReverse?e=e.right:e=e.left}getNext(){let e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},fn=class n{constructor(e,t,r,i,s){this.key=e,this.value=t,this.color=r??n.RED,this.left=i??n.EMPTY,this.right=s??n.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,i,s){return new n(e??this.key,t??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this,s=r(e,i.key);return s<0?i=i.copy(null,null,null,i.left.insert(e,t,r),null):s===0?i=i.copy(null,t,null,null,null):i=i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return n.EMPTY;let e=this;return!e.left.isRed()&&!e.left.left.isRed()&&(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,i=this;if(t(e,i.key)<0)!i.left.isEmpty()&&!i.left.isRed()&&!i.left.left.isRed()&&(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),!i.right.isEmpty()&&!i.right.isRed()&&!i.right.left.isRed()&&(i=i.moveRedRight()),t(e,i.key)===0){if(i.right.isEmpty())return n.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){let e=this.copy(null,null,n.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){let e=this.copy(null,null,n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){let e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){let e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw K(43730,{key:this.key,value:this.value});if(this.right.isRed())throw K(14113,{key:this.key,value:this.value});let e=this.left.check();if(e!==this.right.check())throw K(27949);return e+(this.isRed()?0:1)}};fn.EMPTY=null;fn.RED=!0;fn.BLACK=!1;var Up=class{constructor(){this.size=0}get key(){throw K(57766)}get value(){throw K(16141)}get color(){throw K(16727)}get left(){throw K(29726)}get right(){throw K(36894)}copy(e,t,r,i,s){return this}insert(e,t,r){return new fn(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};fn.EMPTY=new Up;var Ue=class n{constructor(e){this.comparator=e,this.data=new Ie(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){let r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){let i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let r;for(t!==void 0?r=this.data.getIteratorFrom(t):r=this.data.getIterator();r.hasNext();){let i=r.getNext();if(!e(i.key))return}}firstAfterOrEqual(e){let t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new wc(this.data.getIterator())}getIteratorFrom(e){return new wc(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(r=>{t=t.add(r)}),t}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){let i=t.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){let e=[];return this.forEach(t=>{e.push(t)}),e}toString(){let e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){let t=new n(this.comparator);return t.data=e,t}},wc=class{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}};var Gr=class n{constructor(e){this.fields=e,e.sort(xt.comparator)}static empty(){return new n([])}unionWith(e){let t=new Ue(xt.comparator);for(let r of this.fields)t=t.add(r);for(let r of e)t=t.add(r);return new n(t.toArray())}covers(e){for(let t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Wr(this.fields,e.fields,(t,r)=>t.isEqual(r))}};function vP(n){return Buffer.from(n,"base64").toString("binary")}function bP(n){return Buffer.from(n,"binary").toString("base64")}var Ye=class n{constructor(e){this.binaryString=e}static fromBase64String(e){let t=vP(e);return new n(t)}static fromUint8Array(e){let t=SP(e);return new n(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return bP(this.binaryString)}toUint8Array(){return EP(this.binaryString)}approximateByteSize(){return this.binaryString.length*2}compareTo(e){return ee(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}};Ye.EMPTY_BYTE_STRING=new Ye("");function SP(n){let e="";for(let t=0;t<n.length;++t)e+=String.fromCharCode(n[t]);return e}function EP(n){let e=new Uint8Array(n.length);for(let t=0;t<n.length;t++)e[t]=n.charCodeAt(t);return e}var wP=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function kn(n){if(_e(!!n,39018),typeof n=="string"){let e=0,t=wP.exec(n);if(_e(!!t,46558,{timestamp:n}),t[1]){let s=t[1];s=(s+"000000000").substr(0,9),e=Number(s)}let r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}else{let e=ye(n.seconds),t=ye(n.nanos);return{seconds:e,nanos:t}}}function ye(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function Mn(n){return typeof n=="string"?Ye.fromBase64String(n):Ye.fromUint8Array(n)}var iw="server_timestamp",sw="__type__",aw="__previous_value__",ow="__local_write_time__";function hg(n){return(n?.mapValue?.fields||{})[sw]?.stringValue===iw}function TP(n,e){let t={fields:{[sw]:{stringValue:iw},[ow]:{timestampValue:{seconds:n.seconds,nanos:n.nanoseconds}}}};return e&&hg(e)&&(e=Wc(e)),e&&(t.fields[aw]=e),{mapValue:t}}function Wc(n){let e=n.mapValue.fields[aw];return hg(e)?Wc(e):e}function ka(n){let e=kn(n.mapValue.fields[ow].timestampValue);return new Ce(e.seconds,e.nanos)}var qp=class{constructor(e,t,r,i,s,a,o,l,c,u){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=a,this.autoDetectLongPolling=o,this.longPollingOptions=l,this.useFetchStreams=c,this.isUsingEmulator=u}},Vp="(default)",Tc=class n{constructor(e,t){this.projectId=e,this.database=t||Vp}static empty(){return new n("","")}get isDefaultDatabase(){return this.database===Vp}isEqual(e){return e instanceof n&&e.projectId===this.projectId&&e.database===this.database}};function CP(n,e){if(!Object.prototype.hasOwnProperty.apply(n.options,["projectId"]))throw new G(F.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Tc(n.options.projectId,e)}var IP=-1;function Qc(n){return n==null}function Ma(n){return n===0&&1/n===-1/0}function AP(n){return typeof n=="number"&&Number.isInteger(n)&&!Ma(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}var fg="__type__",lw="__max__",mc={mapValue:{fields:{__type__:{stringValue:lw}}}},pg="__vector__",rs="value";function gr(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?hg(n)?4:dw(n)?9007199254740991:uw(n)?10:11:K(28295,{value:n})}function Ut(n,e){if(n===e)return!0;let t=gr(n),r=gr(e);if(t!==r)return!1;switch(t){case 0:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return ka(n).isEqual(ka(e));case 3:return RP(n,e);case 5:return n.stringValue===e.stringValue;case 6:return xP(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return DP(n,e);case 2:return NP(n,e);case 9:return Wr(n.arrayValue.values||[],e.arrayValue.values||[],Ut);case 10:case 11:return OP(n,e);case 9007199254740991:return!0;default:return K(52216,{left:n})}}function RP(n,e){if(typeof n.timestampValue=="string"&&typeof e.timestampValue=="string"&&n.timestampValue.length===e.timestampValue.length)return n.timestampValue===e.timestampValue;let t=kn(n.timestampValue),r=kn(e.timestampValue);return t.seconds===r.seconds&&t.nanos===r.nanos}function DP(n,e){return ye(n.geoPointValue.latitude)===ye(e.geoPointValue.latitude)&&ye(n.geoPointValue.longitude)===ye(e.geoPointValue.longitude)}function xP(n,e){return Mn(n.bytesValue).isEqual(Mn(e.bytesValue))}function NP(n,e){if("integerValue"in n&&"integerValue"in e)return ye(n.integerValue)===ye(e.integerValue);if("doubleValue"in n&&"doubleValue"in e){let t=ye(n.doubleValue),r=ye(e.doubleValue);return t===r?Ma(t)===Ma(r):isNaN(t)&&isNaN(r)}return!1}function OP(n,e){let t=n.mapValue.fields||{},r=e.mapValue.fields||{};if(uE(t)!==uE(r))return!1;for(let i in t)if(t.hasOwnProperty(i)&&(r[i]===void 0||!Ut(t[i],r[i])))return!1;return!0}function Pa(n,e){return(n.values||[]).find(t=>Ut(t,e))!==void 0}function is(n,e){if(n===e)return 0;let t=gr(n),r=gr(e);if(t!==r)return ee(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return ee(n.booleanValue,e.booleanValue);case 2:return kP(n,e);case 3:return dE(n.timestampValue,e.timestampValue);case 4:return dE(ka(n),ka(e));case 5:return ug(n.stringValue,e.stringValue);case 6:return LP(n.bytesValue,e.bytesValue);case 7:return MP(n.referenceValue,e.referenceValue);case 8:return PP(n.geoPointValue,e.geoPointValue);case 9:return cw(n.arrayValue,e.arrayValue);case 10:return FP(n.mapValue,e.mapValue);case 11:return BP(n.mapValue,e.mapValue);default:throw K(23264,{leftType:t})}}function kP(n,e){let t=ye(n.integerValue||n.doubleValue),r=ye(e.integerValue||e.doubleValue);return t<r?-1:t>r?1:t===r?0:isNaN(t)?isNaN(r)?0:-1:1}function dE(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return ee(n,e);let t=kn(n),r=kn(e),i=ee(t.seconds,r.seconds);return i!==0?i:ee(t.nanos,r.nanos)}function MP(n,e){let t=n.split("/"),r=e.split("/");for(let i=0;i<t.length&&i<r.length;i++){let s=ee(t[i],r[i]);if(s!==0)return s}return ee(t.length,r.length)}function PP(n,e){let t=ee(ye(n.latitude),ye(e.latitude));return t!==0?t:ee(ye(n.longitude),ye(e.longitude))}function LP(n,e){let t=Mn(n),r=Mn(e);return t.compareTo(r)}function cw(n,e){let t=n.values||[],r=e.values||[];for(let i=0;i<t.length&&i<r.length;++i){let s=is(t[i],r[i]);if(s)return s}return ee(t.length,r.length)}function FP(n,e){let t=n.fields||{},r=e.fields||{},i=t[rs]?.arrayValue,s=r[rs]?.arrayValue,a=ee(i?.values?.length||0,s?.values?.length||0);return a!==0?a:cw(i,s)}function BP(n,e){if(n===mc.mapValue&&e===mc.mapValue)return 0;if(n===mc.mapValue)return 1;if(e===mc.mapValue)return-1;let t=n.fields||{},r=Object.keys(t),i=e.fields||{},s=Object.keys(i);r.sort(),s.sort();for(let a=0;a<r.length&&a<s.length;++a){let o=ug(r[a],s[a]);if(o!==0)return o;let l=is(t[r[a]],i[s[a]]);if(l!==0)return l}return ee(r.length,s.length)}function ss(n){return mg(n)}function mg(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?qP(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?UP(n.bytesValue):"referenceValue"in n?zP(n.referenceValue):"geoPointValue"in n?VP(n.geoPointValue):"arrayValue"in n?$P(n.arrayValue):"mapValue"in n?GP(n.mapValue):K(61005,{value:n})}function UP(n){return Mn(n).toBase64()}function qP(n){let e=kn(n);return`time(${e.seconds},${e.nanos})`}function VP(n){return`geo(${n.latitude},${n.longitude})`}function zP(n){return $.fromName(n).toString()}function GP(n){let e=Object.keys(n.fields||{}).sort(),t="{",r=!0;for(let i of e)r?r=!1:t+=",",t+=`${i}:${mg(n.fields[i])}`;return t+"}"}function $P(n){let e="[",t=!0;for(let r of n.values||[])t?t=!1:e+=",",e+=mg(r);return e+"]"}function Yc(n){switch(gr(n)){case 0:return 4;case 1:return 4;case 2:return 8;case 3:return 16;case 4:let e=Wc(n);return e?16+Yc(e):16;case 5:return n.stringValue.length*2;case 6:return Mn(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 8:return 16;case 9:return KP(n.arrayValue);case 10:case 11:return jP(n.mapValue);default:throw K(13486,{value:n})}}function jP(n){let e=0;return vs(n.fields,(t,r)=>{e+=t.length+Yc(r)}),e}function KP(n){return(n.values||[]).reduce((e,t)=>e+Yc(t),0)}function zp(n){return!!n&&"integerValue"in n}function HP(n){return!!n&&"doubleValue"in n}function WP(n){return zp(n)||HP(n)}function gg(n){return!!n&&"arrayValue"in n}function hE(n){return!!n&&"nullValue"in n}function fE(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function wp(n){return!!n&&"mapValue"in n}function uw(n){return(n?.mapValue?.fields||{})[fg]?.stringValue===pg}function Da(n){if(n.geoPointValue)return{geoPointValue:{...n.geoPointValue}};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:{...n.timestampValue}};if(n.mapValue){let e={mapValue:{fields:{}}};return vs(n.mapValue.fields,(t,r)=>e.mapValue.fields[t]=Da(r)),e}else if(n.arrayValue){let e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Da(n.arrayValue.values[t]);return e}else return{...n}}function dw(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===lw}var KU={mapValue:{fields:{[fg]:{stringValue:pg},[rs]:{arrayValue:{}}}}};var On=class n{constructor(e){this.value=e}static empty(){return new n({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!wp(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){let r=this.getFieldsMap(e.popLast());r[e.lastSegment()]=Da(t)}setAll(e){let t=xt.emptyPath(),r={},i=[];e.forEach((a,o)=>{if(!t.isImmediateParentOf(o)){let l=this.getFieldsMap(t);this.applyChanges(l,r,i),r={},i=[],t=o.popLast()}a?r[o.lastSegment()]=Da(a):i.push(o.lastSegment())});let s=this.getFieldsMap(t);this.applyChanges(s,r,i)}delete(e){let t=this.field(e.popLast());wp(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Ut(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=t.mapValue.fields[e.get(r)];(!wp(i)||!i.mapValue.fields)&&(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,r){vs(t,(i,s)=>e[i]=s);for(let i of r)delete e[i]}clone(){return new n(Da(this.value))}};var zt=class n{constructor(e,t,r,i,s,a,o){this.key=e,this.documentType=t,this.version=r,this.readTime=i,this.createTime=s,this.data=a,this.documentState=o}static newInvalidDocument(e){return new n(e,0,W.min(),W.min(),W.min(),On.empty(),0)}static newFoundDocument(e,t,r,i){return new n(e,1,t,W.min(),r,i,0)}static newNoDocument(e,t){return new n(e,2,t,W.min(),W.min(),On.empty(),0)}static newUnknownDocument(e,t){return new n(e,3,t,W.min(),W.min(),On.empty(),2)}convertToFoundDocument(e,t){return this.createTime.isEqual(W.min())&&(this.documentType===2||this.documentType===0)&&(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=On.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=On.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=W.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof n&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new n(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}};function QP(n,e,t){let r=e.data.field(n),i=t.data.field(n);return r!==null&&i!==null?is(r,i):K(42886)}var as=class{constructor(e,t){this.position=e,this.inclusive=t}};function hw(n,e,t){let r=0;for(let i=0;i<n.position.length;i++){let s=e[i],a=n.position[i];if(s.field.isKeyField())r=$.comparator($.fromName(a.referenceValue),t.key);else{let o=t.data.field(s.field);r=is(a,o)}if(s.dir==="desc"&&(r=r*-1),r!==0)break}return r}function YP(n,e,t){let r=hw(n,e,t);return n.inclusive?r>=0:r>0}function JP(n,e,t){let r=hw(n,e,t);return n.inclusive?r<=0:r<0}function pE(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++){let r=n.position[t],i=e.position[t];if(!Ut(r,i))return!1}return!0}var os=class{constructor(e,t="asc"){this.field=e,this.dir=t}};function ZP(n){return n.field.canonicalString()+n.dir}function XP(n){return`${n.field.canonicalString()} (${n.dir})`}function eL(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}var Cc=class{},Oe=class n extends Cc{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new $p(e,t,r):t==="array-contains"?new Hp(e,r):t==="in"?new Wp(e,r):t==="not-in"?new Qp(e,r):t==="array-contains-any"?new Yp(e,r):new n(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new jp(e,r):new Kp(e,r)}matches(e){let t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(is(t,this.value)):t!==null&&gr(this.value)===gr(t)&&this.matchesComparison(is(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return K(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}},pn=class n extends Cc{constructor(e,t){super(),this.filters=e,this.op=t,this.memoizedFlattenedFilters=null}static create(e,t){return new n(e,t)}matches(e){return fw(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.memoizedFlattenedFilters!==null?this.memoizedFlattenedFilters:(this.memoizedFlattenedFilters=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[]),this.memoizedFlattenedFilters)}getFilters(){return Object.assign([],this.filters)}};function fw(n){return n.op==="and"}function pw(n){return tL(n)&&fw(n)}function tL(n){for(let e of n.filters)if(e instanceof pn)return!1;return!0}function Gp(n){if(n instanceof Oe)return n.field.canonicalString()+n.op.toString()+ss(n.value);if(pw(n))return n.filters.map(e=>Gp(e)).join(",");{let e=n.filters.map(t=>Gp(t)).join(",");return`${n.op}(${e})`}}function mw(n,e){if(n instanceof Oe)return nL(n,e);if(n instanceof pn)return rL(n,e);K(19439)}function nL(n,e){return e instanceof Oe&&n.op===e.op&&n.field.isEqual(e.field)&&Ut(n.value,e.value)}function rL(n,e){return e instanceof pn&&n.op===e.op&&n.filters.length===e.filters.length?n.filters.reduce((r,i,s)=>r&&mw(i,e.filters[s]),!0):!1}function gw(n){return n instanceof Oe?sL(n):n instanceof pn?iL(n):"Filter"}function iL(n){return n.op.toString()+" {"+n.getFilters().map(gw).join(" ,")+"}"}function sL(n){return`${n.field.canonicalString()} ${n.op} ${ss(n.value)}`}var $p=class extends Oe{constructor(e,t,r){super(e,t,r),this.key=$.fromName(r.referenceValue)}matches(e){let t=$.comparator(e.key,this.key);return this.matchesComparison(t)}},jp=class extends Oe{constructor(e,t){super(e,"in",t),this.keys=yw("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}},Kp=class extends Oe{constructor(e,t){super(e,"not-in",t),this.keys=yw("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}};function yw(n,e){return(e.arrayValue?.values||[]).map(t=>$.fromName(t.referenceValue))}var Hp=class extends Oe{constructor(e,t){super(e,"array-contains",t)}matches(e){let t=e.data.field(this.field);return gg(t)&&Pa(t.arrayValue,this.value)}},Wp=class extends Oe{constructor(e,t){super(e,"in",t)}matches(e){let t=e.data.field(this.field);return t!==null&&Pa(this.value.arrayValue,t)}},Qp=class extends Oe{constructor(e,t){super(e,"not-in",t)}matches(e){if(Pa(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!Pa(this.value.arrayValue,t)}},Yp=class extends Oe{constructor(e,t){super(e,"array-contains-any",t)}matches(e){let t=e.data.field(this.field);return!gg(t)||!t.arrayValue.values?!1:t.arrayValue.values.some(r=>Pa(this.value.arrayValue,r))}};var Jp=class{constructor(e,t=null,r=[],i=[],s=null,a=null,o=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=a,this.endAt=o,this.memoizedCanonicalId=null}};function mE(n,e=null,t=[],r=[],i=null,s=null,a=null){return new Jp(n,e,t,r,i,s,a)}function yg(n){let e=re(n);if(e.memoizedCanonicalId===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(r=>Gp(r)).join(","),t+="|ob:",t+=e.orderBy.map(r=>ZP(r)).join(","),Qc(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(r=>ss(r)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(r=>ss(r)).join(",")),e.memoizedCanonicalId=t}return e.memoizedCanonicalId}function aL(n){let e=n.path.canonicalString();return n.collectionGroup!==null&&(e+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(e+=`, filters: [${n.filters.map(t=>gw(t)).join(", ")}]`),Qc(n.limit)||(e+=", limit: "+n.limit),n.orderBy.length>0&&(e+=`, orderBy: [${n.orderBy.map(t=>XP(t)).join(", ")}]`),n.startAt&&(e+=", startAt: ",e+=n.startAt.inclusive?"b:":"a:",e+=n.startAt.position.map(t=>ss(t)).join(",")),n.endAt&&(e+=", endAt: ",e+=n.endAt.inclusive?"a:":"b:",e+=n.endAt.position.map(t=>ss(t)).join(",")),`Target(${e})`}function _g(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!eL(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!mw(n.filters[t],e.filters[t]))return!1;return n.collectionGroup!==e.collectionGroup||!n.path.isEqual(e.path)||!pE(n.startAt,e.startAt)?!1:pE(n.endAt,e.endAt)}function Zp(n){return $.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}var ls=class{constructor(e,t=null,r=[],i=[],s=null,a="F",o=null,l=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=a,this.startAt=o,this.endAt=l,this.memoizedNormalizedOrderBy=null,this.memoizedTarget=null,this.memoizedAggregateTarget=null,this.startAt,this.endAt}};function oL(n,e,t,r,i,s,a,o){return new ls(n,e,t,r,i,s,a,o)}function vg(n){return new ls(n)}function lL(n,e){return new ls(e,null,n.explicitOrderBy.slice(),n.filters.slice(),n.limit,n.limitType,n.startAt,n.endAt)}function gE(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function cL(n){let e=new Ue(xt.comparator);return n.filters.forEach(t=>{t.getFlattenedFilters().forEach(i=>{i.isInequality()&&(e=e.add(i.field))})}),e}function uL(n){return $.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function dL(n){return n.collectionGroup!==null}function La(n){let e=re(n);if(e.memoizedNormalizedOrderBy===null){e.memoizedNormalizedOrderBy=[];let t=new Set;for(let s of e.explicitOrderBy)e.memoizedNormalizedOrderBy.push(s),t.add(s.field.canonicalString());let r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";cL(e).forEach(s=>{!t.has(s.canonicalString())&&!s.isKeyField()&&e.memoizedNormalizedOrderBy.push(new os(s,r))}),t.has(xt.keyField().canonicalString())||e.memoizedNormalizedOrderBy.push(new os(xt.keyField(),r))}return e.memoizedNormalizedOrderBy}function qt(n){let e=re(n);return e.memoizedTarget||(e.memoizedTarget=hL(e,La(n))),e.memoizedTarget}function hL(n,e){if(n.limitType==="F")return mE(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(i=>{let s=i.dir==="desc"?"asc":"desc";return new os(i.field,s)});let t=n.endAt?new as(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new as(n.startAt.position,n.startAt.inclusive):null;return mE(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function Xp(n,e,t){return new ls(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function Jc(n,e){return _g(qt(n),qt(e))&&n.limitType===e.limitType}function _w(n){return`${yg(qt(n))}|lt:${n.limitType}`}function Wi(n){return`Query(target=${aL(qt(n))}; limitType=${n.limitType})`}function Zc(n,e){return e.isFoundDocument()&&fL(n,e)&&pL(n,e)&&mL(n,e)&&gL(n,e)}function fL(n,e){let t=e.key.path;return n.collectionGroup!==null?e.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(t):$.isDocumentKey(n.path)?n.path.isEqual(t):n.path.isImmediateParentOf(t)}function pL(n,e){for(let t of La(n))if(!t.field.isKeyField()&&e.data.field(t.field)===null)return!1;return!0}function mL(n,e){for(let t of n.filters)if(!t.matches(e))return!1;return!0}function gL(n,e){return!(n.startAt&&!JP(n.startAt,La(n),e)||n.endAt&&!YP(n.endAt,La(n),e))}function yL(n){return n.collectionGroup||(n.path.length%2===1?n.path.lastSegment():n.path.get(n.path.length-2))}function vw(n){return(e,t)=>{let r=!1;for(let i of La(n)){let s=_L(i,e,t);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function _L(n,e,t){let r=n.field.isKeyField()?$.comparator(e.key,t.key):QP(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return K(19790,{direction:n.dir})}}var Pn=class{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(let[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,t){let r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0){this.inner[r]=[[e,t]],this.innerSize++;return}for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e)){i[s]=[e,t];return}i.push([e,t]),this.innerSize++}delete(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[t]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){vs(this.inner,(t,r)=>{for(let[i,s]of r)e(i,s)})}isEmpty(){return rw(this.inner)}size(){return this.innerSize}};var vL=new Ie($.comparator);function yr(){return vL}var bw=new Ie($.comparator);function Ra(...n){let e=bw;for(let t of n)e=e.insert(t.key,t);return e}function bL(){return Fa()}function SL(n){let e=bw;return n.forEach((t,r)=>e=e.insert(t,r.overlayedDocument)),e}function $r(){return Fa()}function Sw(){return Fa()}function Fa(){return new Pn(n=>n.toString(),(n,e)=>n.isEqual(e))}var HU=new Ie($.comparator);var EL=new Ue($.comparator);function se(...n){let e=EL;for(let t of n)e=e.add(t);return e}var wL=new Ue(ee);function TL(){return wL}function bg(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Ma(e)?"-0":e}}function Ew(n){return{integerValue:""+n}}function CL(n,e){return AP(e)?Ew(e):bg(n,e)}var cs=class{constructor(){this._=void 0}};function IL(n,e,t){return n instanceof Ba?TP(t,e):n instanceof us?ww(n,e):n instanceof ds?Tw(n,e):xL(n,e)}function AL(n,e,t){return n instanceof us?ww(n,e):n instanceof ds?Tw(n,e):t}function RL(n,e){return n instanceof Ua?WP(e)?e:{integerValue:0}:null}function DL(n,e){return n instanceof us&&e instanceof us||n instanceof ds&&e instanceof ds?Wr(n.elements,e.elements,Ut):n instanceof Ua&&e instanceof Ua?Ut(n.operand,e.operand):n instanceof Ba&&e instanceof Ba}var Ba=class extends cs{},us=class extends cs{constructor(e){super(),this.elements=e}};function ww(n,e){let t=Cw(e);for(let r of n.elements)t.some(i=>Ut(i,r))||t.push(r);return{arrayValue:{values:t}}}var ds=class extends cs{constructor(e){super(),this.elements=e}};function Tw(n,e){let t=Cw(e);for(let r of n.elements)t=t.filter(i=>!Ut(i,r));return{arrayValue:{values:t}}}var Ua=class extends cs{constructor(e,t){super(),this.serializer=e,this.operand=t}};function xL(n,e){let t=RL(n,e),r=yE(t)+yE(n.operand);return zp(t)&&zp(n.operand)?Ew(r):bg(n.serializer,r)}function yE(n){return ye(n.integerValue||n.doubleValue)}function Cw(n){return gg(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}function NL(n,e){return n.field.isEqual(e.field)&&DL(n.transform,e.transform)}function OL(n,e){return n===void 0&&e===void 0?!0:n&&e?Wr(n,e,(t,r)=>NL(t,r)):!1}var xa=class n{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new n}static exists(e){return new n(void 0,e)}static updateTime(e){return new n(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}};function Xc(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists!==void 0?n.exists===e.isFoundDocument():!0}var qa=class{};function Iw(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new em(n.key,xa.none()):new Va(n.key,n.data,xa.none());{let t=n.data,r=On.empty(),i=new Ue(xt.comparator);for(let s of e.fields)if(!i.has(s)){let a=t.field(s);a===null&&s.length>1&&(s=s.popLast(),a=t.field(s)),a===null?r.delete(s):r.set(s,a),i=i.add(s)}return new hs(n.key,r,new Gr(i.toArray()),xa.none())}}function kL(n,e,t){n instanceof Va?ML(n,e,t):n instanceof hs?LL(n,e,t):BL(n,e,t)}function Na(n,e,t,r){return n instanceof Va?PL(n,e,t,r):n instanceof hs?FL(n,e,t,r):UL(n,e,t)}function _E(n,e){return n.type!==e.type||!n.key.isEqual(e.key)||!n.precondition.isEqual(e.precondition)||!OL(n.fieldTransforms,e.fieldTransforms)?!1:n.type===0?n.value.isEqual(e.value):n.type===1?n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask):!0}var Va=class extends qa{constructor(e,t,r,i=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}};function ML(n,e,t){let r=n.value.clone(),i=Rw(n.fieldTransforms,e,t.transformResults);r.setAll(i),e.convertToFoundDocument(t.version,r).setHasCommittedMutations()}function PL(n,e,t,r){if(!Xc(n.precondition,e))return t;let i=n.value.clone(),s=Dw(n.fieldTransforms,r,e);return i.setAll(s),e.convertToFoundDocument(e.version,i).setHasLocalMutations(),null}var hs=class extends qa{constructor(e,t,r,i,s=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}};function LL(n,e,t){if(!Xc(n.precondition,e)){e.convertToUnknownDocument(t.version);return}let r=Rw(n.fieldTransforms,e,t.transformResults),i=e.data;i.setAll(Aw(n)),i.setAll(r),e.convertToFoundDocument(t.version,i).setHasCommittedMutations()}function FL(n,e,t,r){if(!Xc(n.precondition,e))return t;let i=Dw(n.fieldTransforms,r,e),s=e.data;return s.setAll(Aw(n)),s.setAll(i),e.convertToFoundDocument(e.version,s).setHasLocalMutations(),t===null?null:t.unionWith(n.fieldMask.fields).unionWith(n.fieldTransforms.map(a=>a.field))}function Aw(n){let e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){let r=n.data.field(t);e.set(t,r)}}),e}function Rw(n,e,t){let r=new Map;_e(n.length===t.length,32656,{serverTransformResultCount:t.length,fieldTransformCount:n.length});for(let i=0;i<t.length;i++){let s=n[i],a=s.transform,o=e.data.field(s.field);r.set(s.field,AL(a,o,t[i]))}return r}function Dw(n,e,t){let r=new Map;for(let i of n){let s=i.transform,a=t.data.field(i.field);r.set(i.field,IL(s,a,e))}return r}var em=class extends qa{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}};function BL(n,e,t){e.convertToNoDocument(t.version).setHasCommittedMutations()}function UL(n,e,t){return Xc(n.precondition,e)?(e.convertToNoDocument(e.version).setHasLocalMutations(),null):t}var tm=class{constructor(e,t,r,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,t){let r=t.mutationResults;for(let i=0;i<this.mutations.length;i++){let s=this.mutations[i];if(s.key.isEqual(e.key)){let a=r[i];kL(s,e,a)}}}applyToLocalView(e,t){for(let r of this.baseMutations)r.key.isEqual(e.key)&&(t=Na(r,e,t,this.localWriteTime));for(let r of this.mutations)r.key.isEqual(e.key)&&(t=Na(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){let r=Sw();return this.mutations.forEach(i=>{let s=e.get(i.key),a=s.overlayedDocument,o=this.applyToLocalView(a,s.mutatedFields);o=t.has(i.key)?null:o;let l=Iw(a,o);l!==null&&r.set(i.key,l),a.isValidDocument()||a.convertToNoDocument(W.min())}),r}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),se())}isEqual(e){return this.batchId===e.batchId&&Wr(this.mutations,e.mutations,(t,r)=>_E(t,r))&&Wr(this.baseMutations,e.baseMutations,(t,r)=>_E(t,r))}};var nm=class{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}};var rm=class{constructor(e,t){this.count=e,this.unchangedNames=t}};var Ne;(function(n){n[n.OK=0]="OK",n[n.CANCELLED=1]="CANCELLED",n[n.UNKNOWN=2]="UNKNOWN",n[n.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",n[n.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",n[n.NOT_FOUND=5]="NOT_FOUND",n[n.ALREADY_EXISTS=6]="ALREADY_EXISTS",n[n.PERMISSION_DENIED=7]="PERMISSION_DENIED",n[n.UNAUTHENTICATED=16]="UNAUTHENTICATED",n[n.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",n[n.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",n[n.ABORTED=10]="ABORTED",n[n.OUT_OF_RANGE=11]="OUT_OF_RANGE",n[n.UNIMPLEMENTED=12]="UNIMPLEMENTED",n[n.INTERNAL=13]="INTERNAL",n[n.UNAVAILABLE=14]="UNAVAILABLE",n[n.DATA_LOSS=15]="DATA_LOSS"})(Ne||(Ne={}));function vc(n){if(n===void 0)return Vt("GRPC error has no .code"),F.UNKNOWN;switch(n){case Ne.OK:return F.OK;case Ne.CANCELLED:return F.CANCELLED;case Ne.UNKNOWN:return F.UNKNOWN;case Ne.DEADLINE_EXCEEDED:return F.DEADLINE_EXCEEDED;case Ne.RESOURCE_EXHAUSTED:return F.RESOURCE_EXHAUSTED;case Ne.INTERNAL:return F.INTERNAL;case Ne.UNAVAILABLE:return F.UNAVAILABLE;case Ne.UNAUTHENTICATED:return F.UNAUTHENTICATED;case Ne.INVALID_ARGUMENT:return F.INVALID_ARGUMENT;case Ne.NOT_FOUND:return F.NOT_FOUND;case Ne.ALREADY_EXISTS:return F.ALREADY_EXISTS;case Ne.PERMISSION_DENIED:return F.PERMISSION_DENIED;case Ne.FAILED_PRECONDITION:return F.FAILED_PRECONDITION;case Ne.ABORTED:return F.ABORTED;case Ne.OUT_OF_RANGE:return F.OUT_OF_RANGE;case Ne.UNIMPLEMENTED:return F.UNIMPLEMENTED;case Ne.DATA_LOSS:return F.DATA_LOSS;default:return K(39323,{code:n})}}var im=class extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}};var qL=null;function xw(){return new Ya.TextEncoder}var VL=new En([4294967295,4294967295],0);function vE(n){let e=xw().encode(n),t=new td;return t.update(e),new Uint8Array(t.digest())}function bE(n){let e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0),a=new En([t,r],0),o=new En([i,s],0);return[a,o]}var sm=class n{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new jr(`Invalid padding: ${t}`);if(r<0)throw new jr(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new jr(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new jr(`Invalid padding when bitmap length is 0: ${t}`);this.bitCount=e.length*8-t,this.bitCountInInteger=En.fromNumber(this.bitCount)}getBitIndex(e,t,r){let i=e.add(t.multiply(En.fromNumber(r)));return i.compare(VL)===1&&(i=new En([i.getBits(0),i.getBits(1)],0)),i.modulo(this.bitCountInInteger).toNumber()}isBitSet(e){let t=this.bitmap[Math.floor(e/8)],r=e%8;return(t&1<<r)!==0}mightContain(e){if(this.bitCount===0)return!1;let t=vE(e),[r,i]=bE(t);for(let s=0;s<this.hashCount;s++){let a=this.getBitIndex(r,i,s);if(!this.isBitSet(a))return!1}return!0}static create(e,t,r){let i=e%8===0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),a=new n(s,i,t);return r.forEach(o=>a.insert(o)),a}insert(e){if(this.bitCount===0)return;let t=vE(e),[r,i]=bE(t);for(let s=0;s<this.hashCount;s++){let a=this.getBitIndex(r,i,s);this.setBit(a)}}setBit(e){let t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}},jr=class extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}};var Ic=class n{constructor(e,t,r,i,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t,r){let i=new Map;return i.set(e,za.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new n(W.min(),i,new Ie(ee),yr(),se())}},za=class n{constructor(e,t,r,i,s){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new n(r,t,se(),se(),se())}};var Xi=class{constructor(e,t,r,i){this.updatedTargetIds=e,this.removedTargetIds=t,this.key=r,this.newDoc=i}},Ac=class{constructor(e,t){this.targetId=e,this.existenceFilter=t}},Rc=class{constructor(e,t,r=Ye.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=i}},Dc=class{constructor(){this.pendingResponses=0,this.documentChanges=SE(),this._resumeToken=Ye.EMPTY_BYTE_STRING,this._current=!1,this._hasPendingChanges=!0}get current(){return this._current}get resumeToken(){return this._resumeToken}get isPending(){return this.pendingResponses!==0}get hasPendingChanges(){return this._hasPendingChanges}updateResumeToken(e){e.approximateByteSize()>0&&(this._hasPendingChanges=!0,this._resumeToken=e)}toTargetChange(){let e=se(),t=se(),r=se();return this.documentChanges.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:r=r.add(i);break;default:K(38017,{changeType:s})}}),new za(this._resumeToken,this._current,e,t,r)}clearPendingChanges(){this._hasPendingChanges=!1,this.documentChanges=SE()}addDocumentChange(e,t){this._hasPendingChanges=!0,this.documentChanges=this.documentChanges.insert(e,t)}removeDocumentChange(e){this._hasPendingChanges=!0,this.documentChanges=this.documentChanges.remove(e)}recordPendingTargetRequest(){this.pendingResponses+=1}recordTargetResponse(){this.pendingResponses-=1,_e(this.pendingResponses>=0,3241,{pendingResponses:this.pendingResponses})}markCurrent(){this._hasPendingChanges=!0,this._current=!0}},zL="WatchChangeAggregator",am=class{constructor(e){this.metadataProvider=e,this.targetStates=new Map,this.pendingDocumentUpdates=yr(),this.pendingDocumentUpdatesByTarget=gc(),this.pendingDocumentTargetMapping=gc(),this.pendingTargetResets=new Ie(ee)}handleDocumentChange(e){for(let t of e.updatedTargetIds)e.newDoc&&e.newDoc.isFoundDocument()?this.addDocumentToTarget(t,e.newDoc):this.removeDocumentFromTarget(t,e.key,e.newDoc);for(let t of e.removedTargetIds)this.removeDocumentFromTarget(t,e.key,e.newDoc)}handleTargetChange(e){this.forEachTarget(e,t=>{let r=this.ensureTargetState(t);switch(e.state){case 0:this.isActiveTarget(t)&&r.updateResumeToken(e.resumeToken);break;case 1:r.recordTargetResponse(),r.isPending||r.clearPendingChanges(),r.updateResumeToken(e.resumeToken);break;case 2:r.recordTargetResponse(),r.isPending||this.removeTarget(t);break;case 3:this.isActiveTarget(t)&&(r.markCurrent(),r.updateResumeToken(e.resumeToken));break;case 4:this.isActiveTarget(t)&&(this.resetTarget(t),r.updateResumeToken(e.resumeToken));break;default:K(56790,{state:e.state})}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.targetStates.forEach((r,i)=>{this.isActiveTarget(i)&&t(i)})}handleExistenceFilter(e){let t=e.targetId,r=e.existenceFilter.count,i=this.targetDataForActiveTarget(t);if(i){let s=i.target;if(Zp(s))if(r===0){let a=new $(s.path);this.removeDocumentFromTarget(t,a,zt.newNoDocument(a,W.min()))}else _e(r===1,20013,{expectedCount:r});else{let a=this.getCurrentDocumentCountForTarget(t);if(a!==r){let o=this.parseBloomFilter(e),l=o?this.applyBloomFilter(o,e,a):1;if(l!==0){this.resetTarget(t);let c=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.pendingTargetResets=this.pendingTargetResets.insert(t,c)}qL?.notifyOnExistenceFilterMismatch(GL(a,e.existenceFilter,this.metadataProvider.getDatabaseId(),o,l))}}}}parseBloomFilter(e){let t=e.existenceFilter.unchangedNames;if(!t||!t.bits)return null;let{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=t,a;try{a=Mn(r).toUint8Array()}catch(l){if(l instanceof im)return Zi("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}let o;try{o=new sm(a,i,s)}catch(l){return l instanceof jr?Zi("BloomFilter error: ",l):Zi("Applying bloom filter failed: ",l),null}return o.bitCount===0?null:o}applyBloomFilter(e,t,r){let i=t.existenceFilter.count,s=this.filterRemovedDocuments(e,t.targetId);return i===r-s?0:2}filterRemovedDocuments(e,t){let r=this.metadataProvider.getRemoteKeysForTarget(t),i=0;return r.forEach(s=>{let a=this.metadataProvider.getDatabaseId(),o=`projects/${a.projectId}/databases/${a.database}/documents/${s.path.canonicalString()}`;e.mightContain(o)||(this.removeDocumentFromTarget(t,s,null),i++)}),i}createRemoteEvent(e){let t=new Map;this.targetStates.forEach((s,a)=>{let o=this.targetDataForActiveTarget(a);if(o){if(s.current&&Zp(o.target)){let l=new $(o.target.path);!this.ensureDocumentUpdateByTarget(l).has(a)&&!this.targetContainsDocument(a,l)&&this.removeDocumentFromTarget(a,l,zt.newNoDocument(l,e))}s.hasPendingChanges&&(t.set(a,s.toTargetChange()),s.clearPendingChanges())}});let r=se();this.pendingDocumentTargetMapping.forEach((s,a)=>{let o=!0;a.forEachWhile(l=>{let c=this.targetDataForActiveTarget(l);return c&&c.purpose!=="TargetPurposeLimboResolution"?(o=!1,!1):!0}),o&&(r=r.add(s))}),this.pendingDocumentUpdates.forEach((s,a)=>a.setReadTime(e));let i=new Ic(e,t,this.pendingTargetResets,this.pendingDocumentUpdates,r);return this.pendingDocumentUpdates=yr(),this.pendingDocumentUpdatesByTarget=gc(),this.pendingDocumentTargetMapping=gc(),this.pendingTargetResets=new Ie(ee),i}addDocumentToTarget(e,t){if(!this.isActiveTarget(e))return;let r=this.targetContainsDocument(e,t.key)?2:0;this.ensureTargetState(e).addDocumentChange(t.key,r),this.pendingDocumentUpdates=this.pendingDocumentUpdates.insert(t.key,t),this.pendingDocumentUpdatesByTarget=this.pendingDocumentUpdatesByTarget.insert(t.key,this.ensureDocumentUpdateByTarget(t.key).add(e)),this.pendingDocumentTargetMapping=this.pendingDocumentTargetMapping.insert(t.key,this.ensureDocumentTargetMapping(t.key).add(e))}removeDocumentFromTarget(e,t,r){if(!this.isActiveTarget(e))return;let i=this.ensureTargetState(e);this.targetContainsDocument(e,t)?i.addDocumentChange(t,1):i.removeDocumentChange(t),this.pendingDocumentTargetMapping=this.pendingDocumentTargetMapping.insert(t,this.ensureDocumentTargetMapping(t).delete(e)),this.pendingDocumentTargetMapping=this.pendingDocumentTargetMapping.insert(t,this.ensureDocumentTargetMapping(t).add(e)),r&&(this.pendingDocumentUpdates=this.pendingDocumentUpdates.insert(t,r))}removeTarget(e){this.targetStates.delete(e)}getCurrentDocumentCountForTarget(e){let r=this.ensureTargetState(e).toTargetChange();return this.metadataProvider.getRemoteKeysForTarget(e).size+r.addedDocuments.size-r.removedDocuments.size}recordPendingTargetRequest(e){this.ensureTargetState(e).recordPendingTargetRequest()}ensureTargetState(e){let t=this.targetStates.get(e);return t||(t=new Dc,this.targetStates.set(e,t)),t}ensureDocumentTargetMapping(e){let t=this.pendingDocumentTargetMapping.get(e);return t||(t=new Ue(ee),this.pendingDocumentTargetMapping=this.pendingDocumentTargetMapping.insert(e,t)),t}ensureDocumentUpdateByTarget(e){let t=this.pendingDocumentUpdatesByTarget.get(e);return t||(t=new Ue(ee),this.pendingDocumentUpdatesByTarget=this.pendingDocumentUpdatesByTarget.insert(e,t)),t}isActiveTarget(e){let t=this.targetDataForActiveTarget(e)!==null;return t||V(zL,"Detected inactive target",e),t}targetDataForActiveTarget(e){let t=this.targetStates.get(e);return t&&t.isPending?null:this.metadataProvider.getTargetDataForTarget(e)}resetTarget(e){this.targetStates.set(e,new Dc),this.metadataProvider.getRemoteKeysForTarget(e).forEach(r=>{this.removeDocumentFromTarget(e,r,null)})}targetContainsDocument(e,t){return this.metadataProvider.getRemoteKeysForTarget(e).has(t)}};function gc(){return new Ie($.comparator)}function SE(){return new Ie($.comparator)}function GL(n,e,t,r,i){let s={localCacheCount:n,existenceFilterCount:e.count,databaseId:t.database,projectId:t.projectId},a=e.unchangedNames;return a&&(s.bloomFilter={applied:i===0,hashCount:a?.hashCount??0,bitmapLength:a?.bits?.bitmap?.length??0,padding:a?.bits?.padding??0,mightContain:o=>r?.mightContain(o)??!1}),s}var $L=(()=>{let n={};return n.asc="ASCENDING",n.desc="DESCENDING",n})(),jL=(()=>{let n={};return n["<"]="LESS_THAN",n["<="]="LESS_THAN_OR_EQUAL",n[">"]="GREATER_THAN",n[">="]="GREATER_THAN_OR_EQUAL",n["=="]="EQUAL",n["!="]="NOT_EQUAL",n["array-contains"]="ARRAY_CONTAINS",n.in="IN",n["not-in"]="NOT_IN",n["array-contains-any"]="ARRAY_CONTAINS_ANY",n})(),KL=(()=>{let n={};return n.and="AND",n.or="OR",n})();var xc=class{constructor(e,t){this.databaseId=e,this.useProto3Json=t}};function HL(n){let e=n.code===void 0?F.UNKNOWN:vc(n.code);return new G(e,n.message||"")}function om(n,e){return n.useProto3Json||Qc(e)?e:{value:e}}function WL(n){let e;return typeof n=="object"?e=n.value:e=n,Qc(e)?null:e}function mr(n,e){if(n.useProto3Json){let r=new Date(e.seconds*1e3).toISOString().replace(/\.\d*/,"").replace("Z",""),i=("000000000"+e.nanoseconds).slice(-9);return`${r}.${i}Z`}else return{seconds:""+e.seconds,nanos:e.nanoseconds}}function Nw(n){let e=kn(n);return new Ce(e.seconds,e.nanos)}function Ow(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function QL(n,e){return n.useProto3Json?(_e(e===void 0||typeof e=="string",58123),Ye.fromBase64String(e||"")):(_e(e===void 0||e instanceof Buffer||e instanceof Uint8Array,16193),Ye.fromUint8Array(e||new Uint8Array))}function es(n){return _e(!!n,49232),W.fromTimestamp(Nw(n))}function Sg(n,e){return lm(n,e).canonicalString()}function lm(n,e){let t=JL(n).child("documents");return e===void 0?t:t.child(e)}function kw(n){let e=Te.fromString(n);return _e(Uw(e),10190,{key:e.toString()}),e}function EE(n,e){return Sg(n.databaseId,e.path)}function Tp(n,e){let t=kw(e);if(t.get(1)!==n.databaseId.projectId)throw new G(F.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new G(F.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new $(Pw(t))}function Mw(n,e){return Sg(n.databaseId,e)}function YL(n){let e=kw(n);return e.length===4?Te.emptyPath():Pw(e)}function wE(n){return new Te(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function JL(n){return new Te(["projects",n.projectId,"databases",n.database])}function Pw(n){return _e(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function ZL(n,e){let t;if("targetChange"in e){e.targetChange;let r=XL(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=QL(n,e.targetChange.resumeToken),a=e.targetChange.cause,o=a&&HL(a);t=new Rc(r,i,s,o||null)}else if("documentChange"in e){e.documentChange;let r=e.documentChange;r.document,r.document.name,r.document.updateTime;let i=Tp(n,r.document.name),s=es(r.document.updateTime),a=r.document.createTime?es(r.document.createTime):W.min(),o=new On({mapValue:{fields:r.document.fields}}),l=zt.newFoundDocument(i,s,a,o),c=r.targetIds||[],u=r.removedTargetIds||[];t=new Xi(c,u,l.key,l)}else if("documentDelete"in e){e.documentDelete;let r=e.documentDelete;r.document;let i=Tp(n,r.document),s=r.readTime?es(r.readTime):W.min(),a=zt.newNoDocument(i,s),o=r.removedTargetIds||[];t=new Xi([],o,a.key,a)}else if("documentRemove"in e){e.documentRemove;let r=e.documentRemove;r.document;let i=Tp(n,r.document),s=r.removedTargetIds||[];t=new Xi([],s,i,null)}else if("filter"in e){e.filter;let r=e.filter;r.targetId;let{count:i=0,unchangedNames:s}=r,a=new rm(i,s),o=r.targetId;t=new Ac(o,a)}else return K(11601,{change:e});return t}function XL(n){return n==="NO_CHANGE"?0:n==="ADD"?1:n==="REMOVE"?2:n==="CURRENT"?3:n==="RESET"?4:K(39313,{state:n})}function eF(n){if(!("targetChange"in n))return W.min();let e=n.targetChange;return e.targetIds&&e.targetIds.length||!e.readTime?W.min():es(e.readTime)}function tF(n,e){return{documents:[Mw(n,e.path)]}}function Lw(n,e){let t={structuredQuery:{}},r=e.path,i;e.collectionGroup!==null?(i=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=Mw(n,i);let s=aF(e.filters);s&&(t.structuredQuery.where=s);let a=lF(e.orderBy);a&&(t.structuredQuery.orderBy=a);let o=om(n,e.limit);return o!==null&&(t.structuredQuery.limit=o),e.startAt&&(t.structuredQuery.startAt=uF(e.startAt)),e.endAt&&(t.structuredQuery.endAt=dF(e.endAt)),{queryTarget:t,parent:i}}function nF(n){let e=YL(n.parent),t=n.structuredQuery,r=t.from?t.from.length:0,i=null;if(r>0){_e(r===1,65062);let u=t.from[0];u.allDescendants?i=u.collectionId:e=e.child(u.collectionId)}let s=[];t.where&&(s=oF(t.where));let a=[];t.orderBy&&(a=cF(t.orderBy));let o=null;t.limit&&(o=WL(t.limit));let l=null;t.startAt&&(l=hF(t.startAt));let c=null;return t.endAt&&(c=fF(t.endAt)),oL(e,i,a,s,o,"F",l,c)}function rF(n,e){let t=iF(e.purpose);return t==null?null:{"goog-listen-tags":t}}function iF(n){switch(n){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return K(28987,{purpose:n})}}function sF(n,e){let t,r=e.target;if(Zp(r)?t={documents:tF(n,r)}:t={query:Lw(n,r).queryTarget},t.targetId=e.targetId,e.resumeToken.approximateByteSize()>0){t.resumeToken=Ow(n,e.resumeToken);let i=om(n,e.expectedCount);i!==null&&(t.expectedCount=i)}else if(e.snapshotVersion.compareTo(W.min())>0){t.readTime=mr(n,e.snapshotVersion.toTimestamp());let i=om(n,e.expectedCount);i!==null&&(t.expectedCount=i)}return t}function aF(n){if(n.length!==0)return Bw(pn.create(n,"and"))}function oF(n){let e=Fw(n);return e instanceof pn&&pw(e)?e.getFilters():[e]}function Fw(n){return n.unaryFilter!==void 0?TF(n):n.fieldFilter!==void 0?CF(n):n.compositeFilter!==void 0?IF(n):K(30097,{filter:n})}function lF(n){if(n.length!==0)return n.map(e=>bF(e))}function cF(n){return n.map(e=>SF(e))}function uF(n){return{before:n.inclusive,values:n.position}}function dF(n){return{before:!n.inclusive,values:n.position}}function hF(n){let e=!!n.before,t=n.values||[];return new as(t,e)}function fF(n){let e=!n.before,t=n.values||[];return new as(t,e)}function pF(n){return $L[n]}function mF(n){switch(n){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}function gF(n){return jL[n]}function yF(n){return KL[n]}function _F(n){switch(n){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return K(58110);default:return K(50506)}}function vF(n){switch(n){case"AND":return"and";case"OR":return"or";default:return K(1026)}}function Qi(n){return{fieldPath:n.canonicalString()}}function Ji(n){return xt.fromServerFormat(n.fieldPath)}function bF(n){return{field:Qi(n.field),direction:pF(n.dir)}}function SF(n){return new os(Ji(n.field),mF(n.direction))}function Bw(n){return n instanceof Oe?wF(n):n instanceof pn?EF(n):K(54877,{filter:n})}function EF(n){let e=n.getFilters().map(t=>Bw(t));return e.length===1?e[0]:{compositeFilter:{op:yF(n.op),filters:e}}}function wF(n){if(n.op==="=="){if(fE(n.value))return{unaryFilter:{field:Qi(n.field),op:"IS_NAN"}};if(hE(n.value))return{unaryFilter:{field:Qi(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(fE(n.value))return{unaryFilter:{field:Qi(n.field),op:"IS_NOT_NAN"}};if(hE(n.value))return{unaryFilter:{field:Qi(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Qi(n.field),op:gF(n.op),value:n.value}}}function TF(n){switch(n.unaryFilter.op){case"IS_NAN":let e=Ji(n.unaryFilter.field);return Oe.create(e,"==",{doubleValue:NaN});case"IS_NULL":let t=Ji(n.unaryFilter.field);return Oe.create(t,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let r=Ji(n.unaryFilter.field);return Oe.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let i=Ji(n.unaryFilter.field);return Oe.create(i,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return K(61313);default:return K(60726)}}function CF(n){return Oe.create(Ji(n.fieldFilter.field),_F(n.fieldFilter.op),n.fieldFilter.value)}function IF(n){return pn.create(n.compositeFilter.filters.map(e=>Fw(e)),vF(n.compositeFilter.op))}function Uw(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}var Ga=class n{constructor(e,t,r,i,s=W.min(),a=W.min(),o=Ye.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=o,this.expectedCount=l}withSequenceNumber(e){return new n(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}};var cm=class{constructor(e){this.remoteSerializer=e}};function AF(n){let e=nF({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?Xp(e,e.limit,"L"):e}function RF(n){return{name:n.name,query:AF(n.bundledQuery),readTime:es(n.readTime)}}function DF(n){return{id:n.id,version:n.version,createTime:es(n.createTime)}}var xF=5,NF=10,OF=13,Cp=15,kF=20,MF=25,PF=30,LF=37,FF=45,BF=50,UF=53,qF=55,VF=60,zF=2,Nc=class{constructor(){}writeIndexValue(e,t){this.writeIndexValueAux(e,t),t.writeInfinity()}writeIndexValueAux(e,t){if("nullValue"in e)this.writeValueTypeLabel(t,xF);else if("booleanValue"in e)this.writeValueTypeLabel(t,NF),t.writeNumber(e.booleanValue?1:0);else if("integerValue"in e)this.writeValueTypeLabel(t,Cp),t.writeNumber(ye(e.integerValue));else if("doubleValue"in e){let r=ye(e.doubleValue);isNaN(r)?this.writeValueTypeLabel(t,OF):(this.writeValueTypeLabel(t,Cp),Ma(r)?t.writeNumber(0):t.writeNumber(r))}else if("timestampValue"in e){let r=e.timestampValue;this.writeValueTypeLabel(t,kF),typeof r=="string"&&(r=kn(r)),t.writeString(`${r.seconds||""}`),t.writeNumber(r.nanos||0)}else if("stringValue"in e)this.writeIndexString(e.stringValue,t),this.writeTruncationMarker(t);else if("bytesValue"in e)this.writeValueTypeLabel(t,PF),t.writeBytes(Mn(e.bytesValue)),this.writeTruncationMarker(t);else if("referenceValue"in e)this.writeIndexEntityRef(e.referenceValue,t);else if("geoPointValue"in e){let r=e.geoPointValue;this.writeValueTypeLabel(t,FF),t.writeNumber(r.latitude||0),t.writeNumber(r.longitude||0)}else"mapValue"in e?dw(e)?this.writeValueTypeLabel(t,Number.MAX_SAFE_INTEGER):uw(e)?this.writeIndexVector(e.mapValue,t):(this.writeIndexMap(e.mapValue,t),this.writeTruncationMarker(t)):"arrayValue"in e?(this.writeIndexArray(e.arrayValue,t),this.writeTruncationMarker(t)):K(19022,{indexValue:e})}writeIndexString(e,t){this.writeValueTypeLabel(t,MF),this.writeUnlabeledIndexString(e,t)}writeUnlabeledIndexString(e,t){t.writeString(e)}writeIndexMap(e,t){let r=e.fields||{};this.writeValueTypeLabel(t,qF);for(let i of Object.keys(r))this.writeIndexString(i,t),this.writeIndexValueAux(r[i],t)}writeIndexVector(e,t){let r=e.fields||{};this.writeValueTypeLabel(t,UF);let i=rs,s=r[i].arrayValue?.values?.length||0;this.writeValueTypeLabel(t,Cp),t.writeNumber(ye(s)),this.writeIndexString(i,t),this.writeIndexValueAux(r[i],t)}writeIndexArray(e,t){let r=e.values||[];this.writeValueTypeLabel(t,BF);for(let i of r)this.writeIndexValueAux(i,t)}writeIndexEntityRef(e,t){this.writeValueTypeLabel(t,LF),$.fromName(e).path.forEach(i=>{this.writeValueTypeLabel(t,VF),this.writeUnlabeledIndexString(i,t)})}writeValueTypeLabel(e,t){e.writeNumber(t)}writeTruncationMarker(e){e.writeNumber(zF)}};Nc.INSTANCE=new Nc;var um=class{constructor(){this.collectionParentIndex=new dm}addToCollectionParentIndex(e,t){return this.collectionParentIndex.add(t),O.resolve()}getCollectionParents(e,t){return O.resolve(this.collectionParentIndex.getEntries(t))}addFieldIndex(e,t){return O.resolve()}deleteFieldIndex(e,t){return O.resolve()}deleteAllFieldIndexes(e){return O.resolve()}createTargetIndexes(e,t){return O.resolve()}getDocumentsMatchingTarget(e,t){return O.resolve(null)}getIndexType(e,t){return O.resolve(0)}getFieldIndexes(e,t){return O.resolve([])}getNextCollectionGroupToUpdate(e){return O.resolve(null)}getMinOffset(e,t){return O.resolve(Qr.min())}getMinOffsetFromCollectionGroup(e,t){return O.resolve(Qr.min())}updateCollectionGroup(e,t,r){return O.resolve()}updateIndexEntries(e,t){return O.resolve()}},dm=class{constructor(){this.index={}}add(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t]||new Ue(Te.comparator),s=!i.has(r);return this.index[t]=i.add(r),s}has(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t];return i&&i.has(r)}getEntries(e){return(this.index[e]||new Ue(Te.comparator)).toArray()}};var WU=new Uint8Array(0);var Ip=2,$a=class n{constructor(e){this.lastId=e}next(){return this.lastId+=Ip,this.lastId}static forTargetCache(){return new n(2-Ip)}static forSyncEngine(){return new n(1-Ip)}};var TE={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},eu=-1,qw=40*1024*1024,Dt=class n{static withCacheSize(e){return new n(e,n.DEFAULT_COLLECTION_PERCENTILE,n.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}};Dt.DEFAULT_COLLECTION_PERCENTILE=10;Dt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3;Dt.DEFAULT=new Dt(qw,Dt.DEFAULT_COLLECTION_PERCENTILE,Dt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT);Dt.DISABLED=new Dt(eu,0,0);var CE="LruGarbageCollector",IE=1*1024*1024,GF=60*1e3,$F=300*1e3;function AE([n,e],[t,r]){let i=ee(n,t);return i===0?ee(e,r):i}var hm=class{constructor(e){this.maxElements=e,this.buffer=new Ue(AE),this.previousIndex=0}nextIndex(){return++this.previousIndex}addElement(e){let t=[e,this.nextIndex()];if(this.buffer.size<this.maxElements)this.buffer=this.buffer.add(t);else{let r=this.buffer.last();AE(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}},fm=class{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.gcTask=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==eu&&this.scheduleGC(GF)}stop(){this.gcTask&&(this.gcTask.cancel(),this.gcTask=null)}get started(){return this.gcTask!==null}scheduleGC(e){V(CE,`Garbage collection scheduled in ${e}ms`),this.gcTask=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.gcTask=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){_s(t)?V(CE,"Ignoring IndexedDB error during garbage collection: ",t):await Hc(t)}await this.scheduleGC($F)})}},pm=class{constructor(e,t){this.delegate=e,this.params=t}calculateTargetCount(e,t){return this.delegate.getSequenceNumberCount(e).next(r=>Math.floor(t/100*r))}nthSequenceNumber(e,t){if(t===0)return O.resolve(ns.INVALID);let r=new hm(t);return this.delegate.forEachTarget(e,i=>r.addElement(i.sequenceNumber)).next(()=>this.delegate.forEachOrphanedDocumentSequenceNumber(e,i=>r.addElement(i))).next(()=>r.maxValue)}removeTargets(e,t,r){return this.delegate.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.delegate.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===eu?(V("LruGarbageCollector","Garbage collection skipped; disabled"),O.resolve(TE)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(V("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),TE):this.runGarbageCollection(e,t))}getCacheSize(e){return this.delegate.getCacheSize(e)}runGarbageCollection(e,t){let r,i,s,a,o,l,c,u=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(m=>(m>this.params.maximumSequenceNumbersToCollect?(V("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${m}`),i=this.params.maximumSequenceNumbersToCollect):i=m,a=Date.now(),this.nthSequenceNumber(e,i))).next(m=>(r=m,o=Date.now(),this.removeTargets(e,r,t))).next(m=>(s=m,l=Date.now(),this.removeOrphanedDocuments(e,r))).next(m=>{if(c=Date.now(),Hi()<=X.DEBUG){let d=`LRU Garbage Collection
	Counted targets in ${a-u}ms
	Determined least recently used ${i} in ${o-a}ms
	Removed ${s} targets in ${l-o}ms
	Removed ${m} documents in ${c-l}ms
Total Duration: ${c-u}ms`;V("LruGarbageCollector",d)}return O.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:m})})}};function jF(n,e){return new pm(n,e)}var mm=class{constructor(){this.changes=new Pn(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,zt.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();let r=this.changes.get(t);return r!==void 0?O.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}};var gm=class{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}};var ym=class{constructor(e,t,r,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,t))).next(i=>(r!==null&&Na(r.mutation,i,Gr.empty(),Ce.now()),i))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.getLocalViewOfDocuments(e,r,se()).next(()=>r))}getLocalViewOfDocuments(e,t,r=se()){let i=$r();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,r).next(s=>{let a=Ra();return s.forEach((o,l)=>{a=a.insert(o,l.overlayedDocument)}),a}))}getOverlayedDocuments(e,t){let r=$r();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,se()))}populateOverlays(e,t,r){let i=[];return r.forEach(s=>{t.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((a,o)=>{t.set(a,o)})})}computeViews(e,t,r,i){let s=yr(),a=Fa(),o=bL();return t.forEach((l,c)=>{let u=r.get(c.key);i.has(c.key)&&(u===void 0||u.mutation instanceof hs)?s=s.insert(c.key,c):u!==void 0?(a.set(c.key,u.mutation.getFieldMask()),Na(u.mutation,c,u.mutation.getFieldMask(),Ce.now())):a.set(c.key,Gr.empty())}),this.recalculateAndSaveOverlays(e,s).next(l=>(l.forEach((c,u)=>a.set(c,u)),t.forEach((c,u)=>o.set(c,new gm(u,a.get(c)??null))),o))}recalculateAndSaveOverlays(e,t){let r=Fa(),i=new Ie((a,o)=>a-o),s=se();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(a=>{for(let o of a)o.keys().forEach(l=>{let c=t.get(l);if(c===null)return;let u=r.get(l)||Gr.empty();u=o.applyToLocalView(c,u),r.set(l,u);let m=(i.get(o.batchId)||se()).add(l);i=i.insert(o.batchId,m)})}).next(()=>{let a=[],o=i.getReverseIterator();for(;o.hasNext();){let l=o.getNext(),c=l.key,u=l.value,m=Sw();u.forEach(d=>{if(!s.has(d)){let p=Iw(t.get(d),r.get(d));p!==null&&m.set(d,p),s=s.add(d)}}),a.push(this.documentOverlayCache.saveOverlays(e,c,m))}return O.waitFor(a)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,t,r,i){return uL(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):dL(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,i):this.getDocumentsMatchingCollectionQuery(e,t,r,i)}getNextDocuments(e,t,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,i).next(s=>{let a=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,i-s.size):O.resolve($r()),o=Oa,l=s;return a.next(c=>O.forEach(c,(u,m)=>(o<m.largestBatchId&&(o=m.largestBatchId),s.get(u)?O.resolve():this.remoteDocumentCache.getEntry(e,u).next(d=>{l=l.insert(u,d)}))).next(()=>this.populateOverlays(e,c,s)).next(()=>this.computeViews(e,l,c,se())).next(u=>({batchId:o,changes:SL(u)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new $(t)).next(r=>{let i=Ra();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,t,r,i){let s=t.collectionGroup,a=Ra();return this.indexManager.getCollectionParents(e,s).next(o=>O.forEach(o,l=>{let c=lL(t,l.child(s));return this.getDocumentsMatchingCollectionQuery(e,c,r,i).next(u=>{u.forEach((m,d)=>{a=a.insert(m,d)})})}).next(()=>a))}getDocumentsMatchingCollectionQuery(e,t,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next(a=>(s=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,s,i))).next(a=>{s.forEach((l,c)=>{let u=c.getKey();a.get(u)===null&&(a=a.insert(u,zt.newInvalidDocument(u)))});let o=Ra();return a.forEach((l,c)=>{let u=s.get(l);u!==void 0&&Na(u.mutation,c,Gr.empty(),Ce.now()),Zc(t,c)&&(o=o.insert(l,c))}),o})}};var _m=class{constructor(e){this.serializer=e,this.bundles=new Map,this.namedQueries=new Map}getBundleMetadata(e,t){return O.resolve(this.bundles.get(t))}saveBundleMetadata(e,t){return this.bundles.set(t.id,DF(t)),O.resolve()}getNamedQuery(e,t){return O.resolve(this.namedQueries.get(t))}saveNamedQuery(e,t){return this.namedQueries.set(t.name,RF(t)),O.resolve()}};var vm=class{constructor(){this.overlays=new Ie($.comparator),this.overlayByBatchId=new Map}getOverlay(e,t){return O.resolve(this.overlays.get(t))}getOverlays(e,t){let r=$r();return O.forEach(t,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,t,r){return r.forEach((i,s)=>{this.saveOverlay(e,t,s)}),O.resolve()}removeOverlaysForBatchId(e,t,r){let i=this.overlayByBatchId.get(r);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.overlayByBatchId.delete(r)),O.resolve()}getOverlaysForCollection(e,t,r){let i=$r(),s=t.length+1,a=new $(t.child("")),o=this.overlays.getIteratorFrom(a);for(;o.hasNext();){let c=o.getNext().value,u=c.getKey();if(!t.isPrefixOf(u.path))break;u.path.length===s&&c.largestBatchId>r&&i.set(c.getKey(),c)}return O.resolve(i)}getOverlaysForCollectionGroup(e,t,r,i){let s=new Ie((c,u)=>c-u),a=this.overlays.getIterator();for(;a.hasNext();){let u=a.getNext().value;if(u.getKey().getCollectionGroup()===t&&u.largestBatchId>r){let d=s.get(u.largestBatchId);d===null&&(d=$r(),s=s.insert(u.largestBatchId,d)),d.set(u.getKey(),u)}}let o=$r(),l=s.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((m,d)=>o.set(m,d)),!(o.size()>=i)););return O.resolve(o)}saveOverlay(e,t,r){let i=this.overlays.get(r.key);if(i!==null){let a=this.overlayByBatchId.get(i.largestBatchId).delete(r.key);this.overlayByBatchId.set(i.largestBatchId,a)}this.overlays=this.overlays.insert(r.key,new nm(t,r));let s=this.overlayByBatchId.get(t);s===void 0&&(s=se(),this.overlayByBatchId.set(t,s)),this.overlayByBatchId.set(t,s.add(r.key))}};var bm=class{constructor(){this.sessionToken=Ye.EMPTY_BYTE_STRING}getSessionToken(e){return O.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,O.resolve()}};var ja=class{constructor(){this.refsByKey=new Ue(Re.compareByKey),this.refsByTarget=new Ue(Re.compareByTargetId)}isEmpty(){return this.refsByKey.isEmpty()}addReference(e,t){let r=new Re(e,t);this.refsByKey=this.refsByKey.add(r),this.refsByTarget=this.refsByTarget.add(r)}addReferences(e,t){e.forEach(r=>this.addReference(r,t))}removeReference(e,t){this.removeRef(new Re(e,t))}removeReferences(e,t){e.forEach(r=>this.removeReference(r,t))}removeReferencesForId(e){let t=new $(new Te([])),r=new Re(t,e),i=new Re(t,e+1),s=[];return this.refsByTarget.forEachInRange([r,i],a=>{this.removeRef(a),s.push(a.key)}),s}removeAllReferences(){this.refsByKey.forEach(e=>this.removeRef(e))}removeRef(e){this.refsByKey=this.refsByKey.delete(e),this.refsByTarget=this.refsByTarget.delete(e)}referencesForId(e){let t=new $(new Te([])),r=new Re(t,e),i=new Re(t,e+1),s=se();return this.refsByTarget.forEachInRange([r,i],a=>{s=s.add(a.key)}),s}containsKey(e){let t=new Re(e,0),r=this.refsByKey.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}},Re=class{constructor(e,t){this.key=e,this.targetOrBatchId=t}static compareByKey(e,t){return $.comparator(e.key,t.key)||ee(e.targetOrBatchId,t.targetOrBatchId)}static compareByTargetId(e,t){return ee(e.targetOrBatchId,t.targetOrBatchId)||$.comparator(e.key,t.key)}};var Sm=class{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.nextBatchId=1,this.batchesByDocumentKey=new Ue(Re.compareByKey)}checkEmpty(e){return O.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,i){let s=this.nextBatchId;this.nextBatchId++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let a=new tm(s,t,r,i);this.mutationQueue.push(a);for(let o of i)this.batchesByDocumentKey=this.batchesByDocumentKey.add(new Re(o.key,s)),this.indexManager.addToCollectionParentIndex(e,o.key.path.popLast());return O.resolve(a)}lookupMutationBatch(e,t){return O.resolve(this.findMutationBatch(t))}getNextMutationBatchAfterBatchId(e,t){let r=t+1,i=this.indexOfBatchId(r),s=i<0?0:i;return O.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return O.resolve(this.mutationQueue.length===0?IP:this.nextBatchId-1)}getAllMutationBatches(e){return O.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){let r=new Re(t,0),i=new Re(t,Number.POSITIVE_INFINITY),s=[];return this.batchesByDocumentKey.forEachInRange([r,i],a=>{let o=this.findMutationBatch(a.targetOrBatchId);s.push(o)}),O.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Ue(ee);return t.forEach(i=>{let s=new Re(i,0),a=new Re(i,Number.POSITIVE_INFINITY);this.batchesByDocumentKey.forEachInRange([s,a],o=>{r=r.add(o.targetOrBatchId)})}),O.resolve(this.findMutationBatches(r))}getAllMutationBatchesAffectingQuery(e,t){let r=t.path,i=r.length+1,s=r;$.isDocumentKey(s)||(s=s.child(""));let a=new Re(new $(s),0),o=new Ue(ee);return this.batchesByDocumentKey.forEachWhile(l=>{let c=l.key.path;return r.isPrefixOf(c)?(c.length===i&&(o=o.add(l.targetOrBatchId)),!0):!1},a),O.resolve(this.findMutationBatches(o))}findMutationBatches(e){let t=[];return e.forEach(r=>{let i=this.findMutationBatch(r);i!==null&&t.push(i)}),t}removeMutationBatch(e,t){let r=this.indexOfExistingBatchId(t.batchId,"removed");_e(r===0,55003),this.mutationQueue.shift();let i=this.batchesByDocumentKey;return O.forEach(t.mutations,s=>{let a=new Re(s.key,t.batchId);return i=i.delete(a),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.batchesByDocumentKey=i})}removeCachedMutationKeys(e){}containsKey(e,t){let r=new Re(t,0),i=this.batchesByDocumentKey.firstAfterOrEqual(r);return O.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,O.resolve()}indexOfExistingBatchId(e,t){return this.indexOfBatchId(e)}indexOfBatchId(e){if(this.mutationQueue.length===0)return 0;let t=this.mutationQueue[0].batchId;return e-t}findMutationBatch(e){let t=this.indexOfBatchId(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}};var KF="-9223372036854775808";function HF(){return new Ie($.comparator)}var Em=class{constructor(e){this.sizer=e,this.docs=HF(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){let r=t.key,i=this.docs.get(r),s=i?i.size:0,a=this.sizer(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:a}),this.size+=a-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){let t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){let r=this.docs.get(t);return O.resolve(r?r.document.mutableCopy():zt.newInvalidDocument(t))}getEntries(e,t){let r=yr();return t.forEach(i=>{let s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():zt.newInvalidDocument(i))}),O.resolve(r)}getDocumentsMatchingQuery(e,t,r,i){let s=yr(),a=t.path,o=new $(a.child("__id"+KF+"__")),l=this.docs.getIteratorFrom(o);for(;l.hasNext();){let{key:c,value:{document:u}}=l.getNext();if(!a.isPrefixOf(c.path))break;c.path.length>a.length+1||YM(QM(u),r)<=0||!i.has(u.key)&&!Zc(t,u)||(s=s.insert(u.key,u.mutableCopy()))}return O.resolve(s)}getAllFromCollectionGroup(e,t,r,i){K(9500)}forEachDocumentKey(e,t){return O.forEach(this.docs,r=>t(r))}newChangeBuffer(e){return new wm(this)}getSize(e){return O.resolve(this.size)}};function WF(n){return new Em(n)}var wm=class extends mm{constructor(e){super(),this.documentCache=e}applyChanges(e){let t=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?t.push(this.documentCache.addEntry(e,i)):this.documentCache.removeEntry(r)}),O.waitFor(t)}getFromCache(e,t){return this.documentCache.getEntry(e,t)}getAllFromCache(e,t){return this.documentCache.getEntries(e,t)}};var Tm=class{constructor(e){this.persistence=e,this.targets=new Pn(t=>yg(t),_g),this.lastRemoteSnapshotVersion=W.min(),this.highestTargetId=0,this.highestSequenceNumber=0,this.references=new ja,this.targetCount=0,this.targetIdGenerator=$a.forTargetCache()}forEachTarget(e,t){return this.targets.forEach((r,i)=>t(i)),O.resolve()}getLastRemoteSnapshotVersion(e){return O.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return O.resolve(this.highestSequenceNumber)}allocateTargetId(e){return this.highestTargetId=this.targetIdGenerator.next(),O.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.highestSequenceNumber&&(this.highestSequenceNumber=t),O.resolve()}saveTargetData(e){this.targets.set(e.target,e);let t=e.targetId;t>this.highestTargetId&&(this.targetIdGenerator=new $a(t),this.highestTargetId=t),e.sequenceNumber>this.highestSequenceNumber&&(this.highestSequenceNumber=e.sequenceNumber)}addTargetData(e,t){return this.saveTargetData(t),this.targetCount+=1,O.resolve()}updateTargetData(e,t){return this.saveTargetData(t),O.resolve()}removeTargetData(e,t){return this.targets.delete(t.target),this.references.removeReferencesForId(t.targetId),this.targetCount-=1,O.resolve()}removeTargets(e,t,r){let i=0,s=[];return this.targets.forEach((a,o)=>{o.sequenceNumber<=t&&r.get(o.targetId)===null&&(this.targets.delete(a),s.push(this.removeMatchingKeysForTargetId(e,o.targetId)),i++)}),O.waitFor(s).next(()=>i)}getTargetCount(e){return O.resolve(this.targetCount)}getTargetData(e,t){let r=this.targets.get(t)||null;return O.resolve(r)}addMatchingKeys(e,t,r){return this.references.addReferences(t,r),O.resolve()}removeMatchingKeys(e,t,r){this.references.removeReferences(t,r);let i=this.persistence.referenceDelegate,s=[];return i&&t.forEach(a=>{s.push(i.markPotentiallyOrphaned(e,a))}),O.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this.references.removeReferencesForId(t),O.resolve()}getMatchingKeysForTargetId(e,t){let r=this.references.referencesForId(t);return O.resolve(r)}containsKey(e,t){return O.resolve(this.references.containsKey(t))}};var QF="MemoryPersistence",Oc=class{constructor(e,t){this.mutationQueues={},this.overlays={},this.listenSequence=new ns(0),this._started=!1,this._started=!0,this.globalsCache=new bm,this.referenceDelegate=e(this),this.targetCache=new Tm(this);let r=i=>this.referenceDelegate.documentSize(i);this.indexManager=new um,this.remoteDocumentCache=WF(r),this.serializer=new cm(t),this.bundleCache=new _m(this.serializer)}start(){return Promise.resolve()}shutdown(){return this._started=!1,Promise.resolve()}get started(){return this._started}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new vm,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.mutationQueues[e.toKey()];return r||(r=new Sm(t,this.referenceDelegate),this.mutationQueues[e.toKey()]=r),r}getGlobalsCache(){return this.globalsCache}getTargetCache(){return this.targetCache}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.bundleCache}runTransaction(e,t,r){V(QF,"Starting transaction:",e);let i=new Cm(this.listenSequence.next());return this.referenceDelegate.onTransactionStarted(),r(i).next(s=>this.referenceDelegate.onTransactionCommitted(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}mutationQueuesContainKey(e,t){return O.or(Object.values(this.mutationQueues).map(r=>()=>r.containsKey(e,t)))}},Cm=class extends Bp{constructor(e){super(),this.currentSequenceNumber=e}},Im=class n{constructor(e){this.persistence=e,this.localViewReferences=new ja,this._orphanedDocuments=null}static factory(e){return new n(e)}get orphanedDocuments(){if(this._orphanedDocuments)return this._orphanedDocuments;throw K(60996)}addReference(e,t,r){return this.localViewReferences.addReference(r,t),this.orphanedDocuments.delete(r.toString()),O.resolve()}removeReference(e,t,r){return this.localViewReferences.removeReference(r,t),this.orphanedDocuments.add(r.toString()),O.resolve()}markPotentiallyOrphaned(e,t){return this.orphanedDocuments.add(t.toString()),O.resolve()}removeTarget(e,t){this.localViewReferences.removeReferencesForId(t.targetId).forEach(s=>this.orphanedDocuments.add(s.toString()));let i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(e,t.targetId).next(s=>{s.forEach(a=>this.orphanedDocuments.add(a.toString()))}).next(()=>i.removeTargetData(e,t))}onTransactionStarted(){this._orphanedDocuments=new Set}onTransactionCommitted(e){let r=this.persistence.getRemoteDocumentCache().newChangeBuffer();return O.forEach(this.orphanedDocuments,i=>{let s=$.fromPath(i);return this.isReferenced(e,s).next(a=>{a||r.removeEntry(s,W.min())})}).next(()=>(this._orphanedDocuments=null,r.apply(e)))}updateLimboDocument(e,t){return this.isReferenced(e,t).next(r=>{r?this.orphanedDocuments.delete(t.toString()):this.orphanedDocuments.add(t.toString())})}documentSize(e){return 0}isReferenced(e,t){return O.or([()=>O.resolve(this.localViewReferences.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.mutationQueuesContainKey(e,t)])}},kc=class n{constructor(e,t){this.persistence=e,this.orphanedSequenceNumbers=new Pn(r=>nP(r.path),(r,i)=>r.isEqual(i)),this.garbageCollector=jF(this,t)}static factory(e,t){return new n(e,t)}onTransactionStarted(){}onTransactionCommitted(e){return O.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}getSequenceNumberCount(e){let t=this.orphanedDocumentCount(e);return this.persistence.getTargetCache().getTargetCount(e).next(i=>t.next(s=>i+s))}orphanedDocumentCount(e){let t=0;return this.forEachOrphanedDocumentSequenceNumber(e,r=>{t++}).next(()=>t)}forEachOrphanedDocumentSequenceNumber(e,t){return O.forEach(this.orphanedSequenceNumbers,(r,i)=>this.isPinned(e,r,i).next(s=>s?O.resolve():t(i)))}removeTargets(e,t,r){return this.persistence.getTargetCache().removeTargets(e,t,r)}removeOrphanedDocuments(e,t){let r=0,i=this.persistence.getRemoteDocumentCache(),s=i.newChangeBuffer();return i.forEachDocumentKey(e,o=>this.isPinned(e,o,t).next(l=>{l||(r++,s.removeEntry(o,W.min()))})).next(()=>s.apply(e)).next(()=>r)}markPotentiallyOrphaned(e,t){return this.orphanedSequenceNumbers.set(t,e.currentSequenceNumber),O.resolve()}removeTarget(e,t){let r=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,t,r){return this.orphanedSequenceNumbers.set(r,e.currentSequenceNumber),O.resolve()}removeReference(e,t,r){return this.orphanedSequenceNumbers.set(r,e.currentSequenceNumber),O.resolve()}updateLimboDocument(e,t){return this.orphanedSequenceNumbers.set(t,e.currentSequenceNumber),O.resolve()}documentSize(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=Yc(e.data.value)),t}isPinned(e,t,r){return O.or([()=>this.persistence.mutationQueuesContainKey(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{let i=this.orphanedSequenceNumbers.get(t);return O.resolve(i!==void 0&&i>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}};var QU=1800*1e3;function YF(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;++t)if(n[t]!==e[t])return!1;return!0}var Eg="LocalStore",JF=300*1e6,Am=class{constructor(e,t,r,i){this.persistence=e,this.queryEngine=t,this.serializer=i,this.targetDataByTarget=new Ie(ee),this.targetIdByTarget=new Pn(s=>yg(s),_g),this.collectionGroupReadTime=new Map,this.remoteDocuments=e.getRemoteDocumentCache(),this.targetCache=e.getTargetCache(),this.bundleCache=e.getBundleCache(),this.initializeUserComponents(r)}initializeUserComponents(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new ym(this.remoteDocuments,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.remoteDocuments.setIndexManager(this.indexManager),this.queryEngine.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.targetDataByTarget))}};function ZF(n,e,t,r){return new Am(n,e,t,r)}async function Vw(n,e){let t=re(n);return await t.persistence.runTransaction("Handle user change","readonly",i=>{let s;return t.mutationQueue.getAllMutationBatches(i).next(a=>(s=a,t.initializeUserComponents(e),t.mutationQueue.getAllMutationBatches(i))).next(a=>{let o=[],l=[],c=se();for(let u of s){o.push(u.batchId);for(let m of u.mutations)c=c.add(m.key)}for(let u of a){l.push(u.batchId);for(let m of u.mutations)c=c.add(m.key)}return t.localDocuments.getDocuments(i,c).next(u=>({affectedDocuments:u,removedBatchIds:o,addedBatchIds:l}))})})}function zw(n){let e=re(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.targetCache.getLastRemoteSnapshotVersion(t))}function XF(n,e){let t=re(n),r=e.snapshotVersion,i=t.targetDataByTarget;return t.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{let a=t.remoteDocuments.newChangeBuffer({trackRemovals:!0});i=t.targetDataByTarget;let o=[];e.targetChanges.forEach((u,m)=>{let d=i.get(m);if(!d)return;o.push(t.targetCache.removeMatchingKeys(s,u.removedDocuments,m).next(()=>t.targetCache.addMatchingKeys(s,u.addedDocuments,m)));let p=d.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(m)!==null?p=p.withResumeToken(Ye.EMPTY_BYTE_STRING,W.min()).withLastLimboFreeSnapshotVersion(W.min()):u.resumeToken.approximateByteSize()>0&&(p=p.withResumeToken(u.resumeToken,r)),i=i.insert(m,p),tB(d,p,u)&&o.push(t.targetCache.updateTargetData(s,p))});let l=yr(),c=se();if(e.documentUpdates.forEach(u=>{e.resolvedLimboDocuments.has(u)&&o.push(t.persistence.referenceDelegate.updateLimboDocument(s,u))}),o.push(eB(s,a,e.documentUpdates).next(u=>{l=u.changedDocuments,c=u.existenceChangedKeys})),!r.isEqual(W.min())){let u=t.targetCache.getLastRemoteSnapshotVersion(s).next(m=>t.targetCache.setTargetsMetadata(s,s.currentSequenceNumber,r));o.push(u)}return O.waitFor(o).next(()=>a.apply(s)).next(()=>t.localDocuments.getLocalViewOfDocuments(s,l,c)).next(()=>l)}).then(s=>(t.targetDataByTarget=i,s))}function eB(n,e,t){let r=se(),i=se();return t.forEach(s=>r=r.add(s)),e.getEntries(n,r).next(s=>{let a=yr();return t.forEach((o,l)=>{let c=s.get(o);l.isFoundDocument()!==c.isFoundDocument()&&(i=i.add(o)),l.isNoDocument()&&l.version.isEqual(W.min())?(e.removeEntry(o,l.readTime),a=a.insert(o,l)):!c.isValidDocument()||l.version.compareTo(c.version)>0||l.version.compareTo(c.version)===0&&c.hasPendingWrites?(e.addEntry(l),a=a.insert(o,l)):V(Eg,"Ignoring outdated watch update for ",o,". Current version:",c.version," Watch version:",l.version)}),{changedDocuments:a,existenceChangedKeys:i}})}function tB(n,e,t){return n.resumeToken.approximateByteSize()===0||e.snapshotVersion.toMicroseconds()-n.snapshotVersion.toMicroseconds()>=JF?!0:t.addedDocuments.size+t.modifiedDocuments.size+t.removedDocuments.size>0}async function nB(n,e){let t=re(n);try{await t.persistence.runTransaction("notifyLocalViewChanges","readwrite",r=>O.forEach(e,i=>O.forEach(i.addedKeys,s=>t.persistence.referenceDelegate.addReference(r,i.targetId,s)).next(()=>O.forEach(i.removedKeys,s=>t.persistence.referenceDelegate.removeReference(r,i.targetId,s)))))}catch(r){if(_s(r))V(Eg,"Failed to update sequence numbers: "+r);else throw r}for(let r of e){let i=r.targetId;if(!r.fromCache){let s=t.targetDataByTarget.get(i),a=s.snapshotVersion,o=s.withLastLimboFreeSnapshotVersion(a);t.targetDataByTarget=t.targetDataByTarget.insert(i,o)}}}function rB(n,e){let t=re(n);return t.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return t.targetCache.getTargetData(r,e).next(s=>s?(i=s,O.resolve(i)):t.targetCache.allocateTargetId(r).next(a=>(i=new Ga(e,a,"TargetPurposeListen",r.currentSequenceNumber),t.targetCache.addTargetData(r,i).next(()=>i))))}).then(r=>{let i=t.targetDataByTarget.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.targetDataByTarget=t.targetDataByTarget.insert(r.targetId,r),t.targetIdByTarget.set(e,r.targetId)),r})}function iB(n,e,t){let r=re(n),i=r.targetIdByTarget.get(t);return i!==void 0?O.resolve(r.targetDataByTarget.get(i)):r.targetCache.getTargetData(e,t)}async function Rm(n,e,t){let r=re(n),i=r.targetDataByTarget.get(e),s=t?"readwrite":"readwrite-primary";try{t||await r.persistence.runTransaction("Release target",s,a=>r.persistence.referenceDelegate.removeTarget(a,i))}catch(a){if(_s(a))V(Eg,`Failed to update sequence numbers for target ${e}: ${a}`);else throw a}r.targetDataByTarget=r.targetDataByTarget.remove(e),r.targetIdByTarget.delete(i.target)}function Gw(n,e,t){let r=re(n),i=W.min(),s=se();return r.persistence.runTransaction("Execute query","readwrite",a=>iB(r,a,qt(e)).next(o=>{if(o)return i=o.lastLimboFreeSnapshotVersion,r.targetCache.getMatchingKeysForTargetId(a,o.targetId).next(l=>{s=l})}).next(()=>r.queryEngine.getDocumentsMatchingQuery(a,e,t?i:W.min(),t?s:se())).next(o=>(sB(r,yL(e),o),{documents:o,remoteKeys:s})))}function sB(n,e,t){let r=n.collectionGroupReadTime.get(e)||W.min();t.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),n.collectionGroupReadTime.set(e,r)}var Dm=class{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}};var aB=100;function oB(){return p_()?8:ZM(f_())>0?6:4}var xm=class{constructor(){this.initialized=!1,this.indexAutoCreationEnabled=!1,this.indexAutoCreationMinCollectionSize=aB,this.relativeIndexReadCostPerDocument=oB()}initialize(e,t){this.localDocumentsView=e,this.indexManager=t,this.initialized=!0}getDocumentsMatchingQuery(e,t,r,i){let s={result:null};return this.performQueryUsingIndex(e,t).next(a=>{s.result=a}).next(()=>{if(!s.result)return this.performQueryUsingRemoteKeys(e,t,i,r).next(a=>{s.result=a})}).next(()=>{if(s.result)return;let a=new Dm;return this.executeFullCollectionScan(e,t,a).next(o=>{if(s.result=o,this.indexAutoCreationEnabled)return this.createCacheIndexes(e,t,a,o.size)})}).next(()=>s.result)}createCacheIndexes(e,t,r,i){return r.documentReadCount<this.indexAutoCreationMinCollectionSize?(Hi()<=X.DEBUG&&V("QueryEngine","SDK will not create cache indexes for query:",Wi(t),"since it only creates cache indexes for collection contains","more than or equal to",this.indexAutoCreationMinCollectionSize,"documents"),O.resolve()):(Hi()<=X.DEBUG&&V("QueryEngine","Query:",Wi(t),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.relativeIndexReadCostPerDocument*i?(Hi()<=X.DEBUG&&V("QueryEngine","The SDK decides to create cache indexes for query:",Wi(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,qt(t))):O.resolve())}performQueryUsingIndex(e,t){if(gE(t))return O.resolve(null);let r=qt(t);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(t.limit!==null&&i===1&&(t=Xp(t,null,"F"),r=qt(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{let a=se(...s);return this.localDocumentsView.getDocuments(e,a).next(o=>this.indexManager.getMinOffset(e,r).next(l=>{let c=this.applyQuery(t,o);return this.needsRefill(t,c,a,l.readTime)?this.performQueryUsingIndex(e,Xp(t,null,"F")):this.appendRemainingResults(e,c,t,l)}))})))}performQueryUsingRemoteKeys(e,t,r,i){return gE(t)||i.isEqual(W.min())?O.resolve(null):this.localDocumentsView.getDocuments(e,r).next(s=>{let a=this.applyQuery(t,s);return this.needsRefill(t,a,r,i)?O.resolve(null):(Hi()<=X.DEBUG&&V("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Wi(t)),this.appendRemainingResults(e,a,t,WM(i,Oa)).next(o=>o))})}applyQuery(e,t){let r=new Ue(vw(e));return t.forEach((i,s)=>{Zc(e,s)&&(r=r.add(s))}),r}needsRefill(e,t,r,i){if(e.limit===null)return!1;if(r.size!==t.size)return!0;let s=e.limitType==="F"?t.last():t.first();return s?s.hasPendingWrites||s.version.compareTo(i)>0:!1}executeFullCollectionScan(e,t,r){return Hi()<=X.DEBUG&&V("QueryEngine","Using full collection scan to execute query:",Wi(t)),this.localDocumentsView.getDocumentsMatchingQuery(e,t,Qr.min(),r)}appendRemainingResults(e,t,r,i){return this.localDocumentsView.getDocumentsMatchingQuery(e,r,i).next(s=>(t.forEach(a=>{s=s.insert(a.key,a)}),s))}};var Mc=class{constructor(){this.activeTargetIds=TL()}addQueryTarget(e){this.activeTargetIds=this.activeTargetIds.add(e)}removeQueryTarget(e){this.activeTargetIds=this.activeTargetIds.delete(e)}toWebStorageJSON(){let e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}};var Nm=class{constructor(){this.localState=new Mc,this.queryState={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.localState.addQueryTarget(e),this.queryState[e]||"not-current"}updateQueryState(e,t,r){this.queryState[e]=t}removeLocalQueryTarget(e){this.localState.removeQueryTarget(e)}isLocalQueryTarget(e){return this.localState.activeTargetIds.has(e)}clearQueryState(e){delete this.queryState[e]}getAllActiveQueryTargets(){return this.localState.activeTargetIds}isActiveQueryTarget(e){return this.localState.activeTargetIds.has(e)}start(){return this.localState=new Mc,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}};var Om=class{addCallback(e){}shutdown(){}};var km=class{constructor(e){this.sendFn=e.sendFn,this.closeFn=e.closeFn}onConnected(e){this.wrappedOnConnected=e}onOpen(e){this.wrappedOnOpen=e}onClose(e){this.wrappedOnClose=e}onMessage(e){this.wrappedOnMessage=e}close(){this.closeFn()}send(e){this.sendFn(e)}callOnConnected(){this.wrappedOnConnected()}callOnOpen(){this.wrappedOnOpen()}callOnClose(e){this.wrappedOnClose(e)}callOnMessage(e){this.wrappedOnMessage(e)}};var yc=null;function lB(){return 268435456+Math.round(2147483648*Math.random())}function Ap(){return yc===null?yc=lB():yc++,"0x"+yc.toString(16)}function cB(n){return new Promise((e,t)=>{n((r,i)=>{r?t(r):e(i)})})}var uB="1.9.15",rt="GrpcConnection",dB=`gl-node/${process.versions.node} fire/${ys} grpc/${uB}`;function Rp(n,e,t,r){_e(e===null||e.type==="OAuth",36936);let i=new Kr.Metadata;return e&&e.headers.forEach((s,a)=>i.set(a,s)),t&&t.headers.forEach((s,a)=>i.set(a,s)),r&&i.set("X-Firebase-GMPID",r),i.set("X-Goog-Api-Client",dB),i.set("Google-Cloud-Resource-Prefix",n),i.set("x-goog-request-params",n),i}var Mm=class{get shouldResourcePathBeIncludedInRequest(){return!0}constructor(e,t){this.databaseInfo=t,this.cachedStub=null,this.firestore=e.google.firestore.v1,this.databasePath=`projects/${t.databaseId.projectId}/databases/${t.databaseId.database}`}ensureActiveStub(){if(!this.cachedStub){V(rt,"Creating Firestore stub.");let e=this.databaseInfo.ssl?Kr.credentials.createSsl():Kr.credentials.createInsecure();this.cachedStub=new this.firestore.Firestore(this.databaseInfo.host,e)}return this.cachedStub}invokeRPC(e,t,r,i,s){let a=Ap(),o=this.ensureActiveStub(),l=Rp(this.databasePath,i,s,this.databaseInfo.appId),c={database:this.databasePath,...r};return cB(u=>(V(rt,`RPC '${e}' ${a} invoked with request:`,r),o[e](c,l,(m,d)=>{m?(V(rt,`RPC '${e}' ${a} failed with error:`,m),u(new G(vc(m.code),m.message))):(V(rt,`RPC '${e}' ${a} completed with response:`,d),u(void 0,d))})))}invokeStreamingRPC(e,t,r,i,s,a){let o=Ap(),l=[],c=new hn;V(rt,`RPC '${e}' ${o} invoked (streaming) with request:`,r);let u=this.ensureActiveStub(),m=Rp(this.databasePath,i,s,this.databaseInfo.appId),d={...r,database:this.databasePath},p=u[e](d,m),E=!1;return p.on("data",C=>{V(rt,`RPC ${e} ${o} received result:`,C),l.push(C),a!==void 0&&l.length===a&&(E=!0,c.resolve(l))}),p.on("end",()=>{V(rt,`RPC '${e}' ${o} completed.`),E||(E=!0,c.resolve(l))}),p.on("error",C=>{V(rt,`RPC '${e}' ${o} failed with error:`,C);let T=vc(C.code);c.reject(new G(T,C.message))}),c.promise}openStream(e,t,r){let i=Ap(),s=this.ensureActiveStub(),a=Rp(this.databasePath,t,r,this.databaseInfo.appId),o=s[e](a),l=!1,c=d=>{l||(l=!0,u.callOnClose(d),o.end())},u=new km({sendFn:d=>{if(l)V(rt,`RPC '${e}' stream ${i} not sending because gRPC stream is closed:`,d);else{V(rt,`RPC '${e}' stream ${i} sending:`,d);try{o.write(d)}catch(p){throw Vt("Failure sending:",d),Vt("Error:",p),p}}},closeFn:()=>{V(rt,`RPC '${e}' stream ${i} closed locally via close().`),c()}}),m=!1;return o.on("data",d=>{l||(V(rt,`RPC '${e}' stream ${i} received:`,d),m||(u.callOnConnected(),m=!0),u.callOnMessage(d))}),o.on("end",()=>{V(rt,`RPC '${e}' stream ${i} ended.`),c()}),o.on("error",d=>{if(!l){Zi(rt,`RPC '${e}' stream ${i} error. Code:`,d.code,"Message:",d.message);let p=vc(d.code);c(new G(p,d.message))}}),V(rt,`Opening RPC '${e}' stream ${i} to ${this.databaseInfo.host}`),setTimeout(()=>{u.callOnOpen()},0),u}terminate(){this.cachedStub&&(this.cachedStub.close(),this.cachedStub=void 0)}},$w={google:{nested:{protobuf:{options:{csharp_namespace:"Google.Protobuf.WellKnownTypes",go_package:"github.com/golang/protobuf/ptypes/wrappers",java_package:"com.google.protobuf",java_outer_classname:"WrappersProto",java_multiple_files:!0,objc_class_prefix:"GPB",cc_enable_arenas:!0,optimize_for:"SPEED"},nested:{Timestamp:{fields:{seconds:{type:"int64",id:1},nanos:{type:"int32",id:2}}},FileDescriptorSet:{fields:{file:{rule:"repeated",type:"FileDescriptorProto",id:1}}},FileDescriptorProto:{fields:{name:{type:"string",id:1},package:{type:"string",id:2},dependency:{rule:"repeated",type:"string",id:3},publicDependency:{rule:"repeated",type:"int32",id:10,options:{packed:!1}},weakDependency:{rule:"repeated",type:"int32",id:11,options:{packed:!1}},messageType:{rule:"repeated",type:"DescriptorProto",id:4},enumType:{rule:"repeated",type:"EnumDescriptorProto",id:5},service:{rule:"repeated",type:"ServiceDescriptorProto",id:6},extension:{rule:"repeated",type:"FieldDescriptorProto",id:7},options:{type:"FileOptions",id:8},sourceCodeInfo:{type:"SourceCodeInfo",id:9},syntax:{type:"string",id:12}}},DescriptorProto:{fields:{name:{type:"string",id:1},field:{rule:"repeated",type:"FieldDescriptorProto",id:2},extension:{rule:"repeated",type:"FieldDescriptorProto",id:6},nestedType:{rule:"repeated",type:"DescriptorProto",id:3},enumType:{rule:"repeated",type:"EnumDescriptorProto",id:4},extensionRange:{rule:"repeated",type:"ExtensionRange",id:5},oneofDecl:{rule:"repeated",type:"OneofDescriptorProto",id:8},options:{type:"MessageOptions",id:7},reservedRange:{rule:"repeated",type:"ReservedRange",id:9},reservedName:{rule:"repeated",type:"string",id:10}},nested:{ExtensionRange:{fields:{start:{type:"int32",id:1},end:{type:"int32",id:2}}},ReservedRange:{fields:{start:{type:"int32",id:1},end:{type:"int32",id:2}}}}},FieldDescriptorProto:{fields:{name:{type:"string",id:1},number:{type:"int32",id:3},label:{type:"Label",id:4},type:{type:"Type",id:5},typeName:{type:"string",id:6},extendee:{type:"string",id:2},defaultValue:{type:"string",id:7},oneofIndex:{type:"int32",id:9},jsonName:{type:"string",id:10},options:{type:"FieldOptions",id:8}},nested:{Type:{values:{TYPE_DOUBLE:1,TYPE_FLOAT:2,TYPE_INT64:3,TYPE_UINT64:4,TYPE_INT32:5,TYPE_FIXED64:6,TYPE_FIXED32:7,TYPE_BOOL:8,TYPE_STRING:9,TYPE_GROUP:10,TYPE_MESSAGE:11,TYPE_BYTES:12,TYPE_UINT32:13,TYPE_ENUM:14,TYPE_SFIXED32:15,TYPE_SFIXED64:16,TYPE_SINT32:17,TYPE_SINT64:18}},Label:{values:{LABEL_OPTIONAL:1,LABEL_REQUIRED:2,LABEL_REPEATED:3}}}},OneofDescriptorProto:{fields:{name:{type:"string",id:1},options:{type:"OneofOptions",id:2}}},EnumDescriptorProto:{fields:{name:{type:"string",id:1},value:{rule:"repeated",type:"EnumValueDescriptorProto",id:2},options:{type:"EnumOptions",id:3}}},EnumValueDescriptorProto:{fields:{name:{type:"string",id:1},number:{type:"int32",id:2},options:{type:"EnumValueOptions",id:3}}},ServiceDescriptorProto:{fields:{name:{type:"string",id:1},method:{rule:"repeated",type:"MethodDescriptorProto",id:2},options:{type:"ServiceOptions",id:3}}},MethodDescriptorProto:{fields:{name:{type:"string",id:1},inputType:{type:"string",id:2},outputType:{type:"string",id:3},options:{type:"MethodOptions",id:4},clientStreaming:{type:"bool",id:5},serverStreaming:{type:"bool",id:6}}},FileOptions:{fields:{javaPackage:{type:"string",id:1},javaOuterClassname:{type:"string",id:8},javaMultipleFiles:{type:"bool",id:10},javaGenerateEqualsAndHash:{type:"bool",id:20,options:{deprecated:!0}},javaStringCheckUtf8:{type:"bool",id:27},optimizeFor:{type:"OptimizeMode",id:9,options:{default:"SPEED"}},goPackage:{type:"string",id:11},ccGenericServices:{type:"bool",id:16},javaGenericServices:{type:"bool",id:17},pyGenericServices:{type:"bool",id:18},deprecated:{type:"bool",id:23},ccEnableArenas:{type:"bool",id:31},objcClassPrefix:{type:"string",id:36},csharpNamespace:{type:"string",id:37},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]],reserved:[[38,38]],nested:{OptimizeMode:{values:{SPEED:1,CODE_SIZE:2,LITE_RUNTIME:3}}}},MessageOptions:{fields:{messageSetWireFormat:{type:"bool",id:1},noStandardDescriptorAccessor:{type:"bool",id:2},deprecated:{type:"bool",id:3},mapEntry:{type:"bool",id:7},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]],reserved:[[8,8]]},FieldOptions:{fields:{ctype:{type:"CType",id:1,options:{default:"STRING"}},packed:{type:"bool",id:2},jstype:{type:"JSType",id:6,options:{default:"JS_NORMAL"}},lazy:{type:"bool",id:5},deprecated:{type:"bool",id:3},weak:{type:"bool",id:10},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]],reserved:[[4,4]],nested:{CType:{values:{STRING:0,CORD:1,STRING_PIECE:2}},JSType:{values:{JS_NORMAL:0,JS_STRING:1,JS_NUMBER:2}}}},OneofOptions:{fields:{uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]]},EnumOptions:{fields:{allowAlias:{type:"bool",id:2},deprecated:{type:"bool",id:3},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]]},EnumValueOptions:{fields:{deprecated:{type:"bool",id:1},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]]},ServiceOptions:{fields:{deprecated:{type:"bool",id:33},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]]},MethodOptions:{fields:{deprecated:{type:"bool",id:33},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]]},UninterpretedOption:{fields:{name:{rule:"repeated",type:"NamePart",id:2},identifierValue:{type:"string",id:3},positiveIntValue:{type:"uint64",id:4},negativeIntValue:{type:"int64",id:5},doubleValue:{type:"double",id:6},stringValue:{type:"bytes",id:7},aggregateValue:{type:"string",id:8}},nested:{NamePart:{fields:{namePart:{rule:"required",type:"string",id:1},isExtension:{rule:"required",type:"bool",id:2}}}}},SourceCodeInfo:{fields:{location:{rule:"repeated",type:"Location",id:1}},nested:{Location:{fields:{path:{rule:"repeated",type:"int32",id:1},span:{rule:"repeated",type:"int32",id:2},leadingComments:{type:"string",id:3},trailingComments:{type:"string",id:4},leadingDetachedComments:{rule:"repeated",type:"string",id:6}}}}},GeneratedCodeInfo:{fields:{annotation:{rule:"repeated",type:"Annotation",id:1}},nested:{Annotation:{fields:{path:{rule:"repeated",type:"int32",id:1},sourceFile:{type:"string",id:2},begin:{type:"int32",id:3},end:{type:"int32",id:4}}}}},Struct:{fields:{fields:{keyType:"string",type:"Value",id:1}}},Value:{oneofs:{kind:{oneof:["nullValue","numberValue","stringValue","boolValue","structValue","listValue"]}},fields:{nullValue:{type:"NullValue",id:1},numberValue:{type:"double",id:2},stringValue:{type:"string",id:3},boolValue:{type:"bool",id:4},structValue:{type:"Struct",id:5},listValue:{type:"ListValue",id:6}}},NullValue:{values:{NULL_VALUE:0}},ListValue:{fields:{values:{rule:"repeated",type:"Value",id:1}}},Empty:{fields:{}},DoubleValue:{fields:{value:{type:"double",id:1}}},FloatValue:{fields:{value:{type:"float",id:1}}},Int64Value:{fields:{value:{type:"int64",id:1}}},UInt64Value:{fields:{value:{type:"uint64",id:1}}},Int32Value:{fields:{value:{type:"int32",id:1}}},UInt32Value:{fields:{value:{type:"uint32",id:1}}},BoolValue:{fields:{value:{type:"bool",id:1}}},StringValue:{fields:{value:{type:"string",id:1}}},BytesValue:{fields:{value:{type:"bytes",id:1}}},Any:{fields:{typeUrl:{type:"string",id:1},value:{type:"bytes",id:2}}}}},firestore:{nested:{v1:{options:{csharp_namespace:"Google.Cloud.Firestore.V1",go_package:"google.golang.org/genproto/googleapis/firestore/v1;firestore",java_multiple_files:!0,java_outer_classname:"WriteProto",java_package:"com.google.firestore.v1",objc_class_prefix:"GCFS",php_namespace:"Google\\Cloud\\Firestore\\V1",ruby_package:"Google::Cloud::Firestore::V1"},nested:{AggregationResult:{fields:{aggregateFields:{keyType:"string",type:"Value",id:2}}},BitSequence:{fields:{bitmap:{type:"bytes",id:1},padding:{type:"int32",id:2}}},BloomFilter:{fields:{bits:{type:"BitSequence",id:1},hashCount:{type:"int32",id:2}}},DocumentMask:{fields:{fieldPaths:{rule:"repeated",type:"string",id:1}}},Precondition:{oneofs:{conditionType:{oneof:["exists","updateTime"]}},fields:{exists:{type:"bool",id:1},updateTime:{type:"google.protobuf.Timestamp",id:2}}},TransactionOptions:{oneofs:{mode:{oneof:["readOnly","readWrite"]}},fields:{readOnly:{type:"ReadOnly",id:2},readWrite:{type:"ReadWrite",id:3}},nested:{ReadWrite:{fields:{retryTransaction:{type:"bytes",id:1}}},ReadOnly:{oneofs:{consistencySelector:{oneof:["readTime"]}},fields:{readTime:{type:"google.protobuf.Timestamp",id:2}}}}},Document:{fields:{name:{type:"string",id:1},fields:{keyType:"string",type:"Value",id:2},createTime:{type:"google.protobuf.Timestamp",id:3},updateTime:{type:"google.protobuf.Timestamp",id:4}}},Value:{oneofs:{valueType:{oneof:["nullValue","booleanValue","integerValue","doubleValue","timestampValue","stringValue","bytesValue","referenceValue","geoPointValue","arrayValue","mapValue"]}},fields:{nullValue:{type:"google.protobuf.NullValue",id:11},booleanValue:{type:"bool",id:1},integerValue:{type:"int64",id:2},doubleValue:{type:"double",id:3},timestampValue:{type:"google.protobuf.Timestamp",id:10},stringValue:{type:"string",id:17},bytesValue:{type:"bytes",id:18},referenceValue:{type:"string",id:5},geoPointValue:{type:"google.type.LatLng",id:8},arrayValue:{type:"ArrayValue",id:9},mapValue:{type:"MapValue",id:6}}},ArrayValue:{fields:{values:{rule:"repeated",type:"Value",id:1}}},MapValue:{fields:{fields:{keyType:"string",type:"Value",id:1}}},Firestore:{options:{"(google.api.default_host)":"firestore.googleapis.com","(google.api.oauth_scopes)":"https://www.googleapis.com/auth/cloud-platform,https://www.googleapis.com/auth/datastore"},methods:{GetDocument:{requestType:"GetDocumentRequest",responseType:"Document",options:{"(google.api.http).get":"/v1/{name=projects/*/databases/*/documents/*/**}"},parsedOptions:[{"(google.api.http)":{get:"/v1/{name=projects/*/databases/*/documents/*/**}"}}]},ListDocuments:{requestType:"ListDocumentsRequest",responseType:"ListDocumentsResponse",options:{"(google.api.http).get":"/v1/{parent=projects/*/databases/*/documents/*/**}/{collection_id}"},parsedOptions:[{"(google.api.http)":{get:"/v1/{parent=projects/*/databases/*/documents/*/**}/{collection_id}"}}]},UpdateDocument:{requestType:"UpdateDocumentRequest",responseType:"Document",options:{"(google.api.http).patch":"/v1/{document.name=projects/*/databases/*/documents/*/**}","(google.api.http).body":"document","(google.api.method_signature)":"document,update_mask"},parsedOptions:[{"(google.api.http)":{patch:"/v1/{document.name=projects/*/databases/*/documents/*/**}",body:"document"}},{"(google.api.method_signature)":"document,update_mask"}]},DeleteDocument:{requestType:"DeleteDocumentRequest",responseType:"google.protobuf.Empty",options:{"(google.api.http).delete":"/v1/{name=projects/*/databases/*/documents/*/**}","(google.api.method_signature)":"name"},parsedOptions:[{"(google.api.http)":{delete:"/v1/{name=projects/*/databases/*/documents/*/**}"}},{"(google.api.method_signature)":"name"}]},BatchGetDocuments:{requestType:"BatchGetDocumentsRequest",responseType:"BatchGetDocumentsResponse",responseStream:!0,options:{"(google.api.http).post":"/v1/{database=projects/*/databases/*}/documents:batchGet","(google.api.http).body":"*"},parsedOptions:[{"(google.api.http)":{post:"/v1/{database=projects/*/databases/*}/documents:batchGet",body:"*"}}]},BeginTransaction:{requestType:"BeginTransactionRequest",responseType:"BeginTransactionResponse",options:{"(google.api.http).post":"/v1/{database=projects/*/databases/*}/documents:beginTransaction","(google.api.http).body":"*","(google.api.method_signature)":"database"},parsedOptions:[{"(google.api.http)":{post:"/v1/{database=projects/*/databases/*}/documents:beginTransaction",body:"*"}},{"(google.api.method_signature)":"database"}]},Commit:{requestType:"CommitRequest",responseType:"CommitResponse",options:{"(google.api.http).post":"/v1/{database=projects/*/databases/*}/documents:commit","(google.api.http).body":"*","(google.api.method_signature)":"database,writes"},parsedOptions:[{"(google.api.http)":{post:"/v1/{database=projects/*/databases/*}/documents:commit",body:"*"}},{"(google.api.method_signature)":"database,writes"}]},Rollback:{requestType:"RollbackRequest",responseType:"google.protobuf.Empty",options:{"(google.api.http).post":"/v1/{database=projects/*/databases/*}/documents:rollback","(google.api.http).body":"*","(google.api.method_signature)":"database,transaction"},parsedOptions:[{"(google.api.http)":{post:"/v1/{database=projects/*/databases/*}/documents:rollback",body:"*"}},{"(google.api.method_signature)":"database,transaction"}]},RunQuery:{requestType:"RunQueryRequest",responseType:"RunQueryResponse",responseStream:!0,options:{"(google.api.http).post":"/v1/{parent=projects/*/databases/*/documents}:runQuery","(google.api.http).body":"*","(google.api.http).additional_bindings.post":"/v1/{parent=projects/*/databases/*/documents/*/**}:runQuery","(google.api.http).additional_bindings.body":"*"},parsedOptions:[{"(google.api.http)":{post:"/v1/{parent=projects/*/databases/*/documents}:runQuery",body:"*",additional_bindings:{post:"/v1/{parent=projects/*/databases/*/documents/*/**}:runQuery",body:"*"}}}]},RunAggregationQuery:{requestType:"RunAggregationQueryRequest",responseType:"RunAggregationQueryResponse",responseStream:!0,options:{"(google.api.http).post":"/v1/{parent=projects/*/databases/*/documents}:runAggregationQuery","(google.api.http).body":"*","(google.api.http).additional_bindings.post":"/v1/{parent=projects/*/databases/*/documents/*/**}:runAggregationQuery","(google.api.http).additional_bindings.body":"*"},parsedOptions:[{"(google.api.http)":{post:"/v1/{parent=projects/*/databases/*/documents}:runAggregationQuery",body:"*",additional_bindings:{post:"/v1/{parent=projects/*/databases/*/documents/*/**}:runAggregationQuery",body:"*"}}}]},PartitionQuery:{requestType:"PartitionQueryRequest",responseType:"PartitionQueryResponse",options:{"(google.api.http).post":"/v1/{parent=projects/*/databases/*/documents}:partitionQuery","(google.api.http).body":"*","(google.api.http).additional_bindings.post":"/v1/{parent=projects/*/databases/*/documents/*/**}:partitionQuery","(google.api.http).additional_bindings.body":"*"},parsedOptions:[{"(google.api.http)":{post:"/v1/{parent=projects/*/databases/*/documents}:partitionQuery",body:"*",additional_bindings:{post:"/v1/{parent=projects/*/databases/*/documents/*/**}:partitionQuery",body:"*"}}}]},Write:{requestType:"WriteRequest",requestStream:!0,responseType:"WriteResponse",responseStream:!0,options:{"(google.api.http).post":"/v1/{database=projects/*/databases/*}/documents:write","(google.api.http).body":"*"},parsedOptions:[{"(google.api.http)":{post:"/v1/{database=projects/*/databases/*}/documents:write",body:"*"}}]},Listen:{requestType:"ListenRequest",requestStream:!0,responseType:"ListenResponse",responseStream:!0,options:{"(google.api.http).post":"/v1/{database=projects/*/databases/*}/documents:listen","(google.api.http).body":"*"},parsedOptions:[{"(google.api.http)":{post:"/v1/{database=projects/*/databases/*}/documents:listen",body:"*"}}]},ListCollectionIds:{requestType:"ListCollectionIdsRequest",responseType:"ListCollectionIdsResponse",options:{"(google.api.http).post":"/v1/{parent=projects/*/databases/*/documents}:listCollectionIds","(google.api.http).body":"*","(google.api.http).additional_bindings.post":"/v1/{parent=projects/*/databases/*/documents/*/**}:listCollectionIds","(google.api.http).additional_bindings.body":"*","(google.api.method_signature)":"parent"},parsedOptions:[{"(google.api.http)":{post:"/v1/{parent=projects/*/databases/*/documents}:listCollectionIds",body:"*",additional_bindings:{post:"/v1/{parent=projects/*/databases/*/documents/*/**}:listCollectionIds",body:"*"}}},{"(google.api.method_signature)":"parent"}]},BatchWrite:{requestType:"BatchWriteRequest",responseType:"BatchWriteResponse",options:{"(google.api.http).post":"/v1/{database=projects/*/databases/*}/documents:batchWrite","(google.api.http).body":"*"},parsedOptions:[{"(google.api.http)":{post:"/v1/{database=projects/*/databases/*}/documents:batchWrite",body:"*"}}]},CreateDocument:{requestType:"CreateDocumentRequest",responseType:"Document",options:{"(google.api.http).post":"/v1/{parent=projects/*/databases/*/documents/**}/{collection_id}","(google.api.http).body":"document"},parsedOptions:[{"(google.api.http)":{post:"/v1/{parent=projects/*/databases/*/documents/**}/{collection_id}",body:"document"}}]}}},GetDocumentRequest:{oneofs:{consistencySelector:{oneof:["transaction","readTime"]}},fields:{name:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},mask:{type:"DocumentMask",id:2},transaction:{type:"bytes",id:3},readTime:{type:"google.protobuf.Timestamp",id:5}}},ListDocumentsRequest:{oneofs:{consistencySelector:{oneof:["transaction","readTime"]}},fields:{parent:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},collectionId:{type:"string",id:2,options:{"(google.api.field_behavior)":"REQUIRED"}},pageSize:{type:"int32",id:3},pageToken:{type:"string",id:4},orderBy:{type:"string",id:6},mask:{type:"DocumentMask",id:7},transaction:{type:"bytes",id:8},readTime:{type:"google.protobuf.Timestamp",id:10},showMissing:{type:"bool",id:12}}},ListDocumentsResponse:{fields:{documents:{rule:"repeated",type:"Document",id:1},nextPageToken:{type:"string",id:2}}},CreateDocumentRequest:{fields:{parent:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},collectionId:{type:"string",id:2,options:{"(google.api.field_behavior)":"REQUIRED"}},documentId:{type:"string",id:3},document:{type:"Document",id:4,options:{"(google.api.field_behavior)":"REQUIRED"}},mask:{type:"DocumentMask",id:5}}},UpdateDocumentRequest:{fields:{document:{type:"Document",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},updateMask:{type:"DocumentMask",id:2},mask:{type:"DocumentMask",id:3},currentDocument:{type:"Precondition",id:4}}},DeleteDocumentRequest:{fields:{name:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},currentDocument:{type:"Precondition",id:2}}},BatchGetDocumentsRequest:{oneofs:{consistencySelector:{oneof:["transaction","newTransaction","readTime"]}},fields:{database:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},documents:{rule:"repeated",type:"string",id:2},mask:{type:"DocumentMask",id:3},transaction:{type:"bytes",id:4},newTransaction:{type:"TransactionOptions",id:5},readTime:{type:"google.protobuf.Timestamp",id:7}}},BatchGetDocumentsResponse:{oneofs:{result:{oneof:["found","missing"]}},fields:{found:{type:"Document",id:1},missing:{type:"string",id:2},transaction:{type:"bytes",id:3},readTime:{type:"google.protobuf.Timestamp",id:4}}},BeginTransactionRequest:{fields:{database:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},options:{type:"TransactionOptions",id:2}}},BeginTransactionResponse:{fields:{transaction:{type:"bytes",id:1}}},CommitRequest:{fields:{database:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},writes:{rule:"repeated",type:"Write",id:2},transaction:{type:"bytes",id:3}}},CommitResponse:{fields:{writeResults:{rule:"repeated",type:"WriteResult",id:1},commitTime:{type:"google.protobuf.Timestamp",id:2}}},RollbackRequest:{fields:{database:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},transaction:{type:"bytes",id:2,options:{"(google.api.field_behavior)":"REQUIRED"}}}},RunQueryRequest:{oneofs:{queryType:{oneof:["structuredQuery"]},consistencySelector:{oneof:["transaction","newTransaction","readTime"]}},fields:{parent:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},structuredQuery:{type:"StructuredQuery",id:2},transaction:{type:"bytes",id:5},newTransaction:{type:"TransactionOptions",id:6},readTime:{type:"google.protobuf.Timestamp",id:7}}},RunQueryResponse:{fields:{transaction:{type:"bytes",id:2},document:{type:"Document",id:1},readTime:{type:"google.protobuf.Timestamp",id:3},skippedResults:{type:"int32",id:4}}},RunAggregationQueryRequest:{oneofs:{queryType:{oneof:["structuredAggregationQuery"]},consistencySelector:{oneof:["transaction","newTransaction","readTime"]}},fields:{parent:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},structuredAggregationQuery:{type:"StructuredAggregationQuery",id:2},transaction:{type:"bytes",id:4},newTransaction:{type:"TransactionOptions",id:5},readTime:{type:"google.protobuf.Timestamp",id:6}}},RunAggregationQueryResponse:{fields:{result:{type:"AggregationResult",id:1},transaction:{type:"bytes",id:2},readTime:{type:"google.protobuf.Timestamp",id:3}}},PartitionQueryRequest:{oneofs:{queryType:{oneof:["structuredQuery"]}},fields:{parent:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},structuredQuery:{type:"StructuredQuery",id:2},partitionCount:{type:"int64",id:3},pageToken:{type:"string",id:4},pageSize:{type:"int32",id:5}}},PartitionQueryResponse:{fields:{partitions:{rule:"repeated",type:"Cursor",id:1},nextPageToken:{type:"string",id:2}}},WriteRequest:{fields:{database:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},streamId:{type:"string",id:2},writes:{rule:"repeated",type:"Write",id:3},streamToken:{type:"bytes",id:4},labels:{keyType:"string",type:"string",id:5}}},WriteResponse:{fields:{streamId:{type:"string",id:1},streamToken:{type:"bytes",id:2},writeResults:{rule:"repeated",type:"WriteResult",id:3},commitTime:{type:"google.protobuf.Timestamp",id:4}}},ListenRequest:{oneofs:{targetChange:{oneof:["addTarget","removeTarget"]}},fields:{database:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},addTarget:{type:"Target",id:2},removeTarget:{type:"int32",id:3},labels:{keyType:"string",type:"string",id:4}}},ListenResponse:{oneofs:{responseType:{oneof:["targetChange","documentChange","documentDelete","documentRemove","filter"]}},fields:{targetChange:{type:"TargetChange",id:2},documentChange:{type:"DocumentChange",id:3},documentDelete:{type:"DocumentDelete",id:4},documentRemove:{type:"DocumentRemove",id:6},filter:{type:"ExistenceFilter",id:5}}},Target:{oneofs:{targetType:{oneof:["query","documents"]},resumeType:{oneof:["resumeToken","readTime"]}},fields:{query:{type:"QueryTarget",id:2},documents:{type:"DocumentsTarget",id:3},resumeToken:{type:"bytes",id:4},readTime:{type:"google.protobuf.Timestamp",id:11},targetId:{type:"int32",id:5},once:{type:"bool",id:6},expectedCount:{type:"google.protobuf.Int32Value",id:12}},nested:{DocumentsTarget:{fields:{documents:{rule:"repeated",type:"string",id:2}}},QueryTarget:{oneofs:{queryType:{oneof:["structuredQuery"]}},fields:{parent:{type:"string",id:1},structuredQuery:{type:"StructuredQuery",id:2}}}}},TargetChange:{fields:{targetChangeType:{type:"TargetChangeType",id:1},targetIds:{rule:"repeated",type:"int32",id:2},cause:{type:"google.rpc.Status",id:3},resumeToken:{type:"bytes",id:4},readTime:{type:"google.protobuf.Timestamp",id:6}},nested:{TargetChangeType:{values:{NO_CHANGE:0,ADD:1,REMOVE:2,CURRENT:3,RESET:4}}}},ListCollectionIdsRequest:{fields:{parent:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},pageSize:{type:"int32",id:2},pageToken:{type:"string",id:3}}},ListCollectionIdsResponse:{fields:{collectionIds:{rule:"repeated",type:"string",id:1},nextPageToken:{type:"string",id:2}}},BatchWriteRequest:{fields:{database:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},writes:{rule:"repeated",type:"Write",id:2},labels:{keyType:"string",type:"string",id:3}}},BatchWriteResponse:{fields:{writeResults:{rule:"repeated",type:"WriteResult",id:1},status:{rule:"repeated",type:"google.rpc.Status",id:2}}},StructuredQuery:{fields:{select:{type:"Projection",id:1},from:{rule:"repeated",type:"CollectionSelector",id:2},where:{type:"Filter",id:3},orderBy:{rule:"repeated",type:"Order",id:4},startAt:{type:"Cursor",id:7},endAt:{type:"Cursor",id:8},offset:{type:"int32",id:6},limit:{type:"google.protobuf.Int32Value",id:5}},nested:{CollectionSelector:{fields:{collectionId:{type:"string",id:2},allDescendants:{type:"bool",id:3}}},Filter:{oneofs:{filterType:{oneof:["compositeFilter","fieldFilter","unaryFilter"]}},fields:{compositeFilter:{type:"CompositeFilter",id:1},fieldFilter:{type:"FieldFilter",id:2},unaryFilter:{type:"UnaryFilter",id:3}}},CompositeFilter:{fields:{op:{type:"Operator",id:1},filters:{rule:"repeated",type:"Filter",id:2}},nested:{Operator:{values:{OPERATOR_UNSPECIFIED:0,AND:1,OR:2}}}},FieldFilter:{fields:{field:{type:"FieldReference",id:1},op:{type:"Operator",id:2},value:{type:"Value",id:3}},nested:{Operator:{values:{OPERATOR_UNSPECIFIED:0,LESS_THAN:1,LESS_THAN_OR_EQUAL:2,GREATER_THAN:3,GREATER_THAN_OR_EQUAL:4,EQUAL:5,NOT_EQUAL:6,ARRAY_CONTAINS:7,IN:8,ARRAY_CONTAINS_ANY:9,NOT_IN:10}}}},UnaryFilter:{oneofs:{operandType:{oneof:["field"]}},fields:{op:{type:"Operator",id:1},field:{type:"FieldReference",id:2}},nested:{Operator:{values:{OPERATOR_UNSPECIFIED:0,IS_NAN:2,IS_NULL:3,IS_NOT_NAN:4,IS_NOT_NULL:5}}}},Order:{fields:{field:{type:"FieldReference",id:1},direction:{type:"Direction",id:2}}},FieldReference:{fields:{fieldPath:{type:"string",id:2}}},Projection:{fields:{fields:{rule:"repeated",type:"FieldReference",id:2}}},Direction:{values:{DIRECTION_UNSPECIFIED:0,ASCENDING:1,DESCENDING:2}}}},StructuredAggregationQuery:{oneofs:{queryType:{oneof:["structuredQuery"]}},fields:{structuredQuery:{type:"StructuredQuery",id:1},aggregations:{rule:"repeated",type:"Aggregation",id:3}},nested:{Aggregation:{oneofs:{operator:{oneof:["count","sum","avg"]}},fields:{count:{type:"Count",id:1},sum:{type:"Sum",id:2},avg:{type:"Avg",id:3},alias:{type:"string",id:7}},nested:{Count:{fields:{upTo:{type:"google.protobuf.Int64Value",id:1}}},Sum:{fields:{field:{type:"FieldReference",id:1}}},Avg:{fields:{field:{type:"FieldReference",id:1}}}}}}},Cursor:{fields:{values:{rule:"repeated",type:"Value",id:1},before:{type:"bool",id:2}}},Write:{oneofs:{operation:{oneof:["update","delete","verify","transform"]}},fields:{update:{type:"Document",id:1},delete:{type:"string",id:2},verify:{type:"string",id:5},transform:{type:"DocumentTransform",id:6},updateMask:{type:"DocumentMask",id:3},updateTransforms:{rule:"repeated",type:"DocumentTransform.FieldTransform",id:7},currentDocument:{type:"Precondition",id:4}}},DocumentTransform:{fields:{document:{type:"string",id:1},fieldTransforms:{rule:"repeated",type:"FieldTransform",id:2}},nested:{FieldTransform:{oneofs:{transformType:{oneof:["setToServerValue","increment","maximum","minimum","appendMissingElements","removeAllFromArray"]}},fields:{fieldPath:{type:"string",id:1},setToServerValue:{type:"ServerValue",id:2},increment:{type:"Value",id:3},maximum:{type:"Value",id:4},minimum:{type:"Value",id:5},appendMissingElements:{type:"ArrayValue",id:6},removeAllFromArray:{type:"ArrayValue",id:7}},nested:{ServerValue:{values:{SERVER_VALUE_UNSPECIFIED:0,REQUEST_TIME:1}}}}}},WriteResult:{fields:{updateTime:{type:"google.protobuf.Timestamp",id:1},transformResults:{rule:"repeated",type:"Value",id:2}}},DocumentChange:{fields:{document:{type:"Document",id:1},targetIds:{rule:"repeated",type:"int32",id:5},removedTargetIds:{rule:"repeated",type:"int32",id:6}}},DocumentDelete:{fields:{document:{type:"string",id:1},removedTargetIds:{rule:"repeated",type:"int32",id:6},readTime:{type:"google.protobuf.Timestamp",id:4}}},DocumentRemove:{fields:{document:{type:"string",id:1},removedTargetIds:{rule:"repeated",type:"int32",id:2},readTime:{type:"google.protobuf.Timestamp",id:4}}},ExistenceFilter:{fields:{targetId:{type:"int32",id:1},count:{type:"int32",id:2},unchangedNames:{type:"BloomFilter",id:3}}}}}}},api:{options:{go_package:"google.golang.org/genproto/googleapis/api/annotations;annotations",java_multiple_files:!0,java_outer_classname:"HttpProto",java_package:"com.google.api",objc_class_prefix:"GAPI",cc_enable_arenas:!0},nested:{http:{type:"HttpRule",id:72295728,extend:"google.protobuf.MethodOptions"},Http:{fields:{rules:{rule:"repeated",type:"HttpRule",id:1}}},HttpRule:{oneofs:{pattern:{oneof:["get","put","post","delete","patch","custom"]}},fields:{get:{type:"string",id:2},put:{type:"string",id:3},post:{type:"string",id:4},delete:{type:"string",id:5},patch:{type:"string",id:6},custom:{type:"CustomHttpPattern",id:8},selector:{type:"string",id:1},body:{type:"string",id:7},additionalBindings:{rule:"repeated",type:"HttpRule",id:11}}},CustomHttpPattern:{fields:{kind:{type:"string",id:1},path:{type:"string",id:2}}},methodSignature:{rule:"repeated",type:"string",id:1051,extend:"google.protobuf.MethodOptions"},defaultHost:{type:"string",id:1049,extend:"google.protobuf.ServiceOptions"},oauthScopes:{type:"string",id:1050,extend:"google.protobuf.ServiceOptions"},fieldBehavior:{rule:"repeated",type:"google.api.FieldBehavior",id:1052,extend:"google.protobuf.FieldOptions"},FieldBehavior:{values:{FIELD_BEHAVIOR_UNSPECIFIED:0,OPTIONAL:1,REQUIRED:2,OUTPUT_ONLY:3,INPUT_ONLY:4,IMMUTABLE:5,UNORDERED_LIST:6,NON_EMPTY_DEFAULT:7}}}},type:{options:{cc_enable_arenas:!0,go_package:"google.golang.org/genproto/googleapis/type/latlng;latlng",java_multiple_files:!0,java_outer_classname:"LatLngProto",java_package:"com.google.type",objc_class_prefix:"GTP"},nested:{LatLng:{fields:{latitude:{type:"double",id:1},longitude:{type:"double",id:2}}}}},rpc:{options:{cc_enable_arenas:!0,go_package:"google.golang.org/genproto/googleapis/rpc/status;status",java_multiple_files:!0,java_outer_classname:"StatusProto",java_package:"com.google.rpc",objc_class_prefix:"RPC"},nested:{Status:{fields:{code:{type:"int32",id:1},message:{type:"string",id:2},details:{rule:"repeated",type:"google.protobuf.Any",id:3}}}}}}}},hB={nested:$w},fB=Object.freeze({__proto__:null,nested:$w,default:hB});var pB={longs:String,enums:String,defaults:!0,oneofs:!1};function mB(){let n=VE.fromJSON(fB,pB);return Kr.loadPackageDefinition(n)}function gB(n){let e=mB();return new Mm(e,n)}function yB(){return new Om}function wg(n){return new xc(n,!1)}var _B="ExponentialBackoff",vB=1e3,bB=1.5,SB=60*1e3,Pc=class{constructor(e,t,r=vB,i=bB,s=SB){this.queue=e,this.timerId=t,this.initialDelayMs=r,this.backoffFactor=i,this.maxDelayMs=s,this.currentBaseMs=0,this.timerPromise=null,this.lastAttemptTime=Date.now(),this.reset()}reset(){this.currentBaseMs=0}resetToMax(){this.currentBaseMs=this.maxDelayMs}backoffAndRun(e){this.cancel();let t=Math.floor(this.currentBaseMs+this.jitterDelayMs()),r=Math.max(0,Date.now()-this.lastAttemptTime),i=Math.max(0,t-r);i>0&&V(_B,`Backing off for ${i} ms (base delay: ${this.currentBaseMs} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.timerPromise=this.queue.enqueueAfterDelay(this.timerId,i,()=>(this.lastAttemptTime=Date.now(),e())),this.currentBaseMs*=this.backoffFactor,this.currentBaseMs<this.initialDelayMs&&(this.currentBaseMs=this.initialDelayMs),this.currentBaseMs>this.maxDelayMs&&(this.currentBaseMs=this.maxDelayMs)}skipBackoff(){this.timerPromise!==null&&(this.timerPromise.skipDelay(),this.timerPromise=null)}cancel(){this.timerPromise!==null&&(this.timerPromise.cancel(),this.timerPromise=null)}jitterDelayMs(){return(Math.random()-.5)*this.currentBaseMs}};var RE="PersistentStream",EB=60*1e3,wB=10*1e3,Pm=class{constructor(e,t,r,i,s,a,o,l){this.queue=e,this.idleTimerId=r,this.healthTimerId=i,this.connection=s,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=o,this.listener=l,this.state=0,this.closeCount=0,this.idleTimer=null,this.healthCheck=null,this.stream=null,this.responseCount=0,this.backoff=new Pc(e,t)}isStarted(){return this.state===1||this.state===5||this.isOpen()}isOpen(){return this.state===2||this.state===3}start(){if(this.responseCount=0,this.state===4){this.performBackoff();return}this.auth()}async stop(){this.isStarted()&&await this.close(0)}inhibitBackoff(){this.state=0,this.backoff.reset()}markIdle(){this.isOpen()&&this.idleTimer===null&&(this.idleTimer=this.queue.enqueueAfterDelay(this.idleTimerId,EB,()=>this.handleIdleCloseTimer()))}sendRequest(e){this.cancelIdleCheck(),this.stream.send(e)}async handleIdleCloseTimer(){if(this.isOpen())return this.close(0)}cancelIdleCheck(){this.idleTimer&&(this.idleTimer.cancel(),this.idleTimer=null)}cancelHealthCheck(){this.healthCheck&&(this.healthCheck.cancel(),this.healthCheck=null)}async close(e,t){this.cancelIdleCheck(),this.cancelHealthCheck(),this.backoff.cancel(),this.closeCount++,e!==4?this.backoff.reset():t&&t.code===F.RESOURCE_EXHAUSTED?(Vt(t.toString()),Vt("Using maximum backoff delay to prevent overloading the backend."),this.backoff.resetToMax()):t&&t.code===F.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.tearDown(),this.stream.close(),this.stream=null),this.state=e,await this.listener.onClose(t)}tearDown(){}auth(){this.state=1;let e=this.getCloseGuardedDispatcher(this.closeCount),t=this.closeCount;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.closeCount===t&&this.startStream(r,i)},r=>{e(()=>{let i=new G(F.UNKNOWN,"Fetching auth token failed: "+r.message);return this.handleStreamClose(i)})})}startStream(e,t){let r=this.getCloseGuardedDispatcher(this.closeCount);this.stream=this.startRpc(e,t),this.stream.onConnected(()=>{r(()=>this.listener.onConnected())}),this.stream.onOpen(()=>{r(()=>(this.state=2,this.healthCheck=this.queue.enqueueAfterDelay(this.healthTimerId,wB,()=>(this.isOpen()&&(this.state=3),Promise.resolve())),this.listener.onOpen()))}),this.stream.onClose(i=>{r(()=>this.handleStreamClose(i))}),this.stream.onMessage(i=>{r(()=>++this.responseCount===1?this.onFirst(i):this.onNext(i))})}performBackoff(){this.state=5,this.backoff.backoffAndRun(async()=>{this.state=0,this.start()})}handleStreamClose(e){return V(RE,`close with error: ${e}`),this.stream=null,this.close(4,e)}getCloseGuardedDispatcher(e){return t=>{this.queue.enqueueAndForget(()=>this.closeCount===e?t():(V(RE,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}},Lm=class extends Pm{constructor(e,t,r,i,s,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,i,a),this.serializer=s}startRpc(e,t){return this.connection.openStream("Listen",e,t)}onFirst(e){return this.onNext(e)}onNext(e){this.backoff.reset();let t=ZL(this.serializer,e),r=eF(e);return this.listener.onWatchChange(t,r)}watch(e){let t={};t.database=wE(this.serializer),t.addTarget=sF(this.serializer,e);let r=rF(this.serializer,e);r&&(t.labels=r),this.sendRequest(t)}unwatch(e){let t={};t.database=wE(this.serializer),t.removeTarget=e,this.sendRequest(t)}};var Fm=class{},Bm=class extends Fm{constructor(e,t,r,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=i,this.terminated=!1}verifyInitialized(){if(this.terminated)throw new G(F.FAILED_PRECONDITION,"The client has already been terminated.")}invokeRPC(e,t,r,i){return this.verifyInitialized(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,a])=>this.connection.invokeRPC(e,lm(t,r),i,s,a)).catch(s=>{throw s.name==="FirebaseError"?(s.code===F.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new G(F.UNKNOWN,s.toString())})}invokeStreamingRPC(e,t,r,i,s){return this.verifyInitialized(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,o])=>this.connection.invokeStreamingRPC(e,lm(t,r),i,a,o,s)).catch(a=>{throw a.name==="FirebaseError"?(a.code===F.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new G(F.UNKNOWN,a.toString())})}terminate(){this.terminated=!0,this.connection.terminate()}};function TB(n,e,t,r){return new Bm(n,e,t,r)}function CB(n,e,t){let r=re(n);return r.verifyInitialized(),new Lm(e,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,t)}var IB="OnlineStateTracker",DE=1,xE=10*1e3,Um=class{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.watchStreamFailures=0,this.onlineStateTimer=null,this.shouldWarnClientIsOffline=!0}handleWatchStreamStart(){this.watchStreamFailures===0&&(this.setAndBroadcast("Unknown"),this.onlineStateTimer=this.asyncQueue.enqueueAfterDelay("online_state_timeout",xE,()=>(this.onlineStateTimer=null,this.logClientOfflineWarningIfNecessary(`Backend didn't respond within ${xE/1e3} seconds.`),this.setAndBroadcast("Offline"),Promise.resolve())))}handleWatchStreamFailure(e){this.state==="Online"?this.setAndBroadcast("Unknown"):(this.watchStreamFailures++,this.watchStreamFailures>=DE&&(this.clearOnlineStateTimer(),this.logClientOfflineWarningIfNecessary(`Connection failed ${DE} times. Most recent error: ${e.toString()}`),this.setAndBroadcast("Offline")))}set(e){this.clearOnlineStateTimer(),this.watchStreamFailures=0,e==="Online"&&(this.shouldWarnClientIsOffline=!1),this.setAndBroadcast(e)}setAndBroadcast(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}logClientOfflineWarningIfNecessary(e){let t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.shouldWarnClientIsOffline?(Vt(t),this.shouldWarnClientIsOffline=!1):V(IB,t)}clearOnlineStateTimer(){this.onlineStateTimer!==null&&(this.onlineStateTimer.cancel(),this.onlineStateTimer=null)}};var fs="RemoteStore";var qm=class{constructor(e,t,r,i,s){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.writePipeline=[],this.listenTargets=new Map,this.offlineCauses=new Set,this.onNetworkStatusChange=[],this.connectivityMonitor=s,this.connectivityMonitor.addCallback(a=>{r.enqueueAndForget(async()=>{Xa(this)&&(V(fs,"Restarting streams for network reachability change."),await PB(this))})}),this.onlineStateTracker=new Um(r,i)}};function AB(n,e,t,r,i){return new qm(n,e,t,r,i)}async function tu(n){if(Xa(n))for(let e of n.onNetworkStatusChange)await e(!0)}async function Za(n){for(let e of n.onNetworkStatusChange)await e(!1)}async function RB(n){let e=re(n);V(fs,"RemoteStore shutting down."),e.offlineCauses.add(5),await Za(e),e.connectivityMonitor.shutdown(),e.onlineStateTracker.set("Unknown")}function jw(n,e){let t=re(n);t.listenTargets.has(e.targetId)||(t.listenTargets.set(e.targetId,e),Ag(t)?Ig(t):bs(t).isOpen()&&Cg(t,e))}function Tg(n,e){let t=re(n),r=bs(t);t.listenTargets.delete(e),r.isOpen()&&Kw(t,e),t.listenTargets.size===0&&(r.isOpen()?r.markIdle():Xa(t)&&t.onlineStateTracker.set("Unknown"))}function Cg(n,e){if(n.watchChangeAggregator.recordPendingTargetRequest(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(W.min())>0){let t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}bs(n).watch(e)}function Kw(n,e){n.watchChangeAggregator.recordPendingTargetRequest(e),bs(n).unwatch(e)}function Ig(n){n.watchChangeAggregator=new am({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),getTargetDataForTarget:e=>n.listenTargets.get(e)||null,getDatabaseId:()=>n.datastore.serializer.databaseId}),bs(n).start(),n.onlineStateTracker.handleWatchStreamStart()}function Ag(n){return Xa(n)&&!bs(n).isStarted()&&n.listenTargets.size>0}function Xa(n){return re(n).offlineCauses.size===0}function Hw(n){n.watchChangeAggregator=void 0}async function DB(n){n.onlineStateTracker.set("Online")}async function xB(n){n.listenTargets.forEach((e,t)=>{Cg(n,e)})}async function NB(n,e){Hw(n),Ag(n)?(n.onlineStateTracker.handleWatchStreamFailure(e),Ig(n)):n.onlineStateTracker.set("Unknown")}async function OB(n,e,t){if(n.onlineStateTracker.set("Online"),e instanceof Rc&&e.state===2&&e.cause){try{await MB(n,e)}catch(r){V(fs,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await NE(n,r)}return}if(e instanceof Xi?n.watchChangeAggregator.handleDocumentChange(e):e instanceof Ac?n.watchChangeAggregator.handleExistenceFilter(e):n.watchChangeAggregator.handleTargetChange(e),!t.isEqual(W.min()))try{let r=await zw(n.localStore);t.compareTo(r)>=0&&await kB(n,t)}catch(r){V(fs,"Failed to raise snapshot:",r),await NE(n,r)}}async function NE(n,e,t){if(_s(e))n.offlineCauses.add(1),await Za(n),n.onlineStateTracker.set("Offline"),t||(t=()=>zw(n.localStore)),n.asyncQueue.enqueueRetryable(async()=>{V(fs,"Retrying IndexedDB access"),await t(),n.offlineCauses.delete(1),await tu(n)});else throw e}function kB(n,e){let t=n.watchChangeAggregator.createRemoteEvent(e);return t.targetChanges.forEach((r,i)=>{if(r.resumeToken.approximateByteSize()>0){let s=n.listenTargets.get(i);s&&n.listenTargets.set(i,s.withResumeToken(r.resumeToken,e))}}),t.targetMismatches.forEach((r,i)=>{let s=n.listenTargets.get(r);if(!s)return;n.listenTargets.set(r,s.withResumeToken(Ye.EMPTY_BYTE_STRING,s.snapshotVersion)),Kw(n,r);let a=new Ga(s.target,r,i,s.sequenceNumber);Cg(n,a)}),n.remoteSyncer.applyRemoteEvent(t)}async function MB(n,e){let t=e.cause;for(let r of e.targetIds)n.listenTargets.has(r)&&(await n.remoteSyncer.rejectListen(r,t),n.listenTargets.delete(r),n.watchChangeAggregator.removeTarget(r))}async function PB(n){let e=re(n);e.offlineCauses.add(4),await Za(e),e.onlineStateTracker.set("Unknown"),e.offlineCauses.delete(4),await tu(e)}async function OE(n,e){let t=re(n);t.asyncQueue.verifyOperationInProgress(),V(fs,"RemoteStore received new credentials");let r=Xa(t);t.offlineCauses.add(3),await Za(t),r&&t.onlineStateTracker.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.offlineCauses.delete(3),await tu(t)}async function LB(n,e){let t=re(n);e?(t.offlineCauses.delete(2),await tu(t)):e||(t.offlineCauses.add(2),await Za(t),t.onlineStateTracker.set("Unknown"))}function bs(n){return n.watchStream||(n.watchStream=CB(n.datastore,n.asyncQueue,{onConnected:DB.bind(null,n),onOpen:xB.bind(null,n),onClose:NB.bind(null,n),onWatchChange:OB.bind(null,n)}),n.onNetworkStatusChange.push(async e=>{e?(n.watchStream.inhibitBackoff(),Ag(n)?Ig(n):n.onlineStateTracker.set("Unknown")):(await n.watchStream.stop(),Hw(n))})),n.watchStream}var FB="AsyncQueue",Vm=class n{constructor(e,t,r,i,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new hn,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(a=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,i,s){let a=Date.now()+r,o=new n(e,t,a,i,s);return o.start(r),o}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new G(F.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}};function Ww(n,e){if(Vt(FB,`${e}: ${n}`),_s(n))return new G(F.UNAVAILABLE,`${e}: ${n}`);throw n}var Lc=class n{static emptySet(e){return new n(e.comparator)}constructor(e){e?this.comparator=(t,r)=>e(t,r)||$.comparator(t.key,r.key):this.comparator=(t,r)=>$.comparator(t.key,r.key),this.keyedMap=Ra(),this.sortedSet=new Ie(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){let t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,r)=>(e(t),!1))}add(e){let t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){let t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){let i=t.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){let e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){let r=new n;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}};var Fc=class{constructor(){this.changeMap=new Ie($.comparator)}track(e){let t=e.doc.key,r=this.changeMap.get(t);if(!r){this.changeMap=this.changeMap.insert(t,e);return}e.type!==0&&r.type===3?this.changeMap=this.changeMap.insert(t,e):e.type===3&&r.type!==1?this.changeMap=this.changeMap.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.changeMap=this.changeMap.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.changeMap=this.changeMap.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.changeMap=this.changeMap.remove(t):e.type===1&&r.type===2?this.changeMap=this.changeMap.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.changeMap=this.changeMap.insert(t,{type:2,doc:e.doc}):K(63341,{change:e,oldChange:r})}getChanges(){let e=[];return this.changeMap.inorderTraversal((t,r)=>{e.push(r)}),e}},ps=class n{constructor(e,t,r,i,s,a,o,l,c){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=a,this.syncStateChanged=o,this.excludesMetadataChanges=l,this.hasCachedResults=c}static fromInitialDocuments(e,t,r,i,s){let a=[];return t.forEach(o=>{a.push({type:0,doc:o})}),new n(e,t,Lc.emptySet(t),a,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(this.fromCache!==e.fromCache||this.hasCachedResults!==e.hasCachedResults||this.syncStateChanged!==e.syncStateChanged||!this.mutatedKeys.isEqual(e.mutatedKeys)||!Jc(this.query,e.query)||!this.docs.isEqual(e.docs)||!this.oldDocs.isEqual(e.oldDocs))return!1;let t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==r[i].type||!t[i].doc.isEqual(r[i].doc))return!1;return!0}};var zm=class{constructor(){this.viewSnap=void 0,this.listeners=[]}hasRemoteListeners(){return this.listeners.some(e=>e.listensToRemoteStore())}};function BB(){return new Gm}var Gm=class{constructor(){this.queries=Qw(),this.onlineState="Unknown",this.snapshotsInSyncListeners=new Set}terminate(){$B(this,new G(F.ABORTED,"Firestore shutting down"))}};function Qw(){return new Pn(n=>_w(n),Jc)}async function UB(n,e){let t=re(n),r=3,i=e.query,s=t.queries.get(i);s?!s.hasRemoteListeners()&&e.listensToRemoteStore()&&(r=2):(s=new zm,r=e.listensToRemoteStore()?0:1);try{switch(r){case 0:s.viewSnap=await t.onListen(i,!0);break;case 1:s.viewSnap=await t.onListen(i,!1);break;case 2:await t.onFirstRemoteStoreListen(i);break;default:break}}catch(a){let o=Ww(a,`Initialization of query '${Wi(e.query)}' failed`);e.onError(o);return}t.queries.set(i,s),s.listeners.push(e),e.applyOnlineStateChange(t.onlineState),s.viewSnap&&e.onViewSnapshot(s.viewSnap)&&Rg(t)}async function qB(n,e){let t=re(n),r=e.query,i=3,s=t.queries.get(r);if(s){let a=s.listeners.indexOf(e);a>=0&&(s.listeners.splice(a,1),s.listeners.length===0?i=e.listensToRemoteStore()?0:1:!s.hasRemoteListeners()&&e.listensToRemoteStore()&&(i=2))}switch(i){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}}function VB(n,e){let t=re(n),r=!1;for(let i of e){let s=i.query,a=t.queries.get(s);if(a){for(let o of a.listeners)o.onViewSnapshot(i)&&(r=!0);a.viewSnap=i}}r&&Rg(t)}function zB(n,e,t){let r=re(n),i=r.queries.get(e);if(i)for(let s of i.listeners)s.onError(t);r.queries.delete(e)}function GB(n,e){let t=re(n);t.onlineState=e;let r=!1;t.queries.forEach((i,s)=>{for(let a of s.listeners)a.applyOnlineStateChange(e)&&(r=!0)}),r&&Rg(t)}function $B(n,e){let t=re(n),r=t.queries;t.queries=Qw(),r.forEach((i,s)=>{for(let a of s.listeners)a.onError(e)})}function Rg(n){n.snapshotsInSyncListeners.forEach(e=>{e.next()})}var $m;(function(n){n.Default="default",n.Cache="cache"})($m||($m={}));var jm=class{constructor(e,t,r){this.query=e,this.queryObserver=t,this.raisedInitialEvent=!1,this.snap=null,this.onlineState="Unknown",this.options=r||{}}onViewSnapshot(e){if(!this.options.includeMetadataChanges){let r=[];for(let i of e.docChanges)i.type!==3&&r.push(i);e=new ps(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.raisedInitialEvent?this.shouldRaiseEvent(e)&&(this.queryObserver.next(e),t=!0):this.shouldRaiseInitialEvent(e,this.onlineState)&&(this.raiseInitialEvent(e),t=!0),this.snap=e,t}onError(e){this.queryObserver.error(e)}applyOnlineStateChange(e){this.onlineState=e;let t=!1;return this.snap&&!this.raisedInitialEvent&&this.shouldRaiseInitialEvent(this.snap,e)&&(this.raiseInitialEvent(this.snap),t=!0),t}shouldRaiseInitialEvent(e,t){if(!e.fromCache||!this.listensToRemoteStore())return!0;let r=t!=="Offline";return this.options.waitForSyncWhenOnline&&r?!1:!e.docs.isEmpty()||e.hasCachedResults||t==="Offline"}shouldRaiseEvent(e){if(e.docChanges.length>0)return!0;let t=this.snap&&this.snap.hasPendingWrites!==e.hasPendingWrites;return e.syncStateChanged||t?this.options.includeMetadataChanges===!0:!1}raiseInitialEvent(e){e=ps.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.raisedInitialEvent=!0,this.queryObserver.next(e)}listensToRemoteStore(){return this.options.source!==$m.Cache}};var Km=class n{constructor(e,t,r,i){this.targetId=e,this.fromCache=t,this.addedKeys=r,this.removedKeys=i}static fromSnapshot(e,t){let r=se(),i=se();for(let s of t.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key);break}return new n(e,t.fromCache,r,i)}};var Bc=class{constructor(e){this.key=e}},Uc=class{constructor(e){this.key=e}},Hm=class{constructor(e,t){this.query=e,this._syncedDocuments=t,this.syncState=null,this.hasCachedResults=!1,this.current=!1,this.limboDocuments=se(),this.mutatedKeys=se(),this.docComparator=vw(e),this.documentSet=new Lc(this.docComparator)}get syncedDocuments(){return this._syncedDocuments}computeDocChanges(e,t){let r=t?t.changeSet:new Fc,i=t?t.documentSet:this.documentSet,s=t?t.mutatedKeys:this.mutatedKeys,a=i,o=!1,l=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,c=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((u,m)=>{let d=i.get(u),p=Zc(this.query,m)?m:null,E=d?this.mutatedKeys.has(d.key):!1,C=p?p.hasLocalMutations||this.mutatedKeys.has(p.key)&&p.hasCommittedMutations:!1,T=!1;d&&p?d.data.isEqual(p.data)?E!==C&&(r.track({type:3,doc:p}),T=!0):this.shouldWaitForSyncedDocument(d,p)||(r.track({type:2,doc:p}),T=!0,(l&&this.docComparator(p,l)>0||c&&this.docComparator(p,c)<0)&&(o=!0)):!d&&p?(r.track({type:0,doc:p}),T=!0):d&&!p&&(r.track({type:1,doc:d}),T=!0,(l||c)&&(o=!0)),T&&(p?(a=a.add(p),C?s=s.add(u):s=s.delete(u)):(a=a.delete(u),s=s.delete(u)))}),this.query.limit!==null)for(;a.size>this.query.limit;){let u=this.query.limitType==="F"?a.last():a.first();a=a.delete(u.key),s=s.delete(u.key),r.track({type:1,doc:u})}return{documentSet:a,changeSet:r,needsRefill:o,mutatedKeys:s}}shouldWaitForSyncedDocument(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,i){let s=this.documentSet;this.documentSet=e.documentSet,this.mutatedKeys=e.mutatedKeys;let a=e.changeSet.getChanges();a.sort((m,d)=>jB(m.type,d.type)||this.docComparator(m.doc,d.doc)),this.applyTargetChange(r),i=i??!1;let o=t&&!i?this.updateLimboDocuments():[],c=this.limboDocuments.size===0&&this.current&&!i?1:0,u=c!==this.syncState;return this.syncState=c,a.length===0&&!u?{limboChanges:o}:{snapshot:new ps(this.query,e.documentSet,s,a,e.mutatedKeys,c===0,u,!1,r?r.resumeToken.approximateByteSize()>0:!1),limboChanges:o}}applyOnlineStateChange(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({documentSet:this.documentSet,changeSet:new Fc,mutatedKeys:this.mutatedKeys,needsRefill:!1},!1)):{limboChanges:[]}}shouldBeInLimbo(e){return!(this._syncedDocuments.has(e)||!this.documentSet.has(e)||this.documentSet.get(e).hasLocalMutations)}applyTargetChange(e){e&&(e.addedDocuments.forEach(t=>this._syncedDocuments=this._syncedDocuments.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this._syncedDocuments=this._syncedDocuments.delete(t)),this.current=e.current)}updateLimboDocuments(){if(!this.current)return[];let e=this.limboDocuments;this.limboDocuments=se(),this.documentSet.forEach(r=>{this.shouldBeInLimbo(r.key)&&(this.limboDocuments=this.limboDocuments.add(r.key))});let t=[];return e.forEach(r=>{this.limboDocuments.has(r)||t.push(new Uc(r))}),this.limboDocuments.forEach(r=>{e.has(r)||t.push(new Bc(r))}),t}synchronizeWithPersistedState(e){this._syncedDocuments=e.remoteKeys,this.limboDocuments=se();let t=this.computeDocChanges(e.documents);return this.applyChanges(t,!0)}computeInitialSnapshot(){return ps.fromInitialDocuments(this.query,this.documentSet,this.mutatedKeys,this.syncState===0,this.hasCachedResults)}};function jB(n,e){let t=r=>{switch(r){case 0:return 1;case 2:return 2;case 3:return 2;case 1:return 0;default:return K(20277,{change:r})}};return t(n)-t(e)}var Dg="SyncEngine",Wm=class{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}},Qm=class{constructor(e){this.key=e,this.receivedDocument=!1}},Ym=class{constructor(e,t,r,i,s,a){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=a,this.syncEngineListener={},this.queryViewsByQuery=new Pn(o=>_w(o),Jc),this.queriesByTarget=new Map,this.enqueuedLimboResolutions=new Set,this.activeLimboTargetsByKey=new Ie($.comparator),this.activeLimboResolutionsByTarget=new Map,this.limboDocumentRefs=new ja,this.mutationUserCallbacks={},this.pendingWritesCallbacks=new Map,this.limboTargetIdGenerator=$a.forSyncEngine(),this.onlineState="Unknown",this._isPrimaryClient=void 0}get isPrimaryClient(){return this._isPrimaryClient===!0}};function KB(n,e,t,r,i,s,a){let o=new Ym(n,e,t,r,i,s);return a&&(o._isPrimaryClient=!0),o}async function HB(n,e,t=!0){let r=tT(n),i,s=r.queryViewsByQuery.get(e);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.computeInitialSnapshot()):i=await Yw(r,e,t,!0),i}async function WB(n,e){let t=tT(n);await Yw(t,e,!0,!1)}async function Yw(n,e,t,r){let i=await rB(n.localStore,qt(e)),s=i.targetId,a=n.sharedClientState.addLocalQueryTarget(s,t),o;return r&&(o=await QB(n,e,s,a==="current",i.resumeToken)),n.isPrimaryClient&&t&&jw(n.remoteStore,i),o}async function QB(n,e,t,r,i){n.applyDocChanges=(m,d,p)=>t3(n,m,d,p);let s=await Gw(n.localStore,e,!0),a=new Hm(e,s.remoteKeys),o=a.computeDocChanges(s.documents),l=za.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",i),c=a.applyChanges(o,n.isPrimaryClient,l);Xw(n,t,c.limboChanges);let u=new Wm(e,t,a);return n.queryViewsByQuery.set(e,u),n.queriesByTarget.has(t)?n.queriesByTarget.get(t).push(e):n.queriesByTarget.set(t,[e]),c.snapshot}async function YB(n,e,t){let r=re(n),i=r.queryViewsByQuery.get(e),s=r.queriesByTarget.get(i.targetId);if(s.length>1){r.queriesByTarget.set(i.targetId,s.filter(a=>!Jc(a,e))),r.queryViewsByQuery.delete(e);return}r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await Rm(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),t&&Tg(r.remoteStore,i.targetId),Jm(r,i.targetId)}).catch(Hc)):(Jm(r,i.targetId),await Rm(r.localStore,i.targetId,!0))}async function JB(n,e){let t=re(n),r=t.queryViewsByQuery.get(e),i=t.queriesByTarget.get(r.targetId);t.isPrimaryClient&&i.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),Tg(t.remoteStore,r.targetId))}async function Jw(n,e){let t=re(n);try{let r=await XF(t.localStore,e);e.targetChanges.forEach((i,s)=>{let a=t.activeLimboResolutionsByTarget.get(s);a&&(_e(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1,22616),i.addedDocuments.size>0?a.receivedDocument=!0:i.modifiedDocuments.size>0?_e(a.receivedDocument,14607):i.removedDocuments.size>0&&(_e(a.receivedDocument,42227),a.receivedDocument=!1))}),await eT(t,r,e)}catch(r){await Hc(r)}}function kE(n,e,t){let r=re(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){let i=[];r.queryViewsByQuery.forEach((s,a)=>{let o=a.view.applyOnlineStateChange(e);o.snapshot&&i.push(o.snapshot)}),GB(r.eventManager,e),i.length&&r.syncEngineListener.onWatchChange(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function ZB(n,e,t){let r=re(n);r.sharedClientState.updateQueryState(e,"rejected",t);let i=r.activeLimboResolutionsByTarget.get(e),s=i&&i.key;if(s){let a=new Ie($.comparator);a=a.insert(s,zt.newNoDocument(s,W.min()));let o=se().add(s),l=new Ic(W.min(),new Map,new Ie(ee),a,o);await Jw(r,l),r.activeLimboTargetsByKey=r.activeLimboTargetsByKey.remove(s),r.activeLimboResolutionsByTarget.delete(e),xg(r)}else await Rm(r.localStore,e,!1).then(()=>Jm(r,e,t)).catch(Hc)}function XB(n,e){n.pendingWritesCallbacks.forEach(t=>{t.forEach(r=>{r.reject(new G(F.CANCELLED,e))})}),n.pendingWritesCallbacks.clear()}function Jm(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(let r of n.queriesByTarget.get(e))n.queryViewsByQuery.delete(r),t&&n.syncEngineListener.onWatchError(r,t);n.queriesByTarget.delete(e),n.isPrimaryClient&&n.limboDocumentRefs.removeReferencesForId(e).forEach(i=>{n.limboDocumentRefs.containsKey(i)||Zw(n,i)})}function Zw(n,e){n.enqueuedLimboResolutions.delete(e.path.canonicalString());let t=n.activeLimboTargetsByKey.get(e);t!==null&&(Tg(n.remoteStore,t),n.activeLimboTargetsByKey=n.activeLimboTargetsByKey.remove(e),n.activeLimboResolutionsByTarget.delete(t),xg(n))}function Xw(n,e,t){for(let r of t)r instanceof Bc?(n.limboDocumentRefs.addReference(r.key,e),e3(n,r)):r instanceof Uc?(V(Dg,"Document no longer in limbo: "+r.key),n.limboDocumentRefs.removeReference(r.key,e),n.limboDocumentRefs.containsKey(r.key)||Zw(n,r.key)):K(19791,{limboChange:r})}function e3(n,e){let t=e.key,r=t.path.canonicalString();!n.activeLimboTargetsByKey.get(t)&&!n.enqueuedLimboResolutions.has(r)&&(V(Dg,"New document in limbo: "+t),n.enqueuedLimboResolutions.add(r),xg(n))}function xg(n){for(;n.enqueuedLimboResolutions.size>0&&n.activeLimboTargetsByKey.size<n.maxConcurrentLimboResolutions;){let e=n.enqueuedLimboResolutions.values().next().value;n.enqueuedLimboResolutions.delete(e);let t=new $(Te.fromString(e)),r=n.limboTargetIdGenerator.next();n.activeLimboResolutionsByTarget.set(r,new Qm(t)),n.activeLimboTargetsByKey=n.activeLimboTargetsByKey.insert(t,r),jw(n.remoteStore,new Ga(qt(vg(t.path)),r,"TargetPurposeLimboResolution",ns.INVALID))}}async function eT(n,e,t){let r=re(n),i=[],s=[],a=[];r.queryViewsByQuery.isEmpty()||(r.queryViewsByQuery.forEach((o,l)=>{a.push(r.applyDocChanges(l,e,t).then(c=>{if((c||t)&&r.isPrimaryClient){let u=c?!c.fromCache:t?.targetChanges.get(l.targetId)?.current;r.sharedClientState.updateQueryState(l.targetId,u?"current":"not-current")}if(c){i.push(c);let u=Km.fromSnapshot(l.targetId,c);s.push(u)}}))}),await Promise.all(a),r.syncEngineListener.onWatchChange(i),await nB(r.localStore,s))}async function t3(n,e,t,r){let i=e.view.computeDocChanges(t);i.needsRefill&&(i=await Gw(n.localStore,e.query,!1).then(({documents:l})=>e.view.computeDocChanges(l,i)));let s=r&&r.targetChanges.get(e.targetId),a=r&&r.targetMismatches.get(e.targetId)!=null,o=e.view.applyChanges(i,n.isPrimaryClient,s,a);return Xw(n,e.targetId,o.limboChanges),o.snapshot}async function n3(n,e){let t=re(n);if(!t.currentUser.isEqual(e)){V(Dg,"User change. New user:",e.toKey());let i=await Vw(t.localStore,e);t.currentUser=e,XB(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,i.removedBatchIds,i.addedBatchIds),await eT(t,i.affectedDocuments)}}function r3(n,e){let t=re(n),r=t.activeLimboResolutionsByTarget.get(e);if(r&&r.receivedDocument)return se().add(r.key);{let i=se(),s=t.queriesByTarget.get(e);if(!s)return i;for(let a of s){let o=t.queryViewsByQuery.get(a);i=i.unionWith(o.view.syncedDocuments)}return i}}function tT(n){let e=re(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=Jw.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=r3.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=ZB.bind(null,e),e.syncEngineListener.onWatchChange=VB.bind(null,e.eventManager),e.syncEngineListener.onWatchError=zB.bind(null,e.eventManager),e}var ms=class{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=wg(e.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(e),this.persistence=this.createPersistence(e),await this.persistence.start(),this.localStore=this.createLocalStore(e),this.gcScheduler=this.createGarbageCollectionScheduler(e,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(e,this.localStore)}createGarbageCollectionScheduler(e,t){return null}createIndexBackfillerScheduler(e,t){return null}createLocalStore(e){return ZF(this.persistence,new xm,e.initialUser,this.serializer)}createPersistence(e){return new Oc(Im.factory,this.serializer)}createSharedClientState(e){return new Nm}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}};ms.provider={build:()=>new ms};var Zm=class extends ms{constructor(e){super(),this.cacheSizeBytes=e}createGarbageCollectionScheduler(e,t){_e(this.persistence.referenceDelegate instanceof kc,46915);let r=this.persistence.referenceDelegate.garbageCollector;return new fm(r,e.asyncQueue,t)}createPersistence(e){let t=this.cacheSizeBytes!==void 0?Dt.withCacheSize(this.cacheSizeBytes):Dt.DEFAULT;return new Oc(r=>kc.factory(r,t),this.serializer)}};var Ka=class{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>kE(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=n3.bind(null,this.syncEngine),await LB(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return BB()}createDatastore(e){let t=wg(e.databaseInfo.databaseId),r=gB(e.databaseInfo);return TB(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return AB(this.localStore,this.datastore,e.asyncQueue,t=>kE(this.syncEngine,t,0),yB())}createSyncEngine(e,t){return KB(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){await RB(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}};Ka.provider={build:()=>new Ka};var Xm=class{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.scheduleEvent(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.scheduleEvent(this.observer.error,e):Vt("Uncaught Error in snapshot listener:",e.toString()))}mute(){this.muted=!0}scheduleEvent(e,t){setTimeout(()=>{this.muted||e(t)},0)}};var _r="FirestoreClient",i3=100,s3=11,a3=20,o3=22,eg=class{constructor(e,t,r,i,s){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=i,this.user=qe.UNAUTHENTICATED,this.clientId=ts.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(r,async a=>{V(_r,"Received user=",a.uid),await this.authCredentialListener(a),this.user=a}),this.appCheckCredentials.start(r,a=>(V(_r,"Received new app check token=",a),this.appCheckCredentialListener(a,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:i3}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();let e=new hn;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){let r=Ww(t,"Failed to shutdown persistence");e.reject(r)}}),e.promise}};async function Dp(n,e){n.asyncQueue.verifyOperationInProgress(),V(_r,"Initializing OfflineComponentProvider");let t=n.configuration;await e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener(async i=>{r.isEqual(i)||(await Vw(e.localStore,i),r=i)}),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e}async function ME(n,e){n.asyncQueue.verifyOperationInProgress();let t=await c3(n);V(_r,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener(r=>OE(e.remoteStore,r)),n.setAppCheckTokenChangeListener((r,i)=>OE(e.remoteStore,i)),n._onlineComponents=e}function l3(n){return n.name==="FirebaseError"?n.code===F.FAILED_PRECONDITION||n.code===F.UNIMPLEMENTED:typeof DOMException<"u"&&n instanceof DOMException?n.code===o3||n.code===a3||n.code===s3:!0}async function c3(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){V(_r,"Using user provided OfflineComponentProvider");try{await Dp(n,n._uninitializedComponentsProvider._offline)}catch(e){let t=e;if(!l3(t))throw t;Zi("Error using user provided cache. Falling back to memory cache: "+t),await Dp(n,new ms)}}else V(_r,"Using default OfflineComponentProvider"),await Dp(n,new Zm(void 0));return n._offlineComponents}async function u3(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(V(_r,"Using user provided OnlineComponentProvider"),await ME(n,n._uninitializedComponentsProvider._online)):(V(_r,"Using default OnlineComponentProvider"),await ME(n,new Ka))),n._onlineComponents}async function d3(n){let e=await u3(n),t=e.eventManager;return t.onListen=HB.bind(null,e.syncEngine),t.onUnlisten=YB.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=WB.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=JB.bind(null,e.syncEngine),t}function h3(n,e,t={}){let r=new hn;return n.asyncQueue.enqueueAndForget(async()=>{let i=await d3(n);return f3(i,n.asyncQueue,e,t,r)}),r.promise}function f3(n,e,t,r,i){let s=new Xm({next:o=>{s.mute(),e.enqueueAndForget(()=>qB(n,a));let l=o.docs.has(t);!l&&o.fromCache?i.reject(new G(F.UNAVAILABLE,"Failed to get document because the client is offline.")):l&&o.fromCache&&r&&r.source==="server"?i.reject(new G(F.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):i.resolve(o)},error:o=>i.reject(o)}),a=new jm(vg(t.path),s,{includeMetadataChanges:!0,waitForSyncWhenOnline:!0});return UB(n,a)}function p3(n,e){return n.timeoutSeconds===e.timeoutSeconds}function nT(n){let e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}var m3="ComponentProvider",PE=new Map;function g3(n){let e=PE.get(n);e&&(V(m3,"Removing Datastore"),PE.delete(n),e.terminate())}function y3(n,e,t,r){return new qp(n,e,t,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling,nT(r.experimentalLongPollingOptions),r.useFetchStreams,r.isUsingEmulator)}var rT="firestore.googleapis.com",LE=!0,FE=5,BE=30,_3=!0,qc=class{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new G(F.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=rT,this.ssl=LE}else this.host=e.host,this.ssl=e.ssl??LE;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=qw;else{if(e.cacheSizeBytes!==eu&&e.cacheSizeBytes<IE)throw new G(F.INVALID_ARGUMENT,`cacheSizeBytes must be at least ${IE}`);this.cacheSizeBytes=e.cacheSizeBytes}KM("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=_3:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=nT(e.experimentalLongPollingOptions??{}),v3(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&p3(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}};function v3(n){if(n.timeoutSeconds!==void 0){if(isNaN(n.timeoutSeconds))throw new G(F.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (must not be NaN)`);if(n.timeoutSeconds<FE)throw new G(F.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (minimum allowed value is ${FE})`);if(n.timeoutSeconds>BE)throw new G(F.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (maximum allowed value is ${BE})`)}}var Ha=class{constructor(e,t,r,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new qc({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new G(F.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new G(F.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new qc(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=qM(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return g3(this),Promise.resolve()}};function b3(n,e,t,r={}){n=Lp(n,Ha);let i=Bu(e),s=n._getSettings(),a={...s,emulatorOptions:n._getEmulatorOptions()},o=`${e}:${t}`;i&&(u_(`https://${o}`),h_("Firestore",!0)),s.host!==rT&&s.host!==o&&Zi("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");let l={...s,host:o,ssl:i,emulatorOptions:r};if(!oi(l,a)&&(n._setSettings(l),r.mockUserToken)){let c,u;if(typeof r.mockUserToken=="string")c=r.mockUserToken,u=qe.MOCK_USER;else{c=d_(r.mockUserToken,n._app?.options.projectId);let m=r.mockUserToken.sub||r.mockUserToken.user_id;if(!m)throw new G(F.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");u=new qe(m)}n._authCredentials=new Np(new bc(c,u))}}var tg=class n{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new n(this.firestore,e,this._query)}},ct=class n{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Wa(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new n(this.firestore,e,this._key)}toJSON(){return{type:n._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,r){if(Ja(t,n._jsonSchema))return new n(e,r||null,new $(Te.fromString(t.referencePath)))}};ct._jsonSchemaVersion="firestore/documentReference/1.0";ct._jsonSchema={type:De("string",ct._jsonSchemaVersion),referencePath:De("string")};var Wa=class n extends tg{constructor(e,t,r){super(e,t,vg(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let e=this._path.popLast();return e.isEmpty()?null:new ct(this.firestore,null,new $(e))}withConverter(e){return new n(this.firestore,e,this._path)}};function iT(n,e,...t){if(n=yo(n),arguments.length===1&&(e=ts.newId()),jM("doc","path",e),n instanceof Ha){let r=Te.fromString(e,...t);return aE(r),new ct(n,null,new $(r))}else{if(!(n instanceof ct)&&!(n instanceof Wa))throw new G(F.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=n._path.child(Te.fromString(e,...t));return aE(r),new ct(n.firestore,n instanceof Wa?n.converter:null,new $(r))}}var S3="AsyncQueue",Vc=class{constructor(e=Promise.resolve()){this.retryableOps=[],this._isShuttingDown=!1,this.delayedOperations=[],this.failure=null,this.operationInProgress=!1,this.skipNonRestrictedTasks=!1,this.timerIdsToSkip=[],this.backoff=new Pc(this,"async_queue_retry"),this.visibilityHandler=()=>{this.backoff.skipBackoff()},this.tail=e}get isShuttingDown(){return this._isShuttingDown}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.verifyNotFailed(),this.enqueueInternal(e)}enterRestrictedMode(e){this._isShuttingDown||(this._isShuttingDown=!0,this.skipNonRestrictedTasks=e||!1)}enqueue(e){if(this.verifyNotFailed(),this._isShuttingDown)return new Promise(()=>{});let t=new hn;return this.enqueueInternal(()=>this._isShuttingDown&&this.skipNonRestrictedTasks?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.retryableOps.push(e),this.retryNextOp()))}async retryNextOp(){if(this.retryableOps.length!==0){try{await this.retryableOps[0](),this.retryableOps.shift(),this.backoff.reset()}catch(e){if(_s(e))V(S3,"Operation failed with retryable error: "+e);else throw e}this.retryableOps.length>0&&this.backoff.backoffAndRun(()=>this.retryNextOp())}}enqueueInternal(e){let t=this.tail.then(()=>(this.operationInProgress=!0,e().catch(r=>{this.failure=r,this.operationInProgress=!1;let i=UE(r);throw Vt("INTERNAL UNHANDLED ERROR: ",i),r}).then(r=>(this.operationInProgress=!1,r))));return this.tail=t,t}enqueueAfterDelay(e,t,r){this.verifyNotFailed(),this.timerIdsToSkip.indexOf(e)>-1&&(t=0);let i=Vm.createAndSchedule(this,e,t,r,s=>this.removeDelayedOperation(s));return this.delayedOperations.push(i),i}verifyNotFailed(){this.failure&&K(47125,{messageOrStack:UE(this.failure)})}verifyOperationInProgress(){}async drain(){let e;do e=this.tail,await e;while(e!==this.tail)}containsDelayedOperation(e){for(let t of this.delayedOperations)if(t.timerId===e)return!0;return!1}runAllDelayedOperationsUntil(e){return this.drain().then(()=>{this.delayedOperations.sort((t,r)=>t.targetTimeMs-r.targetTimeMs);for(let t of this.delayedOperations)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.drain()})}skipDelaysForTimerId(e){this.timerIdsToSkip.push(e)}removeDelayedOperation(e){let t=this.delayedOperations.indexOf(e);this.delayedOperations.splice(t,1)}};function UE(n){let e=n.message||"";return n.stack&&(n.stack.includes(n.message)?e=n.stack:e=n.message+`
`+n.stack),e}var zc=class extends Ha{constructor(e,t,r,i){super(e,t,r,i),this.type="firestore",this._queue=new Vc,this._persistenceKey=i?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){let e=this._firestoreClient.terminate();this._queue=new Vc(e),this._firestoreClient=void 0,await e}}};function sT(n,e){let t=typeof n=="object"?n:N_(),r=typeof n=="string"?n:e||Vp,i=R_(t,"firestore").getImmediate({identifier:r});if(!i._initialized){let s=c_("firestore");s&&b3(i,...s)}return i}function E3(n){if(n._terminated)throw new G(F.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||w3(n),n._firestoreClient}function w3(n){let e=n._freezeSettings(),t=y3(n._databaseId,n._app?.options.appId||"",n._persistenceKey,e);n._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(n._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),n._firestoreClient=new eg(n._authCredentials,n._appCheckCredentials,n._queue,t,n._componentsProvider&&T3(n._componentsProvider))}function T3(n){let e=n?._online.build();return{_offline:n?._offline.build(e),_online:e}}function C3(n,e=!0){BM(x_),zs(new bn("firestore",(t,{instanceIdentifier:r,options:i})=>{let s=t.getProvider("app").getImmediate(),a=new zc(new Op(t.getProvider("auth-internal")),new Pp(s,t.getProvider("app-check-internal")),CP(s,r),s);return i={useFetchStreams:e,...i},a._setSettings(i),a},"PUBLIC").setMultipleInstances(!0)),zn(rE,iE,n),zn(rE,iE,"esm2020")}var vr=class n{constructor(e){this._byteString=e}static fromBase64String(e){try{return new n(Ye.fromBase64String(e))}catch(t){throw new G(F.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new n(Ye.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:n._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Ja(e,n._jsonSchema))return n.fromBase64String(e.bytes)}};vr._jsonSchemaVersion="firestore/bytes/1.0";vr._jsonSchema={type:De("string",vr._jsonSchemaVersion),bytes:De("string")};var Gc=class{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new G(F.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new xt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};var $c=class{constructor(e){this._methodName=e}};var br=class n{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new G(F.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new G(F.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return ee(this._lat,e._lat)||ee(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:n._jsonSchemaVersion}}static fromJSON(e){if(Ja(e,n._jsonSchema))return new n(e.latitude,e.longitude)}};br._jsonSchemaVersion="firestore/geoPoint/1.0";br._jsonSchema={type:De("string",br._jsonSchemaVersion),latitude:De("number"),longitude:De("number")};var Sr=class n{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return YF(this._values,e._values)}toJSON(){return{type:n._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Ja(e,n._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(t=>typeof t=="number"))return new n(e.vectorValues);throw new G(F.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}};Sr._jsonSchemaVersion="firestore/vectorValue/1.0";Sr._jsonSchema={type:De("string",Sr._jsonSchemaVersion),vectorValues:De("object")};var I3=/^__.*__$/;function aT(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw K(40011,{dataSource:n})}}var ng=class n{constructor(e,t,r,i,s,a){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.validatePath(),this.fieldTransforms=s||[],this.fieldMask=a||[]}get path(){return this.settings.path}get dataSource(){return this.settings.dataSource}contextWith(e){return new n({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}childContextForField(e){let t=this.path?.child(e),r=this.contextWith({path:t,arrayElement:!1});return r.validatePathSegment(e),r}childContextForFieldPath(e){let t=this.path?.child(e),r=this.contextWith({path:t,arrayElement:!1});return r.validatePath(),r}childContextForArray(e){return this.contextWith({path:void 0,arrayElement:!0})}createError(e){return ig(e,this.settings.methodName,this.settings.hasConverter||!1,this.path,this.settings.targetDoc)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}validatePath(){if(this.path)for(let e=0;e<this.path.length;e++)this.validatePathSegment(this.path.get(e))}validatePathSegment(e){if(e.length===0)throw this.createError("Document fields must not be empty");if(aT(this.dataSource)&&I3.test(e))throw this.createError('Document fields cannot begin and end with "__"')}},rg=class{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||wg(e)}createContext(e,t,r,i=!1){return new ng({dataSource:e,methodName:t,targetDoc:r,path:xt.emptyPath(),arrayElement:!1,hasConverter:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}};function oT(n,e){if(n=yo(n),cT(n))return N3("Unsupported field value:",e,n),lT(n,e);if(n instanceof $c)return R3(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.arrayElement&&e.dataSource!==4)throw e.createError("Nested arrays are not supported");return A3(n,e)}else return D3(n,e)}function lT(n,e){let t={};return rw(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):vs(n,(r,i)=>{let s=oT(i,e.childContextForField(r));s!=null&&(t[r]=s)}),{mapValue:{fields:t}}}function A3(n,e){let t=[],r=0;for(let i of n){let s=oT(i,e.childContextForArray(r));s==null&&(s={nullValue:"NULL_VALUE"}),t.push(s),r++}return{arrayValue:{values:t}}}function R3(n,e){if(!aT(e.dataSource))throw e.createError(`${n._methodName}() can only be used with update() and set()`);if(!e.path)throw e.createError(`${n._methodName}() is not currently supported inside arrays`);let t=n._toFieldTransform(e);t&&e.fieldTransforms.push(t)}function D3(n,e){if(n=yo(n),n===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return CL(e.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){let t=Ce.fromDate(n);return{timestampValue:mr(e.serializer,t)}}else if(n instanceof Ce){let t=new Ce(n.seconds,Math.floor(n.nanoseconds/1e3)*1e3);return{timestampValue:mr(e.serializer,t)}}else{if(n instanceof br)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof vr)return{bytesValue:Ow(e.serializer,n._byteString)};if(n instanceof ct){let t=e.databaseId,r=n.firestore._databaseId;if(!r.isEqual(t))throw e.createError(`Document reference is for database ${r.projectId}/${r.database} but should be for database ${t.projectId}/${t.database}`);return{referenceValue:Sg(n.firestore._databaseId||e.databaseId,n._key.path)}}else{if(n instanceof Sr)return x3(n,e);throw e.createError(`Unsupported field value: ${dg(n)}`)}}}function x3(n,e){return{mapValue:{fields:{[fg]:{stringValue:pg},[rs]:{arrayValue:{values:n.toArray().map(r=>{if(typeof r!="number")throw e.createError("VectorValues must only contain numeric values.");return bg(e.serializer,r)})}}}}}}function cT(n){return typeof n=="object"&&n!==null&&!(n instanceof Array)&&!(n instanceof Date)&&!(n instanceof Ce)&&!(n instanceof br)&&!(n instanceof vr)&&!(n instanceof ct)&&!(n instanceof $c)&&!(n instanceof Sr)}function N3(n,e,t){if(!cT(t)||!GE(t)){let r=dg(t);throw r==="an object"?e.createError(n+" a custom object"):e.createError(n+" "+r)}}var O3=new RegExp("[~\\*/\\[\\]]");function k3(n,e,t){if(e.search(O3)>=0)throw ig(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new Gc(...e.split("."))._internalPath}catch{throw ig(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function ig(n,e,t,r,i){let s=r&&!r.isEmpty(),a=i!==void 0,o=`Function ${e}() called with invalid data`;t&&(o+=" (via `toFirestore()`)"),o+=". ";let l="";return(s||a)&&(l+=" (found",s&&(l+=` in field ${r}`),a&&(l+=` in document ${i}`),l+=")"),new G(F.INVALID_ARGUMENT,o+n+l)}var jc=class{constructor(e,t,r,i,s){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new ct(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document)if(this._converter){let e=new sg(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}else return this._userDataWriter.convertValue(this._document.data.value);else return}get(e){if(this._document){let t=this._document.data.field(uT("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}},sg=class extends jc{data(){return super.data()}};function uT(n,e){return typeof e=="string"?k3(n,e):e instanceof Gc?e._internalPath:e._delegate._internalPath}var ag=class{convertValue(e,t="none"){switch(gr(e)){case 0:return null;case 1:return e.booleanValue;case 2:return ye(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Mn(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw K(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){let r={};return vs(e,(i,s)=>{r[i]=this.convertValue(s,t)}),r}convertVectorValue(e){let t=e.fields?.[rs].arrayValue?.values?.map(r=>ye(r.doubleValue));return new Sr(t)}convertGeoPoint(e){return new br(ye(e.latitude),ye(e.longitude))}convertArray(e,t){return(e.values||[]).map(r=>this.convertValue(r,t))}convertServerTimestamp(e,t){switch(t){case"previous":let r=Wc(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(ka(e));default:return null}}convertTimestamp(e){let t=kn(e);return new Ce(t.seconds,t.nanos)}convertDocumentKey(e,t){let r=Te.fromString(e);_e(Uw(r),9688,{name:e});let i=new Tc(r.get(1),r.get(3)),s=new $(r.popFirst(5));return i.isEqual(t)||Vt(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),s}};var og=xw();function Er(n){let e=JSON.stringify(n);return`${og.encode(e).byteLength}${e}`}var M3={metadata:{id:"test-bundle",createTime:{seconds:1577836805,nanos:6},version:1,totalDocuments:1,totalBytes:416}};Er(M3);var P3={documentMetadata:{name:"projects/test-project/databases/(default)/documents/collectionId/doc1",readTime:{seconds:5,nanos:6},exists:!0}};Er(P3);var L3={document:{name:"projects/test-project/databases/(default)/documents/collectionId/doc1",createTime:{seconds:1,nanos:2e6},updateTime:{seconds:3,nanos:4e3},fields:{foo:{stringValue:"value"},bar:{integerValue:-42}}}};Er(L3);var F3={documentMetadata:{name:"projects/test-project/databases/(default)/documents/collectionId/doc2",readTime:{seconds:5,nanos:6},exists:!0}};Er(F3);var B3={document:{name:"projects/test-project/databases/(default)/documents/collectionId/doc2",createTime:{seconds:1,nanos:2e6},updateTime:{seconds:3,nanos:4e3},fields:{foo:{stringValue:"value1"},bar:{integerValue:42},emptyArray:{arrayValue:{}},emptyMap:{mapValue:{}}}}};Er(B3);var U3={documentMetadata:{name:"projects/test-project/databases/(default)/documents/collectionId/nodoc",readTime:{seconds:5,nanos:6},exists:!1}};Er(U3);var q3={namedQuery:{name:"limitQuery",bundledQuery:{parent:"projects/fireeats-97d5e/databases/(default)/documents",structuredQuery:{from:[{collectionId:"node_3.7.5_7Li7XoCjutvNxwD0tpo9"}],orderBy:[{field:{fieldPath:"sort"},direction:"DESCENDING"}],limit:{value:1}},limitType:"FIRST"},readTime:{seconds:1590011379,nanos:191164e3}}};Er(q3);var V3={namedQuery:{name:"limitToLastQuery",bundledQuery:{parent:"projects/fireeats-97d5e/databases/(default)/documents",structuredQuery:{from:[{collectionId:"node_3.7.5_7Li7XoCjutvNxwD0tpo9"}],orderBy:[{field:{fieldPath:"sort"},direction:"ASCENDING"}],limit:{value:1}},limitType:"LAST"},readTime:{seconds:1590011379,nanos:543063e3}}};Er(V3);var z3=1,Kc=class{constructor(e,t){this.firestore=e,this.bundleId=t,this.documents=new Map,this.namedQueries=new Map,this.latestReadTime=new Ce(0,0),this.databaseId=e._databaseId,this.serializer=new xc(this.databaseId,!0),this.userDataReader=new rg(this.databaseId,!0,this.serializer)}addBundleDocument(e,t){let r=this.documents.get(e.documentPath),i=r?.metadata.queries,s=e.readTime,a=r?.metadata.readTime?Nw(r.metadata.readTime):null,o=!s&&a==null,l=s!==void 0&&(a==null||a<s);if((o||l)&&this.documents.set(e.documentPath,{document:this.toBundleDocument(e),metadata:{name:EE(this.serializer,e.documentKey),readTime:s?mr(this.serializer,s):void 0,exists:e.documentExists}}),s&&s>this.latestReadTime&&(this.latestReadTime=s),t){let c=this.documents.get(e.documentPath);c.metadata.queries=i||[],c.metadata.queries.push(t)}}addBundleQuery(e){if(this.namedQueries.has(e.name))throw new Error(`Query name conflict: ${name} has already been added.`);let t=new Ce(0,0);for(let s of e.docBundleDataArray)this.addBundleDocument(s,e.name),s.readTime&&s.readTime>t&&(t=s.readTime);let r=Lw(this.serializer,qt(e.query)),i={parent:e.parent,structuredQuery:r.queryTarget.structuredQuery};this.namedQueries.set(e.name,{name:e.name,bundledQuery:i,readTime:mr(this.serializer,t)})}toBundleDocument(e){let t=this.userDataReader.createContext(4,"internal toBundledDocument"),r=lT(e.documentData,t);return{name:EE(this.serializer,e.documentKey),fields:r.mapValue.fields,updateTime:mr(this.serializer,e.versionTime),createTime:mr(this.serializer,e.createdTime)}}lengthPrefixedString(e){let t=JSON.stringify(e);return`${og.encode(t).byteLength}${t}`}build(){let e="";for(let r of this.namedQueries.values())e+=this.lengthPrefixedString({namedQuery:r});for(let r of this.documents.values()){let i=r.metadata;e+=this.lengthPrefixedString({documentMetadata:i});let s=r.document;s&&(e+=this.lengthPrefixedString({document:s}))}let t={id:this.bundleId,createTime:mr(this.serializer,this.latestReadTime),version:z3,totalDocuments:this.documents.size,totalBytes:og.encode(e).length};return e=this.lengthPrefixedString({metadata:t})+e,e}};function G3(n,e,t,r){let i=new Kc(n,ts.newId());return i.addBundleDocument(dT(r,t,e)),i.build()}function $3(n,e,t,r,i,s,a){let o=[];for(let u=0;u<s.length;u++)o.push(dT(i[u],a[u],s[u]));let l={name:t,query:e,parent:r,docBundleDataArray:o},c=new Kc(n,t);return c.addBundleQuery(l),c.build()}function dT(n,e,t){return{documentData:e,documentKey:t.mutableCopy().key,documentPath:n,documentExists:!0,createdTime:t.createTime.toTimestamp(),readTime:t.readTime.toTimestamp(),versionTime:t.version.toTimestamp()}}var Yr=class{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}},Jr=class n extends jc{constructor(e,t,r,i,s,a){super(e,t,r,i,a),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document)if(this._converter){let t=new gs(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}else return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps);else return}get(e,t={}){if(this._document){let r=this._document.data.field(uT("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new G(F.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");let e=this._document,t={};if(t.type=n._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument())return t;let r=this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous");return t.bundle=G3(this._firestore,e,r,this.ref.path),t}};Jr._jsonSchemaVersion="firestore/documentSnapshot/1.0";Jr._jsonSchema={type:De("string",Jr._jsonSchemaVersion),bundleSource:De("string","DocumentSnapshot"),bundleName:De("string"),bundle:De("string")};var gs=class extends Jr{data(e={}){return super.data(e)}},Qa=class n{constructor(e,t,r,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new Yr(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){let e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(r=>{e.call(t,new gs(this._firestore,this._userDataWriter,r.key,r,new Yr(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){let t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new G(F.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return(!this._cachedChanges||this._cachedChangesIncludeMetadataChanges!==t)&&(this._cachedChanges=j3(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new G(F.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");let e={};e.type=n._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=ts.newId();let t=this._firestore._databaseId.database,i=`projects/${this._firestore._databaseId.projectId}/databases/${t}/documents`,s=[],a=[],o=[];return this.docs.forEach(l=>{l._document!==null&&(s.push(l._document),a.push(this._userDataWriter.convertObjectMap(l._document.data.value.mapValue.fields,"previous")),o.push(l.ref.path))}),e.bundle=$3(this._firestore,this.query._query,e.bundleName,i,o,s,a),e}};Qa._jsonSchemaVersion="firestore/querySnapshot/1.0";Qa._jsonSchema={type:De("string",Qa._jsonSchemaVersion),bundleSource:De("string","QuerySnapshot"),bundleName:De("string"),bundle:De("string")};function j3(n,e){if(n._snapshot.oldDocs.isEmpty()){let t=0;return n._snapshot.docChanges.map(r=>{let i=new gs(n._firestore,n._userDataWriter,r.doc.key,r.doc,new Yr(n._snapshot.mutatedKeys.has(r.doc.key),n._snapshot.fromCache),n.query.converter);return r.doc,{type:"added",doc:i,oldIndex:-1,newIndex:t++}})}else{let t=n._snapshot.oldDocs;return n._snapshot.docChanges.filter(r=>e||r.type!==3).map(r=>{let i=new gs(n._firestore,n._userDataWriter,r.doc.key,r.doc,new Yr(n._snapshot.mutatedKeys.has(r.doc.key),n._snapshot.fromCache),n.query.converter),s=-1,a=-1;return r.type!==0&&(s=t.indexOf(r.doc.key),t=t.delete(r.doc.key)),r.type!==1&&(t=t.add(r.doc),a=t.indexOf(r.doc.key)),{type:K3(r.type),doc:i,oldIndex:s,newIndex:a}})}}function K3(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return K(61501,{type:n})}}function hT(n){n=Lp(n,ct);let e=Lp(n.firestore,zc),t=E3(e);return h3(t,n._key).then(r=>H3(e,n,r))}var lg=class extends ag{constructor(e){super(),this.firestore=e}convertBytes(e){return new vr(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new ct(this.firestore,null,t)}};function H3(n,e,t){let r=t.docs.get(e._key),i=new lg(n);return new Jr(n,i,e._key,r,new Yr(t.hasPendingWrites,t.fromCache),e.converter)}C3("node");var W3={apiKey:"AIzaSyBjRN2L_WyJcfe-8kUHxjWfVW7FT0B8vp4",authDomain:"excalidraw-room-persistence.firebaseapp.com",projectId:"excalidraw-room-persistence",storageBucket:"excalidraw-room-persistence.appspot.com",messagingSenderId:"654800341332",appId:"1:654800341332:web:4a692de0d3383706"},Ng=null,Og=null;function Q3(){return Ng||(Ng=ed(W3)),Og||(Og=sT(Ng)),Og}async function Y3(n,e){console.log("[Excalidraw] Loading room from Firebase:",n);let t=Q3(),r=iT(t,"scenes",n),i=await hT(r);if(!i.exists())throw new Error(`Room not found in Firebase: ${n}`);console.log("[Excalidraw] Room document found!");let s=i.data();if(!s.ciphertext||!s.iv)throw new Error("Room data is missing ciphertext or iv");let a=new Uint8Array(s.ciphertext.toUint8Array()),o=new Uint8Array(s.iv.toUint8Array());console.log("[Excalidraw] Decrypting room data...");let l=Buffer.from(e,"base64"),c=await eo.webcrypto.subtle.importKey("raw",l,{name:"AES-GCM"},!0,["decrypt"]),u=await eo.webcrypto.subtle.decrypt({name:"AES-GCM",iv:o},c,a),m=new TextDecoder().decode(u),d=JSON.parse(m);console.log("[Excalidraw] Room decrypted successfully");let p;if(Array.isArray(d))p={type:"excalidraw",version:2,source:"https://excalidraw.com",elements:d,appState:{}};else if(d.type==="excalidraw")p=d;else throw new Error("Invalid room data format");return console.log("[Excalidraw] Room elements count:",p.elements.length),p}async function J3(n,e){let t=`https://json.excalidraw.com/api/v2/${n}`;console.log("[Excalidraw] Fetching from:",t);let r=await fetch(t);if(console.log("[Excalidraw] Response status:",r.status),!r.ok)throw r.status===404?new Error(`Scene not found: ${n}`):new Error(`Failed to fetch data: ${r.status} ${r.statusText}`);let i=await r.arrayBuffer(),s=new Uint8Array(i),a=new DataView(i);console.log("[Excalidraw] Received",s.length,"bytes");let o=0,l=a.getUint32(o,!1);o+=4,console.log("[Excalidraw] Binary format version:",l);let c=a.getUint32(o,!1);o+=4;let u=s.slice(o,o+c);o+=c;let m=new TextDecoder().decode(u),d=JSON.parse(m);console.log("[Excalidraw] Header:",d);let p=a.getUint32(o,!1);o+=4;let E=s.slice(o,o+p);o+=p;let C=a.getUint32(o,!1);o+=4;let T=s.slice(o,o+C),I=Buffer.from(e,"base64"),N=await eo.webcrypto.subtle.importKey("raw",I,{name:"AES-GCM"},!0,["decrypt"]);try{let A=await eo.webcrypto.subtle.decrypt({name:"AES-GCM",iv:E},N,T),S;if(d.compression==="pako@1"){let L=t_(new Uint8Array(A)),v=0;for(let y=0;y<L.length;y++)if(L[y]===123){v=y;break}S=new TextDecoder().decode(L.slice(v))}else S=new TextDecoder().decode(A);let P=JSON.parse(S);if(console.log("Parsed scene data keys:",Object.keys(P)),console.log("Scene type:",P.type),console.log("Elements count:",P.elements?.length),!P||typeof P!="object")throw new Error("Invalid JSON data: not an object");if(P.type!=="excalidraw")throw new Error(`Invalid Excalidraw data: expected type "excalidraw", got "${P.type||"undefined"}"`);if(!Array.isArray(P.elements))throw new Error('Invalid Excalidraw data: missing or invalid "elements" array');return P}catch(A){let S=A.message;throw S.includes("Invalid Excalidraw data")||S.includes("Invalid JSON data")?A:new Error(`Decryption failed. The key might be incorrect. Error: ${S}`)}}async function fT(n){console.log("[Excalidraw] Starting download from URL:",n);let e="";try{e=new URL(n).hash.slice(1),console.log("[Excalidraw] Parsed hash:",e)}catch{throw new Error("Invalid URL")}let t,r,i=!1;if(e.startsWith("json=")){let s=e.split("=")[1].split(",");t=s[0],r=s[1],console.log("[Excalidraw] JSON format - ID:",t)}else if(e.startsWith("room=")){let s=e.split("=")[1].split(",");t=s[0],r=s[1],i=!0,console.log("[Excalidraw] Room format - ID:",t)}else throw new Error("Invalid Excalidraw URL format. Must contain #json= or #room=");if(!t||!r)throw new Error("Could not extract ID or Key from URL");return i?Y3(t,r):J3(t,r)}var Z3={saveFolder:"logs"},nu=class extends yt.Plugin{async onload(){await this.loadSettings(),this.addCommand({id:"import-excalidraw-from-url",name:"Import Excalidraw from URL",callback:()=>{new Mg(this.app,this).open()}}),this.addSettingTab(new kg(this.app,this))}onunload(){}async loadSettings(){this.settings=Object.assign({},Z3,await this.loadData())}async saveSettings(){await this.saveData(this.settings)}async importFromUrl(e){try{new yt.Notice("Downloading Excalidraw scene...");let t=await fT(e),r=new Date,i=String(r.getDate()).padStart(2,"0"),s=String(r.getMonth()+1).padStart(2,"0"),a=String(r.getFullYear()).slice(-2),o=`${a}-${s}-${i}.excalidraw`,l=this.settings.saveFolder;l&&!await this.app.vault.adapter.exists(l)&&await this.app.vault.createFolder(l);let u=l?`${l}/${o}`:o,m=1;for(;await this.app.vault.adapter.exists(u);){let d=`${a}-${s}-${i}-${m}.excalidraw`;u=l?`${l}/${d}`:d,m++}await this.app.vault.create(u,JSON.stringify(t,null,2)),new yt.Notice(`Saved: ${u}`)}catch(t){new yt.Notice(`Error: ${t.message}`),console.error("[Excalidraw Import]",t)}}},kg=class extends yt.PluginSettingTab{constructor(e,t){super(e,t),this.plugin=t}display(){let{containerEl:e}=this;e.empty(),e.createEl("h2",{text:"Excalidraw Import Settings"}),new yt.Setting(e).setName("Save folder").setDesc("Folder where imported Excalidraw files will be saved. Leave empty to save in vault root.").addText(t=>t.setPlaceholder("logs").setValue(this.plugin.settings.saveFolder).onChange(async r=>{this.plugin.settings.saveFolder=r.trim(),await this.plugin.saveSettings()}))}},Mg=class extends yt.Modal{constructor(e,t){super(e),this.plugin=t}onOpen(){let{contentEl:e}=this;e.createEl("h2",{text:"Import Excalidraw from URL"}),e.createEl("p",{text:"Enter an Excalidraw URL (e.g., https://excalidraw.com/#json=... or https://excalidraw.com/#room=...)"});let r=e.createDiv({cls:"excalidraw-import-input"}).createEl("input",{type:"text",placeholder:"https://excalidraw.com/#json=..."});r.style.width="100%",r.style.marginBottom="10px";let i=e.createDiv({cls:"excalidraw-import-buttons"});i.style.display="flex",i.style.justifyContent="flex-end",i.style.gap="10px",i.createEl("button",{text:"Cancel"}).addEventListener("click",()=>this.close()),i.createEl("button",{text:"Import",cls:"mod-cta"}).addEventListener("click",async()=>{let o=r.value.trim();o?(this.close(),await this.plugin.importFromUrl(o)):new yt.Notice("Please enter a URL")}),r.addEventListener("keydown",async o=>{if(o.key==="Enter"){let l=r.value.trim();l&&(this.close(),await this.plugin.importFromUrl(l))}}),r.focus()}onClose(){let{contentEl:e}=this;e.empty()}};
/*! Bundled license information:

@grpc/proto-loader/build/src/util.js:
@grpc/proto-loader/build/src/index.js:
  (**
   * @license
   * Copyright 2018 gRPC authors.
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *     http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *
   *)

long/umd/index.js:
  (**
   * @license
   * Copyright 2009 The Closure Library Authors
   * Copyright 2020 Daniel Wirtz / The long.js Authors.
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *     http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *
   * SPDX-License-Identifier: Apache-2.0
   *)

pako/dist/pako.esm.mjs:
  (*! pako 2.1.0 https://github.com/nodeca/pako @license (MIT AND Zlib) *)

@firebase/util/dist/node-esm/index.node.esm.js:
@firebase/util/dist/node-esm/index.node.esm.js:
@firebase/util/dist/node-esm/index.node.esm.js:
@firebase/util/dist/node-esm/index.node.esm.js:
@firebase/util/dist/node-esm/index.node.esm.js:
@firebase/util/dist/node-esm/index.node.esm.js:
@firebase/util/dist/node-esm/index.node.esm.js:
@firebase/util/dist/node-esm/index.node.esm.js:
@firebase/util/dist/node-esm/index.node.esm.js:
@firebase/logger/dist/esm/index.esm.js:
@firebase/firestore/dist/index.node.mjs:
@firebase/firestore/dist/index.node.mjs:
@firebase/firestore/dist/index.node.mjs:
@firebase/firestore/dist/index.node.mjs:
@firebase/firestore/dist/index.node.mjs:
@firebase/firestore/dist/index.node.mjs:
@firebase/firestore/dist/index.node.mjs:
@firebase/firestore/dist/index.node.mjs:
@firebase/firestore/dist/index.node.mjs:
@firebase/firestore/dist/index.node.mjs:
@firebase/firestore/dist/index.node.mjs:
@firebase/firestore/dist/index.node.mjs:
@firebase/firestore/dist/index.node.mjs:
@firebase/firestore/dist/index.node.mjs:
@firebase/firestore/dist/index.node.mjs:
@firebase/firestore/dist/index.node.mjs:
@firebase/firestore/dist/index.node.mjs:
@firebase/firestore/dist/index.node.mjs:
@firebase/firestore/dist/index.node.mjs:
@firebase/firestore/dist/index.node.mjs:
@firebase/firestore/dist/index.node.mjs:
@firebase/firestore/dist/index.node.mjs:
  (**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/util/dist/node-esm/index.node.esm.js:
@firebase/util/dist/node-esm/index.node.esm.js:
@firebase/firestore/dist/index.node.mjs:
@firebase/firestore/dist/index.node.mjs:
@firebase/firestore/dist/index.node.mjs:
@firebase/firestore/dist/index.node.mjs:
@firebase/firestore/dist/index.node.mjs:
@firebase/firestore/dist/index.node.mjs:
@firebase/firestore/dist/index.node.mjs:
@firebase/firestore/dist/index.node.mjs:
@firebase/firestore/dist/index.node.mjs:
  (**
   * @license
   * Copyright 2022 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/util/dist/node-esm/index.node.esm.js:
  (**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2025 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2021 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/util/dist/node-esm/index.node.esm.js:
@firebase/component/dist/esm/index.esm.js:
@firebase/app/dist/esm/index.esm.js:
@firebase/app/dist/esm/index.esm.js:
@firebase/firestore/dist/index.node.mjs:
@firebase/firestore/dist/index.node.mjs:
@firebase/firestore/dist/index.node.mjs:
  (**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/util/dist/node-esm/index.node.esm.js:
firebase/app/dist/index.mjs:
@firebase/firestore/dist/index.node.mjs:
@firebase/firestore/dist/index.node.mjs:
@firebase/firestore/dist/index.node.mjs:
@firebase/firestore/dist/index.node.mjs:
@firebase/firestore/dist/index.node.mjs:
@firebase/firestore/dist/index.node.mjs:
@firebase/firestore/dist/index.node.mjs:
@firebase/firestore/dist/index.node.mjs:
@firebase/firestore/dist/index.node.mjs:
@firebase/firestore/dist/index.node.mjs:
@firebase/firestore/dist/index.node.mjs:
@firebase/firestore/dist/index.node.mjs:
@firebase/firestore/dist/index.node.mjs:
@firebase/firestore/dist/index.node.mjs:
@firebase/firestore/dist/index.node.mjs:
@firebase/firestore/dist/index.node.mjs:
@firebase/firestore/dist/index.node.mjs:
@firebase/firestore/dist/index.node.mjs:
@firebase/firestore/dist/index.node.mjs:
@firebase/firestore/dist/index.node.mjs:
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/util/dist/node-esm/index.node.esm.js:
  (**
   * @license
   * Copyright 2021 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/app/dist/esm/index.esm.js:
  (**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2023 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/app/dist/esm/index.esm.js:
  (**
   * @license
   * Copyright 2021 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/webchannel-wrapper/dist/bloom-blob/esm/bloom_blob_es2018.js:
  (** @license
  Copyright The Closure Library Authors.
  SPDX-License-Identifier: Apache-2.0
  *)
  (** @license
  
   Copyright The Closure Library Authors.
   SPDX-License-Identifier: Apache-2.0
  *)

@firebase/firestore/dist/index.node.mjs:
@firebase/firestore/dist/index.node.mjs:
@firebase/firestore/dist/index.node.mjs:
@firebase/firestore/dist/index.node.mjs:
  (**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.node.mjs:
@firebase/firestore/dist/index.node.mjs:
@firebase/firestore/dist/index.node.mjs:
@firebase/firestore/dist/index.node.mjs:
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.node.mjs:
  (**
   * @license
   * Copyright 2025 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2021 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.node.mjs:
@firebase/firestore/dist/index.node.mjs:
  (**
   * @license
   * Copyright 2018 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.node.mjs:
  (**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2022 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.node.mjs:
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2018 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.node.mjs:
@firebase/firestore/dist/index.node.mjs:
  (**
   * @license
   * Copyright 2022 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.node.mjs:
@firebase/firestore/dist/index.node.mjs:
@firebase/firestore/dist/index.node.mjs:
@firebase/firestore/dist/index.node.mjs:
@firebase/firestore/dist/index.node.mjs:
  (**
   * @license
   * Copyright 2023 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.node.mjs:
  (**
   * @license
   * Copyright 2024 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.node.mjs:
  (**
   * @license
   * Copyright 2021 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2021 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law | agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES | CONDITIONS OF ANY KIND, either express | implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.node.mjs:
  (**
   * @license
   * Copyright 2018 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.node.mjs:
  (**
   * @license
   * Copyright 2022 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2024 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.node.mjs:
  (**
   * @license
   * Copyright 2023 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.node.mjs:
  (**
   * @license
   * Copyright 2018 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.node.mjs:
  (**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2023 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.node.mjs:
  (**
   * @license
   * Copyright 2025 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.node.mjs:
  (**
   * @license
   * Copyright 2023 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.node.mjs:
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2023 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.node.mjs:
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2024 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.node.mjs:
  (**
   * @license
   * Copyright 2025 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.node.mjs:
@firebase/firestore/dist/index.node.mjs:
  (**
   * @license
   * Copyright 2021 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
*/
